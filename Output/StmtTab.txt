StmtID	SrcID	SourceLine	SrcComment	SrcRelevant	SrcBlockstart
1000001	1	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	0
1000002	1	       CBL CICS('SP,EDF')	0	0	1
1000003	1	      ******************************************************************	1	0	0
1000004	1	      *                                                                *	1	0	1
1000005	1	      *  Copyright IBM Corp. 2023                                      *	1	0	1
1000006	1	      *                                                                *	1	0	1
1000007	1	      ******************************************************************	1	0	1
1000009	1	      ******************************************************************	1	0	1
1000010	1	      * This program lists accounts belonging to a specified customer	1	0	1
1000011	1	      * number.	1	0	1
1000012	1	      ******************************************************************	1	0	1
1000014	1	       IDENTIFICATION DIVISION.	0	0	0
1000015	1	       PROGRAM-ID. BNK1CCA.	0	0	1
1000016	1	       AUTHOR. James O'Grady.	0	0	1
1000018	1	       ENVIRONMENT DIVISION.	0	0	1
1000019	1	       CONFIGURATION SECTION.	0	0	1
1000020	1	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
1000021	1	        SOURCE-COMPUTER.  IBM-370.	0	0	0
1000022	1	       OBJECT-COMPUTER.  IBM-370.	0	0	1
1000024	1	       INPUT-OUTPUT SECTION.	0	0	1
1000026	1	       DATA DIVISION.	0	0	1
1000027	1	       WORKING-STORAGE SECTION.	0	0	1
1000029	1	       01 WS-CICS-WORK-AREA.	0	0	1
1000030	1	          03 WS-CICS-RESP             PIC S9(8) COMP VALUE 0.	0	0	1
1000031	1	          03 WS-CICS-RESP2            PIC S9(8) COMP VALUE 0.	0	0	1
1000033	1	       01 WS-FAIL-INFO.	0	0	1
1000034	1	          03 FILLER                   PIC X(9)  value 'BNK1CCA  '.	0	0	1
1000035	1	          03 WS-CICS-FAIL-MSG         PIC X(70) VALUE ' '.	0	0	1
1000036	1	          03 FILLER                   PIC X(6)  VALUE ' RESP='.	0	0	1
1000037	1	          03 WS-CICS-RESP-DISP        PIC 9(10) VALUE 0.	0	0	1
1000038	1	          03 FILLER                   PIC X(7)  VALUE ' RESP2='.	0	0	1
1000039	1	          03 WS-CICS-RESP2-DISP       PIC 9(10) VALUE 0.	0	0	1
1000040	1	          03 FILLER                   PIC X(15) VALUE ' ABENDING TASK.'.	0	0	1
1000042	1	       01 SWITCHES.	0	0	1
1000043	1	           03 VALID-DATA-SW           PIC X VALUE 'Y'.	0	0	1
1000044	1	              88 VALID-DATA           VALUE 'Y'.	0	0	1
1000046	1	       01 FLAGS.	0	0	1
1000047	1	           03 SEND-FLAG               PIC X.	0	0	1
1000048	1	              88 SEND-ERASE           VALUE '1'.	0	0	1
1000049	1	              88 SEND-DATAONLY        VALUE '2'.	0	0	1
1000050	1	              88 SEND-DATAONLY-ALARM  VALUE '3'.	0	0	1
1000052	1	       01 ACTION-ALPHA.	0	0	1
1000053	1	           03 ACTION-NUM              PIC 9.	0	0	1
1000055	1	      *	1	0	0
1000056	1	      * The end of session message	1	0	1
1000057	1	      *	1	0	1
1000058	1	       01 END-OF-SESSION-MESSAGE      PIC X(13) VALUE 'Session Ended'.	0	0	0
1000060	1	       01 RESPONSE-CODE               PIC S9(8) COMP.	0	0	1
1000062	1	       01 COMMUNICATION-AREA          PIC X.	0	0	1
1000064	1	       COPY BNK1ACC.	0	0	1
1000066	1	       COPY DFHAID.	0	0	1
1000068	1	       01 COMM-DOB-SPLIT.	0	0	1
1000069	1	          03 COMM-DOB-SPLIT-DD         PIC 99.	0	0	1
1000070	1	          03 COMM-DOB-SPLIT-MM         PIC 99.	0	0	1
1000071	1	          03 COMM-DOB-SPLIT-YYYY       PIC 9999.	0	0	1
1000073	1	       01 COMM-ADDR-SPLIT.	0	0	1
1000074	1	          03 COMM-ADDR-SPLIT1          PIC X(60).	0	0	1
1000075	1	          03 COMM-ADDR-SPLIT2          PIC X(60).	0	0	1
1000076	1	          03 COMM-ADDR-SPLIT3          PIC X(40).	0	0	1
1000078	1	       01 WS-COMM-AREA.	0	0	1
1000079	1	          03 WS-COMM-EYE               PIC X(4).	0	0	1
1000080	1	          03 WS-COMM-SCODE             PIC X(6).	0	0	1
1000081	1	          03 WS-COMM-CUSTNO            PIC X(10).	0	0	1
1000082	1	          03 WS-COMM-NAME              PIC X(60).	0	0	1
1000083	1	          03 WS-COMM-ADDR              PIC X(160).	0	0	1
1000084	1	          03 WS-COMM-DOB               PIC 9(8).	0	0	1
1000086	1	       01 WS-CONVERSION.	0	0	1
1000087	1	          03 WS-AVAIL-BAL-9            PIC 9(10)V99.	0	0	1
1000088	1	          03 WS-AVAIL-BAL-CONV-X REDEFINES WS-AVAIL-BAL-9.	0	0	1
1000089	1	             05 WS-AVAIL-BAL-X-PND         PIC X(10).	0	0	1
1000090	1	             05 WS-AVAIL-BAL-X-PNCE        PIC X(2).	0	0	1
1000091	1	          03 WS-ACT-BAL-9              PIC 9(10)V99.	0	0	1
1000092	1	          03 WS-ACT-BAL-CONV-X REDEFINES WS-ACT-BAL-9.	0	0	1
1000093	1	             05 WS-ACT-BAL-X-PND           PIC X(10).	0	0	1
1000094	1	             05 WS-ACT-BAL-X-PNCE          PIC X(2).	0	0	1
1000096	1	       01 INQACCCU-PROGRAM             PIC X(8) VALUE 'INQACCCU'.	0	0	1
1000097	1	       01 INQACCCU-COMMAREA.	0	0	1
1000098	1	          COPY INQACCCU.	0	0	1
1000100	1	       01 WS-INDEX                     PIC S9(8) BINARY.	0	0	1
1000101	1	       01 SCODE-CHAR                   PIC X(6).	0	0	1
1000102	1	       01 ACCNO-CHAR                   PIC X(8).	0	0	1
1000103	1	       01 NUMBER-OF-ACCOUNTS-DISPLAY   PIC Z9 DISPLAY.	0	0	1
1000105	1	       01 WS-AVAIL-BAL-SIGN            PIC X VALUE ' '.	0	0	1
1000106	1	       01 WS-ACT-BAL-SIGN              PIC X VALUE ' '.	0	0	1
1000108	1	       01 DUMP-TITLE                   PIC X(16)	0	0	1
1000109	1	                                          VALUE 'BNK1CCA DUMP NOW'.	0	0	1
1000111	1	       01 COMPANY-NAME-FULL            PIC X(32).	0	0	1
1000113	1	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
1000114	1	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
1000115	1	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
1000116	1	          03 WS-ORIG-DATE-DD              PIC 99.	0	0	1
1000117	1	          03 FILLER                       PIC X.	0	0	1
1000118	1	          03 WS-ORIG-DATE-MM              PIC 99.	0	0	1
1000119	1	          03 FILLER                       PIC X.	0	0	1
1000120	1	          03 WS-ORIG-DATE-YYYY            PIC 9999.	0	0	1
1000122	1	       01 WS-ORIG-DATE-GRP-X.	0	0	1
1000123	1	          03 WS-ORIG-DATE-DD-X         PIC XX.	0	0	1
1000124	1	          03 FILLER                    PIC X VALUE '.'.	0	0	1
1000125	1	          03 WS-ORIG-DATE-MM-X         PIC XX.	0	0	1
1000126	1	          03 FILLER                    PIC X VALUE '.'.	0	0	1
1000127	1	          03 WS-ORIG-DATE-YYYY-X       PIC X(4).	0	0	1
1000129	1	       01 WS-TIME-DATA.	0	0	1
1000130	1	           03 WS-TIME-NOW              PIC 9(6).	0	0	1
1000131	1	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
1000132	1	              05 WS-TIME-NOW-GRP-HH       PIC 99.	0	0	1
1000133	1	              05 WS-TIME-NOW-GRP-MM       PIC 99.	0	0	1
1000134	1	              05 WS-TIME-NOW-GRP-SS       PIC 99.	0	0	1
1000136	1	       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.	0	0	1
1000138	1	       01 ABNDINFO-REC.	0	0	1
1000139	1	           COPY ABNDINFO.	0	0	1
1000141	1	       LINKAGE SECTION.	0	0	1
1000142	1	       01 DFHCOMMAREA.	0	0	1
1000143	1	          03 COMM-EYE                  PIC X(4).	0	0	1
1000144	1	          03 COMM-SCODE                PIC X(6).	0	0	1
1000145	1	          03 COMM-CUSTNO               PIC X(10).	0	0	1
1000146	1	          03 COMM-NAME                 PIC X(60).	0	0	1
1000147	1	          03 COMM-ADDR                 PIC X(160).	0	0	1
1000148	1	          03 COMM-DOB                  PIC 9(8).	0	0	1
1000152	1	       PROCEDURE DIVISION.	0	0	1
1000153	1	       PREMIERE SECTION.	0	0	1
1000154	1	       A010.	0	0	1
1000156	1	           EVALUATE TRUE	0	0	1
1000158	1	      *	1	0	0
1000159	1	      *       Is it the first time through? If so, send the map	1	0	1
1000160	1	      *       with erased (empty) data fields.	1	0	1
1000161	1	      *	1	0	1
1000162	1	              WHEN EIBCALEN = ZERO	0	0	0
1000163	1	                 MOVE LOW-VALUE TO BNK1ACCO	0	0	1
1000164	1	                 MOVE -1 TO CUSTNOL	0	0	1
1000165	1	                 SET SEND-ERASE TO TRUE	0	0	1
1000166	1	                 PERFORM SEND-MAP	0	0	1
1000168	1	      *	1	0	0
1000169	1	      *       If a PA key is pressed, just carry on	1	0	1
1000170	1	      *	1	0	1
1000171	1	              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3	0	0	0
1000172	1	                 CONTINUE	0	0	1
1000174	1	      *	1	0	0
1000175	1	      *       When Pf3 is pressed, return to the main menu	1	0	1
1000176	1	      *	1	0	1
1000177	1	              WHEN EIBAID = DFHPF3	0	0	0
1000178	1	                 EXEC CICS RETURN	0	0	1
1000179	1	                    TRANSID('OMEN')	0	0	1
1000180	1	                    IMMEDIATE	0	0	1
1000181	1	                    RESP(WS-CICS-RESP)	0	0	1
1000182	1	                    RESP2(WS-CICS-RESP2)	0	0	1
1000183	1	                 END-EXEC	0	0	1
1000185	1	      *	1	0	0
1000186	1	      *       If the aid or Pf12 is pressed, then send a termination	1	0	1
1000187	1	      *       message.	1	0	1
1000188	1	      *	1	0	1
1000189	1	              WHEN EIBAID = DFHAID OR DFHPF12	0	0	0
1000190	1	                 PERFORM SEND-TERMINATION-MSG	0	0	1
1000191	1	                 EXEC CICS	0	0	1
1000192	1	                    RETURN	0	0	1
1000193	1	                 END-EXEC	0	0	1
1000195	1	      *	1	0	0
1000196	1	      *       When CLEAR is pressed	1	0	1
1000197	1	      *	1	0	1
1000198	1	              WHEN EIBAID = DFHCLEAR	0	0	0
1000199	1	                 EXEC CICS SEND CONTROL	0	0	1
1000200	1	                          ERASE	0	0	1
1000201	1	                          FREEKB	0	0	1
1000202	1	                 END-EXEC	0	0	1
1000204	1	                 EXEC CICS RETURN	0	0	1
1000205	1	                 END-EXEC	0	0	1
1000207	1	      *	1	0	0
1000208	1	      *       When enter is presseed then process the content	1	0	1
1000209	1	      *	1	0	1
1000210	1	              WHEN EIBAID = DFHENTER	0	0	0
1000211	1	                  PERFORM PROCESS-MAP	0	0	1
1000213	1	      *	1	0	0
1000214	1	      *       When anything else happens, send the invalid key message	1	0	1
1000215	1	      *	1	0	1
1000216	1	              WHEN OTHER	0	0	0
1000217	1	                 MOVE LOW-VALUES TO BNK1ACCO	0	0	1
1000218	1	                 MOVE 'Invalid key pressed.' TO MESSAGEO	0	0	1
1000219	1	                  MOVE -1 TO CUSTNOL	0	0	1
1000220	1	                 SET SEND-DATAONLY-ALARM TO TRUE	0	0	1
1000221	1	                 PERFORM SEND-MAP	0	0	1
1000223	1	           END-EVALUATE.	0	0	1
1000225	1	           EXEC CICS	0	0	1
1000226	1	               RETURN TRANSID('OCCA')	0	0	1
1000227	1	               COMMAREA(WS-COMM-AREA)	0	0	1
1000228	1	               LENGTH(248)	0	0	1
1000229	1	               RESP(WS-CICS-RESP)	0	0	1
1000230	1	               RESP2(WS-CICS-RESP2)	0	0	1
1000231	1	           END-EXEC.	0	0	1
1000233	1	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
1000234	1	      *	1	0	0
1000235	1	      *       Preserve the RESP and RESP2, then set up the	1	0	1
1000236	1	      *       standard ABEND info before getting the applid,	1	0	1
1000237	1	      *       date/time etc. and linking to the Abend Handler	1	0	1
1000238	1	      *       program.	1	0	1
1000239	1	      *	1	0	1
1000240	1	              INITIALIZE ABNDINFO-REC	0	0	0
1000241	1	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
1000242	1	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
1000243	1	      *	1	0	0
1000244	1	      *       Get supplemental information	1	0	1
1000245	1	      *	1	0	1
1000246	1	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
1000247	1	              END-EXEC	0	0	1
1000249	1	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
1000250	1	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
1000252	1	              PERFORM POPULATE-TIME-DATE	0	0	1
1000254	1	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
1000255	1	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
1000256	1	                    ':' DELIMITED BY SIZE,	0	0	1
1000257	1	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
1000258	1	                     ':' DELIMITED BY SIZE,	0	0	1
1000259	1	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
1000260	1	                     INTO ABND-TIME	0	0	1
1000261	1	              END-STRING	0	0	1
1000263	1	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
1000264	1	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
1000266	1	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
1000267	1	              END-EXEC	0	0	1
1000269	1	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
1000271	1	              STRING 'A010 - RETURN TRANSID(OCCA) FAIL'	0	0	1
1000272	1	                    DELIMITED BY SIZE,	0	0	1
1000273	1	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
1000274	1	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
1000275	1	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
1000276	1	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
1000277	1	                    INTO ABND-FREEFORM	0	0	1
1000278	1	              END-STRING	0	0	1
1000280	1	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
1000281	1	                        COMMAREA(ABNDINFO-REC)	0	0	1
1000282	1	              END-EXEC	0	0	1
1000284	1	              INITIALIZE WS-FAIL-INFO	0	0	1
1000285	1	              MOVE 'BNK1CCA - A010 - RETURN TRANSID(OCCA) FAIL' TO	0	0	1
1000286	1	                 WS-CICS-FAIL-MSG	0	0	1
1000287	1	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
1000288	1	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
1000289	1	              PERFORM ABEND-THIS-TASK	0	0	1
1000290	1	           END-IF.	0	0	1
1000292	1	       A999.	0	0	1
1000293	1	           EXIT.	0	0	1
1000296	1	        PROCESS-MAP SECTION.	0	0	1
1000297	1	        PM010.	0	0	1
1000298	1	      *	1	0	0
1000299	1	      *    Retrieve the data from the map	1	0	1
1000300	1	      *	1	0	1
1000301	1	           PERFORM RECEIVE-MAP.	0	0	0
1000303	1	      *	1	0	0
1000304	1	      *    Validate the received data	1	0	1
1000305	1	      *	1	0	1
1000306	1	           PERFORM EDIT-DATA.	0	0	0
1000308	1	      *	1	0	0
1000309	1	      *    If the data passes validation go on to	1	0	1
1000310	1	      *    retrieve the CUSTOMER information	1	0	1
1000311	1	      *	1	0	1
1000312	1	           IF VALID-DATA	0	0	0
1000313	1	              PERFORM GET-CUST-DATA	0	0	1
1000314	1	           END-IF.	0	0	1
1000316	1	           SET SEND-DATAONLY-ALARM TO TRUE.	0	0	1
1000318	1	      *	1	0	0
1000319	1	      *    Output the data to the screen	1	0	1
1000320	1	      *	1	0	1
1000321	1	           PERFORM SEND-MAP.	0	0	0
1000323	1	        PM999.	0	0	1
1000324	1	            EXIT.	0	0	1
1000327	1	        RECEIVE-MAP SECTION.	0	0	1
1000328	1	        RM010.	0	0	1
1000329	1	      *	1	0	0
1000330	1	      *    Retrieve the data	1	0	1
1000331	1	      *	1	0	1
1000332	1	            INITIALIZE BNK1ACCI.	0	0	0
1000333	1	            EXEC CICS	0	0	1
1000334	1	               RECEIVE MAP('BNK1ACC')	0	0	1
1000335	1	               MAPSET('BNK1ACC')	0	0	1
1000336	1	               INTO(BNK1ACCI)	0	0	1
1000337	1	               RESP(WS-CICS-RESP)	0	0	1
1000338	1	               RESP2(WS-CICS-RESP2)	0	0	1
1000339	1	            END-EXEC.	0	0	1
1000341	1	            IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
1000343	1	      *	1	0	0
1000344	1	      *        Preserve the RESP and RESP2, then set up the	1	0	1
1000345	1	      *        standard ABEND info before getting the applid,	1	0	1
1000346	1	      *        date/time etc. and linking to the Abend Handler	1	0	1
1000347	1	      *        program.	1	0	1
1000348	1	      *	1	0	1
1000349	1	               INITIALIZE ABNDINFO-REC	0	0	0
1000350	1	               MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
1000351	1	               MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
1000352	1	      *	1	0	0
1000353	1	      *        Get supplemental information	1	0	1
1000354	1	      *	1	0	1
1000355	1	               EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
1000356	1	               END-EXEC	0	0	1
1000358	1	               MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
1000359	1	               MOVE EIBTRNID   TO ABND-TRANID	0	0	1
1000361	1	               PERFORM POPULATE-TIME-DATE	0	0	1
1000363	1	               MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
1000364	1	               STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
1000365	1	                     ':' DELIMITED BY SIZE,	0	0	1
1000366	1	                      WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
1000367	1	                      ':' DELIMITED BY SIZE,	0	0	1
1000368	1	                      WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
1000369	1	                      INTO ABND-TIME	0	0	1
1000370	1	               END-STRING	0	0	1
1000372	1	               MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
1000373	1	               MOVE 'HBNK'      TO ABND-CODE	0	0	1
1000375	1	               EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
1000376	1	               END-EXEC	0	0	1
1000378	1	               MOVE ZEROS      TO ABND-SQLCODE	0	0	1
1000380	1	               STRING 'RM010 - RECEIVE MAP FAIL.'	0	0	1
1000381	1	                     DELIMITED BY SIZE,	0	0	1
1000382	1	                     'EIBRESP=' DELIMITED BY SIZE,	0	0	1
1000383	1	                     ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
1000384	1	                     ' RESP2=' DELIMITED BY SIZE,	0	0	1
1000385	1	                     ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
1000386	1	                     INTO ABND-FREEFORM	0	0	1
1000387	1	               END-STRING	0	0	1
1000389	1	               EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
1000390	1	                         COMMAREA(ABNDINFO-REC)	0	0	1
1000391	1	               END-EXEC	0	0	1
1000394	1	               INITIALIZE WS-FAIL-INFO	0	0	1
1000395	1	               MOVE 'BNKMENU - RM010 - RECEIVE MAP FAIL ' TO	0	0	1
1000396	1	                  WS-CICS-FAIL-MSG	0	0	1
1000397	1	               MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
1000398	1	               MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
1000399	1	               PERFORM ABEND-THIS-TASK	0	0	1
1000400	1	            END-IF.	0	0	1
1000402	1	        RM999.	0	0	1
1000403	1	            EXIT.	0	0	1
1000406	1	        EDIT-DATA SECTION.	0	0	1
1000407	1	        ED010.	0	0	1
1000408	1	      *	1	0	0
1000409	1	      *    Perform validation on the incoming fields	1	0	1
1000410	1	      *	1	0	1
1000411	1	           IF CUSTNOI NOT NUMERIC	0	0	0
1000412	1	              MOVE 'Please enter a customer number.' TO	0	0	1
1000413	1	                  MESSAGEO	0	0	1
1000414	1	              MOVE 'N' TO VALID-DATA-SW	0	0	1
1000415	1	           END-IF.	0	0	1
1000417	1	        ED999.	0	0	1
1000418	1	            EXIT.	0	0	1
1000421	1	        GET-CUST-DATA SECTION.	0	0	1
1000422	1	        GCD010.	0	0	1
1000423	1	      *	1	0	0
1000424	1	      *    Set up the fields required by INQACCCU then link to it	1	0	1
1000425	1	      *	1	0	1
1000426	1	           MOVE 20 TO NUMBER-OF-ACCOUNTS.	0	0	0
1000427	1	           MOVE 'N' TO COMM-SUCCESS OF INQACCCU-COMMAREA.	0	0	1
1000429	1	           MOVE CUSTNOI TO CUSTOMER-NUMBER OF INQACCCU-COMMAREA.	0	0	1
1000430	1	           SET COMM-PCB-POINTER TO NULL.	0	0	1
1000432	1	      *	1	0	0
1000433	1	      *    Link to INQACCCU	1	0	1
1000434	1	      *	1	0	1
1000435	1	           EXEC CICS LINK	0	0	0
1000436	1	               PROGRAM(INQACCCU-PROGRAM)	0	0	1
1000437	1	               COMMAREA(INQACCCU-COMMAREA)	0	0	1
1000438	1	               RESP(WS-CICS-RESP)	0	0	1
1000439	1	               RESP2(WS-CICS-RESP2)	0	0	1
1000440	1	               SYNCONRETURN	0	0	1
1000441	1	           END-EXEC.	0	0	1
1000443	1	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
1000444	1	      *	1	0	0
1000445	1	      *       Preserve the RESP and RESP2, then set up the	1	0	1
1000446	1	      *       standard ABEND info before getting the applid,	1	0	1
1000447	1	      *       date/time etc. and linking to the Abend Handler	1	0	1
1000448	1	      *       program.	1	0	1
1000449	1	      *	1	0	1
1000450	1	              INITIALIZE ABNDINFO-REC	0	0	0
1000451	1	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
1000452	1	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
1000453	1	      *	1	0	0
1000454	1	      *       Get supplemental information	1	0	1
1000455	1	      *	1	0	1
1000456	1	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
1000457	1	              END-EXEC	0	0	1
1000459	1	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
1000460	1	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
1000462	1	              PERFORM POPULATE-TIME-DATE	0	0	1
1000464	1	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
1000465	1	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
1000466	1	                     ':' DELIMITED BY SIZE,	0	0	1
1000467	1	                             WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
1000468	1	                      ':' DELIMITED BY SIZE,	0	0	1
1000469	1	                      WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
1000470	1	                      INTO ABND-TIME	0	0	1
1000471	1	              END-STRING	0	0	1
1000473	1	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
1000474	1	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
1000476	1	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
1000477	1	              END-EXEC	0	0	1
1000479	1	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
1000481	1	              STRING 'GCD010 - LINK INQACCCU FAIL.'	0	0	1
1000482	1	                     DELIMITED BY SIZE,	0	0	1
1000483	1	                     'EIBRESP=' DELIMITED BY SIZE,	0	0	1
1000484	1	                     ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
1000485	1	                     ' RESP2=' DELIMITED BY SIZE,	0	0	1
1000486	1	                     ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
1000487	1	                     INTO ABND-FREEFORM	0	0	1
1000488	1	              END-STRING	0	0	1
1000490	1	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
1000491	1	                         COMMAREA(ABNDINFO-REC)	0	0	1
1000492	1	              END-EXEC	0	0	1
1000494	1	              INITIALIZE WS-FAIL-INFO	0	0	1
1000495	1	              MOVE 'BNK1CCA - GCD010 - LINK INQACCCU  FAIL      '	0	0	1
1000496	1	                 TO WS-CICS-FAIL-MSG	0	0	1
1000497	1	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
1000498	1	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
1000499	1	              PERFORM ABEND-THIS-TASK	0	0	1
1000500	1	           END-IF.	0	0	1
1000502	1	      *	1	0	0
1000503	1	      *    If no matching customer was found	1	0	1
1000504	1	      *	1	0	1
1000505	1	           IF CUSTOMER-FOUND = 'N'	0	0	0
1000506	1	              MOVE SPACES TO MESSAGEO	0	0	1
1000507	1	              STRING 'Unable to find customer '	0	0	1
1000508	1	                 CUSTOMER-NUMBER DELIMITED BY SIZE	0	0	1
1000509	1	              INTO MESSAGEO	0	0	1
1000511	1	      *	1	0	0
1000512	1	      *       Empty the account numbers in the on screen array	1	0	1
1000513	1	      *	1	0	1
1000514	1	              PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL	0	0	0
1000515	1	              WS-INDEX > 10	0	0	1
1000516	1	                 MOVE SPACES TO ACCOUNTO(WS-INDEX)	0	0	1
1000517	1	              END-PERFORM	0	0	1
1000519	1	              GO TO GCD999	0	0	1
1000520	1	           END-IF.	0	0	1
1000522	1	      *	1	0	0
1000523	1	      *    If a customer was found, empty the account numbers	1	0	1
1000524	1	      *    in the on screen array	1	0	1
1000525	1	      *	1	0	1
1000526	1	           PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL	0	0	0
1000527	1	           WS-INDEX > 10	0	0	1
1000528	1	              MOVE SPACES to ACCOUNTO(ws-index)	0	0	1
1000529	1	           END-PERFORM.	0	0	1
1000531	1	           IF NUMBER-OF-ACCOUNTS = ZERO	0	0	1
1000532	1	              MOVE 'No accounts found for customer' to MESSAGEO	0	0	1
1000533	1	           ELSE	0	0	1
1000534	1	              IF COMM-SUCCESS = 'N'	0	0	1
1000535	1	                 MOVE SPACES TO MESSAGEO	0	0	1
1000536	1	                 STRING 'Error accessing accounts for customer '	0	0	1
1000537	1	                    CUSTOMER-NUMBER '.' DELIMITED BY SIZE	0	0	1
1000538	1	                 INTO MESSAGEO	0	0	1
1000539	1	              ELSE	0	0	1
1000540	1	                 MOVE NUMBER-OF-ACCOUNTS TO NUMBER-OF-ACCOUNTS-DISPLAY	0	0	1
1000541	1	                 MOVE SPACES TO MESSAGEO	0	0	1
1000542	1	                 STRING NUMBER-OF-ACCOUNTS-DISPLAY	0	0	1
1000543	1	                    DELIMITED BY SIZE,	0	0	1
1000544	1	                    ' accounts found' DELIMITED BY SIZE	0	0	1
1000545	1	                 INTO MESSAGEO	0	0	1
1000546	1	              END-IF	0	0	1
1000548	1	      *	1	0	0
1000549	1	      *       Populate the account number/s on screen (along	1	0	1
1000550	1	      *       with other information returned from INQACCCU).	1	0	1
1000551	1	      *	1	0	1
1000552	1	              PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL	0	0	0
1000553	1	              WS-INDEX > NUMBER-OF-ACCOUNTS	0	0	1
1000554	1	              OR WS-INDEX > 10	0	0	1
1000555	1	                 MOVE COMM-SCODE OF INQACCCU-COMMAREA(WS-INDEX)	0	0	1
1000556	1	                    TO SCODE-CHAR	0	0	1
1000557	1	                 MOVE COMM-ACCNO(WS-INDEX) TO ACCNO-CHAR	0	0	1
1000558	1	                 MOVE SPACES TO ACCOUNTO(WS-INDEX)	0	0	1
1000559	1	                 MOVE ' ' TO WS-AVAIL-BAL-SIGN	0	0	1
1000560	1	                 MOVE ' ' TO WS-ACT-BAL-SIGN	0	0	1
1000562	1	                 IF COMM-AVAIL-BAL(WS-INDEX) < 0	0	0	1
1000563	1	                    MOVE '-' TO WS-AVAIL-BAL-SIGN	0	0	1
1000564	1	                 ELSE	0	0	1
1000565	1	                    MOVE '+' TO WS-AVAIL-BAL-SIGN	0	0	1
1000566	1	                 END-IF	0	0	1
1000568	1	                 IF COMM-ACTUAL-BAL(WS-INDEX) < 0	0	0	1
1000569	1	                    MOVE '-' TO WS-ACT-BAL-SIGN	0	0	1
1000570	1	                 ELSE	0	0	1
1000571	1	                    MOVE '+' TO WS-ACT-BAL-SIGN	0	0	1
1000572	1	                 END-IF	0	0	1
1000574	1	                 MOVE COMM-AVAIL-BAL(WS-INDEX) TO	0	0	1
1000575	1	                    WS-AVAIL-BAL-9	0	0	1
1000576	1	                 MOVE COMM-ACTUAL-BAL(WS-INDEX) TO	0	0	1
1000577	1	                    WS-ACT-BAL-9	0	0	1
1000579	1	                 STRING	0	0	1
1000580	1	                    SCODE-CHAR  DELIMITED BY SIZE	0	0	1
1000581	1	                    '      '    DELIMITED BY SIZE	0	0	1
1000582	1	                    ACCNO-CHAR  DELIMITED BY SIZE	0	0	1
1000583	1	                    '         ' DELIMITED BY SIZE	0	0	1
1000584	1	                    COMM-ACC-TYPE(WS-INDEX)	0	0	1
1000585	1	                                DELIMITED BY SIZE	0	0	1
1000586	1	                    '       '	0	0	1
1000587	1	                                DELIMITED BY SIZE	0	0	1
1000588	1	                    WS-AVAIL-BAL-SIGN	0	0	1
1000589	1	                                DELIMITED BY SIZE	0	0	1
1000590	1	                    WS-AVAIL-BAL-X-PND	0	0	1
1000591	1	                                DELIMITED BY SIZE	0	0	1
1000592	1	                    '.'	0	0	1
1000593	1	                                DELIMITED BY SIZE	0	0	1
1000594	1	                    WS-AVAIL-BAL-X-PNCE	0	0	1
1000595	1	                                DELIMITED BY SIZE	0	0	1
1000596	1	                    '  '	0	0	1
1000597	1	                                DELIMITED BY SIZE	0	0	1
1000598	1	                    WS-ACT-BAL-SIGN	0	0	1
1000599	1	                                DELIMITED BY SIZE	0	0	1
1000600	1	                    WS-ACT-BAL-X-PND	0	0	1
1000601	1	                               DELIMITED BY SIZE	0	0	1
1000602	1	                    '.'	0	0	1
1000603	1	                               DELIMITED BY SIZE	0	0	1
1000604	1	                    WS-ACT-BAL-X-PNCE	0	0	1
1000605	1	                               DELIMITED BY SIZE	0	0	1
1000606	1	                 INTO ACCOUNTO(WS-INDEX)	0	0	1
1000607	1	              END-PERFORM	0	0	1
1000609	1	           END-IF.	0	0	1
1000611	1	        GCD999.	0	0	1
1000612	1	            EXIT.	0	0	1
1000615	1	        SEND-MAP SECTION.	0	0	1
1000616	1	        SM010.	0	0	1
1000618	1	      *	1	0	0
1000619	1	      *    If the map needs to have its data erased	1	0	1
1000620	1	      *	1	0	1
1000621	1	           IF SEND-ERASE	0	0	0
1000622	1	               EXEC CICS SEND MAP('BNK1ACC')	0	0	1
1000623	1	                  MAPSET('BNK1ACC')	0	0	1
1000624	1	                  FROM(BNK1ACCO)	0	0	1
1000625	1	                  ERASE	0	0	1
1000626	1	                  RESP(WS-CICS-RESP)	0	0	1
1000627	1	                  RESP2(WS-CICS-RESP2)	0	0	1
1000628	1	               END-EXEC	0	0	1
1000630	1	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
1000631	1	      *	1	0	0
1000632	1	      *          Preserve the RESP and RESP2, then set up the	1	0	1
1000633	1	      *          standard ABEND info before getting the applid,	1	0	1
1000634	1	      *          date/time etc. and linking to the Abend Handler	1	0	1
1000635	1	      *          program.	1	0	1
1000636	1	      *	1	0	1
1000637	1	                 INITIALIZE ABNDINFO-REC	0	0	0
1000638	1	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
1000639	1	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
1000640	1	      *	1	0	0
1000641	1	      *          Get supplemental information	1	0	1
1000642	1	      *	1	0	1
1000643	1	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
1000644	1	                 END-EXEC	0	0	1
1000646	1	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
1000647	1	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
1000649	1	                 PERFORM POPULATE-TIME-DATE	0	0	1
1000651	1	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
1000652	1	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
1000653	1	                       ':' DELIMITED BY SIZE,	0	0	1
1000654	1	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
1000655	1	                        ':' DELIMITED BY SIZE,	0	0	1
1000656	1	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
1000657	1	                        INTO ABND-TIME	0	0	1
1000658	1	                 END-STRING	0	0	1
1000660	1	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
1000661	1	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
1000663	1	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
1000664	1	                 END-EXEC	0	0	1
1000666	1	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
1000668	1	                 STRING 'SM010 - SEND MAP ERASE FAIL.'	0	0	1
1000669	1	                       DELIMITED BY SIZE,	0	0	1
1000670	1	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
1000671	1	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
1000672	1	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
1000673	1	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
1000674	1	                       INTO ABND-FREEFORM	0	0	1
1000675	1	                 END-STRING	0	0	1
1000677	1	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
1000678	1	                           COMMAREA(ABNDINFO-REC)	0	0	1
1000679	1	                 END-EXEC	0	0	1
1000681	1	                 INITIALIZE WS-FAIL-INFO	0	0	1
1000682	1	                 MOVE 'BNK1CCA - SM010 - SEND MAP ERASE FAIL '	0	0	1
1000683	1	                    TO WS-CICS-FAIL-MSG	0	0	1
1000684	1	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
1000685	1	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
1000686	1	                 PERFORM ABEND-THIS-TASK	0	0	1
1000687	1	              END-IF	0	0	1
1000689	1	              GO TO SM999	0	0	1
1000690	1	           END-IF.	0	0	1
1000692	1	      *	1	0	0
1000693	1	      *    If the map just needs a resend of only the data	1	0	1
1000694	1	      *	1	0	1
1000695	1	           IF SEND-DATAONLY	0	0	0
1000696	1	              EXEC CICS SEND MAP('BNK1ACC')	0	0	1
1000697	1	                 MAPSET('BNK1ACC')	0	0	1
1000698	1	                 FROM(BNK1ACCO)	0	0	1
1000699	1	                 DATAONLY	0	0	1
1000700	1	                 RESP(WS-CICS-RESP)	0	0	1
1000701	1	                 RESP2(WS-CICS-RESP2)	0	0	1
1000702	1	              END-EXEC	0	0	1
1000704	1	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
1000706	1	      *	1	0	0
1000707	1	      *          Preserve the RESP and RESP2, then set up the	1	0	1
1000708	1	      *          standard ABEND info before getting the applid,	1	0	1
1000709	1	      *          date/time etc. and linking to the Abend Handler	1	0	1
1000710	1	      *          program.	1	0	1
1000711	1	      *	1	0	1
1000712	1	                 INITIALIZE ABNDINFO-REC	0	0	0
1000713	1	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
1000714	1	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
1000715	1	      *	1	0	0
1000716	1	      *          Get supplemental information	1	0	1
1000717	1	      *	1	0	1
1000718	1	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
1000719	1	                 END-EXEC	0	0	1
1000721	1	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
1000722	1	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
1000724	1	                 PERFORM POPULATE-TIME-DATE	0	0	1
1000726	1	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
1000727	1	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
1000728	1	                       ':' DELIMITED BY SIZE,	0	0	1
1000729	1	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
1000730	1	                        ':' DELIMITED BY SIZE,	0	0	1
1000731	1	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
1000732	1	                        INTO ABND-TIME	0	0	1
1000733	1	                 END-STRING	0	0	1
1000735	1	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
1000736	1	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
1000738	1	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
1000739	1	                 END-EXEC	0	0	1
1000741	1	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
1000743	1	                 STRING 'SM010 - SEND MAP DATAONLY FAIL.'	0	0	1
1000744	1	                       DELIMITED BY SIZE,	0	0	1
1000745	1	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
1000746	1	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
1000747	1	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
1000748	1	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
1000749	1	                       INTO ABND-FREEFORM	0	0	1
1000750	1	                 END-STRING	0	0	1
1000752	1	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
1000753	1	                           COMMAREA(ABNDINFO-REC)	0	0	1
1000754	1	                 END-EXEC	0	0	1
1000757	1	                 INITIALIZE WS-FAIL-INFO	0	0	1
1000758	1	                 MOVE 'BNK1CCA - SM010 - SEND MAP DATAONLY FAIL '	0	0	1
1000759	1	                    TO WS-CICS-FAIL-MSG	0	0	1
1000760	1	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
1000761	1	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
1000762	1	                 PERFORM ABEND-THIS-TASK	0	0	1
1000763	1	              END-IF	0	0	1
1000765	1	              GO TO SM999	0	0	1
1000766	1	           END-IF.	0	0	1
1000768	1	      *	1	0	0
1000769	1	      *    If we have elected to send the map and a beep	1	0	1
1000770	1	      *	1	0	1
1000771	1	           IF SEND-DATAONLY-ALARM	0	0	0
1000772	1	              EXEC CICS SEND MAP('BNK1ACC')	0	0	1
1000773	1	                 MAPSET('BNK1ACC')	0	0	1
1000774	1	                 FROM(BNK1ACCO)	0	0	1
1000775	1	                 DATAONLY	0	0	1
1000776	1	                 ALARM	0	0	1
1000777	1	                 RESP(WS-CICS-RESP)	0	0	1
1000778	1	                 RESP2(WS-CICS-RESP2)	0	0	1
1000779	1	              END-EXEC	0	0	1
1000781	1	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
1000784	1	      *	1	0	0
1000785	1	      *          Preserve the RESP and RESP2, then set up the	1	0	1
1000786	1	      *          standard ABEND info before getting the applid,	1	0	1
1000787	1	      *          date/time etc. and linking to the Abend Handler	1	0	1
1000788	1	      *          program.	1	0	1
1000789	1	      *	1	0	1
1000790	1	                 INITIALIZE ABNDINFO-REC	0	0	0
1000791	1	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
1000792	1	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
1000793	1	      *	1	0	0
1000794	1	      *          Get supplemental information	1	0	1
1000795	1	      *	1	0	1
1000796	1	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
1000797	1	                 END-EXEC	0	0	1
1000799	1	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
1000800	1	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
1000802	1	                 PERFORM POPULATE-TIME-DATE	0	0	1
1000804	1	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
1000805	1	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
1000806	1	                       ':' DELIMITED BY SIZE,	0	0	1
1000807	1	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
1000808	1	                        ':' DELIMITED BY SIZE,	0	0	1
1000809	1	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
1000810	1	                        INTO ABND-TIME	0	0	1
1000811	1	                 END-STRING	0	0	1
1000813	1	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
1000814	1	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
1000816	1	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
1000817	1	                 END-EXEC	0	0	1
1000819	1	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
1000821	1	                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL.'	0	0	1
1000822	1	                       DELIMITED BY SIZE,	0	0	1
1000823	1	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
1000824	1	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
1000825	1	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
1000826	1	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
1000827	1	                       INTO ABND-FREEFORM	0	0	1
1000828	1	                 END-STRING	0	0	1
1000830	1	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
1000831	1	                           COMMAREA(ABNDINFO-REC)	0	0	1
1000832	1	                 END-EXEC	0	0	1
1000835	1	                 INITIALIZE WS-FAIL-INFO	0	0	1
1000836	1	                 MOVE 'BNK1CCA - SM010 - SEND MAP DATAONLY ALARM FAIL '	0	0	1
1000837	1	                    TO WS-CICS-FAIL-MSG	0	0	1
1000838	1	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
1000839	1	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
1000840	1	                 PERFORM ABEND-THIS-TASK	0	0	1
1000841	1	              END-IF	0	0	1
1000843	1	           END-IF.	0	0	1
1000845	1	       SM999.	0	0	1
1000846	1	           EXIT.	0	0	1
1000849	1	       SEND-TERMINATION-MSG SECTION.	0	0	1
1000850	1	       STM010.	0	0	1
1000851	1	      *	1	0	0
1000852	1	      *    Send the termination message	1	0	1
1000853	1	      *	1	0	1
1000854	1	           EXEC CICS SEND TEXT	0	0	0
1000855	1	              FROM(END-OF-SESSION-MESSAGE)	0	0	1
1000856	1	              ERASE	0	0	1
1000857	1	              FREEKB	0	0	1
1000858	1	              RESP(WS-CICS-RESP)	0	0	1
1000859	1	              RESP2(WS-CICS-RESP2)	0	0	1
1000860	1	           END-EXEC.	0	0	1
1000862	1	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
1000863	1	      *	1	0	0
1000864	1	      *       Preserve the RESP and RESP2, then set up the	1	0	1
1000865	1	      *       standard ABEND info before getting the applid,	1	0	1
1000866	1	      *       date/time etc. and linking to the Abend Handler	1	0	1
1000867	1	      *       program.	1	0	1
1000868	1	      *	1	0	1
1000869	1	              INITIALIZE ABNDINFO-REC	0	0	0
1000870	1	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
1000871	1	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
1000872	1	      *	1	0	0
1000873	1	      *       Get supplemental information	1	0	1
1000874	1	      *	1	0	1
1000875	1	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
1000876	1	              END-EXEC	0	0	1
1000878	1	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
1000879	1	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
1000881	1	              PERFORM POPULATE-TIME-DATE	0	0	1
1000883	1	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
1000884	1	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
1000885	1	                    ':' DELIMITED BY SIZE,	0	0	1
1000886	1	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
1000887	1	                     ':' DELIMITED BY SIZE,	0	0	1
1000888	1	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
1000889	1	                     INTO ABND-TIME	0	0	1
1000890	1	              END-STRING	0	0	1
1000892	1	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
1000893	1	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
1000895	1	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
1000896	1	              END-EXEC	0	0	1
1000898	1	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
1000900	1	              STRING 'STM010 - SEND TEXT FAIL.'	0	0	1
1000901	1	                    DELIMITED BY SIZE,	0	0	1
1000902	1	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
1000903	1	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
1000904	1	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
1000905	1	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
1000906	1	                    INTO ABND-FREEFORM	0	0	1
1000907	1	              END-STRING	0	0	1
1000909	1	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
1000910	1	                        COMMAREA(ABNDINFO-REC)	0	0	1
1000911	1	              END-EXEC	0	0	1
1000913	1	              INITIALIZE WS-FAIL-INFO	0	0	1
1000914	1	              MOVE 'BNK1CCA - STM010 - SEND TEXT FAIL'	0	0	1
1000915	1	                 TO WS-CICS-FAIL-MSG	0	0	1
1000916	1	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
1000917	1	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
1000918	1	              PERFORM ABEND-THIS-TASK	0	0	1
1000919	1	           END-IF.	0	0	1
1000921	1	       STM999.	0	0	1
1000922	1	           EXIT.	0	0	1
1000925	1	       ABEND-THIS-TASK SECTION.	0	0	1
1000926	1	       ATT010.	0	0	1
1000927	1	           DISPLAY WS-FAIL-INFO.	0	0	1
1000928	1	           EXEC CICS ABEND	0	0	1
1000929	1	              ABCODE('HBNK')	0	0	1
1000930	1	              NODUMP	0	0	1
1000931	1	           END-EXEC.	0	0	1
1000933	1	       ATT999.	0	0	1
1000934	1	           EXIT.	0	0	1
1000937	1	       POPULATE-TIME-DATE SECTION.	0	0	1
1000938	1	       PTD010.	0	0	1
1000940	1	           EXEC CICS ASKTIME	0	0	1
1000941	1	              ABSTIME(WS-U-TIME)	0	0	1
1000942	1	           END-EXEC.	0	0	1
1000944	1	           EXEC CICS FORMATTIME	0	0	1
1000945	1	                     ABSTIME(WS-U-TIME)	0	0	1
1000946	1	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
1000947	1	                     TIME(WS-TIME-NOW)	0	0	1
1000948	1	                     DATESEP	0	0	1
1000949	1	           END-EXEC.	0	0	1
1000951	1	       PTD999.	0	0	1
1000952	1	           EXIT.	0	0	1
2000000	2	<<<< included file >>>>	0	0	0
2000001	2	       01  RETURN-CODE PIC S9(4) COMP.	0	0	1
2000002	2	       01  SORT-CORE-SIZE PIC S9(8) COMP.	0	0	0
2000003	2	       01  SORT-MODE-SIZE PIC S9(8) COMP.	0	0	0
2000004	2	       01  SORT-FILE-SIZE PIC S9(8) COMP.	0	0	0
2000005	2	       01  SORT-RETURN PIC S9(8) COMP.	0	0	0
2000006	2	       01  TALLY PIC S9(5) COMP.	0	0	0
2000007	2	      * IBM	1	0	1
2000008	2	      *01  CURRENT-DATE PIC X(8).	1	0	0
2000009	2	       01  SHIFT-OUT PIC X(1) VALUE X"E".	0	0	1
2000010	2	       01  SHIFT-IN PIC X(1) VALUE X"F".	0	0	0
2000011	2	       01  SORT-CONTROL PIC X(8) VALUE "IGZSRTCD".	0	0	0
2000012	2	       01  SORT-MESSAGE PIC X(8).	0	0	0
2000013	2	       01  TIME-OF-DAY PIC X(6).	0	0	0
2000014	2	       01  WHEN-COMPILED PIC X(16).	0	0	0
2000015	2	       01  SQL-INIT-FLAG PIC 9.	0	0	0
2000016	2	      * BS2000	1	0	1
2000017	2	       01  SORT-EOW PIC S9(7) COMP-3.	0	0	1
2000019	2	      * USE DEBUGGING	1	0	1
2000020	2	       01  DEBUG-ITEM.	0	0	1
2000021	2	             02 DEBUG-LINE PIC X(6).	0	0	0
2000022	2	             02 FILLER PIC X VALUE SPACE.	0	0	0
2000023	2	             02 DEBUG-NAME PIC X(36).	0	0	0
2000024	2	             02 FILLER PIC X VALUE SPACE.	0	0	0
2000025	2	             02 DEBUG-SUB-1 PIC S9999 SIGN LEADING SEPARATE.	0	0	0
2000026	2	             02 FILLER PIC X VALUE SPACE.	0	0	0
2000027	2	             02 DEBUG-SUB-2 PIC S9999 SIGN LEADING SEPARATE.	0	0	0
2000028	2	             02 FILLER PIC X VALUE SPACE.	0	0	0
2000029	2	             02 DEBUG-SUB-3 PIC S9999 SIGN LEADING SEPARATE.	0	0	0
2000030	2	             02 FILLER PIC X VALUE SPACE.	0	0	0
2000031	2	             02 DEBUG-CONTENTS PIC X(1).	0	0	0
2000033	2	      * JSON	1	0	1
2000034	2	       01 JSON-CODE PICTURE S9(9) USAGE BINARY VALUE 0.	0	0	1
2000035	2	       01 JSON-STATUS PICTURE S9(9) USAGE BINARY VALUE 0.	0	0	0
2000037	2	      * XML	1	0	1
2000038	2	       01  XML-CODE  PIC S9(9) COMP VALUE 0.	0	0	1
2000039	2	       01  XML-EVENT PIC X(30) VALUE SPACE.	0	0	0
2000040	2	       01  XML-NTEXT.	0	0	0
2000041	2	       01  XML-TEXT.	0	0	0
2000042	2	       01  XML-NAMESPACE.	0	0	0
2000043	2	       01  XML-NNAMESPACE.	0	0	0
2000044	2	       01  XML-NAMESPACE-PREFIX.	0	0	0
2000045	2	       01  XML-NNAMESPACE-PREFIX.	0	0	0
2000046	2	       01  XML-INFORMATION PIC S9(9) COMP VALUE 0.	0	0	0
3000000	3	<<<< file not found >>>>	0	0	0
3000001	3	<<<< file not found >>>>	0	0	0
4000000	4	<<<< included file >>>>	0	0	0
4000001	4	*******                                                                 01000000	1	0	1
4000002	4	*******   COPYRIGHT = 5655-018 (C) COPYRIGHT IBM CORP. 1985  =          01100000	1	0	0
4000003	4	*******               THIS MODULE IS "RESTRICTED MATERIALS OF=IBM"      01200000	1	0	0
4000004	4	*******               LICENSED MATERIALS - PROPERTY OF IBM   =          01300000	1	0	0
4000005	4	*******               REFER TO COPYRIGHT INSTRUCTIONS        =          01400000	1	0	0
4000006	4	*******               FORM NUMBER G120-2083                  =          01500000	1	0	0
4000007	4	*******                                                                 01600000	1	0	0
4000008	4	       01    DFHAID.                                                    02000000	0	0	1
4000009	4	         02  DFHNULL   PIC  X  VALUE IS ' '.                            04000000	0	0	0
4000010	4	         02  DFHENTER  PIC  X  VALUE IS ''''.                           06000000	0	0	0
4000011	4	         02  DFHCLEAR  PIC  X  VALUE IS '_'.                            08000000	0	0	0
4000012	4	         02  DFHCLRP   PIC  X  VALUE IS 'ö'.                            09000000	0	0	0
4000013	4	         02  DFHPEN    PIC  X  VALUE IS '='.                            10000000	0	0	0
4000014	4	         02  DFHOPID   PIC  X  VALUE IS 'W'.                            12000000	0	0	0
4000015	4	         02  DFHMSRE   PIC  X  VALUE IS 'X'.                            14000000	0	0	0
4000016	4	         02  DFHSTRF   PIC  X  VALUE IS 'h'.                            16000000	0	0	0
4000017	4	         02  DFHTRIG   PIC  X  VALUE IS '"'.                            18000000	0	0	0
4000018	4	         02  DFHPA1    PIC  X  VALUE IS '%'.                            20000000	0	0	0
4000019	4	         02  DFHPA2    PIC  X  VALUE IS '>'.                            22000000	0	0	0
4000020	4	         02  DFHPA3    PIC  X  VALUE IS ','.                            25000000	0	0	0
4000021	4	         02  DFHPF1    PIC  X  VALUE IS '1'.                            28000000	0	0	0
4000022	4	         02  DFHPF2    PIC  X  VALUE IS '2'.                            31000000	0	0	0
4000023	4	         02  DFHPF3    PIC  X  VALUE IS '3'.                            34000000	0	0	0
4000024	4	         02  DFHPF4    PIC  X  VALUE IS '4'.                            37000000	0	0	0
4000025	4	         02  DFHPF5    PIC  X  VALUE IS '5'.                            40000000	0	0	0
4000026	4	         02  DFHPF6    PIC  X  VALUE IS '6'.                            43000000	0	0	0
4000027	4	         02  DFHPF7    PIC  X  VALUE IS '7'.                            46000000	0	0	0
4000028	4	         02  DFHPF8    PIC  X  VALUE IS '8'.                            49000000	0	0	0
4000029	4	         02  DFHPF9    PIC  X  VALUE IS '9'.                            52000000	0	0	0
4000030	4	         02  DFHPF10   PIC  X  VALUE IS ':'.                            55000000	0	0	0
4000031	4	         02  DFHPF11   PIC  X  VALUE IS '#'.                            58000000	0	0	0
4000032	4	         02  DFHPF12   PIC  X  VALUE IS '§'.                            61000000	0	0	0
4000033	4	         02  DFHPF13   PIC  X  VALUE IS 'A'.                            64000000	0	0	0
4000034	4	         02  DFHPF14   PIC  X  VALUE IS 'B'.                            67000000	0	0	0
4000035	4	         02  DFHPF15   PIC  X  VALUE IS 'C'.                            70000000	0	0	0
4000036	4	         02  DFHPF16   PIC  X  VALUE IS 'D'.                            73000000	0	0	0
4000037	4	         02  DFHPF17   PIC  X  VALUE IS 'E'.                            76000000	0	0	0
4000038	4	         02  DFHPF18   PIC  X  VALUE IS 'F'.                            79000000	0	0	0
4000039	4	         02  DFHPF19   PIC  X  VALUE IS 'G'.                            82000000	0	0	0
4000040	4	         02  DFHPF20   PIC  X  VALUE IS 'H'.                            85000000	0	0	0
4000041	4	         02  DFHPF21   PIC  X  VALUE IS 'I'.                            88000000	0	0	0
4000042	4	         02  DFHPF22   PIC  X  VALUE IS 'Ä'.                            91000000	0	0	0
4000043	4	         02  DFHPF23   PIC  X  VALUE IS '.'.                            94000000	0	0	0
4000044	4	         02  DFHPF24   PIC  X  VALUE IS '<'.                            97000000	0	0	0
5000000	5	<<<< file not found >>>>	0	0	0
5000001	5	<<<< file not found >>>>	0	0	0
6000000	6	<<<< file not found >>>>	0	0	0
6000001	6	<<<< file not found >>>>	0	0	0
7000001	7	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	0
7000002	7	       CBL CICS('SP,EDF')	0	0	1
7000003	7	      ******************************************************************	1	0	0
7000004	7	      *                                                                *	1	0	1
7000005	7	      *  Copyright IBM Corp. 2023                                      *	1	0	1
7000006	7	      *                                                                *	1	0	1
7000007	7	      ******************************************************************	1	0	1
7000008	7	      ******************************************************************	1	0	1
7000009	7	      * This is the Display Account program in the BANKING application	1	0	1
7000010	7	      * BMS suite. This program also handles requests to delete an	1	0	1
7000011	7	      * account.	1	0	1
7000012	7	      *	1	0	1
7000013	7	      ******************************************************************	1	0	1
7000014	7	       IDENTIFICATION DIVISION.	0	0	0
7000015	7	       PROGRAM-ID. BNK1DAC.	0	0	1
7000016	7	       AUTHOR. Jon Collett.	0	0	1
7000018	7	       ENVIRONMENT DIVISION.	0	0	1
7000019	7	       CONFIGURATION SECTION.	0	0	1
7000020	7	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
7000021	7	       SOURCE-COMPUTER.  IBM-370.	0	0	0
7000022	7	       OBJECT-COMPUTER.  IBM-370.	0	0	1
7000024	7	       INPUT-OUTPUT SECTION.	0	0	1
7000026	7	       DATA DIVISION.	0	0	1
7000027	7	       WORKING-STORAGE SECTION.	0	0	1
7000029	7	       01 WS-CICS-WORK-AREA.	0	0	1
7000030	7	          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.	0	0	1
7000031	7	          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.	0	0	1
7000033	7	       01 WS-FAIL-INFO.	0	0	1
7000034	7	          03 FILLER                    PIC X(9)  VALUE 'BNK1DAC  '.	0	0	1
7000035	7	          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.	0	0	1
7000036	7	          03 FILLER                    PIC X(6)  VALUE ' RESP='.	0	0	1
7000037	7	          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.	0	0	1
7000038	7	          03 FILLER                    PIC X(7)  VALUE ' RESP2='.	0	0	1
7000039	7	          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.	0	0	1
7000040	7	          03 FILLER                    PIC X(15)	0	0	1
7000041	7	                                          VALUE ' ABENDING TASK.'.	0	0	1
7000042	7	       01 SWITCHES.	0	0	1
7000043	7	           03 VALID-DATA-SW            PIC X VALUE 'Y'.	0	0	1
7000044	7	              88 VALID-DATA               VALUE 'Y'.	0	0	1
7000046	7	       01 FLAGS.	0	0	1
7000047	7	           03 SEND-FLAG                PIC X.	0	0	1
7000048	7	              88 SEND-ERASE               VALUE '1'.	0	0	1
7000049	7	              88 SEND-DATAONLY            VALUE '2'.	0	0	1
7000050	7	              88 SEND-DATAONLY-ALARM      VALUE '3'.	0	0	1
7000052	7	       01 ACTION-ALPHA.	0	0	1
7000053	7	           03 ACTION-NUM               PIC 9.	0	0	1
7000055	7	      *	1	0	0
7000056	7	      * The end of session message	1	0	1
7000057	7	      *	1	0	1
7000058	7	       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.	0	0	0
7000060	7	       01 RESPONSE-CODE                PIC S9(8) COMP.	0	0	1
7000062	7	       01 COMMUNICATION-AREA           PIC X.	0	0	1
7000064	7	       COPY BNK1DAM.	0	0	1
7000066	7	       COPY DFHAID.	0	0	1
7000068	7	       01 COMM-OPENED-SPLIT.	0	0	1
7000069	7	          03 COMM-OPENED-SPLIT-DD      PIC 99.	0	0	1
7000070	7	          03 COMM-OPENED-SPLIT-MM      PIC 99.	0	0	1
7000071	7	          03 COMM-OPENED-SPLIT-YY      PIC 9999.	0	0	1
7000073	7	       01 COMM-LAST-ST-SPLIT.	0	0	1
7000074	7	          03 COMM-LAST-ST-DD           PIC 99.	0	0	1
7000075	7	          03 COMM-LAST-ST-MM           PIC 99.	0	0	1
7000076	7	          03 COMM-LAST-ST-YY           PIC 9999.	0	0	1
7000078	7	       01 COMM-NEXT-ST-SPLIT.	0	0	1
7000079	7	          03 COMM-NEXT-ST-DD           PIC 99.	0	0	1
7000080	7	          03 COMM-NEXT-ST-MM           PIC 99.	0	0	1
7000081	7	          03 COMM-NEXT-ST-YY           PIC 9999.	0	0	1
7000083	7	       01 PARMS-SUBPGM.	0	0	1
7000084	7	          03 PARMS-SUBPGM-EYE          PIC X(4).	0	0	1
7000085	7	          88 PARMS-SUBPGM-EYE-VALID        VALUE 'ACCT'.	0	0	1
7000086	7	          03 PARMS-SUBPGM-CUSTNO       PIC X(10).	0	0	1
7000087	7	          03 PARMS-SUBPGM-SCODE        PIC X(6).	0	0	1
7000088	7	          03 PARMS-SUBPGM-ACCNO        PIC 9(8).	0	0	1
7000089	7	          03 PARMS-SUBPGM-ACC-TYPE     PIC X(8).	0	0	1
7000090	7	          03 PARMS-SUBPGM-INT-RATE     PIC 9(4)V99.	0	0	1
7000091	7	          03 PARMS-SUBPGM-OPENED       PIC 9(8).	0	0	1
7000092	7	          03 PARMS-SUBPGM-OVERDRAFT    PIC 9(8).	0	0	1
7000093	7	          03 PARMS-SUBPGM-LAST-STMT-DT PIC 9(8).	0	0	1
7000094	7	          03 PARMS-SUBPGM-NEXT-STMT-DT PIC 9(8).	0	0	1
7000095	7	          03 PARMS-SUBPGM-AVAIL-BAL    PIC S9(10)V99.	0	0	1
7000096	7	          03 PARMS-SUBPGM-ACTUAL-BAL   PIC S9(10)V99.	0	0	1
7000097	7	          03 PARMS-SUBPGM-SUCCESS      PIC X.	0	0	1
7000098	7	          03 PARMS-SUBPGM-FAIL-CD      PIC X.	0	0	1
7000099	7	          03 PARMS-SUBPGM-DEL-SUCCESS  PIC X.	0	0	1
7000100	7	          03 PARMS-SUBPGM-DEL-FAIL-CD  PIC X.	0	0	1
7000101	7	          03 PARMS-SUBPGM-DEL-APPLID   PIC X(8).	0	0	1
7000102	7	          03 PARMS-SUBPGM-DEL-PCB1     POINTER.	0	0	1
7000103	7	          03 PARMS-SUBPGM-DEL-PCB2     POINTER.	0	0	1
7000104	7	          03 PARMS-SUBPGM-DEL-PCB3     POINTER.	0	0	1
7000106	7	       COPY INQACC.	0	0	1
7000108	7	       01 WS-COMM-AREA.	0	0	1
7000109	7	          03 WS-COMM-EYE               PIC X(4).	0	0	1
7000110	7	          03 WS-COMM-CUSTNO            PIC X(10).	0	0	1
7000111	7	          03 WS-COMM-SCODE             PIC X(6).	0	0	1
7000112	7	          03 WS-COMM-ACCNO             PIC 9(8).	0	0	1
7000113	7	          03 WS-COMM-ACC-TYPE          PIC X(8).	0	0	1
7000114	7	          03 WS-COMM-INT-RATE          PIC 9(4)V99.	0	0	1
7000115	7	          03 WS-COMM-OPENED            PIC 9(8).	0	0	1
7000116	7	          03 WS-COMM-OVERDRAFT         PIC 9(8).	0	0	1
7000117	7	          03 WS-COMM-LAST-STMT-DT      PIC 9(8).	0	0	1
7000118	7	          03 WS-COMM-NEXT-STMT-DT      PIC 9(8).	0	0	1
7000119	7	          03 WS-COMM-AVAIL-BAL         PIC S9(10)V99.	0	0	1
7000120	7	          03 WS-COMM-ACTUAL-BAL        PIC S9(10)V99.	0	0	1
7000121	7	          03 WS-COMM-SUCCESS           PIC X.	0	0	1
7000122	7	          03 WS-COMM-FAIL-CD           PIC X.	0	0	1
7000123	7	          03 WS-COMM-DEL-SUCCESS       PIC X.	0	0	1
7000124	7	          03 WS-COMM-DEL-FAIL-CD       PIC X.	0	0	1
7000126	7	       01 COMM-AVAIL-BAL-DISP          PIC 9(12).	0	0	1
7000127	7	       01 COMM-ACT-BAL-DISP            PIC 9(12).	0	0	1
7000129	7	       01 WS-STUFF.	0	0	1
7000130	7	          03 WS-AVAIL-BAL-UNSIGN       PIC 9(12).	0	0	1
7000131	7	          03 WS-ACT-BAL-UNSIGN         PIC 9(12).	0	0	1
7000133	7	       01 COMPANY-NAME-FULL            PIC X(32).	0	0	1
7000135	7	       01 AVAILABLE-BALANCE-DISPLAY    PIC +9(10).99.	0	0	1
7000136	7	       01 ACTUAL-BALANCE-DISPLAY       PIC +9(10).99.	0	0	1
7000138	7	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
7000139	7	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
7000140	7	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
7000141	7	          03 WS-ORIG-DATE-DD              PIC 99.	0	0	1
7000142	7	          03 FILLER                       PIC X.	0	0	1
7000143	7	          03 WS-ORIG-DATE-MM              PIC 99.	0	0	1
7000144	7	          03 FILLER                       PIC X.	0	0	1
7000145	7	          03 WS-ORIG-DATE-YYYY            PIC 9999.	0	0	1
7000147	7	       01 WS-ORIG-DATE-GRP-X.	0	0	1
7000148	7	          03 WS-ORIG-DATE-DD-X         PIC XX.	0	0	1
7000149	7	          03 FILLER                    PIC X VALUE '.'.	0	0	1
7000150	7	          03 WS-ORIG-DATE-MM-X         PIC XX.	0	0	1
7000151	7	          03 FILLER                    PIC X VALUE '.'.	0	0	1
7000152	7	          03 WS-ORIG-DATE-YYYY-X       PIC X(4).	0	0	1
7000154	7	       01 WS-TIME-DATA.	0	0	1
7000155	7	           03 WS-TIME-NOW              PIC 9(6).	0	0	1
7000156	7	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
7000157	7	              05 WS-TIME-NOW-GRP-HH       PIC 99.	0	0	1
7000158	7	              05 WS-TIME-NOW-GRP-MM       PIC 99.	0	0	1
7000159	7	              05 WS-TIME-NOW-GRP-SS       PIC 99.	0	0	1
7000161	7	       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.	0	0	1
7000163	7	       01 ABNDINFO-REC.	0	0	1
7000164	7	           COPY ABNDINFO.	0	0	1
7000166	7	       LINKAGE SECTION.	0	0	1
7000168	7	        01 DFHCOMMAREA.	0	0	1
7000169	7	           03 COMM-EYE                 PIC X(4).	0	0	1
7000170	7	           03 COMM-CUSTNO              PIC X(10).	0	0	1
7000171	7	           03 COMM-SCODE               PIC X(6).	0	0	1
7000172	7	           03 COMM-ACCNO               PIC 9(8).	0	0	1
7000173	7	           03 COMM-ACC-TYPE            PIC X(8).	0	0	1
7000174	7	           03 COMM-INT-RATE            PIC 9(6).	0	0	1
7000175	7	           03 COMM-OPENED              PIC 9(8).	0	0	1
7000176	7	           03 COMM-OVERDRAFT           PIC 9(8).	0	0	1
7000177	7	           03 COMM-LAST-STMT-DT        PIC 9(8).	0	0	1
7000178	7	           03 COMM-NEXT-STMT-DT        PIC 9(8).	0	0	1
7000179	7	           03 COMM-AVAIL-BAL           PIC S9(10)V99.	0	0	1
7000180	7	           03 COMM-ACTUAL-BAL          PIC S9(10)V99.	0	0	1
7000181	7	           03 COMM-SUCCESS             PIC X.	0	0	1
7000182	7	           03 COMM-FAIL-CD             PIC X.	0	0	1
7000183	7	           03 COMM-DEL-SUCCESS         PIC X.	0	0	1
7000184	7	           03 COMM-DEL-FAIL-CD         PIC X.	0	0	1
7000187	7	       PROCEDURE DIVISION.	0	0	1
7000188	7	       PREMIERE SECTION.	0	0	1
7000189	7	       A010.	0	0	1
7000191	7	           EVALUATE TRUE	0	0	1
7000192	7	      *	1	0	0
7000193	7	      *       Is it the first time through? If so, send the map	1	0	1
7000194	7	      *       with erased (empty) data fields.	1	0	1
7000195	7	      *	1	0	1
7000196	7	              WHEN EIBCALEN = ZERO	0	0	0
7000197	7	                 MOVE LOW-VALUE TO BNK1DAO	0	0	1
7000198	7	                 MOVE -1 TO ACCNOL	0	0	1
7000199	7	                 SET SEND-ERASE TO TRUE	0	0	1
7000200	7	                 INITIALIZE WS-COMM-AREA	0	0	1
7000201	7	                 PERFORM SEND-MAP	0	0	1
7000203	7	      *	1	0	0
7000204	7	      *       If a PA key is pressed, just carry on	1	0	1
7000205	7	      *	1	0	1
7000206	7	              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3	0	0	0
7000207	7	                 CONTINUE	0	0	1
7000209	7	      *	1	0	0
7000210	7	      *       When Pf3 is pressed, return to the main menu	1	0	1
7000211	7	      *	1	0	1
7000212	7	              WHEN EIBAID = DFHPF3	0	0	0
7000213	7	                 EXEC CICS RETURN	0	0	1
7000214	7	                    TRANSID('OMEN')	0	0	1
7000215	7	                    IMMEDIATE	0	0	1
7000216	7	                    RESP(WS-CICS-RESP)	0	0	1
7000217	7	                    RESP2(WS-CICS-RESP2)	0	0	1
7000218	7	                 END-EXEC	0	0	1
7000220	7	      *	1	0	0
7000221	7	      *       When Pf5 is pressed, process the map	1	0	1
7000222	7	      *	1	0	1
7000223	7	              WHEN EIBAID = DFHPF5	0	0	0
7000224	7	                 PERFORM PROCESS-MAP	0	0	1
7000226	7	      *	1	0	0
7000227	7	      *       When Pf12 is pressed, send a termination	1	0	1
7000228	7	      *       message.	1	0	1
7000229	7	      *	1	0	1
7000230	7	              WHEN EIBAID = DFHPF12	0	0	0
7000231	7	                 PERFORM SEND-TERMINATION-MSG	0	0	1
7000233	7	                 EXEC CICS	0	0	1
7000234	7	                    RETURN	0	0	1
7000235	7	                 END-EXEC	0	0	1
7000237	7	      *	1	0	0
7000238	7	      *       When CLEAR is pressed	1	0	1
7000239	7	      *	1	0	1
7000240	7	              WHEN EIBAID = DFHCLEAR	0	0	0
7000241	7	                EXEC CICS SEND CONTROL	0	0	1
7000242	7	                          ERASE	0	0	1
7000243	7	                          FREEKB	0	0	1
7000244	7	                END-EXEC	0	0	1
7000246	7	                EXEC CICS RETURN	0	0	1
7000247	7	                END-EXEC	0	0	1
7000249	7	      *	1	0	0
7000250	7	      *       When enter is pressed then process the content	1	0	1
7000251	7	      *	1	0	1
7000252	7	              WHEN EIBAID = DFHENTER	0	0	0
7000253	7	                 PERFORM PROCESS-MAP	0	0	1
7000255	7	      *	1	0	0
7000256	7	      *       When anything else happens, send the invalid key message	1	0	1
7000257	7	      *	1	0	1
7000258	7	              WHEN OTHER	0	0	0
7000259	7	                 MOVE LOW-VALUES TO BNK1DAO	0	0	1
7000260	7	                 MOVE 'Invalid key pressed.' TO MESSAGEO	0	0	1
7000261	7	                 MOVE -1 TO ACCNOL	0	0	1
7000262	7	                 SET SEND-DATAONLY-ALARM TO TRUE	0	0	1
7000264	7	                 PERFORM SEND-MAP	0	0	1
7000266	7	           END-EVALUATE.	0	0	1
7000268	7	      *	1	0	0
7000269	7	      *    Provided that we have been around this way before (i.e. it is	1	0	1
7000270	7	      *    NOT the first time through, put the data returned from the	1	0	1
7000271	7	      *    sub program into the area that we use as the COMMAREA on the	1	0	1
7000272	7	      *    RETURN.	1	0	1
7000273	7	      *	1	0	1
7000274	7	           IF EIBCALEN NOT = ZERO	0	0	0
7000275	7	              IF INQACC-EYE = 'ACCT'	0	0	1
7000276	7	                 MOVE INQACC-EYE          TO WS-COMM-EYE	0	0	1
7000277	7	                 MOVE INQACC-CUSTNO       TO WS-COMM-CUSTNO	0	0	1
7000278	7	                 MOVE INQACC-SCODE        TO WS-COMM-SCODE	0	0	1
7000279	7	                 MOVE INQACC-ACCNO        TO WS-COMM-ACCNO	0	0	1
7000280	7	                 MOVE INQACC-ACC-TYPE     TO WS-COMM-ACC-TYPE	0	0	1
7000281	7	                 MOVE INQACC-INT-RATE     TO WS-COMM-INT-RATE	0	0	1
7000282	7	                 MOVE INQACC-OPENED       TO WS-COMM-OPENED	0	0	1
7000283	7	                 MOVE INQACC-OVERDRAFT    TO WS-COMM-OVERDRAFT	0	0	1
7000284	7	                 MOVE INQACC-LAST-STMT-DT TO WS-COMM-LAST-STMT-DT	0	0	1
7000285	7	                 MOVE INQACC-NEXT-STMT-DT TO WS-COMM-NEXT-STMT-DT	0	0	1
7000286	7	                 MOVE INQACC-AVAIL-BAL    TO WS-COMM-AVAIL-BAL	0	0	1
7000287	7	                 MOVE INQACC-ACTUAL-BAL   TO WS-COMM-ACTUAL-BAL	0	0	1
7000288	7	                 MOVE INQACC-SUCCESS      TO WS-COMM-SUCCESS	0	0	1
7000289	7	              ELSE	0	0	1
7000290	7	                 INITIALIZE WS-COMM-AREA	0	0	1
7000291	7	              END-IF	0	0	1
7000293	7	           END-IF.	0	0	1
7000295	7	           EXEC CICS	0	0	1
7000296	7	              RETURN TRANSID('ODAC')	0	0	1
7000297	7	              COMMAREA(WS-COMM-AREA)	0	0	1
7000298	7	              LENGTH(102)	0	0	1
7000299	7	              RESP(WS-CICS-RESP)	0	0	1
7000300	7	              RESP2(WS-CICS-RESP2)	0	0	1
7000301	7	           END-EXEC.	0	0	1
7000303	7	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
7000304	7	      *	1	0	0
7000305	7	      *       Preserve the RESP and RESP2, then set up the	1	0	1
7000306	7	      *       standard ABEND info before getting the applid,	1	0	1
7000307	7	      *       date/time etc. and linking to the Abend Handler	1	0	1
7000308	7	      *       program.	1	0	1
7000309	7	      *	1	0	1
7000310	7	              INITIALIZE ABNDINFO-REC	0	0	0
7000311	7	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
7000312	7	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
7000313	7	      *	1	0	0
7000314	7	      *       Get supplemental information	1	0	1
7000315	7	      *	1	0	1
7000316	7	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
7000317	7	              END-EXEC	0	0	1
7000319	7	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
7000320	7	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
7000322	7	              PERFORM POPULATE-TIME-DATE	0	0	1
7000324	7	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
7000325	7	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
7000326	7	                    ':' DELIMITED BY SIZE,	0	0	1
7000327	7	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
7000328	7	                     ':' DELIMITED BY SIZE,	0	0	1
7000329	7	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
7000330	7	                     INTO ABND-TIME	0	0	1
7000331	7	              END-STRING	0	0	1
7000333	7	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
7000334	7	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
7000336	7	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
7000337	7	              END-EXEC	0	0	1
7000339	7	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
7000341	7	              STRING 'A010 - RETURN TRANSID(ODAC) FAIL.'	0	0	1
7000342	7	                    DELIMITED BY SIZE,	0	0	1
7000343	7	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
7000344	7	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
7000345	7	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
7000346	7	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
7000347	7	                    INTO ABND-FREEFORM	0	0	1
7000348	7	              END-STRING	0	0	1
7000350	7	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
7000351	7	                        COMMAREA(ABNDINFO-REC)	0	0	1
7000352	7	              END-EXEC	0	0	1
7000354	7	              INITIALIZE WS-FAIL-INFO	0	0	1
7000355	7	              MOVE 'BNK1DAC - A010 - RETURN TRANSID(ODAC) FAIL' TO	0	0	1
7000356	7	                 WS-CICS-FAIL-MSG	0	0	1
7000357	7	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
7000358	7	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
7000359	7	              PERFORM ABEND-THIS-TASK	0	0	1
7000360	7	           END-IF.	0	0	1
7000362	7	       A999.	0	0	1
7000363	7	           EXIT.	0	0	1
7000366	7	       PROCESS-MAP SECTION.	0	0	1
7000367	7	       PM010.	0	0	1
7000368	7	      *	1	0	0
7000369	7	      *    Retrieve the data from the map	1	0	1
7000370	7	      *	1	0	1
7000371	7	           PERFORM RECEIVE-MAP.	0	0	0
7000373	7	      *	1	0	0
7000374	7	      *    If enter is pressed validate the data	1	0	1
7000375	7	      *	1	0	1
7000376	7	           IF EIBAID = DFHENTER	0	0	0
7000377	7	      *	1	0	0
7000378	7	      *       Validate the received data	1	0	1
7000379	7	      *	1	0	1
7000380	7	              PERFORM EDIT-DATA	0	0	0
7000382	7	      *	1	0	0
7000383	7	      *       If the data passes validation go on to	1	0	1
7000384	7	      *       retrieve account information.	1	0	1
7000385	7	      *	1	0	1
7000386	7	              IF VALID-DATA	0	0	0
7000387	7	                 PERFORM GET-ACC-DATA	0	0	1
7000388	7	              ELSE	0	0	1
7000389	7	                 INITIALIZE PARMS-SUBPGM	0	0	1
7000390	7	              END-IF	0	0	1
7000392	7	           END-IF.	0	0	1
7000394	7	      *	1	0	0
7000395	7	      *    If pF5 (delete) is pressed validate the data	1	0	1
7000396	7	      *	1	0	1
7000398	7	           IF EIBAID = DFHPF5	0	0	0
7000399	7	              PERFORM VALIDATE-DATA	0	0	1
7000401	7	      *	1	0	0
7000402	7	      *       If the data passes validation go on to	1	0	1
7000403	7	      *       delete the account.	1	0	1
7000404	7	      *	1	0	1
7000405	7	              IF VALID-DATA	0	0	0
7000406	7	                 PERFORM DEL-ACC-DATA	0	0	1
7000407	7	              END-IF	0	0	1
7000409	7	           END-IF.	0	0	1
7000411	7	           SET SEND-DATAONLY-ALARM TO TRUE.	0	0	1
7000412	7	      *	1	0	0
7000413	7	      *    Output the data to the screen	1	0	1
7000414	7	      *	1	0	1
7000415	7	           PERFORM SEND-MAP.	0	0	0
7000417	7	       PM999.	0	0	1
7000418	7	           EXIT.	0	0	1
7000421	7	       RECEIVE-MAP SECTION.	0	0	1
7000422	7	       RM010.	0	0	1
7000423	7	      *	1	0	0
7000424	7	      *    Retrieve the data	1	0	1
7000425	7	      *	1	0	1
7000426	7	           EXEC CICS	0	0	0
7000427	7	              RECEIVE MAP('BNK1DA')	0	0	1
7000428	7	              MAPSET('BNK1DAM')	0	0	1
7000429	7	              INTO(BNK1DAI)	0	0	1
7000430	7	              RESP(WS-CICS-RESP)	0	0	1
7000431	7	              RESP2(WS-CICS-RESP2)	0	0	1
7000432	7	           END-EXEC.	0	0	1
7000434	7	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
7000435	7	      *	1	0	0
7000436	7	      *       Preserve the RESP and RESP2, then set up the	1	0	1
7000437	7	      *       standard ABEND info before getting the applid,	1	0	1
7000438	7	      *       date/time etc. and linking to the Abend Handler	1	0	1
7000439	7	      *       program.	1	0	1
7000440	7	      *	1	0	1
7000441	7	              INITIALIZE ABNDINFO-REC	0	0	0
7000442	7	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
7000443	7	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
7000444	7	      *	1	0	0
7000445	7	      *       Get supplemental information	1	0	1
7000446	7	      *	1	0	1
7000447	7	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
7000448	7	              END-EXEC	0	0	1
7000450	7	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
7000451	7	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
7000453	7	              PERFORM POPULATE-TIME-DATE	0	0	1
7000455	7	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
7000456	7	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
7000457	7	                    ':' DELIMITED BY SIZE,	0	0	1
7000458	7	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
7000459	7	                     ':' DELIMITED BY SIZE,	0	0	1
7000460	7	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
7000461	7	                     INTO ABND-TIME	0	0	1
7000462	7	              END-STRING	0	0	1
7000464	7	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
7000465	7	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
7000467	7	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
7000468	7	              END-EXEC	0	0	1
7000470	7	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
7000472	7	              STRING 'RM010 - RECEIVE MAP FAIL.'	0	0	1
7000473	7	                    DELIMITED BY SIZE,	0	0	1
7000474	7	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
7000475	7	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
7000476	7	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
7000477	7	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
7000478	7	                    INTO ABND-FREEFORM	0	0	1
7000479	7	              END-STRING	0	0	1
7000481	7	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
7000482	7	                        COMMAREA(ABNDINFO-REC)	0	0	1
7000483	7	              END-EXEC	0	0	1
7000486	7	              INITIALIZE WS-FAIL-INFO	0	0	1
7000487	7	              MOVE 'BNK1DAC - RM010 - RECEIVE MAP FAIL ' TO	0	0	1
7000488	7	                 WS-CICS-FAIL-MSG	0	0	1
7000489	7	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
7000490	7	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
7000491	7	              PERFORM ABEND-THIS-TASK	0	0	1
7000492	7	           END-IF.	0	0	1
7000494	7	       RM999.	0	0	1
7000495	7	           EXIT.	0	0	1
7000498	7	       EDIT-DATA SECTION.	0	0	1
7000499	7	       ED010.	0	0	1
7000500	7	      *	1	0	0
7000501	7	      *    Perform validation on the incoming fields	1	0	1
7000502	7	      *	1	0	1
7000503	7	           IF ACCNOI = LOW-VALUES	0	0	0
7000504	7	           OR ACCNOL = 0	0	0	1
7000505	7	             MOVE 'Please enter an account number.' TO	0	0	1
7000506	7	                 MESSAGEO	0	0	1
7000507	7	             MOVE 'N' TO VALID-DATA-SW	0	0	1
7000508	7	             GO TO ED999	0	0	1
7000509	7	           END-IF	0	0	1
7000511	7	           EXEC CICS BIF DEEDIT	0	0	1
7000512	7	              FIELD(ACCNOI)	0	0	1
7000513	7	           END-EXEC	0	0	1
7000515	7	           IF ACCNOI NOT NUMERIC	0	0	1
7000516	7	              MOVE 'Please enter an account number.' TO	0	0	1
7000517	7	                 MESSAGEO	0	0	1
7000518	7	              MOVE 'N' TO VALID-DATA-SW	0	0	1
7000519	7	           END-IF.	0	0	1
7000521	7	       ED999.	0	0	1
7000522	7	           EXIT.	0	0	1
7000525	7	       VALIDATE-DATA SECTION.	0	0	1
7000526	7	       VD010.	0	0	1
7000527	7	      *	1	0	0
7000528	7	      *    Perform further validation on the incoming fields	1	0	1
7000529	7	      *	1	0	1
7000530	7	           IF COMM-SCODE = ZEROES OR LOW-VALUES	0	0	0
7000531	7	           OR COMM-ACCNO = ZEROES OR LOW-VALUES	0	0	1
7000532	7	              MOVE 'N' TO VALID-DATA-SW	0	0	1
7000533	7	              MOVE SPACES TO MESSAGEO	0	0	1
7000534	7	              STRING 'Please enter an account number.'	0	0	1
7000535	7	                  DELIMITED BY SIZE,	0	0	1
7000536	7	                  INTO MESSAGEO	0	0	1
7000537	7	              MOVE -1 TO ACCNOL	0	0	1
7000538	7	            END-IF.	0	0	1
7000540	7	       VD999.	0	0	1
7000541	7	           EXIT.	0	0	1
7000544	7	       GET-ACC-DATA SECTION.	0	0	1
7000545	7	       GAD010.	0	0	1
7000546	7	      *	1	0	0
7000547	7	      *    Set up the fields required by INQACC then link to it	1	0	1
7000548	7	      *	1	0	1
7000549	7	           INITIALIZE PARMS-SUBPGM INQACC-COMMAREA	0	0	0
7000550	7	           SET INQACC-PCB1-POINTER TO NULL	0	0	1
7000551	7	           MOVE ACCNOI TO PARMS-SUBPGM-ACCNO INQACC-ACCNO.	0	0	1
7000553	7	           EXEC CICS LINK	0	0	1
7000554	7	              PROGRAM('INQACC')	0	0	1
7000555	7	              COMMAREA(INQACC-COMMAREA)	0	0	1
7000556	7	              RESP(WS-CICS-RESP)	0	0	1
7000557	7	              RESP2(WS-CICS-RESP2)	0	0	1
7000558	7	              SYNCONRETURN	0	0	1
7000559	7	           END-EXEC.	0	0	1
7000561	7	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
7000562	7	      *	1	0	0
7000563	7	      *       Preserve the RESP and RESP2, then set up the	1	0	1
7000564	7	      *       standard ABEND info before getting the applid,	1	0	1
7000565	7	      *       date/time etc. and linking to the Abend Handler	1	0	1
7000566	7	      *       program.	1	0	1
7000567	7	      *	1	0	1
7000568	7	              INITIALIZE ABNDINFO-REC	0	0	0
7000569	7	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
7000570	7	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
7000571	7	      *	1	0	0
7000572	7	      *       Get supplemental information	1	0	1
7000573	7	      *	1	0	1
7000574	7	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
7000575	7	              END-EXEC	0	0	1
7000577	7	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
7000578	7	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
7000580	7	              PERFORM POPULATE-TIME-DATE	0	0	1
7000582	7	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
7000583	7	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
7000584	7	                    ':' DELIMITED BY SIZE,	0	0	1
7000585	7	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
7000586	7	                     ':' DELIMITED BY SIZE,	0	0	1
7000587	7	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
7000588	7	                     INTO ABND-TIME	0	0	1
7000589	7	              END-STRING	0	0	1
7000591	7	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
7000592	7	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
7000594	7	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
7000595	7	              END-EXEC	0	0	1
7000597	7	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
7000599	7	              STRING 'GAD010  - LINK INQACC FAIL.'	0	0	1
7000600	7	                    DELIMITED BY SIZE,	0	0	1
7000601	7	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
7000602	7	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
7000603	7	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
7000604	7	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
7000605	7	                    INTO ABND-FREEFORM	0	0	1
7000606	7	              END-STRING	0	0	1
7000608	7	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
7000609	7	                        COMMAREA(ABNDINFO-REC)	0	0	1
7000610	7	              END-EXEC	0	0	1
7000612	7	              INITIALIZE WS-FAIL-INFO	0	0	1
7000613	7	              MOVE 'BNK1DAC - GAD010 - LINK INQACC  FAIL      '	0	0	1
7000614	7	                 TO WS-CICS-FAIL-MSG	0	0	1
7000615	7	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
7000616	7	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
7000617	7	              PERFORM ABEND-THIS-TASK	0	0	1
7000618	7	           END-IF.	0	0	1
7000620	7	      *	1	0	0
7000621	7	      *    Check to see if there was any data returned, if not output	1	0	1
7000622	7	      *    an error message	1	0	1
7000623	7	      *	1	0	1
7000624	7	           IF INQACC-ACC-TYPE  = SPACES AND	0	0	0
7000625	7	           INQACC-INT-RATE  = 0	0	0	1
7000626	7	           AND INQACC-SUCCESS = 'N'	0	0	1
7000628	7	              MOVE 'Sorry, but that account number was not found.' TO	0	0	1
7000629	7	                 MESSAGEO	0	0	1
7000630	7	              MOVE 'N' TO VALID-DATA-SW	0	0	1
7000631	7	              MOVE SPACES   TO SORTCO	0	0	1
7000632	7	              MOVE SPACES   TO CUSTNOO	0	0	1
7000633	7	              MOVE SPACES   TO ACCNO2O	0	0	1
7000634	7	              MOVE SPACES   TO ACTYPEO	0	0	1
7000635	7	              MOVE zero     TO INTRTO	0	0	1
7000636	7	              MOVE SPACES   TO COMM-OPENED-SPLIT	0	0	1
7000637	7	              MOVE SPACES   TO OPENDDO	0	0	1
7000638	7	              MOVE SPACES   TO OPENMMO	0	0	1
7000639	7	              MOVE SPACES   TO OPENYYO	0	0	1
7000641	7	              MOVE SPACES   TO OVERDRO	0	0	1
7000643	7	              MOVE SPACES   TO COMM-LAST-ST-SPLIT	0	0	1
7000644	7	              MOVE SPACES   TO LSTMTDDO	0	0	1
7000645	7	              MOVE SPACES   TO LSTMTMMO	0	0	1
7000646	7	              MOVE SPACES   TO LSTMTYYO	0	0	1
7000648	7	              MOVE SPACES   TO COMM-NEXT-ST-SPLIT	0	0	1
7000649	7	              MOVE SPACES   TO NSTMTDDO	0	0	1
7000650	7	              MOVE SPACES   TO NSTMTMMO	0	0	1
7000651	7	              MOVE SPACES   TO NSTMTYYO	0	0	1
7000653	7	              MOVE zero     TO AVAILABLE-BALANCE-DISPLAY	0	0	1
7000654	7	              MOVE zero     TO ACTUAL-BALANCE-DISPLAY	0	0	1
7000655	7	              MOVE available-balance-display TO AVBALO	0	0	1
7000656	7	              MOVE actual-balance-display    TO ACTBALO	0	0	1
7000658	7	              GO TO GAD999	0	0	1
7000659	7	           END-IF.	0	0	1
7000661	7	      *	1	0	0
7000662	7	      *    Set the values on the map	1	0	1
7000663	7	      *	1	0	1
7000664	7	           MOVE INQACC-SCODE             TO SORTCO.	0	0	0
7000665	7	           MOVE INQACC-CUSTNO            TO CUSTNOO.	0	0	1
7000666	7	           MOVE INQACC-ACCNO             TO ACCNO2O.	0	0	1
7000667	7	           MOVE INQACC-ACC-TYPE          TO ACTYPEO.	0	0	1
7000668	7	           MOVE INQACC-INT-RATE          TO INTRTO.	0	0	1
7000670	7	           MOVE INQACC-OPENED            TO COMM-OPENED-SPLIT.	0	0	1
7000671	7	           MOVE COMM-OPENED-SPLIT-DD     TO OPENDDO.	0	0	1
7000672	7	           MOVE COMM-OPENED-SPLIT-MM     TO OPENMMO.	0	0	1
7000673	7	           MOVE COMM-OPENED-SPLIT-YY     TO OPENYYO.	0	0	1
7000675	7	           MOVE INQACC-OVERDRAFT    TO OVERDRO.	0	0	1
7000677	7	           MOVE INQACC-LAST-STMT-DT TO COMM-LAST-ST-SPLIT.	0	0	1
7000678	7	           MOVE COMM-LAST-ST-DD           TO LSTMTDDO.	0	0	1
7000679	7	           MOVE COMM-LAST-ST-MM           TO LSTMTMMO.	0	0	1
7000680	7	           MOVE COMM-LAST-ST-YY           TO LSTMTYYO.	0	0	1
7000682	7	           MOVE INQACC-NEXT-STMT-DT TO COMM-NEXT-ST-SPLIT.	0	0	1
7000683	7	           MOVE COMM-NEXT-ST-DD           TO NSTMTDDO.	0	0	1
7000684	7	           MOVE COMM-NEXT-ST-MM           TO NSTMTMMO.	0	0	1
7000685	7	           MOVE COMM-NEXT-ST-YY           TO NSTMTYYO.	0	0	1
7000687	7	           MOVE INQACC-AVAIL-BAL      TO AVAILABLE-BALANCE-DISPLAY.	0	0	1
7000688	7	           MOVE INQACC-ACTUAL-BAL     TO ACTual-balance-display.	0	0	1
7000689	7	           MOVE available-balance-display TO AVBALO	0	0	1
7000690	7	           MOVE actual-balance-display    TO ACTBALO	0	0	1
7000692	7	           MOVE SPACES TO MESSAGEO.	0	0	1
7000693	7	           STRING 'If you wish to delete the Account press <PF5>.'	0	0	1
7000694	7	                 DELIMITED BY SIZE,	0	0	1
7000695	7	                 ' ' DELIMITED BY SIZE	0	0	1
7000696	7	                 INTO MESSAGEO.	0	0	1
7000697	7	       GAD999.	0	0	1
7000698	7	           EXIT.	0	0	1
7000701	7	       DEL-ACC-DATA SECTION.	0	0	1
7000702	7	       DAD010.	0	0	1
7000703	7	      *	1	0	0
7000704	7	      *    Set up the fields required by DELACC then link to it	1	0	1
7000705	7	      *	1	0	1
7000706	7	           INITIALIZE PARMS-SUBPGM	0	0	0
7000707	7	           COMPUTE PARMS-SUBPGM-ACCNO = FUNCTION NUMVAL(ACCNO2I)	0	0	1
7000708	7	           SET PARMS-SUBPGM-DEL-PCB1 TO NULL.	0	0	1
7000709	7	           SET PARMS-SUBPGM-DEL-PCB2 TO NULL.	0	0	1
7000710	7	           SET PARMS-SUBPGM-DEL-PCB3 TO NULL.	0	0	1
7000712	7	           EXEC CICS LINK	0	0	1
7000713	7	              PROGRAM('DELACC')	0	0	1
7000714	7	              COMMAREA(PARMS-SUBPGM)	0	0	1
7000715	7	              RESP(WS-CICS-RESP)	0	0	1
7000716	7	              RESP2(WS-CICS-RESP2)	0	0	1
7000717	7	              SYNCONRETURN	0	0	1
7000718	7	           END-EXEC.	0	0	1
7000720	7	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
7000721	7	              INITIALIZE WS-FAIL-INFO	0	0	1
7000722	7	              MOVE 'BNK1DAC - DAD010 - LINK DELACC  FAIL      '	0	0	1
7000723	7	                 TO WS-CICS-FAIL-MSG	0	0	1
7000724	7	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
7000725	7	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
7000726	7	              PERFORM ABEND-THIS-TASK	0	0	1
7000727	7	           END-IF.	0	0	1
7000729	7	      *	1	0	0
7000730	7	      *    Check to see if there was any data returned, if not output	1	0	1
7000731	7	      *    an error message	1	0	1
7000732	7	      *	1	0	1
7000733	7	           IF PARMS-SUBPGM-DEL-SUCCESS = 'N' AND	0	0	0
7000734	7	           PARMS-SUBPGM-DEL-FAIL-CD = '1'	0	0	1
7000735	7	              MOVE SPACES TO MESSAGEO	0	0	1
7000736	7	              STRING 'Sorry, but that account number was not found.'	0	0	1
7000737	7	                 DELIMITED BY SIZE,	0	0	1
7000738	7	                 ' Account NOT deleted.' DELIMITED BY SIZE	0	0	1
7000739	7	                 INTO MESSAGEO	0	0	1
7000740	7	              MOVE 'N' TO VALID-DATA-SW	0	0	1
7000741	7	              MOVE PARMS-SUBPGM-SCODE   TO SORTCO	0	0	1
7000742	7	              GO TO DAD999	0	0	1
7000743	7	           END-IF.	0	0	1
7000745	7	           IF PARMS-SUBPGM-DEL-SUCCESS = 'N' AND	0	0	1
7000746	7	           PARMS-SUBPGM-DEL-FAIL-CD = '2'	0	0	1
7000747	7	              MOVE SPACES TO MESSAGEO	0	0	1
7000748	7	              STRING 'Sorry, but a datastore error occurred.'	0	0	1
7000749	7	                 DELIMITED BY SIZE,	0	0	1
7000750	7	                 ' Account NOT deleted.' DELIMITED BY SIZE	0	0	1
7000751	7	                 INTO MESSAGEO	0	0	1
7000752	7	              MOVE 'N' TO VALID-DATA-SW	0	0	1
7000753	7	              MOVE PARMS-SUBPGM-SCODE   TO SORTCO	0	0	1
7000754	7	              GO TO DAD999	0	0	1
7000755	7	           END-IF.	0	0	1
7000757	7	           IF PARMS-SUBPGM-DEL-SUCCESS = 'N' AND	0	0	1
7000758	7	           PARMS-SUBPGM-DEL-FAIL-CD = '3'	0	0	1
7000759	7	              MOVE SPACES TO MESSAGEO	0	0	1
7000760	7	              STRING 'Sorry, but a delete error occurred.'	0	0	1
7000761	7	                 DELIMITED BY SIZE,	0	0	1
7000762	7	                 ' Account NOT deleted.' DELIMITED BY SIZE	0	0	1
7000763	7	                 INTO MESSAGEO	0	0	1
7000764	7	              MOVE 'N' TO VALID-DATA-SW	0	0	1
7000765	7	              MOVE PARMS-SUBPGM-SCODE   TO SORTCO	0	0	1
7000766	7	              GO TO DAD999	0	0	1
7000767	7	           END-IF.	0	0	1
7000769	7	           IF PARMS-SUBPGM-DEL-SUCCESS = 'N'	0	0	1
7000770	7	              MOVE SPACES TO MESSAGEO	0	0	1
7000771	7	              STRING 'Sorry, but a delete error occurred.'	0	0	1
7000772	7	                 DELIMITED BY SIZE,	0	0	1
7000773	7	                 ' Account NOT deleted.' DELIMITED BY SIZE	0	0	1
7000774	7	                 INTO MESSAGEO	0	0	1
7000775	7	              MOVE 'N' TO VALID-DATA-SW	0	0	1
7000776	7	              MOVE PARMS-SUBPGM-SCODE   TO SORTCO	0	0	1
7000777	7	              GO TO DAD999	0	0	1
7000778	7	           END-IF.	0	0	1
7000780	7	      *	1	0	0
7000781	7	      *    Set the values on the map	1	0	1
7000782	7	      *	1	0	1
7000783	7	           MOVE SPACES TO SORTCO.	0	0	0
7000784	7	           MOVE SPACES TO CUSTNOO.	0	0	1
7000785	7	           MOVE SPACES TO ACCNO2O.	0	0	1
7000786	7	           MOVE SPACES TO ACTYPEO.	0	0	1
7000787	7	           MOVE ZERO TO INTRTO.	0	0	1
7000789	7	           MOVE SPACES TO OPENDDO.	0	0	1
7000790	7	           MOVE SPACES TO OPENMMO.	0	0	1
7000791	7	           MOVE SPACES TO OPENYYO.	0	0	1
7000793	7	           MOVE SPACES TO OVERDRO.	0	0	1
7000794	7	           MOVE SPACES TO LSTMTDDO.	0	0	1
7000795	7	           MOVE SPACES TO LSTMTMMO.	0	0	1
7000796	7	           MOVE SPACES TO LSTMTYYO.	0	0	1
7000798	7	           MOVE SPACES TO NSTMTDDO.	0	0	1
7000799	7	           MOVE SPACES TO NSTMTMMO.	0	0	1
7000800	7	           MOVE SPACES TO NSTMTYYO.	0	0	1
7000802	7	           MOVE ZERO TO AVAILABLE-BALANCE-DISPLAY.	0	0	1
7000803	7	           MOVE ZERO TO ACTUAL-BALANCE-DISPLAY.	0	0	1
7000804	7	           MOVE AVAILABLE-BALANCE-DISPLAY TO AVBALO	0	0	1
7000805	7	           MOVE ACTUAL-BALANCE-DISPLAY    TO ACTBALO	0	0	1
7000807	7	           MOVE SPACES TO MESSAGEO.	0	0	1
7000809	7	           STRING 'Account ' DELIMITED BY SIZE,	0	0	1
7000810	7	                 PARMS-SUBPGM-ACCNO DELIMITED BY SIZE,	0	0	1
7000811	7	                 ' was successfully deleted.'	0	0	1
7000812	7	                 DELIMITED BY SIZE,	0	0	1
7000813	7	                 INTO MESSAGEO	0	0	1
7000814	7	           END-STRING.	0	0	1
7000816	7	       DAD999.	0	0	1
7000817	7	           EXIT.	0	0	1
7000820	7	       SEND-MAP SECTION.	0	0	1
7000821	7	       SM010.	0	0	1
7000822	7	      *	1	0	0
7000823	7	      *    If the map needs to have its data erased	1	0	1
7000824	7	      *	1	0	1
7000825	7	           IF SEND-ERASE	0	0	0
7000827	7	              EXEC CICS SEND MAP('BNK1DA')	0	0	1
7000828	7	                 MAPSET('BNK1DAM')	0	0	1
7000829	7	                 FROM(BNK1DAO)	0	0	1
7000830	7	                 ERASE	0	0	1
7000831	7	                 RESP(WS-CICS-RESP)	0	0	1
7000832	7	                 RESP2(WS-CICS-RESP2)	0	0	1
7000833	7	              END-EXEC	0	0	1
7000835	7	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
7000836	7	      *	1	0	0
7000837	7	      *          Preserve the RESP and RESP2, then set up the	1	0	1
7000838	7	      *          standard ABEND info before getting the applid,	1	0	1
7000839	7	      *          date/time etc. and linking to the Abend Handler	1	0	1
7000840	7	      *          program.	1	0	1
7000841	7	      *	1	0	1
7000842	7	                 INITIALIZE ABNDINFO-REC	0	0	0
7000843	7	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
7000844	7	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
7000845	7	      *	1	0	0
7000846	7	      *          Get supplemental information	1	0	1
7000847	7	      *	1	0	1
7000848	7	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
7000849	7	                 END-EXEC	0	0	1
7000851	7	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
7000852	7	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
7000854	7	                 PERFORM POPULATE-TIME-DATE	0	0	1
7000856	7	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
7000857	7	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
7000858	7	                       ':' DELIMITED BY SIZE,	0	0	1
7000859	7	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
7000860	7	                        ':' DELIMITED BY SIZE,	0	0	1
7000861	7	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
7000862	7	                        INTO ABND-TIME	0	0	1
7000863	7	                 END-STRING	0	0	1
7000865	7	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
7000866	7	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
7000868	7	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
7000869	7	                 END-EXEC	0	0	1
7000871	7	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
7000873	7	                 STRING 'SM010 - SEND MAP ERASE FAIL.'	0	0	1
7000874	7	                       DELIMITED BY SIZE,	0	0	1
7000875	7	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
7000876	7	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
7000877	7	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
7000878	7	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
7000879	7	                       INTO ABND-FREEFORM	0	0	1
7000880	7	                 END-STRING	0	0	1
7000882	7	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
7000883	7	                           COMMAREA(ABNDINFO-REC)	0	0	1
7000884	7	                 END-EXEC	0	0	1
7000886	7	                 INITIALIZE WS-FAIL-INFO	0	0	1
7000887	7	                 MOVE 'BNK1DAC - SM010 - SEND MAP ERASE FAIL '	0	0	1
7000888	7	                    TO WS-CICS-FAIL-MSG	0	0	1
7000889	7	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
7000890	7	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
7000891	7	                 PERFORM ABEND-THIS-TASK	0	0	1
7000892	7	              END-IF	0	0	1
7000894	7	              GO TO SM999	0	0	1
7000895	7	           END-IF.	0	0	1
7000897	7	      *	1	0	0
7000898	7	      *    If the map just needs a resend of only the data	1	0	1
7000899	7	      *	1	0	1
7000900	7	           IF SEND-DATAONLY	0	0	0
7000901	7	              IF MESSAGEO IS NOT EQUAL SPACES	0	0	1
7000902	7	              AND MESSAGEO IS NOT EQUAL LOW-VALUES	0	0	1
7000903	7	                 MOVE 'Account lookup successful.' TO MESSAGEO	0	0	1
7000904	7	              END-IF	0	0	1
7000906	7	              EXEC CICS SEND MAP('BNK1DA')	0	0	1
7000907	7	                 MAPSET('BNK1DAM')	0	0	1
7000908	7	                 FROM(BNK1DAO)	0	0	1
7000909	7	                 DATAONLY	0	0	1
7000910	7	                 RESP(WS-CICS-RESP)	0	0	1
7000911	7	                 RESP2(WS-CICS-RESP2)	0	0	1
7000912	7	              END-EXEC	0	0	1
7000914	7	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
7000915	7	      *	1	0	0
7000916	7	      *          Preserve the RESP and RESP2, then set up the	1	0	1
7000917	7	      *          standard ABEND info before getting the applid,	1	0	1
7000918	7	      *          date/time etc. and linking to the Abend Handler	1	0	1
7000919	7	      *          program.	1	0	1
7000920	7	      *	1	0	1
7000921	7	                 INITIALIZE ABNDINFO-REC	0	0	0
7000922	7	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
7000923	7	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
7000924	7	      *	1	0	0
7000925	7	      *          Get supplemental information	1	0	1
7000926	7	      *	1	0	1
7000927	7	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
7000928	7	                 END-EXEC	0	0	1
7000930	7	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
7000931	7	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
7000933	7	                 PERFORM POPULATE-TIME-DATE	0	0	1
7000935	7	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
7000936	7	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
7000937	7	                       ':' DELIMITED BY SIZE,	0	0	1
7000938	7	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
7000939	7	                        ':' DELIMITED BY SIZE,	0	0	1
7000940	7	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
7000941	7	                        INTO ABND-TIME	0	0	1
7000942	7	                 END-STRING	0	0	1
7000944	7	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
7000945	7	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
7000947	7	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
7000948	7	                 END-EXEC	0	0	1
7000950	7	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
7000952	7	                 STRING 'SM010 - SEND MAP DATAONLY FAIL.'	0	0	1
7000953	7	                       DELIMITED BY SIZE,	0	0	1
7000954	7	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
7000955	7	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
7000956	7	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
7000957	7	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
7000958	7	                       INTO ABND-FREEFORM	0	0	1
7000959	7	                 END-STRING	0	0	1
7000961	7	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
7000962	7	                           COMMAREA(ABNDINFO-REC)	0	0	1
7000963	7	                 END-EXEC	0	0	1
7000965	7	                 INITIALIZE WS-FAIL-INFO	0	0	1
7000966	7	                 MOVE 'BNK1DAC - SM010 - SEND MAP DATAONLY FAIL '	0	0	1
7000967	7	                    TO WS-CICS-FAIL-MSG	0	0	1
7000968	7	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
7000969	7	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
7000970	7	                 PERFORM ABEND-THIS-TASK	0	0	1
7000971	7	              END-IF	0	0	1
7000973	7	              GO TO SM999	0	0	1
7000974	7	           END-IF.	0	0	1
7000976	7	      *	1	0	0
7000977	7	      *    If we have elected to send the map and a beep	1	0	1
7000978	7	      *	1	0	1
7000979	7	           IF SEND-DATAONLY-ALARM	0	0	0
7000980	7	              EXEC CICS SEND MAP('BNK1DA')	0	0	1
7000981	7	                 MAPSET('BNK1DAM')	0	0	1
7000982	7	                 FROM(BNK1DAO)	0	0	1
7000983	7	                 DATAONLY	0	0	1
7000984	7	                 ALARM	0	0	1
7000985	7	                 RESP(WS-CICS-RESP)	0	0	1
7000986	7	                 RESP2(WS-CICS-RESP2)	0	0	1
7000987	7	              END-EXEC	0	0	1
7000989	7	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
7000990	7	      *	1	0	0
7000991	7	      *          Preserve the RESP and RESP2, then set up the	1	0	1
7000992	7	      *          standard ABEND info before getting the applid,	1	0	1
7000993	7	      *          date/time etc. and linking to the Abend Handler	1	0	1
7000994	7	      *          program.	1	0	1
7000995	7	      *	1	0	1
7000996	7	                 INITIALIZE ABNDINFO-REC	0	0	0
7000997	7	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
7000998	7	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
7000999	7	      *	1	0	0
7001000	7	      *          Get supplemental information	1	0	1
7001001	7	      *	1	0	1
7001002	7	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
7001003	7	                 END-EXEC	0	0	1
7001005	7	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
7001006	7	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
7001008	7	                 PERFORM POPULATE-TIME-DATE	0	0	1
7001010	7	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
7001011	7	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
7001012	7	                       ':' DELIMITED BY SIZE,	0	0	1
7001013	7	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
7001014	7	                        ':' DELIMITED BY SIZE,	0	0	1
7001015	7	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
7001016	7	                        INTO ABND-TIME	0	0	1
7001017	7	                 END-STRING	0	0	1
7001019	7	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
7001020	7	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
7001022	7	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
7001023	7	                 END-EXEC	0	0	1
7001025	7	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
7001027	7	                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL.'	0	0	1
7001028	7	                       DELIMITED BY SIZE,	0	0	1
7001029	7	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
7001030	7	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
7001031	7	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
7001032	7	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
7001033	7	                       INTO ABND-FREEFORM	0	0	1
7001034	7	                 END-STRING	0	0	1
7001036	7	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
7001037	7	                           COMMAREA(ABNDINFO-REC)	0	0	1
7001038	7	                 END-EXEC	0	0	1
7001041	7	                 INITIALIZE WS-FAIL-INFO	0	0	1
7001042	7	                 MOVE 'BNK1DAC - SM010 - SEND MAP DATAONLY ALARM FAIL '	0	0	1
7001043	7	                    TO WS-CICS-FAIL-MSG	0	0	1
7001044	7	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
7001045	7	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
7001046	7	                 PERFORM ABEND-THIS-TASK	0	0	1
7001047	7	              END-IF	0	0	1
7001049	7	           END-IF.	0	0	1
7001051	7	       SM999.	0	0	1
7001052	7	           EXIT.	0	0	1
7001055	7	       SEND-TERMINATION-MSG SECTION.	0	0	1
7001056	7	       STM010.	0	0	1
7001057	7	      *	1	0	0
7001058	7	      *    Send the termination message	1	0	1
7001059	7	      *	1	0	1
7001060	7	           EXEC CICS SEND TEXT	0	0	0
7001061	7	              FROM(END-OF-SESSION-MESSAGE)	0	0	1
7001062	7	              ERASE	0	0	1
7001063	7	              FREEKB	0	0	1
7001064	7	              RESP(WS-CICS-RESP)	0	0	1
7001065	7	              RESP2(WS-CICS-RESP2)	0	0	1
7001066	7	           END-EXEC.	0	0	1
7001068	7	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
7001069	7	      *	1	0	0
7001070	7	      *       Preserve the RESP and RESP2, then set up the	1	0	1
7001071	7	      *       standard ABEND info before getting the applid,	1	0	1
7001072	7	      *       date/time etc. and linking to the Abend Handler	1	0	1
7001073	7	      *       program.	1	0	1
7001074	7	      *	1	0	1
7001075	7	              INITIALIZE ABNDINFO-REC	0	0	0
7001076	7	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
7001077	7	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
7001078	7	      *	1	0	0
7001079	7	      *       Get supplemental information	1	0	1
7001080	7	      *	1	0	1
7001081	7	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
7001082	7	              END-EXEC	0	0	1
7001084	7	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
7001085	7	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
7001087	7	              PERFORM POPULATE-TIME-DATE	0	0	1
7001089	7	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
7001090	7	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
7001091	7	                    ':' DELIMITED BY SIZE,	0	0	1
7001092	7	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
7001093	7	                     ':' DELIMITED BY SIZE,	0	0	1
7001094	7	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
7001095	7	                     INTO ABND-TIME	0	0	1
7001096	7	              END-STRING	0	0	1
7001098	7	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
7001099	7	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
7001101	7	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
7001102	7	              END-EXEC	0	0	1
7001104	7	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
7001106	7	              STRING 'STM010 - SEND TEXT FAIL.'	0	0	1
7001107	7	                    DELIMITED BY SIZE,	0	0	1
7001108	7	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
7001109	7	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
7001110	7	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
7001111	7	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
7001112	7	                    INTO ABND-FREEFORM	0	0	1
7001113	7	              END-STRING	0	0	1
7001115	7	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
7001116	7	                        COMMAREA(ABNDINFO-REC)	0	0	1
7001117	7	              END-EXEC	0	0	1
7001119	7	              INITIALIZE WS-FAIL-INFO	0	0	1
7001120	7	              MOVE 'BNK1DAC - STM010 - SEND TEXT FAIL'	0	0	1
7001121	7	                 TO WS-CICS-FAIL-MSG	0	0	1
7001122	7	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
7001123	7	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
7001124	7	              PERFORM ABEND-THIS-TASK	0	0	1
7001125	7	           END-IF.	0	0	1
7001127	7	       STM999.	0	0	1
7001128	7	           EXIT.	0	0	1
7001131	7	       ABEND-THIS-TASK SECTION.	0	0	1
7001132	7	       ATT010.	0	0	1
7001133	7	           EXEC CICS ABEND	0	0	1
7001134	7	                ABCODE('HBNK')	0	0	1
7001135	7	                NODUMP	0	0	1
7001136	7	           END-EXEC.	0	0	1
7001138	7	       ATT999.	0	0	1
7001139	7	           EXIT.	0	0	1
7001142	7	       POPULATE-TIME-DATE SECTION.	0	0	1
7001143	7	       PTD010.	0	0	1
7001144	7	      D    DISPLAY 'POPULATE-TIME-DATE SECTION'.	0	0	1
7001146	7	           EXEC CICS ASKTIME	0	0	1
7001147	7	              ABSTIME(WS-U-TIME)	0	0	1
7001148	7	           END-EXEC.	0	0	1
7001150	7	           EXEC CICS FORMATTIME	0	0	1
7001151	7	                     ABSTIME(WS-U-TIME)	0	0	1
7001152	7	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
7001153	7	                     TIME(WS-TIME-NOW)	0	0	1
7001154	7	                     DATESEP	0	0	1
7001155	7	           END-EXEC.	0	0	1
7001157	7	       PTD999.	0	0	1
7001158	7	           EXIT.	0	0	1
8000000	8	<<<< file not found >>>>	0	0	0
8000001	8	<<<< file not found >>>>	0	0	0
9000000	9	<<<< file not found >>>>	0	0	0
9000001	9	<<<< file not found >>>>	0	0	0
10000001	10	       CBL CICS('SP,EDF')	0	0	1
10000002	10	       CBL SQL	0	0	1
10000003	10	      ******************************************************************	1	0	0
10000004	10	      *                                                                *	1	0	1
10000005	10	      *  Copyright IBM Corp. 2023                                      *	1	0	1
10000006	10	      *                                                                *	1	0	1
10000007	10	      ******************************************************************	1	0	1
10000010	10	       IDENTIFICATION DIVISION.	0	0	0
10000011	10	       PROGRAM-ID. ACCTCTRL.	0	0	1
10000012	10	       AUTHOR. OGRADYJ.	0	0	1
10000014	10	       ENVIRONMENT DIVISION.	0	0	1
10000015	10	       CONFIGURATION SECTION.	0	0	1
10000016	10	      * SOURCE-COMPUTER.  IBM-370 WITH DEBUGGING MODE.	1	0	0
10000017	10	       SOURCE-COMPUTER.  IBM-370.	0	0	0
10000018	10	       OBJECT-COMPUTER.  IBM-370.	0	0	1
10000020	10	       INPUT-OUTPUT SECTION.	0	0	1
10000024	10	       DATA DIVISION.	0	0	1
10000025	10	       FILE SECTION.	0	0	1
10000028	10	       WORKING-STORAGE SECTION.	0	0	1
10000029	10	       01 SYSIDERR-RETRY PIC 999.	0	0	1
10000031	10	       LOCAL-STORAGE SECTION.	0	0	1
10000032	10	       01 DATA-STORE-TYPE      PIC X.	0	0	1
10000033	10	          88 DATASTORE-TYPE-DLI     VALUE '1'.	0	0	1
10000034	10	          88 DATASTORE-TYPE-DB2     VALUE '2'.	0	0	1
10000035	10	          88 DATASTORE-TYPE-VSAM    VALUE 'V'.	0	0	1
10000037	10	       01 ACCOUNT-KY.	0	0	1
10000038	10	          03 REQUIRED-SORT-CODE   PIC 9(6) VALUE 0.	0	0	1
10000039	10	          03 REQUIRED-ACCT-NUMBER PIC 9(8) VALUE 0.	0	0	1
10000043	10	       01 EXIT-DB2-READ        PIC X VALUE 'N'.	0	0	1
10000045	10	       01 WS-V-RETRIED         PIC X VALUE 'N'.	0	0	1
10000046	10	       01 WS-D-RETRIED         PIC X VALUE 'N'.	0	0	1
10000048	10	       01 SQLCODE-DISPLAY                 PIC S9(8) DISPLAY	0	0	1
10000049	10	           SIGN LEADING SEPARATE.	0	0	1
10000051	10	       01 WS-PASSED-DATA.	0	0	1
10000052	10	          02 WS-TEST-KEY                             PIC X(4).	0	0	1
10000053	10	          02 WS-SORT-CODE                            PIC 9(6).	0	0	1
10000054	10	          02 WS-ACCOUNT-RANGE.	0	0	1
10000055	10	             07 WS-ACCOUNT-RANGE-TOP                PIC X.	0	0	1
10000056	10	             07 WS-ACCOUNT-RANGE-MIDDLE             PIC X.	0	0	1
10000057	10	             07 WS-ACCOUNT-RANGE-BOTTOM             PIC X.	0	0	1
10000059	10	       01 WS-SORT-DIV.	0	0	1
10000060	10	          03 WS-SORT-DIV1                    PIC XX.	0	0	1
10000061	10	          03 WS-SORT-DIV2                    PIC XX.	0	0	1
10000062	10	          03 WS-SORT-DIV3                    PIC XX.	0	0	1
10000064	10	       01 WS-DISP-ACCT-NO-VAL                PIC S9(18) DISPLAY.	0	0	1
10000066	10	       01 WS-ACCT-REC-LEN                    PIC S9(4) COMP VALUE 0.	0	0	1
10000068	10	       01 NCS-UPDATED                        PIC X VALUE 'N'.	0	0	1
10000070	10	       01 WS-EIBTASKN12                  PIC 9(12) VALUE 0.	0	0	1
10000071	10	       77 PROCTRAN-RETRY PIC 999.	0	0	1
10000073	10	       01 ACCOUNT-KY2.	0	0	1
10000074	10	          03 REQUIRED-SORT-CODE2   PIC 9(6) VALUE 0.	0	0	1
10000075	10	          03 REQUIRED-ACCT-NUMBER2 PIC 9(10) VALUE 0.	0	0	1
10000077	10	       01 ACCOUNT-KY2-BYTES REDEFINES ACCOUNT-KY2 PIC X(16).	0	0	1
10000079	10	       01 HIGHEST-ACCT-NUMBER  PIC 9(10) VALUE 0.	0	0	1
10000081	10	       01 WS-CICS-RESP PIC S9(8) BINARY.	0	0	1
10000082	10	       01 WS-CICS-RESP2 PIC S9(8) BINARY.	0	0	1
10000084	10	      * Pull in the SQL COMMAREA	1	0	0
10000085	10	       EXEC SQL	0	0	0
10000086	10	          INCLUDE SQLCA	0	0	1
10000087	10	       END-EXEC.	0	0	1
10000089	10	       01 HV-NUMBER-OF-ACCOUNTS PIC S9(8) BINARY.	0	0	1
10000090	10	       01 HV-ACCOUNT-SORTCODE PIC X(6).	0	0	1
10000094	10	       01 WS-U-TIME                      PIC S9(15) COMP-3.	0	0	1
10000095	10	       01 WS-ORIG-DATE                   PIC X(10).	0	0	1
10000096	10	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
10000097	10	          03 WS-ORIG-DATE-DD             PIC 99.	0	0	1
10000098	10	          03 FILLER                      PIC X.	0	0	1
10000099	10	          03 WS-ORIG-DATE-MM             PIC 99.	0	0	1
10000100	10	          03 FILLER                      PIC X.	0	0	1
10000101	10	          03 WS-ORIG-DATE-YYYY           PIC 9999.	0	0	1
10000103	10	       01 WS-ORIG-DATE-GRP-X.	0	0	1
10000104	10	          03 WS-ORIG-DATE-DD-X           PIC XX.	0	0	1
10000105	10	          03 FILLER                      PIC X VALUE '.'.	0	0	1
10000106	10	          03 WS-ORIG-DATE-MM-X           PIC XX.	0	0	1
10000107	10	          03 FILLER                      PIC X VALUE '.'.	0	0	1
10000108	10	          03 WS-ORIG-DATE-YYYY-X         PIC X(4).	0	0	1
10000111	10	       01 WS-TIME-DATA.	0	0	1
10000112	10	           03 WS-TIME-NOW                  PIC 9(6).	0	0	1
10000113	10	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
10000114	10	              05 WS-TIME-NOW-GRP-HH     PIC 99.	0	0	1
10000115	10	              05 WS-TIME-NOW-GRP-MM     PIC 99.	0	0	1
10000116	10	              05 WS-TIME-NOW-GRP-SS     PIC 99.	0	0	1
10000118	10	       01 WS-ABEND-PGM                  PIC X(8) VALUE 'ABNDPROC'.	0	0	1
10000120	10	       01 ABNDINFO-REC.	0	0	1
10000121	10	           COPY ABNDINFO.	0	0	1
10000123	10	       COPY SORTCODE.	0	0	1
10000125	10	       LINKAGE SECTION.	0	0	1
10000126	10	       01 DFHCOMMAREA.	0	0	1
10000127	10	           COPY ACCTCTRL.	0	0	1
10000132	10	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
10000133	10	       PREMIERE SECTION.	0	0	1
10000134	10	       P010.	0	0	1
10000138	10	           MOVE SORTCODE TO	0	0	1
10000139	10	              REQUIRED-SORT-CODE.	0	0	1
10000141	10	           PERFORM GET-NUMBER-OF-ACCOUNTS-DB2	0	0	1
10000144	10	      D    DISPLAY 'OUTPUT DATA IS='	0	0	1
10000145	10	      D       DFHCOMMAREA.	0	0	1
10000148	10	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
10000150	10	       P999.	0	0	1
10000151	10	           EXIT.	0	0	1
10000157	10	       GET-NUMBER-OF-ACCOUNTS-DB2 SECTION.	0	0	1
10000158	10	       WCD010.	0	0	1
10000160	10	           INITIALIZE DFHCOMMAREA.	0	0	1
10000163	10	           MOVE REQUIRED-SORT-CODE TO HV-ACCOUNT-SORTCODE	0	0	1
10000165	10	           EXEC SQL	0	0	1
10000166	10	              SELECT COUNT(*)	0	0	1
10000167	10	              INTO  :HV-NUMBER-OF-ACCOUNTS	0	0	1
10000168	10	              FROM ACCOUNT	0	0	1
10000169	10	              WHERE ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE	0	0	1
10000170	10	           END-EXEC.	0	0	1
10000172	10	           IF SQLCODE = ZERO	0	0	1
10000173	10	             MOVE 'Y' TO ACCOUNT-CONTROL-SUCCESS-FLAG	0	0	1
10000174	10	             MOVE HV-NUMBER-OF-ACCOUNTS TO NUMBER-OF-ACCOUNTS	0	0	1
10000175	10	           ELSE	0	0	1
10000176	10	             MOVE 'N' TO ACCOUNT-CONTROL-SUCCESS-FLAG	0	0	1
10000177	10	             MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
10000178	10	           END-IF.	0	0	1
10000179	10	       WCD999.	0	0	1
10000180	10	           EXIT.	0	0	1
10000182	10	      /	1	0	0
10000183	10	       POPULATE-TIME-DATE SECTION.	0	0	0
10000184	10	       PTD010.	0	0	1
10000185	10	      D    DISPLAY 'POPULATE-TIME-DATE SECTION'.	0	0	1
10000187	10	           EXEC CICS ASKTIME	0	0	1
10000188	10	              ABSTIME(WS-U-TIME)	0	0	1
10000189	10	           END-EXEC.	0	0	1
10000191	10	           EXEC CICS FORMATTIME	0	0	1
10000192	10	                     ABSTIME(WS-U-TIME)	0	0	1
10000193	10	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
10000194	10	                     TIME(WS-TIME-NOW)	0	0	1
10000195	10	                     DATESEP	0	0	1
10000196	10	           END-EXEC.	0	0	1
10000198	10	       PTD999.	0	0	1
10000199	10	           EXIT.	0	0	1
10000202	10	      *	1	0	0
10000203	10	      * Finish	1	0	1
10000204	10	      *	1	0	1
10000205	10	       GET-ME-OUT-OF-HERE SECTION.	0	0	0
10000206	10	       GMOFH010.	0	0	1
10000208	10	           EXEC CICS RETURN	0	0	1
10000209	10	           END-EXEC.	0	0	1
10000211	10	       GMOFH999.	0	0	1
10000212	10	           EXIT.	0	0	1
11000000	11	<<<< included file >>>>	0	0	0
11000001	11	**********************************************************************	1	0	0
11000002	11	******* COPY STRECKE SQLCA	1	0	0
11000003	11	**********************************************************************	1	0	0
11000004	11	       01 SQLCA.	0	0	1
11000005	11	          05 SQLCAID                 PIC  X(08)    VALUE SPACES.	0	0	0
11000006	11	          05 SQLCABC                 PIC S9(09)    COMPUTATIONAL.	0	0	0
11000007	11	          05 SQLCODE                 PIC S9(09)    COMPUTATIONAL.	0	0	0
11000008	11	          05 SQLERRM.	0	0	0
11000009	11	          49 SQLERRML                PIC S9(04)    COMPUTATIONAL.	0	0	0
11000010	11	          49 SQLERRMC                PIC  X(70)    VALUE SPACES.	0	0	0
11000011	11	          05 SQLERRP                 PIC  X(08)    VALUE SPACES.	0	0	0
11000012	11	          05 SQLERRD                 OCCURS 6 TIMES	0	0	0
11000013	11	                                     PIC S9(09)    COMPUTATIONAL.	0	0	0
11000014	11	          05 SQLWARN.	0	0	0
11000015	11	          10 SQLWARN0                PIC  X(01)    VALUE SPACE.	0	0	0
11000016	11	          10 SQLWARN1                PIC  X(01)    VALUE SPACE.	0	0	0
11000017	11	          10 SQLWARN2                PIC  X(01)    VALUE SPACE.	0	0	0
11000018	11	          10 SQLWARN3                PIC  X(01)    VALUE SPACE.	0	0	0
11000019	11	          10 SQLWARN4                PIC  X(01)    VALUE SPACE.	0	0	0
11000020	11	          10 SQLWARN5                PIC  X(01)    VALUE SPACE.	0	0	0
11000021	11	          10 SQLWARN6                PIC  X(01)    VALUE SPACE.	0	0	0
11000022	11	          10 SQLWARN7                PIC  X(01)    VALUE SPACE.	0	0	0
11000023	11	          05 SQLEXT.	0	0	0
11000024	11	          10 SQLWARN8                PIC  X(01)    VALUE SPACE.	0	0	0
11000025	11	          10 SQLWARN9                PIC  X(01)    VALUE SPACE.	0	0	0
11000026	11	          10 SQLWARNA                PIC  X(01)    VALUE SPACE.	0	0	0
11000027	11	          10 SQLSTATE                PIC  X(05)    VALUE SPACE.	0	0	0
12000000	12	<<<< file not found >>>>	0	0	0
12000001	12	<<<< file not found >>>>	0	0	0
13000000	13	<<<< file not found >>>>	0	0	0
13000001	13	<<<< file not found >>>>	0	0	0
14000001	14	       CBL CICS('SP,EDF')	0	0	0
14000002	14	      ******************************************************************	1	0	0
14000003	14	      *                                                                *	1	0	1
14000004	14	      *  Copyright IBM Corp. 2023                                      *	1	0	1
14000005	14	      *                                                                *	1	0	1
14000006	14	      ******************************************************************	1	0	1
14000007	14	      ******************************************************************	1	0	1
14000008	14	      * This program is the dummy credit agency, used for credit	1	0	1
14000009	14	      * scoring. Data is passed to the program via a channel and	1	0	1
14000010	14	      * container and the role of this program is to delay for a	1	0	1
14000011	14	      * random amount of time (between 0 and 3 seconds) and to	1	0	1
14000012	14	      * create a random credit score (between 1 and 999), then finish.	1	0	1
14000013	14	      *	1	0	1
14000014	14	      * The purpose of the initial delay is to emulate data being	1	0	1
14000015	14	      * returned to the parent program (this program is driven using	1	0	1
14000016	14	      * the Async API). There is a delay of 3 seconds in the parent	1	0	1
14000017	14	      * so what this means is there a 1 in 4 chance that data will be	1	0	1
14000018	14	      * returned withing the overall 3 second delay - this emulates	1	0	1
14000019	14	      * not always being able to get a timely reply back to the parent.	1	0	1
14000020	14	      *	1	0	1
14000021	14	      *	1	0	1
14000022	14	      ******************************************************************	1	0	1
14000024	14	       IDENTIFICATION DIVISION.	0	0	0
14000025	14	       PROGRAM-ID. CRDTAGY4.	0	0	1
14000026	14	       AUTHOR. Jon Collett.	0	0	1
14000028	14	       ENVIRONMENT DIVISION.	0	0	1
14000029	14	       CONFIGURATION SECTION.	0	0	1
14000030	14	      * SOURCE-COMPUTER.  IBM-370 WITH DEBUGGING MODE.	1	0	0
14000031	14	       SOURCE-COMPUTER.  IBM-370.	0	0	0
14000032	14	       OBJECT-COMPUTER.  IBM-370.	0	0	1
14000034	14	       INPUT-OUTPUT SECTION.	0	0	1
14000036	14	       DATA DIVISION.	0	0	1
14000037	14	       FILE SECTION.	0	0	1
14000039	14	       WORKING-STORAGE SECTION.	0	0	1
14000042	14	       COPY SORTCODE.	0	0	1
14000045	14	       01 WS-CONT-IN.	0	0	1
14000046	14	          03 WS-CONT-IN-EYECATCHER      PIC X(4).	0	0	1
14000047	14	          03 WS-CONT-IN-KEY.	0	0	1
14000048	14	             05 WS-CONT-IN-SORTCODE     PIC 9(6) DISPLAY.	0	0	1
14000049	14	             05 WS-CONT-IN-NUMBER       PIC 9(10) DISPLAY.	0	0	1
14000050	14	          03 WS-CONT-IN-NAME            PIC X(60).	0	0	1
14000051	14	          03 WS-CONT-IN-ADDRESS         PIC X(160).	0	0	1
14000052	14	          03 WS-CONT-IN-DATE-OF-BIRTH   PIC 9(8).	0	0	1
14000053	14	          03 WS-CONT-IN-DOB-GROUP REDEFINES WS-CONT-IN-DATE-OF-BIRTH.	0	0	1
14000054	14	             05 WS-CONT-IN-BIRTH-DAY    PIC 99.	0	0	1
14000055	14	             05 WS-CONT-IN-BIRTH-MONTH  PIC 99.	0	0	1
14000056	14	             05 WS-CONT-IN-BIRTH-YEAR   PIC 9999.	0	0	1
14000057	14	          03 WS-CONT-IN-CREDIT-SCORE    PIC 999.	0	0	1
14000058	14	          03 WS-CONT-IN-CS-REVIEW-DATE  PIC 9(8).	0	0	1
14000059	14	          03 WS-CONT-IN-SUCCESS         PIC X.	0	0	1
14000060	14	          03 WS-CONT-IN-FAIL-CODE       PIC X.	0	0	1
14000062	14	       01 WS-CICS-WORK-AREA.	0	0	1
14000063	14	          05 WS-CICS-RESP               PIC S9(8) COMP.	0	0	1
14000064	14	          05 WS-CICS-RESP2              PIC S9(8) COMP.	0	0	1
14000067	14	       01 WS-DELAY-AMT                  PIC S9(8) COMP	0	0	1
14000068	14	                                                   VALUE 0.	0	0	1
14000070	14	       01 WS-CONTAINER-NAME             PIC X(16)  VALUE SPACES.	0	0	1
14000071	14	       01 WS-CHANNEL-NAME               PIC X(16)  VALUE SPACES.	0	0	1
14000073	14	       01 WS-CONTAINER-LEN              PIC S9(8) COMP	0	0	1
14000074	14	                                                   VALUE 0.	0	0	1
14000075	14	       01 WS-NEW-CREDSCORE              PIC 999    VALUE 0.	0	0	1
14000076	14	       01 WS-SEED                       PIC S9(15) COMP.	0	0	1
14000079	14	       01 WS-U-TIME                     PIC S9(15) COMP-3.	0	0	1
14000080	14	       01 WS-ORIG-DATE                  PIC X(10).	0	0	1
14000081	14	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
14000082	14	          03 WS-ORIG-DATE-DD            PIC 99.	0	0	1
14000083	14	          03 FILLER                     PIC X.	0	0	1
14000084	14	          03 WS-ORIG-DATE-MM            PIC 99.	0	0	1
14000085	14	          03 FILLER                     PIC X.	0	0	1
14000086	14	          03 WS-ORIG-DATE-YYYY          PIC 9999.	0	0	1
14000088	14	       01 WS-ORIG-DATE-GRP-X.	0	0	1
14000089	14	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
14000090	14	          03 FILLER                     PIC X      VALUE '.'.	0	0	1
14000091	14	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
14000092	14	          03 FILLER                     PIC X      VALUE '.'.	0	0	1
14000093	14	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
14000096	14	       01 WS-TIME-DATA.	0	0	1
14000097	14	          03 WS-TIME-NOW                PIC 9(6).	0	0	1
14000098	14	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
14000099	14	             05 WS-TIME-NOW-GRP-HH      PIC 99.	0	0	1
14000100	14	             05 WS-TIME-NOW-GRP-MM      PIC 99.	0	0	1
14000101	14	             05 WS-TIME-NOW-GRP-SS      PIC 99.	0	0	1
14000103	14	       01 WS-ABEND-PGM                  PIC X(8)   VALUE 'ABNDPROC'.	0	0	1
14000105	14	       01 ABNDINFO-REC.	0	0	1
14000106	14	           COPY ABNDINFO.	0	0	1
14000109	14	       LINKAGE SECTION.	0	0	1
14000112	14	       PROCEDURE DIVISION.	0	0	1
14000113	14	       PREMIERE SECTION.	0	0	1
14000114	14	       A010.	0	0	1
14000115	14	      *	1	0	0
14000116	14	      *    Generate a random  number of seconds between 0 & 3.	1	0	1
14000117	14	      *    This is the delay amount in seconds.	1	0	1
14000118	14	      *	1	0	1
14000120	14	           MOVE 'CIPD            ' TO WS-CONTAINER-NAME.	0	0	0
14000121	14	           MOVE 'CIPCREDCHANN    ' TO WS-CHANNEL-NAME.	0	0	1
14000122	14	           MOVE EIBTASKN           TO WS-SEED.	0	0	1
14000124	14	           COMPUTE WS-DELAY-AMT = ((3 - 1)	0	0	1
14000125	14	                            * FUNCTION RANDOM(WS-SEED)) + 1.	0	0	1
14000127	14	           EXEC CICS DELAY	0	0	1
14000128	14	                FOR SECONDS(WS-DELAY-AMT)	0	0	1
14000129	14	                RESP(WS-CICS-RESP)	0	0	1
14000130	14	                RESP2(WS-CICS-RESP2)	0	0	1
14000131	14	           END-EXEC.	0	0	1
14000133	14	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
14000134	14	      *	1	0	0
14000135	14	      *       Preserve the RESP and RESP2, then set up the	1	0	1
14000136	14	      *       standard ABEND info before getting the applid,	1	0	1
14000137	14	      *       date/time etc. and linking to the Abend Handler	1	0	1
14000138	14	      *       program.	1	0	1
14000139	14	      *	1	0	1
14000140	14	              INITIALIZE ABNDINFO-REC	0	0	0
14000141	14	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
14000142	14	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
14000143	14	      *	1	0	0
14000144	14	      *       Get supplemental information	1	0	1
14000145	14	      *	1	0	1
14000146	14	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
14000147	14	              END-EXEC	0	0	1
14000149	14	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
14000150	14	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
14000152	14	              PERFORM POPULATE-TIME-DATE	0	0	1
14000154	14	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
14000155	14	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
14000156	14	                      ':' DELIMITED BY SIZE,	0	0	1
14000157	14	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
14000158	14	                       ':' DELIMITED BY SIZE,	0	0	1
14000159	14	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
14000160	14	                       INTO ABND-TIME	0	0	1
14000161	14	              END-STRING	0	0	1
14000163	14	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
14000164	14	              MOVE 'PLOP'      TO ABND-CODE	0	0	1
14000166	14	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
14000167	14	              END-EXEC	0	0	1
14000169	14	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
14000171	14	              STRING 'A010  - *** The delay messed up! ***'	0	0	1
14000172	14	                      DELIMITED BY SIZE,	0	0	1
14000173	14	                      ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
14000174	14	                      ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
14000175	14	                      ' RESP2=' DELIMITED BY SIZE,	0	0	1
14000176	14	                      ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
14000177	14	                      INTO ABND-FREEFORM	0	0	1
14000178	14	              END-STRING	0	0	1
14000180	14	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
14000181	14	                          COMMAREA(ABNDINFO-REC)	0	0	1
14000182	14	              END-EXEC	0	0	1
14000185	14	              DISPLAY '*** The delay messed up ! ***'	0	0	1
14000186	14	              EXEC CICS ABEND	0	0	1
14000187	14	                 ABCODE('PLOP')	0	0	1
14000188	14	              END-EXEC	0	0	1
14000189	14	           END-IF.	0	0	1
14000192	14	           COMPUTE WS-CONTAINER-LEN = LENGTH OF WS-CONT-IN.	0	0	1
14000194	14	           EXEC CICS GET CONTAINER(WS-CONTAINER-NAME)	0	0	1
14000195	14	                     CHANNEL(WS-CHANNEL-NAME)	0	0	1
14000196	14	                     INTO(WS-CONT-IN)	0	0	1
14000197	14	                     FLENGTH(WS-CONTAINER-LEN)	0	0	1
14000198	14	                     RESP(WS-CICS-RESP)	0	0	1
14000199	14	                     RESP2(WS-CICS-RESP2)	0	0	1
14000200	14	           END-EXEC.	0	0	1
14000202	14	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
14000203	14	              DISPLAY 'CRDTAGY4 - UNABLE TO GET CONTAINER. RESP='	0	0	1
14000204	14	                 WS-CICS-RESP ', RESP2=' WS-CICS-RESP2	0	0	1
14000205	14	              DISPLAY 'CONTAINER=' WS-CONTAINER-NAME ' CHANNEL='	0	0	1
14000206	14	                       WS-CHANNEL-NAME ' FLENGTH='	0	0	1
14000207	14	                       WS-CONTAINER-LEN	0	0	1
14000208	14	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
14000209	14	           END-IF.	0	0	1
14000211	14	      *	1	0	0
14000212	14	      *    Now generate a credit score between 1 and 999. Because we	1	0	1
14000213	14	      *    used a SEED on the first RANDOM (above) we don't need to	1	0	1
14000214	14	      *    use a SEED again when using RANDOM for a subsequent time	1	0	1
14000215	14	      *	1	0	1
14000217	14	           COMPUTE WS-NEW-CREDSCORE = ((999 - 1)	0	0	0
14000218	14	                            * FUNCTION RANDOM) + 1.	0	0	1
14000220	14	           MOVE WS-NEW-CREDSCORE TO WS-CONT-IN-CREDIT-SCORE.	0	0	1
14000222	14	      *	1	0	0
14000223	14	      *    Now PUT the data back into a container	1	0	1
14000224	14	      *	1	0	1
14000225	14	           COMPUTE WS-CONTAINER-LEN = LENGTH OF WS-CONT-IN.	0	0	0
14000227	14	           EXEC CICS PUT CONTAINER(WS-CONTAINER-NAME)	0	0	1
14000228	14	                         FROM(WS-CONT-IN)	0	0	1
14000229	14	                         FLENGTH(WS-CONTAINER-LEN)	0	0	1
14000230	14	                         CHANNEL(WS-CHANNEL-NAME)	0	0	1
14000231	14	                         RESP(WS-CICS-RESP)	0	0	1
14000232	14	                         RESP2(WS-CICS-RESP2)	0	0	1
14000233	14	           END-EXEC.	0	0	1
14000235	14	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
14000236	14	              DISPLAY 'CRDTAGY4- UNABLE TO PUT CONTAINER. RESP='	0	0	1
14000237	14	                 WS-CICS-RESP ', RESP2=' WS-CICS-RESP2	0	0	1
14000238	14	              DISPLAY  'CONTAINER='  WS-CONTAINER-NAME	0	0	1
14000239	14	              ' CHANNEL=' WS-CHANNEL-NAME ' FLENGTH='	0	0	1
14000240	14	                    WS-CONTAINER-LEN	0	0	1
14000241	14	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
14000242	14	           END-IF.	0	0	1
14000244	14	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
14000246	14	       A999.	0	0	1
14000247	14	           EXIT.	0	0	1
14000250	14	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
14000251	14	       GMOFH010.	0	0	1
14000253	14	           EXEC CICS RETURN	0	0	1
14000254	14	           END-EXEC.	0	0	1
14000256	14	       GMOFH999.	0	0	1
14000257	14	           EXIT.	0	0	1
14000260	14	       POPULATE-TIME-DATE SECTION.	0	0	1
14000261	14	       PTD010.	0	0	1
14000263	14	           EXEC CICS ASKTIME	0	0	1
14000264	14	              ABSTIME(WS-U-TIME)	0	0	1
14000265	14	           END-EXEC.	0	0	1
14000267	14	           EXEC CICS FORMATTIME	0	0	1
14000268	14	                     ABSTIME(WS-U-TIME)	0	0	1
14000269	14	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
14000270	14	                     TIME(WS-TIME-NOW)	0	0	1
14000271	14	                     DATESEP	0	0	1
14000272	14	           END-EXEC.	0	0	1
14000274	14	       PTD999.	0	0	1
14000275	14	           EXIT.	0	0	1
15000001	15	       CBL CICS('SP,EDF,DLI')	0	0	1
15000002	15	       CBL SQL	0	0	1
15000003	15	      ******************************************************************	1	0	0
15000004	15	      *                                                                *	1	0	1
15000005	15	      *  Copyright IBM Corp. 2023                                      *	1	0	1
15000006	15	      *                                                                *	1	0	1
15000007	15	      ******************************************************************	1	0	1
15000009	15	      ******************************************************************	1	0	1
15000010	15	      * This program takes an incoming account number. It then accesses	1	0	1
15000011	15	      * the DB2 datastore & retrieves the associated account record/row	1	0	1
15000012	15	      * matching on the account number & the account_type.	1	0	1
15000013	15	      *	1	0	1
15000014	15	      * Should there be any issues, the program will abend.	1	0	1
15000015	15	      *	1	0	1
15000016	15	      ******************************************************************	1	0	1
15000018	15	       IDENTIFICATION DIVISION.	0	0	0
15000019	15	       PROGRAM-ID. INQACC.	0	0	1
15000020	15	       AUTHOR. Jon Collett.	0	0	1
15000022	15	       ENVIRONMENT DIVISION.	0	0	1
15000023	15	       CONFIGURATION SECTION.	0	0	1
15000024	15	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
15000025	15	       SOURCE-COMPUTER.  IBM-370.	0	0	0
15000026	15	       OBJECT-COMPUTER.  IBM-370.	0	0	1
15000028	15	       INPUT-OUTPUT SECTION.	0	0	1
15000030	15	       DATA DIVISION.	0	0	1
15000031	15	       FILE SECTION.	0	0	1
15000033	15	       WORKING-STORAGE SECTION.	0	0	1
15000037	15	       COPY SORTCODE.	0	0	1
15000040	15	      * Get the ACCOUNT DB2 copybook	1	0	0
15000041	15	           EXEC SQL	0	0	0
15000042	15	              INCLUDE ACCDB2	0	0	1
15000043	15	           END-EXEC.	0	0	1
15000045	15	      * ACCOUNT Host variables for DB2	1	0	0
15000046	15	       01 HOST-ACCOUNT-ROW.	0	0	0
15000047	15	          03 HV-ACCOUNT-EYECATCHER     PIC X(4).	0	0	1
15000048	15	          03 HV-ACCOUNT-CUST-NO        PIC X(10).	0	0	1
15000049	15	          03 HV-ACCOUNT-SORTCODE       PIC X(6).	0	0	1
15000050	15	          03 HV-ACCOUNT-ACC-NO         PIC X(8).	0	0	1
15000051	15	          03 HV-ACCOUNT-ACC-TYPE       PIC X(8).	0	0	1
15000052	15	          03 HV-ACCOUNT-INT-RATE       PIC S9(4)V99 COMP-3.	0	0	1
15000053	15	          03 HV-ACCOUNT-OPENED         PIC X(10).	0	0	1
15000054	15	          03 HV-ACCOUNT-OVERDRAFT-LIM  PIC S9(9) COMP.	0	0	1
15000055	15	          03 HV-ACCOUNT-LAST-STMT      PIC X(10).	0	0	1
15000056	15	          03 HV-ACCOUNT-NEXT-STMT      PIC X(10).	0	0	1
15000057	15	          03 HV-ACCOUNT-AVAIL-BAL      PIC S9(10)V99 COMP-3.	0	0	1
15000058	15	          03 HV-ACCOUNT-ACTUAL-BAL     PIC S9(10)V99 COMP-3.	0	0	1
15000060	15	      * Pull in the SQL COMMAREA	1	0	0
15000061	15	        EXEC SQL	0	0	0
15000062	15	          INCLUDE SQLCA	0	0	1
15000063	15	        END-EXEC.	0	0	1
15000065	15	      * Declare the CURSOR for ACCOUNT table	1	0	0
15000066	15	           EXEC SQL DECLARE ACC-CURSOR CURSOR FOR	0	0	0
15000067	15	              SELECT ACCOUNT_EYECATCHER,	0	0	1
15000068	15	                     ACCOUNT_CUSTOMER_NUMBER,	0	0	1
15000069	15	                     ACCOUNT_SORTCODE,	0	0	1
15000070	15	                     ACCOUNT_NUMBER,	0	0	1
15000071	15	                     ACCOUNT_TYPE,	0	0	1
15000072	15	                     ACCOUNT_INTEREST_RATE,	0	0	1
15000073	15	                     ACCOUNT_OPENED,	0	0	1
15000074	15	                     ACCOUNT_OVERDRAFT_LIMIT,	0	0	1
15000075	15	                     ACCOUNT_LAST_STATEMENT,	0	0	1
15000076	15	                     ACCOUNT_NEXT_STATEMENT,	0	0	1
15000077	15	                     ACCOUNT_AVAILABLE_BALANCE,	0	0	1
15000078	15	                     ACCOUNT_ACTUAL_BALANCE	0	0	1
15000079	15	                     FROM ACCOUNT	0	0	1
15000080	15	                     WHERE ACCOUNT_SORTCODE =	0	0	1
15000081	15	                        :HV-ACCOUNT-SORTCODE AND	0	0	1
15000082	15	                        ACCOUNT_NUMBER =	0	0	1
15000083	15	                        :HV-ACCOUNT-ACC-NO	0	0	1
15000084	15	                     FOR FETCH ONLY	0	0	1
15000085	15	           END-EXEC.	0	0	1
15000087	15	       01 WS-CICS-WORK-AREA.	0	0	1
15000088	15	          05 WS-CICS-RESP              PIC S9(8) COMP.	0	0	1
15000089	15	          05 WS-CICS-RESP2             PIC S9(8) COMP.	0	0	1
15000091	15	       01 EXIT-BROWSE-LOOP             PIC X VALUE 'N'.	0	0	1
15000093	15	       01 OUTPUT-DATA.	0	0	1
15000094	15	           COPY ACCOUNT.	0	0	1
15000096	15	       01 RETURNED-DATA.	0	0	1
15000097	15	           03 RETURNED-EYE-CATCHER     PIC X(4).	0	0	1
15000098	15	           03 RETURNED-CUST-NO         PIC 9(10).	0	0	1
15000099	15	           03 RETURNED-KEY.	0	0	1
15000100	15	              05 RETURNED-SORT-CODE       PIC 9(6).	0	0	1
15000101	15	              05 RETURNED-NUMBER          PIC 9(8).	0	0	1
15000102	15	           03 RETURNED-TYPE            PIC X(8).	0	0	1
15000103	15	           03 RETURNED-INTEREST-RATE   PIC 9(4)V99.	0	0	1
15000104	15	           03 RETURNED-OPENED          PIC 9(8).	0	0	1
15000105	15	           03 RETURNED-OVERDRAFT-LIMIT PIC 9(8).	0	0	1
15000106	15	           03 RETURNED-LAST-STMT-DATE  PIC 9(8).	0	0	1
15000107	15	           03 RETURNED-NEXT-STMT-DATE  PIC 9(8).	0	0	1
15000108	15	           03 RETURNED-AVAILABLE-BALANCE  PIC S9(10)V99.	0	0	1
15000109	15	           03 RETURNED-ACTUAL-BALANCE     PIC S9(10)V99.	0	0	1
15000111	15	       01 DESIRED-KEY                  PIC 9(10) BINARY.	0	0	1
15000113	15	       01 DB2-DATE-REFORMAT.	0	0	1
15000114	15	          03 DB2-DATE-REF-YR           PIC 9(4).	0	0	1
15000115	15	          03 FILLER                    PIC X.	0	0	1
15000116	15	          03 DB2-DATE-REF-MNTH         PIC 99.	0	0	1
15000117	15	          03 FILLER                    PIC X.	0	0	1
15000118	15	          03 DB2-DATE-REF-DAY          PIC 99.	0	0	1
15000120	15	       01 DATA-STORE-TYPE              PIC X.	0	0	1
15000121	15	          88 DATASTORE-TYPE-DB2           VALUE '2'.	0	0	1
15000122	15	          88 DATASTORE-TYPE-VSAM          VALUE 'V'.	0	0	1
15000124	15	       01 DB2-EXIT-LOOP                PIC X.	0	0	1
15000125	15	       01 FETCH-DATA-CNT               PIC 9(4) COMP.	0	0	1
15000126	15	       01 WS-CUST-ALT-KEY-LEN          PIC S9(4) COMP VALUE +10.	0	0	1
15000128	15	       01 ACCOUNT-KY.	0	0	1
15000129	15	          03 REQUIRED-SORT-CODE        PIC 9(6)  VALUE 0.	0	0	1
15000130	15	          03 REQUIRED-ACC-NUM          PIC 9(8)  VALUE 0.	0	0	1
15000132	15	       01 MY-ABEND-CODE                PIC XXXX.	0	0	1
15000134	15	       01 WS-STORM-DRAIN               PIC X VALUE 'N'.	0	0	1
15000136	15	       01 STORM-DRAIN-CONDITION        PIC X(20).	0	0	1
15000138	15	       01 SQLCODE-DISPLAY              PIC S9(8) DISPLAY	0	0	1
15000139	15	           SIGN LEADING SEPARATE.	0	0	1
15000141	15	      *	1	0	0
15000142	15	      * ACCOUNT NCS definitions	1	0	1
15000143	15	      *	1	0	1
15000144	15	       01 NCS-ACC-NO-STUFF.	0	0	0
15000145	15	          03 NCS-ACC-NO-NAME.	0	0	1
15000146	15	             05 NCS-ACC-NO-ACT-NAME    PIC X(8)	0	0	1
15000147	15	                                          VALUE 'HBNKACCT'.	0	0	1
15000148	15	             05 NCS-ACC-NO-TEST-SORT   PIC X(6)	0	0	1
15000149	15	                                          VALUE '      '.	0	0	1
15000150	15	             05 NCS-ACC-NO-FILL        PIC XX	0	0	1
15000151	15	                                          VALUE '  '.	0	0	1
15000152	15	          03 NCS-ACC-NO-INC            PIC 9(16) COMP	0	0	1
15000153	15	                                          VALUE 0.	0	0	1
15000154	15	          03 NCS-ACC-NO-VALUE          PIC 9(16) COMP	0	0	1
15000155	15	                                          VALUE 0.	0	0	1
15000156	15	          03 NCS-ACC-NO-RESP           PIC XX VALUE '00'.	0	0	1
15000158	15	       01 WS-DISP-ACC-NO-VAL           PIC S9(18) DISPLAY.	0	0	1
15000160	15	       01 ACCOUNT-KY2.	0	0	1
15000161	15	          03 REQUIRED-SORT-CODE2       PIC 9(6) VALUE 0.	0	0	1
15000162	15	          03 REQUIRED-ACC-NUMBER2      PIC 9(8) VALUE 0.	0	0	1
15000164	15	       01 WS-POINTER USAGE POINTER.	0	0	1
15000165	15	       01 WS-POINTER-BYTES  REDEFINES WS-POINTER  PIC X(8).	0	0	1
15000166	15	       01 WS-POINTER-NUMBER  REDEFINES WS-POINTER PIC 9(8) BINARY.	0	0	1
15000168	15	       01 WS-POINTER-NUMBER-DISPLAY    PIC 9(8) DISPLAY.	0	0	1
15000170	15	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
15000171	15	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
15000172	15	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
15000173	15	          03 WS-ORIG-DATE-DD           PIC 99.	0	0	1
15000174	15	          03 FILLER                    PIC X.	0	0	1
15000175	15	          03 WS-ORIG-DATE-MM           PIC 99.	0	0	1
15000176	15	          03 FILLER                    PIC X.	0	0	1
15000177	15	          03 WS-ORIG-DATE-YYYY         PIC 9999.	0	0	1
15000179	15	       01 WS-ORIG-DATE-GRP-X.	0	0	1
15000180	15	          03 WS-ORIG-DATE-DD-X         PIC XX.	0	0	1
15000181	15	          03 FILLER                    PIC X VALUE '.'.	0	0	1
15000182	15	          03 WS-ORIG-DATE-MM-X         PIC XX.	0	0	1
15000183	15	          03 FILLER                    PIC X VALUE '.'.	0	0	1
15000184	15	          03 WS-ORIG-DATE-YYYY-X       PIC X(4).	0	0	1
15000186	15	       01 WS-TIME-DATA.	0	0	1
15000187	15	           03 WS-TIME-NOW              PIC 9(6).	0	0	1
15000188	15	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
15000189	15	              05 WS-TIME-NOW-GRP-HH       PIC 99.	0	0	1
15000190	15	              05 WS-TIME-NOW-GRP-MM       PIC 99.	0	0	1
15000191	15	              05 WS-TIME-NOW-GRP-SS       PIC 99.	0	0	1
15000193	15	       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.	0	0	1
15000195	15	       01 ABNDINFO-REC.	0	0	1
15000196	15	           COPY ABNDINFO.	0	0	1
15000198	15	       LINKAGE SECTION.	0	0	1
15000199	15	       COPY INQACC REPLACING INQACC-COMMAREA BY DFHCOMMAREA.	0	0	1
15000202	15	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
15000203	15	       PREMIERE SECTION.	0	0	1
15000204	15	       A010.	0	0	1
15000206	15	           INITIALIZE OUTPUT-DATA.	0	0	1
15000207	15	      *	1	0	0
15000208	15	      *    Set up the abend handling	1	0	1
15000209	15	      *	1	0	1
15000210	15	           EXEC CICS HANDLE	0	0	0
15000211	15	              ABEND LABEL(ABEND-HANDLING)	0	0	1
15000212	15	           END-EXEC.	0	0	1
15000214	15	           MOVE SORTCODE TO REQUIRED-SORT-CODE OF ACCOUNT-KY.	0	0	1
15000215	15	      *	1	0	0
15000216	15	      *          Get the ACCOUNT row from DB2	1	0	1
15000217	15	      *	1	0	1
15000218	15	           IF INQACC-ACCNO = 99999999	0	0	0
15000219	15	             PERFORM READ-ACCOUNT-LAST	0	0	1
15000220	15	           ELSE	0	0	1
15000221	15	             PERFORM READ-ACCOUNT-DB2	0	0	1
15000222	15	           END-IF	0	0	1
15000225	15	      *	1	0	0
15000226	15	      *    Return the ACCOUNT data to the COMMAREA	1	0	1
15000227	15	      *	1	0	1
15000229	15	           IF ACCOUNT-TYPE = SPACES OR LOW-VALUES	0	0	0
15000230	15	              MOVE 'N' TO INQACC-SUCCESS	0	0	1
15000231	15	           ELSE	0	0	1
15000232	15	              MOVE ACCOUNT-EYE-CATCHER       TO INQACC-EYE	0	0	1
15000233	15	              MOVE ACCOUNT-CUST-NO           TO INQACC-CUSTNO	0	0	1
15000234	15	              MOVE ACCOUNT-SORT-CODE         TO INQACC-SCODE	0	0	1
15000235	15	              MOVE ACCOUNT-NUMBER            TO INQACC-ACCNO	0	0	1
15000236	15	              MOVE ACCOUNT-TYPE              TO INQACC-ACC-TYPE	0	0	1
15000237	15	              MOVE ACCOUNT-INTEREST-RATE     TO INQACC-INT-RATE	0	0	1
15000238	15	              MOVE ACCOUNT-OPENED            TO INQACC-OPENED	0	0	1
15000239	15	              MOVE ACCOUNT-OVERDRAFT-LIMIT   TO INQACC-OVERDRAFT	0	0	1
15000240	15	              MOVE ACCOUNT-LAST-STMT-DATE    TO INQACC-LAST-STMT-DT	0	0	1
15000241	15	              MOVE ACCOUNT-NEXT-STMT-DATE    TO INQACC-NEXT-STMT-DT	0	0	1
15000242	15	              MOVE ACCOUNT-AVAILABLE-BALANCE TO INQACC-AVAIL-BAL	0	0	1
15000243	15	              MOVE ACCOUNT-ACTUAL-BALANCE    TO INQACC-ACTUAL-BAL	0	0	1
15000244	15	              MOVE 'Y'                       TO INQACC-SUCCESS	0	0	1
15000245	15	           END-IF.	0	0	1
15000247	15	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
15000249	15	       A999.	0	0	1
15000250	15	           EXIT.	0	0	1
15000253	15	       READ-ACCOUNT-DB2 SECTION.	0	0	1
15000254	15	       RAD010.	0	0	1
15000256	15	      *	1	0	0
15000257	15	      *     Read the DB2 datastore and process the data	1	0	1
15000258	15	      *	1	0	1
15000260	15	      *	1	0	1
15000261	15	      *    Open the DB2 CURSOR	1	0	1
15000262	15	      *	1	0	1
15000263	15	           MOVE INQACC-ACCNO	0	0	0
15000264	15	              TO HV-ACCOUNT-ACC-NO.	0	0	1
15000265	15	           MOVE SORTCODE TO HV-ACCOUNT-SORTCODE.	0	0	1
15000267	15	      *	1	0	0
15000268	15	      *    Open the DB2 CURSOR	1	0	1
15000269	15	      *	1	0	1
15000270	15	           EXEC SQL OPEN ACC-CURSOR	0	0	0
15000271	15	           END-EXEC.	0	0	1
15000273	15	           IF SQLCODE NOT = 0	0	0	1
15000274	15	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
15000275	15	      *	1	0	0
15000276	15	      *       Preserve the RESP and RESP2, then set up the	1	0	1
15000277	15	      *       standard ABEND info before getting the applid,	1	0	1
15000278	15	      *       date/time etc. and linking to the Abend Handler	1	0	1
15000279	15	      *       program.	1	0	1
15000280	15	      *	1	0	1
15000281	15	              INITIALIZE ABNDINFO-REC	0	0	0
15000282	15	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
15000283	15	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
15000284	15	      *	1	0	0
15000285	15	      *       Get supplemental information	1	0	1
15000286	15	      *	1	0	1
15000287	15	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
15000288	15	              END-EXEC	0	0	1
15000290	15	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
15000291	15	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
15000293	15	              PERFORM POPULATE-TIME-DATE	0	0	1
15000295	15	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
15000296	15	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
15000297	15	                    ':' DELIMITED BY SIZE,	0	0	1
15000298	15	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
15000299	15	                     ':' DELIMITED BY SIZE,	0	0	1
15000300	15	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
15000301	15	                     INTO ABND-TIME	0	0	1
15000302	15	              END-STRING	0	0	1
15000304	15	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
15000305	15	              MOVE 'HRAC'      TO ABND-CODE	0	0	1
15000307	15	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
15000308	15	              END-EXEC	0	0	1
15000310	15	              MOVE SQLCODE-DISPLAY TO ABND-SQLCODE	0	0	1
15000312	15	              STRING 'RAD010 -Failure when attempting to OPEN DB2 '	0	0	1
15000313	15	                    DELIMITED BY SIZE,	0	0	1
15000314	15	                    'CURSOR. Check SQLCODE. '	0	0	1
15000315	15	                    DELIMITED BY SIZE,	0	0	1
15000316	15	                    'SQLCODE=' DELIMITED BY SIZE,	0	0	1
15000317	15	                    SQLCODE-DISPLAY DELIMITED BY SIZE,	0	0	1
15000318	15	                    INTO ABND-FREEFORM	0	0	1
15000319	15	              END-STRING	0	0	1
15000321	15	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
15000322	15	                        COMMAREA(ABNDINFO-REC)	0	0	1
15000323	15	              END-EXEC	0	0	1
15000325	15	              DISPLAY 'Failure when attempting to open DB2 CURSOR '	0	0	1
15000326	15	                  'ACC-CURSOR. With SQL code='	0	0	1
15000327	15	                  SQLCODE-DISPLAY	0	0	1
15000329	15	      *	1	0	0
15000330	15	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
15000331	15	      *       is applicable in a workload if activated	1	0	1
15000332	15	      *	1	0	1
15000333	15	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
15000335	15	              EXEC CICS ABEND ABCODE('HRAC')	0	0	1
15000336	15	                 CANCEL	0	0	1
15000337	15	                 NODUMP	0	0	1
15000338	15	              END-EXEC	0	0	1
15000340	15	           END-IF.	0	0	1
15000342	15	      *	1	0	0
15000343	15	      *    FETCH the account row	1	0	1
15000344	15	      *	1	0	1
15000345	15	           PERFORM FETCH-DATA.	0	0	0
15000347	15	      *	1	0	0
15000348	15	      *    Close the DB2 CURSOR	1	0	1
15000349	15	      *	1	0	1
15000350	15	           EXEC SQL CLOSE ACC-CURSOR	0	0	0
15000351	15	           END-EXEC.	0	0	1
15000353	15	           IF SQLCODE NOT = 0	0	0	1
15000354	15	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
15000355	15	      *	1	0	0
15000356	15	      *       Preserve the RESP and RESP2, then set up the	1	0	1
15000357	15	      *       standard ABEND info before getting the applid,	1	0	1
15000358	15	      *       date/time etc. and linking to the Abend Handler	1	0	1
15000359	15	      *       program.	1	0	1
15000360	15	      *	1	0	1
15000361	15	              INITIALIZE ABNDINFO-REC	0	0	0
15000362	15	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
15000363	15	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
15000364	15	      *	1	0	0
15000365	15	      *       Get supplemental information	1	0	1
15000366	15	      *	1	0	1
15000367	15	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
15000368	15	              END-EXEC	0	0	1
15000370	15	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
15000371	15	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
15000373	15	              PERFORM POPULATE-TIME-DATE	0	0	1
15000375	15	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
15000376	15	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
15000377	15	                    ':' DELIMITED BY SIZE,	0	0	1
15000378	15	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
15000379	15	                     ':' DELIMITED BY SIZE,	0	0	1
15000380	15	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
15000381	15	                     INTO ABND-TIME	0	0	1
15000382	15	              END-STRING	0	0	1
15000384	15	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
15000385	15	              MOVE 'HRAC'      TO ABND-CODE	0	0	1
15000387	15	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
15000388	15	              END-EXEC	0	0	1
15000390	15	              MOVE SQLCODE-DISPLAY TO ABND-SQLCODE	0	0	1
15000392	15	              STRING 'RAD010 -Failure when attempting to CLOSE DB2 '	0	0	1
15000393	15	                    DELIMITED BY SIZE,	0	0	1
15000394	15	                    'CURSOR (ACC-CUSOR). Check SQLCODE'	0	0	1
15000395	15	                    DELIMITED BY SIZE,	0	0	1
15000396	15	                    'SQLCODE=' DELIMITED BY SIZE,	0	0	1
15000397	15	                    SQLCODE-DISPLAY DELIMITED BY SIZE,	0	0	1
15000398	15	                    INTO ABND-FREEFORM	0	0	1
15000399	15	              END-STRING	0	0	1
15000401	15	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
15000402	15	                        COMMAREA(ABNDINFO-REC)	0	0	1
15000403	15	              END-EXEC	0	0	1
15000406	15	              DISPLAY 'Failure when attempting to close the DB2 CURSOR'	0	0	1
15000407	15	                  ' ACC-CURSOR. With SQL code='	0	0	1
15000408	15	                  SQLCODE-DISPLAY	0	0	1
15000409	15	      *	1	0	0
15000410	15	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
15000411	15	      *       is applicable in a workload if activated	1	0	1
15000412	15	      *	1	0	1
15000413	15	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
15000415	15	              EXEC CICS ABEND ABCODE('HRAC')	0	0	1
15000416	15	                 CANCEL	0	0	1
15000417	15	                 NODUMP	0	0	1
15000418	15	              END-EXEC	0	0	1
15000420	15	           END-IF.	0	0	1
15000422	15	       RAD999.	0	0	1
15000423	15	           EXIT.	0	0	1
15000426	15	       FETCH-DATA SECTION.	0	0	1
15000427	15	       FD010.	0	0	1
15000428	15	      *	1	0	0
15000429	15	      *    Gets matching data from the ACCOUNT table	1	0	1
15000430	15	      *	1	0	1
15000431	15	           EXEC SQL FETCH FROM ACC-CURSOR	0	0	0
15000432	15	              INTO :HV-ACCOUNT-EYECATCHER,	0	0	1
15000433	15	                   :HV-ACCOUNT-CUST-NO,	0	0	1
15000434	15	                   :HV-ACCOUNT-SORTCODE,	0	0	1
15000435	15	                   :HV-ACCOUNT-ACC-NO,	0	0	1
15000436	15	                   :HV-ACCOUNT-ACC-TYPE,	0	0	1
15000437	15	                   :HV-ACCOUNT-INT-RATE,	0	0	1
15000438	15	                   :HV-ACCOUNT-OPENED,	0	0	1
15000439	15	                   :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
15000440	15	                   :HV-ACCOUNT-LAST-STMT,	0	0	1
15000441	15	                   :HV-ACCOUNT-NEXT-STMT,	0	0	1
15000442	15	                   :HV-ACCOUNT-AVAIL-BAL,	0	0	1
15000443	15	                   :HV-ACCOUNT-ACTUAL-BAL	0	0	1
15000444	15	           END-EXEC.	0	0	1
15000446	15	      *	1	0	0
15000447	15	      *    If there is no data found at all, then return a	1	0	1
15000448	15	      *    low value record	1	0	1
15000449	15	      *	1	0	1
15000450	15	           IF SQLCODE = +100	0	0	0
15000452	15	             INITIALIZE OUTPUT-DATA	0	0	1
15000453	15	             MOVE SORTCODE TO ACCOUNT-SORT-CODE OF OUTPUT-DATA	0	0	1
15000454	15	             MOVE INQACC-ACCNO TO ACCOUNT-NUMBER OF OUTPUT-DATA	0	0	1
15000456	15	             GO TO FD999	0	0	1
15000458	15	           END-IF.	0	0	1
15000460	15	           IF SQLCODE NOT = 0	0	0	1
15000462	15	      *	1	0	0
15000463	15	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
15000464	15	      *       is applicable in a workload if activated	1	0	1
15000465	15	      *	1	0	1
15000466	15	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
15000468	15	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
15000470	15	      *	1	0	0
15000471	15	      *       Preserve the RESP and RESP2, then set up the	1	0	1
15000472	15	      *       standard ABEND info before getting the applid,	1	0	1
15000473	15	      *       date/time etc. and linking to the Abend Handler	1	0	1
15000474	15	      *       program.	1	0	1
15000475	15	      *	1	0	1
15000476	15	              INITIALIZE ABNDINFO-REC	0	0	0
15000477	15	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
15000478	15	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
15000479	15	      *	1	0	0
15000480	15	      *       Get supplemental information	1	0	1
15000481	15	      *	1	0	1
15000482	15	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
15000483	15	              END-EXEC	0	0	1
15000485	15	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
15000486	15	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
15000488	15	              PERFORM POPULATE-TIME-DATE	0	0	1
15000490	15	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
15000491	15	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
15000492	15	                    ':' DELIMITED BY SIZE,	0	0	1
15000493	15	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
15000494	15	                     ':' DELIMITED BY SIZE,	0	0	1
15000495	15	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
15000496	15	                     INTO ABND-TIME	0	0	1
15000497	15	              END-STRING	0	0	1
15000499	15	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
15000500	15	              MOVE 'HRAC'      TO ABND-CODE	0	0	1
15000502	15	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
15000503	15	              END-EXEC	0	0	1
15000505	15	              MOVE SQLCODE-DISPLAY TO ABND-SQLCODE	0	0	1
15000507	15	              STRING 'FD010 -Failure when attempting to FETCH from '	0	0	1
15000508	15	                    DELIMITED BY SIZE,	0	0	1
15000509	15	                    'DB2 CURSOR (ACC-CURSOR). Check SQLCODE'	0	0	1
15000510	15	                    DELIMITED BY SIZE,	0	0	1
15000511	15	                    'SQLCODE=' DELIMITED BY SIZE,	0	0	1
15000512	15	                    SQLCODE-DISPLAY DELIMITED BY SIZE,	0	0	1
15000513	15	                    INTO ABND-FREEFORM	0	0	1
15000514	15	              END-STRING	0	0	1
15000516	15	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
15000517	15	                        COMMAREA(ABNDINFO-REC)	0	0	1
15000518	15	              END-EXEC	0	0	1
15000520	15	              DISPLAY 'Failure when attempting to FETCH from the DB2 '	0	0	1
15000521	15	                  'CURSOR ACC-CURSOR. With SQL code='	0	0	1
15000522	15	                  SQLCODE-DISPLAY	0	0	1
15000524	15	              EXEC CICS ABEND ABCODE('HRAC')	0	0	1
15000525	15	                 CANCEL	0	0	1
15000526	15	                 NODUMP	0	0	1
15000527	15	              END-EXEC	0	0	1
15000529	15	           END-IF.	0	0	1
15000531	15	      *	1	0	0
15000532	15	      *    If we found a matching account record	1	0	1
15000533	15	      *	1	0	1
15000534	15	           MOVE HV-ACCOUNT-EYECATCHER TO	0	0	0
15000535	15	              ACCOUNT-EYE-CATCHER OF OUTPUT-DATA.	0	0	1
15000536	15	           MOVE HV-ACCOUNT-CUST-NO TO	0	0	1
15000537	15	              ACCOUNT-CUST-NO OF OUTPUT-DATA.	0	0	1
15000538	15	           MOVE HV-ACCOUNT-SORTCODE TO	0	0	1
15000539	15	              ACCOUNT-SORT-CODE OF OUTPUT-DATA.	0	0	1
15000540	15	           MOVE HV-ACCOUNT-ACC-NO TO	0	0	1
15000541	15	              ACCOUNT-NUMBER OF OUTPUT-DATA.	0	0	1
15000542	15	           MOVE HV-ACCOUNT-ACC-TYPE TO	0	0	1
15000543	15	              ACCOUNT-TYPE OF OUTPUT-DATA.	0	0	1
15000544	15	           MOVE HV-ACCOUNT-INT-RATE TO	0	0	1
15000545	15	              ACCOUNT-INTEREST-RATE OF OUTPUT-DATA.	0	0	1
15000546	15	           MOVE HV-ACCOUNT-OPENED TO DB2-DATE-REFORMAT.	0	0	1
15000547	15	           MOVE DB2-DATE-REF-DAY TO	0	0	1
15000548	15	              ACCOUNT-OPENED-DAY OF OUTPUT-DATA.	0	0	1
15000549	15	           MOVE DB2-DATE-REF-MNTH TO	0	0	1
15000550	15	              ACCOUNT-OPENED-MONTH OF OUTPUT-DATA.	0	0	1
15000551	15	           MOVE DB2-DATE-REF-YR TO	0	0	1
15000552	15	              ACCOUNT-OPENED-YEAR OF OUTPUT-DATA.	0	0	1
15000553	15	           MOVE HV-ACCOUNT-OVERDRAFT-LIM TO	0	0	1
15000554	15	              ACCOUNT-OVERDRAFT-LIMIT OF OUTPUT-DATA.	0	0	1
15000555	15	           MOVE HV-ACCOUNT-LAST-STMT TO DB2-DATE-REFORMAT.	0	0	1
15000556	15	           MOVE DB2-DATE-REF-DAY TO	0	0	1
15000557	15	              ACCOUNT-LAST-STMT-DAY OF OUTPUT-DATA.	0	0	1
15000558	15	           MOVE DB2-DATE-REF-MNTH TO	0	0	1
15000559	15	              ACCOUNT-LAST-STMT-MONTH OF OUTPUT-DATA.	0	0	1
15000560	15	           MOVE DB2-DATE-REF-YR TO	0	0	1
15000561	15	              ACCOUNT-LAST-STMT-YEAR OF OUTPUT-DATA.	0	0	1
15000562	15	           MOVE HV-ACCOUNT-NEXT-STMT TO DB2-DATE-REFORMAT	0	0	1
15000563	15	           MOVE DB2-DATE-REF-DAY TO	0	0	1
15000564	15	              ACCOUNT-NEXT-STMT-DAY OF OUTPUT-DATA.	0	0	1
15000565	15	           MOVE DB2-DATE-REF-MNTH TO	0	0	1
15000566	15	              ACCOUNT-NEXT-STMT-MONTH OF OUTPUT-DATA.	0	0	1
15000567	15	           MOVE DB2-DATE-REF-YR TO	0	0	1
15000568	15	              ACCOUNT-NEXT-STMT-YEAR OF OUTPUT-DATA.	0	0	1
15000569	15	           MOVE HV-ACCOUNT-AVAIL-BAL TO	0	0	1
15000570	15	              ACCOUNT-AVAILABLE-BALANCE OF OUTPUT-DATA.	0	0	1
15000571	15	           MOVE HV-ACCOUNT-ACTUAL-BAL TO	0	0	1
15000572	15	              ACCOUNT-ACTUAL-BALANCE OF OUTPUT-DATA.	0	0	1
15000574	15	       FD999.	0	0	1
15000575	15	           EXIT.	0	0	1
15000578	15	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
15000579	15	       GMOFH010.	0	0	1
15000581	15	      *	1	0	0
15000582	15	      *    Return control back to CICS	1	0	1
15000583	15	      *	1	0	1
15000584	15	           EXEC CICS RETURN	0	0	0
15000585	15	           END-EXEC.	0	0	1
15000587	15	           GOBACK.	0	0	1
15000589	15	       GMOFH999.	0	0	1
15000590	15	           EXIT.	0	0	1
15000593	15	      *	1	0	0
15000594	15	      * Check for Storm Drain Condition (DB2)	1	0	1
15000595	15	      *	1	0	1
15000596	15	       CHECK-FOR-STORM-DRAIN-DB2 SECTION.	0	0	0
15000597	15	       CFSDCD010.	0	0	1
15000599	15	      *	1	0	0
15000600	15	      *    Check if the Sqclode that is returned one that will	1	0	1
15000601	15	      *    trigger Storm Drain is active in Workload	1	0	1
15000602	15	      *	1	0	1
15000604	15	           EVALUATE SQLCODE	0	0	0
15000606	15	              WHEN 923	0	0	1
15000607	15	                 MOVE 'DB2 Connection lost ' TO STORM-DRAIN-CONDITION	0	0	1
15000609	15	              WHEN OTHER	0	0	1
15000610	15	                 MOVE 'Not Storm Drain     ' TO STORM-DRAIN-CONDITION	0	0	1
15000612	15	           END-EVALUATE.	0	0	1
15000614	15	           MOVE SQLCODE TO SQLCODE-DISPLAY.	0	0	1
15000616	15	           IF STORM-DRAIN-CONDITION NOT EQUAL 'Not Storm Drain     '	0	0	1
15000617	15	              DISPLAY 'INQACC: Check-For-Storm-Drain-DB2: Storm '	0	0	1
15000618	15	                      'Drain condition (' STORM-DRAIN-CONDITION ') '	0	0	1
15000619	15	                      'has been met (' SQLCODE-DISPLAY ').'	0	0	1
15000620	15	           ELSE	0	0	1
15000621	15	              CONTINUE	0	0	1
15000622	15	           END-IF.	0	0	1
15000625	15	       CFSDCD999.	0	0	1
15000626	15	           EXIT.	0	0	1
15000629	15	      *	1	0	0
15000630	15	      * How ABENDs are dealt with	1	0	1
15000631	15	      *	1	0	1
15000632	15	       ABEND-HANDLING SECTION.	0	0	0
15000633	15	       AH010.	0	0	1
15000635	15	           EXEC CICS ASSIGN ABCODE(MY-ABEND-CODE)	0	0	1
15000636	15	           END-EXEC.	0	0	1
15000638	15	      *	1	0	0
15000639	15	      *    Evaluate the Abend code that is returned	1	0	1
15000640	15	      *      - For DB2 AD2Z ... provide some diagnostics	1	0	1
15000641	15	      *      - For VSAM RLS abends: AFCR, AFCS and AFCT record the	1	0	1
15000642	15	      *     Abend as happening but do not abend ... leave this to	1	0	1
15000643	15	      *     CPSM WLM "Storm drain" (Abend probability) to handle	1	0	1
15000644	15	      *    If not a "storm drain" ... take the abend afterwards	1	0	1
15000645	15	      *	1	0	1
15000646	15	           EVALUATE MY-ABEND-CODE	0	0	0
15000648	15	      *	1	0	0
15000649	15	      *       DB2 AD2Z abend	1	0	1
15000650	15	      *	1	0	1
15000651	15	              WHEN 'AD2Z'	0	0	0
15000653	15	                 MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
15000654	15	                 DISPLAY 'DB2 DEADLOCK DETECTED IN INQACC, SQLCODE='	0	0	1
15000655	15	                    SQLCODE-DISPLAY	0	0	1
15000656	15	                 DISPLAY 'DB2 DEADLOCK FOR ACCOUNT '	0	0	1
15000657	15	                    HV-ACCOUNT-ACC-NO	0	0	1
15000658	15	                 DISPLAY  'SQLSTATE=' SQLSTATE	0	0	1
15000659	15	                        ',SQLERRMC=' sqlerrmc(1:sqlerrmL)	0	0	1
15000660	15	                        ',SQLERRD(1)=' SQLERRD(1)	0	0	1
15000661	15	                        ',SQLERRD(2)=' SQLERRD(2)	0	0	1
15000662	15	                        ',SQLERRD(3)=' SQLERRD(3)	0	0	1
15000663	15	                        ',SQLERRD(4)=' SQLERRD(4)	0	0	1
15000664	15	                        ',SQLERRD(5)=' SQLERRD(5)	0	0	1
15000665	15	                        ',SQLERRD(6)=' SQLERRD(6)	0	0	1
15000667	15	      *	1	0	0
15000668	15	      *          VSAM RLS abends, subject to CPSM WLM Storm Drain check	1	0	1
15000669	15	      *          if handled (as here) and Workload Abend Thresholds are	1	0	1
15000670	15	      *          set.	1	0	1
15000671	15	      *	1	0	1
15000672	15	              WHEN 'AFCR'	0	0	0
15000674	15	              WHEN 'AFCS'	0	0	1
15000676	15	              WHEN 'AFCT'	0	0	1
15000677	15	                 MOVE 'Y' TO WS-STORM-DRAIN	0	0	1
15000678	15	                 DISPLAY 'INQACC: Check-For-Storm-Drain-VSAM: Storm '	0	0	1
15000679	15	                       'Drain condition (Abend ' MY-ABEND-CODE ') '	0	0	1
15000680	15	                       'has been met.'	0	0	1
15000682	15	                 EXEC CICS SYNCPOINT ROLLBACK	0	0	1
15000683	15	                    RESP(WS-CICS-RESP)	0	0	1
15000684	15	                    RESP2(WS-CICS-RESP2)	0	0	1
15000685	15	                 END-EXEC	0	0	1
15000687	15	                IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
15000689	15	      *	1	0	0
15000690	15	      *            Preserve the RESP and RESP2, then set up the	1	0	1
15000691	15	      *            standard ABEND info before getting the applid,	1	0	1
15000692	15	      *            date/time etc. and linking to the Abend Handler	1	0	1
15000693	15	      *            program.	1	0	1
15000694	15	      *	1	0	1
15000695	15	                   INITIALIZE ABNDINFO-REC	0	0	0
15000696	15	                   MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
15000697	15	                   MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
15000698	15	      *	1	0	0
15000699	15	      *            Get supplemental information	1	0	1
15000700	15	      *	1	0	1
15000701	15	                   EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
15000702	15	                   END-EXEC	0	0	1
15000704	15	                   MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
15000705	15	                   MOVE EIBTRNID   TO ABND-TRANID	0	0	1
15000707	15	                   PERFORM POPULATE-TIME-DATE	0	0	1
15000709	15	                   MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
15000710	15	                   STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
15000711	15	                       ':' DELIMITED BY SIZE,	0	0	1
15000712	15	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
15000713	15	                        ':' DELIMITED BY SIZE,	0	0	1
15000714	15	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
15000715	15	                        INTO ABND-TIME	0	0	1
15000716	15	                   END-STRING	0	0	1
15000718	15	                   MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
15000719	15	                   MOVE 'HROL'      TO ABND-CODE	0	0	1
15000721	15	                   EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
15000722	15	                   END-EXEC	0	0	1
15000724	15	                   MOVE 0 TO ABND-SQLCODE	0	0	1
15000726	15	                   STRING 'AH010 -Unable to perform SYNCPOINT ROLLBACK.'	0	0	1
15000727	15	                       DELIMITED BY SIZE,	0	0	1
15000728	15	                       ' Possible integrity issue following VSAM RLS '	0	0	1
15000729	15	                       DELIMITED BY SIZE,	0	0	1
15000730	15	                       ' abend.' DELIMITED BY SIZE,	0	0	1
15000731	15	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
15000732	15	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
15000733	15	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
15000734	15	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
15000735	15	                       INTO ABND-FREEFORM	0	0	1
15000736	15	                   END-STRING	0	0	1
15000738	15	                   EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
15000739	15	                           COMMAREA(ABNDINFO-REC)	0	0	1
15000740	15	                   END-EXEC	0	0	1
15000742	15	                   DISPLAY 'INQACC: Unable to perform Syncpoint '	0	0	1
15000743	15	                           'Rollback. Possible Integrity issue '	0	0	1
15000744	15	                           ' following VSAM RLS abend. '	0	0	1
15000745	15	                           ' RESP CODE=' WS-CICS-RESP	0	0	1
15000746	15	                           ' RESP2 CODE=' WS-CICS-RESP2	0	0	1
15000748	15	                   EXEC CICS ABEND	0	0	1
15000749	15	                      ABCODE ('HROL')	0	0	1
15000750	15	                      NODUMP	0	0	1
15000751	15	                       CANCEL	0	0	1
15000752	15	                   END-EXEC	0	0	1
15000754	15	                END-IF	0	0	1
15000756	15	                MOVE 'N' TO INQACC-SUCCESS	0	0	1
15000758	15	                EXEC CICS RETURN	0	0	1
15000759	15	                END-EXEC	0	0	1
15000761	15	           END-EVALUATE.	0	0	1
15000763	15	           IF WS-STORM-DRAIN = 'N'	0	0	1
15000764	15	      *	1	0	0
15000765	15	      *       Preserve the RESP and RESP2, then set up the	1	0	1
15000766	15	      *       standard ABEND info before getting the applid,	1	0	1
15000767	15	      *       date/time etc. and linking to the Abend Handler	1	0	1
15000768	15	      *       program.	1	0	1
15000769	15	      *	1	0	1
15000770	15	              INITIALIZE ABNDINFO-REC	0	0	0
15000771	15	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
15000772	15	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
15000773	15	      *	1	0	0
15000774	15	      *       Get supplemental information	1	0	1
15000775	15	      *	1	0	1
15000776	15	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
15000777	15	              END-EXEC	0	0	1
15000779	15	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
15000780	15	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
15000782	15	              PERFORM POPULATE-TIME-DATE	0	0	1
15000784	15	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
15000785	15	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
15000786	15	                     ':' DELIMITED BY SIZE,	0	0	1
15000787	15	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
15000788	15	                     ':' DELIMITED BY SIZE,	0	0	1
15000789	15	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
15000790	15	                     INTO ABND-TIME	0	0	1
15000791	15	              END-STRING	0	0	1
15000793	15	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
15000794	15	              MOVE MY-ABEND-CODE TO ABND-CODE	0	0	1
15000796	15	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
15000797	15	              END-EXEC	0	0	1
15000799	15	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
15000801	15	              STRING 'AH010 -WVS-STORM-DRAIN=N'	0	0	1
15000802	15	                    DELIMITED BY SIZE,	0	0	1
15000803	15	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
15000804	15	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
15000805	15	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
15000806	15	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
15000807	15	                    INTO ABND-FREEFORM	0	0	1
15000808	15	              END-STRING	0	0	1
15000810	15	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
15000811	15	                 COMMAREA(ABNDINFO-REC)	0	0	1
15000812	15	              END-EXEC	0	0	1
15000814	15	              EXEC CICS ABEND ABCODE( MY-ABEND-CODE)	0	0	1
15000815	15	              NODUMP	0	0	1
15000816	15	              CANCEL	0	0	1
15000817	15	              END-EXEC	0	0	1
15000819	15	           END-IF.	0	0	1
15000821	15	       AH999.	0	0	1
15000822	15	           EXIT.	0	0	1
15000824	15	      *	1	0	0
15000825	15	      * Access the ACCOUNT Named Counter Server	1	0	1
15000826	15	      *	1	0	1
15000827	15	       READ-ACCOUNT-LAST SECTION.	0	0	0
15000828	15	       RAN010.	0	0	1
15000830	15	            PERFORM GET-LAST-ACCOUNT-DB2.	0	0	1
15000831	15	            MOVE REQUIRED-ACC-NUMBER2 TO NCS-ACC-NO-VALUE.	0	0	1
15000833	15	       RAN999.	0	0	1
15000834	15	           EXIT.	0	0	1
15000837	15	       GET-LAST-ACCOUNT-DB2 SECTION.	0	0	1
15000838	15	       GLAD010.	0	0	1
15000839	15	           INITIALIZE OUTPUT-DATA.	0	0	1
15000840	15	           MOVE REQUIRED-ACC-NUMBER2 TO HV-ACCOUNT-ACC-NO.	0	0	1
15000841	15	           MOVE REQUIRED-SORT-CODE TO HV-ACCOUNT-SORTCODE.	0	0	1
15000842	15	           MOVE SORTCODE TO HV-ACCOUNT-SORTCODE.	0	0	1
15000843	15	           EXEC SQL	0	0	1
15000844	15	              SELECT ACCOUNT_EYECATCHER,	0	0	1
15000845	15	                     ACCOUNT_CUSTOMER_NUMBER,	0	0	1
15000846	15	                     ACCOUNT_SORTCODE,	0	0	1
15000847	15	                     ACCOUNT_NUMBER,	0	0	1
15000848	15	                     ACCOUNT_TYPE,	0	0	1
15000849	15	                     ACCOUNT_INTEREST_RATE,	0	0	1
15000850	15	                     ACCOUNT_OPENED,	0	0	1
15000851	15	                     ACCOUNT_OVERDRAFT_LIMIT,	0	0	1
15000852	15	                     ACCOUNT_LAST_STATEMENT,	0	0	1
15000853	15	                     ACCOUNT_NEXT_STATEMENT,	0	0	1
15000854	15	                     ACCOUNT_AVAILABLE_BALANCE,	0	0	1
15000855	15	                     ACCOUNT_ACTUAL_BALANCE	0	0	1
15000856	15	              INTO :HV-ACCOUNT-EYECATCHER,	0	0	1
15000857	15	                   :HV-ACCOUNT-CUST-NO,	0	0	1
15000858	15	                   :HV-ACCOUNT-SORTCODE,	0	0	1
15000859	15	                   :HV-ACCOUNT-ACC-NO,	0	0	1
15000860	15	                   :HV-ACCOUNT-ACC-TYPE,	0	0	1
15000861	15	                   :HV-ACCOUNT-INT-RATE,	0	0	1
15000862	15	                   :HV-ACCOUNT-OPENED,	0	0	1
15000863	15	                   :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
15000864	15	                   :HV-ACCOUNT-LAST-STMT,	0	0	1
15000865	15	                   :HV-ACCOUNT-NEXT-STMT,	0	0	1
15000866	15	                   :HV-ACCOUNT-AVAIL-BAL,	0	0	1
15000867	15	                   :HV-ACCOUNT-ACTUAL-BAL	0	0	1
15000868	15	              FROM ACCOUNT	0	0	1
15000869	15	              WHERE ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE	0	0	1
15000870	15	              ORDER BY ACCOUNT_NUMBER DESC	0	0	1
15000871	15	              FETCH FIRST 1 ROWS ONLY	0	0	1
15000872	15	           END-EXEC.	0	0	1
15000874	15	           IF SQLCODE IS NOT EQUAL TO ZERO	0	0	1
15000875	15	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
15000877	15	      *	1	0	0
15000878	15	      *       Preserve the RESP and RESP2, then set up the	1	0	1
15000879	15	      *       standard ABEND info before getting the applid,	1	0	1
15000880	15	      *       date/time etc. and linking to the Abend Handler	1	0	1
15000881	15	      *       program.	1	0	1
15000882	15	      *	1	0	1
15000883	15	              INITIALIZE ABNDINFO-REC	0	0	0
15000884	15	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
15000885	15	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
15000886	15	      *	1	0	0
15000887	15	      *       Get supplemental information	1	0	1
15000888	15	      *	1	0	1
15000889	15	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
15000890	15	              END-EXEC	0	0	1
15000892	15	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
15000893	15	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
15000895	15	              PERFORM POPULATE-TIME-DATE	0	0	1
15000897	15	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
15000898	15	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
15000899	15	                   ':' DELIMITED BY SIZE,	0	0	1
15000900	15	                    WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
15000901	15	                    ':' DELIMITED BY SIZE,	0	0	1
15000902	15	                    WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
15000903	15	                     INTO ABND-TIME	0	0	1
15000904	15	              END-STRING	0	0	1
15000906	15	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
15000907	15	              MOVE 'HNCS'      TO ABND-CODE	0	0	1
15000909	15	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
15000910	15	              END-EXEC	0	0	1
15000912	15	              MOVE SQLCODE-DISPLAY TO ABND-SQLCODE	0	0	1
15000914	15	              STRING 'GLAD010 -ACCOUNT NCS '	0	0	1
15000915	15	                   DELIMITED BY SIZE,	0	0	1
15000916	15	                   NCS-ACC-NO-NAME   DELIMITED BY SIZE,	0	0	1
15000917	15	                   ' CANNOT be accessed and DB2 ' DELIMITED BY SIZE,	0	0	1
15000918	15	                   ' SELECT failed. SQLCODE='	0	0	1
15000919	15	                   DELIMITED BY SIZE,	0	0	1
15000920	15	                   SQLCODE-DISPLAY DELIMITED BY SIZE	0	0	1
15000921	15	                   INTO ABND-FREEFORM	0	0	1
15000922	15	              END-STRING	0	0	1
15000924	15	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
15000925	15	                       COMMAREA(ABNDINFO-REC)	0	0	1
15000926	15	              END-EXEC	0	0	1
15000928	15	              DISPLAY 'INQACC - ACCOUNT NCS ' NCS-ACC-NO-NAME	0	0	1
15000929	15	                 ' CANNOT BE ACCESSED AND DB2 SELECT FAILED. SQLCODE='	0	0	1
15000930	15	                 SQLCODE-DISPLAY	0	0	1
15000932	15	              EXEC CICS ABEND	0	0	1
15000933	15	                       ABCODE('HNCS')	0	0	1
15000934	15	                       NODUMP	0	0	1
15000935	15	                       CANCEL	0	0	1
15000936	15	              END-EXEC	0	0	1
15000937	15	           ELSE	0	0	1
15000938	15	      *	1	0	0
15000939	15	      *    If we found a matching account record	1	0	1
15000940	15	      *	1	0	1
15000941	15	             MOVE HV-ACCOUNT-EYECATCHER TO	0	0	0
15000942	15	                ACCOUNT-EYE-CATCHER OF OUTPUT-DATA	0	0	1
15000943	15	             MOVE HV-ACCOUNT-CUST-NO TO	0	0	1
15000944	15	                ACCOUNT-CUST-NO OF OUTPUT-DATA	0	0	1
15000945	15	             MOVE HV-ACCOUNT-SORTCODE TO	0	0	1
15000946	15	                ACCOUNT-SORT-CODE OF OUTPUT-DATA	0	0	1
15000947	15	             MOVE HV-ACCOUNT-ACC-NO TO	0	0	1
15000948	15	                ACCOUNT-NUMBER OF OUTPUT-DATA	0	0	1
15000949	15	             MOVE HV-ACCOUNT-ACC-TYPE TO	0	0	1
15000950	15	                ACCOUNT-TYPE OF OUTPUT-DATA	0	0	1
15000951	15	             MOVE HV-ACCOUNT-INT-RATE TO	0	0	1
15000952	15	                ACCOUNT-INTEREST-RATE OF OUTPUT-DATA	0	0	1
15000953	15	             MOVE HV-ACCOUNT-OPENED TO DB2-DATE-REFORMAT	0	0	1
15000954	15	             MOVE DB2-DATE-REF-DAY TO	0	0	1
15000955	15	                ACCOUNT-OPENED-DAY OF OUTPUT-DATA	0	0	1
15000956	15	             MOVE DB2-DATE-REF-MNTH TO	0	0	1
15000957	15	                ACCOUNT-OPENED-MONTH OF OUTPUT-DATA	0	0	1
15000958	15	             MOVE DB2-DATE-REF-YR TO	0	0	1
15000959	15	                ACCOUNT-OPENED-YEAR OF OUTPUT-DATA	0	0	1
15000960	15	             MOVE HV-ACCOUNT-OVERDRAFT-LIM TO	0	0	1
15000961	15	                ACCOUNT-OVERDRAFT-LIMIT OF OUTPUT-DATA	0	0	1
15000962	15	             MOVE HV-ACCOUNT-LAST-STMT TO DB2-DATE-REFORMAT	0	0	1
15000963	15	             MOVE DB2-DATE-REF-DAY TO	0	0	1
15000964	15	                ACCOUNT-LAST-STMT-DAY OF OUTPUT-DATA	0	0	1
15000965	15	             MOVE DB2-DATE-REF-MNTH TO	0	0	1
15000966	15	                ACCOUNT-LAST-STMT-MONTH OF OUTPUT-DATA	0	0	1
15000967	15	             MOVE DB2-DATE-REF-YR TO	0	0	1
15000968	15	                ACCOUNT-LAST-STMT-YEAR OF OUTPUT-DATA	0	0	1
15000969	15	             MOVE HV-ACCOUNT-NEXT-STMT TO DB2-DATE-REFORMAT	0	0	1
15000970	15	             MOVE DB2-DATE-REF-DAY TO	0	0	1
15000971	15	                ACCOUNT-NEXT-STMT-DAY OF OUTPUT-DATA	0	0	1
15000972	15	             MOVE DB2-DATE-REF-MNTH TO	0	0	1
15000973	15	                ACCOUNT-NEXT-STMT-MONTH OF OUTPUT-DATA	0	0	1
15000974	15	             MOVE DB2-DATE-REF-YR TO	0	0	1
15000975	15	                ACCOUNT-NEXT-STMT-YEAR OF OUTPUT-DATA	0	0	1
15000976	15	             MOVE HV-ACCOUNT-AVAIL-BAL TO	0	0	1
15000977	15	                ACCOUNT-AVAILABLE-BALANCE OF OUTPUT-DATA	0	0	1
15000978	15	             MOVE HV-ACCOUNT-ACTUAL-BAL TO	0	0	1
15000979	15	                ACCOUNT-ACTUAL-BALANCE OF OUTPUT-DATA	0	0	1
15000981	15	           END-IF.	0	0	1
15000983	15	       GLAD999.	0	0	1
15000984	15	           EXIT.	0	0	1
15000987	15	       POPULATE-TIME-DATE SECTION.	0	0	1
15000988	15	       PTD010.	0	0	1
15000990	15	           EXEC CICS ASKTIME	0	0	1
15000991	15	              ABSTIME(WS-U-TIME)	0	0	1
15000992	15	           END-EXEC.	0	0	1
15000994	15	           EXEC CICS FORMATTIME	0	0	1
15000995	15	                     ABSTIME(WS-U-TIME)	0	0	1
15000996	15	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
15000997	15	                     TIME(WS-TIME-NOW)	0	0	1
15000998	15	                     DATESEP	0	0	1
15000999	15	           END-EXEC.	0	0	1
15001001	15	       PTD999.	0	0	1
15001002	15	           EXIT.	0	0	1
16000000	16	<<<< file not found >>>>	0	0	0
16000001	16	<<<< file not found >>>>	0	0	0
17000000	17	<<<< file not found >>>>	0	0	0
17000001	17	<<<< file not found >>>>	0	0	0
18000001	18	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	1
18000002	18	       CBL CICS('SP,EDF')	0	0	1
18000003	18	      ******************************************************************	1	0	0
18000004	18	      *                                                                *	1	0	1
18000005	18	      *  Copyright IBM Corp. 2023                                      *	1	0	1
18000006	18	      *                                                                *	1	0	1
18000007	18	      ******************************************************************	1	0	1
18000010	18	      ******************************************************************	1	0	1
18000011	18	      * This is the Update Account program in the BANKING application	1	0	1
18000012	18	      * BMS suite.	1	0	1
18000013	18	      *	1	0	1
18000014	18	      ******************************************************************	1	0	1
18000015	18	       IDENTIFICATION DIVISION.	0	0	0
18000016	18	       PROGRAM-ID. BNK1UAC.	0	0	1
18000017	18	       AUTHOR. Jon Collett.	0	0	1
18000019	18	       ENVIRONMENT DIVISION.	0	0	1
18000020	18	       CONFIGURATION SECTION.	0	0	1
18000021	18	      * SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
18000022	18	       SOURCE-COMPUTER.  IBM-370.	0	0	0
18000023	18	       OBJECT-COMPUTER.  IBM-370.	0	0	1
18000025	18	       INPUT-OUTPUT SECTION.	0	0	1
18000027	18	       DATA DIVISION.	0	0	1
18000028	18	       WORKING-STORAGE SECTION.	0	0	1
18000030	18	       01 WS-CICS-WORK-AREA.	0	0	1
18000031	18	          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.	0	0	1
18000032	18	          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.	0	0	1
18000034	18	       01 WS-FAIL-INFO.	0	0	1
18000035	18	          03 FILLER                    PIC X(9) VALUE 'BNK1UAC '.	0	0	1
18000036	18	          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.	0	0	1
18000037	18	          03 FILLER                    PIC X(6)  VALUE ' RESP='.	0	0	1
18000038	18	          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.	0	0	1
18000039	18	          03 FILLER                    PIC X(7)  VALUE ' RESP2='.	0	0	1
18000040	18	          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.	0	0	1
18000041	18	          03 FILLER                    PIC X(15)	0	0	1
18000042	18	                                          VALUE ' ABENDING TASK.'.	0	0	1
18000044	18	       01 SWITCHES.	0	0	1
18000045	18	           03 VALID-DATA-SW            PIC X VALUE 'Y'.	0	0	1
18000046	18	              88 VALID-DATA               VALUE 'Y'.	0	0	1
18000048	18	       01 FLAGS.	0	0	1
18000049	18	           03 SEND-FLAG                PIC X.	0	0	1
18000050	18	              88 SEND-ERASE               VALUE '1'.	0	0	1
18000051	18	              88 SEND-DATAONLY            VALUE '2'.	0	0	1
18000052	18	              88 SEND-DATAONLY-ALARM      VALUE '3'.	0	0	1
18000054	18	       01 ACTION-ALPHA.	0	0	1
18000055	18	           03 ACTION-NUM               PIC 9.	0	0	1
18000057	18	      *	1	0	0
18000058	18	      * The end of session message	1	0	1
18000059	18	      *	1	0	1
18000060	18	       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.	0	0	0
18000062	18	       01 RESPONSE-CODE                PIC S9(8) COMP.	0	0	1
18000064	18	       01 COMMUNICATION-AREA           PIC X.	0	0	1
18000066	18	       COPY BNK1UAM.	0	0	1
18000068	18	       COPY DFHAID.	0	0	1
18000071	18	       01 AMTI9                        PIC 9(12).	0	0	1
18000073	18	       01 WS-STUFF1.	0	0	1
18000074	18	           03 WS-COMM-ACT-BAL-UNSIGN   PIC 9(12).	0	0	1
18000076	18	       01 WS-STUFF2 REDEFINES WS-STUFF1.	0	0	1
18000077	18	           03 WS-COMM-ACT-BAL-X        PIC X(12).	0	0	1
18000079	18	       01 WS-STUFF3.	0	0	1
18000080	18	           03 WS-COMM-AMT-UNSIGN          PIC 9(12).	0	0	1
18000081	18	       01 WS-STUFF4 REDEFINES WS-STUFF3.	0	0	1
18000082	18	           03 WS-COMM-AMT-X               PIC X(12).	0	0	1
18000084	18	       01 WS-STUFF5.	0	0	1
18000085	18	            03 WS-COMM-AV-BAL-UNSIGN      PIC 9(12).	0	0	1
18000087	18	       01 WS-STUFF6 REDEFINES WS-STUFF5.	0	0	1
18000088	18	           03 WS-COMM-AV-BAL-X            PIC X(12).	0	0	1
18000090	18	       01 WS-LSTMTDDI                  PIC 99.	0	0	1
18000091	18	       01 WS-LSTMTMMI                  PIC 99.	0	0	1
18000092	18	       01 WS-LSTMTYYI                  PIC 9999.	0	0	1
18000094	18	       01 WS-NSTMTDDI                  PIC 99.	0	0	1
18000095	18	       01 WS-NSTMTMMI                  PIC 99.	0	0	1
18000096	18	       01 WS-NSTMTYYI                  PIC 9999.	0	0	1
18000098	18	       01 WS-DATE-SPLIT.	0	0	1
18000099	18	           03 WS-DATE-SPLIT-DD         PIC 99.	0	0	1
18000100	18	           03 WS-DATE-SPLIT-MM         PIC 99.	0	0	1
18000101	18	           03 WS-DATE-SPLIT-YY         PIC 9999.	0	0	1
18000103	18	       01 WS-CONVERSION.	0	0	1
18000104	18	           03 WS-CONVERT-PICX          PIC X(14).	0	0	1
18000105	18	           03 WS-CONVERT-SPLIT REDEFINES WS-CONVERT-PICX.	0	0	1
18000106	18	              05 WS-CONVERT-SIGN          PIC X.	0	0	1
18000107	18	              05 WS-CONVERT-DEC           PIC 9(10).	0	0	1
18000108	18	              05 WS-CONVERT-POINT         PIC X.	0	0	1
18000109	18	              05 WS-CONVERT-REMAIN        PIC 99.	0	0	1
18000111	18	       01 WS-CONVERTED-VAL1            PIC S9(10)V99 VALUE 0.	0	0	1
18000112	18	       01 WS-CONVERTED-VAL2            PIC S9(10)V99 VALUE 0.	0	0	1
18000113	18	       01 WS-CONVERTED-VAL3            PIC S9(10)V99 VALUE 0.	0	0	1
18000114	18	       01 WS-CONVERTED-VAL4            PIC S9(10)V99 VALUE 0.	0	0	1
18000116	18	       01 INT-RT-CONVERT.	0	0	1
18000117	18	          03 INT-RT-X                  PIC X(6).	0	0	1
18000118	18	          03 INT-RT-GROUP REDEFINES INT-RT-X.	0	0	1
18000119	18	             05 INT-RT-9                 PIC 9(4)V99.	0	0	1
18000121	18	       01 WS-COMM-AREA.	0	0	1
18000122	18	          03 WS-COMM-EYE               PIC X(4).	0	0	1
18000123	18	          03 WS-COMM-CUSTNO            PIC X(10).	0	0	1
18000124	18	          03 WS-COMM-SCODE             PIC X(6).	0	0	1
18000125	18	          03 WS-COMM-ACCNO             PIC 9(8).	0	0	1
18000126	18	          03 WS-COMM-ACC-TYPE          PIC X(8).	0	0	1
18000127	18	          03 WS-COMM-INT-RATE          PIC 9(4)V99.	0	0	1
18000128	18	          03 WS-COMM-OPENED            PIC 9(8).	0	0	1
18000129	18	          03 WS-COMM-OVERDRAFT         PIC 9(8).	0	0	1
18000130	18	          03 WS-COMM-LAST-STMT-DT      PIC 9(8).	0	0	1
18000131	18	          03 WS-COMM-NEXT-STMT-DT      PIC 9(8).	0	0	1
18000132	18	          03 WS-COMM-AVAIL-BAL         PIC S9(10)V99.	0	0	1
18000133	18	          03 WS-COMM-ACTUAL-BAL        PIC S9(10)V99.	0	0	1
18000134	18	          03 WS-COMM-SUCCESS           PIC X.	0	0	1
18000136	18	       01 COMPANY-NAME-FULL            PIC X(32).	0	0	1
18000138	18	       01 INTRTI-COMP-1 USAGE COMP-1.	0	0	1
18000140	18	       01 INTRT-PIC9                   PIC 9999.99.	0	0	1
18000142	18	       01 WS-NUM-COUNT-POINT           PIC S9(8) BINARY.	0	0	1
18000143	18	       01 WS-NUM-COUNT-TOTAL           PIC S9(8) BINARY.	0	0	1
18000145	18	       01 AVAILABLE-BALANCE-DISPLAY    PIC +9(10).99.	0	0	1
18000146	18	       01 ACTUAL-BALANCE-DISPLAY       PIC +9(10).99.	0	0	1
18000148	18	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
18000149	18	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
18000150	18	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
18000151	18	          03 WS-ORIG-DATE-DD              PIC 99.	0	0	1
18000152	18	          03 FILLER                       PIC X.	0	0	1
18000153	18	          03 WS-ORIG-DATE-MM              PIC 99.	0	0	1
18000154	18	          03 FILLER                       PIC X.	0	0	1
18000155	18	          03 WS-ORIG-DATE-YYYY            PIC 9999.	0	0	1
18000157	18	       01 WS-ORIG-DATE-GRP-X.	0	0	1
18000158	18	          03 WS-ORIG-DATE-DD-X         PIC XX.	0	0	1
18000159	18	          03 FILLER                    PIC X VALUE '.'.	0	0	1
18000160	18	          03 WS-ORIG-DATE-MM-X         PIC XX.	0	0	1
18000161	18	          03 FILLER                    PIC X VALUE '.'.	0	0	1
18000162	18	          03 WS-ORIG-DATE-YYYY-X       PIC X(4).	0	0	1
18000165	18	       01 WS-TIME-DATA.	0	0	1
18000166	18	           03 WS-TIME-NOW              PIC 9(6).	0	0	1
18000167	18	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
18000168	18	              05 WS-TIME-NOW-GRP-HH       PIC 99.	0	0	1
18000169	18	              05 WS-TIME-NOW-GRP-MM       PIC 99.	0	0	1
18000170	18	              05 WS-TIME-NOW-GRP-SS       PIC 99.	0	0	1
18000172	18	       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.	0	0	1
18000174	18	       01 ABNDINFO-REC.	0	0	1
18000175	18	           COPY ABNDINFO.	0	0	1
18000178	18	       LINKAGE SECTION.	0	0	1
18000179	18	       01 DFHCOMMAREA.	0	0	1
18000180	18	          03 COMM-EYE                  PIC X(4).	0	0	1
18000181	18	          03 COMM-CUSTNO               PIC X(10).	0	0	1
18000182	18	          03 COMM-SCODE                PIC X(6).	0	0	1
18000183	18	          03 COMM-ACCNO                PIC 9(8).	0	0	1
18000184	18	          03 COMM-ACC-TYPE             PIC X(8).	0	0	1
18000185	18	          03 COMM-INT-RATE             PIC 9(4)V99.	0	0	1
18000186	18	          03 COMM-OPENED               PIC 9(8).	0	0	1
18000187	18	          03 COMM-OVERDRAFT            PIC 9(8).	0	0	1
18000188	18	          03 COMM-LAST-STMT-DT         PIC 9(8).	0	0	1
18000189	18	          03 COMM-NEXT-STMT-DT         PIC 9(8).	0	0	1
18000190	18	          03 COMM-AVAIL-BAL            PIC S9(10)V99.	0	0	1
18000191	18	          03 COMM-ACTUAL-BAL           PIC S9(10)V99.	0	0	1
18000192	18	          03 COMM-SUCCESS              PIC X.	0	0	1
18000193	18	          03 COMM-PCB1-POINTER         POINTER.	0	0	1
18000196	18	       PROCEDURE DIVISION.	0	0	1
18000197	18	       PREMIERE SECTION.	0	0	1
18000198	18	       A010.	0	0	1
18000200	18	           EVALUATE TRUE	0	0	1
18000201	18	      *	1	0	0
18000202	18	      *       Is it the first time through? If so, send the map	1	0	1
18000203	18	      *       with erased (empty) data fields.	1	0	1
18000204	18	      *	1	0	1
18000205	18	              WHEN EIBCALEN = ZERO	0	0	0
18000206	18	                 MOVE LOW-VALUE TO BNK1UAO	0	0	1
18000207	18	                 MOVE -1 TO ACCNOL	0	0	1
18000208	18	                 SET SEND-ERASE TO TRUE	0	0	1
18000209	18	                 INITIALIZE WS-COMM-AREA	0	0	1
18000210	18	                 PERFORM SEND-MAP	0	0	1
18000212	18	      *	1	0	0
18000213	18	      *       If a PA key is pressed, just carry on	1	0	1
18000214	18	      *	1	0	1
18000215	18	              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3	0	0	0
18000216	18	                 CONTINUE	0	0	1
18000218	18	      *	1	0	0
18000219	18	      *       When Pf3 is pressed, return to the main menu	1	0	1
18000220	18	      *	1	0	1
18000221	18	              WHEN EIBAID = DFHPF3	0	0	0
18000222	18	                 EXEC CICS RETURN	0	0	1
18000223	18	                    TRANSID('OMEN')	0	0	1
18000224	18	                    IMMEDIATE	0	0	1
18000225	18	                    RESP(WS-CICS-RESP)	0	0	1
18000226	18	                    RESP2(WS-CICS-RESP2)	0	0	1
18000227	18	                 END-EXEC	0	0	1
18000229	18	      *	1	0	0
18000230	18	      *       If the aid or Pf12 is pressed, then send a termination	1	0	1
18000231	18	      *       message.	1	0	1
18000232	18	      *	1	0	1
18000233	18	              WHEN EIBAID = DFHAID OR DFHPF12	0	0	0
18000234	18	                 PERFORM SEND-TERMINATION-MSG	0	0	1
18000235	18	                 EXEC CICS	0	0	1
18000236	18	                    RETURN	0	0	1
18000237	18	                 END-EXEC	0	0	1
18000239	18	      *	1	0	0
18000240	18	      *       When CLEAR is pressed	1	0	1
18000241	18	      *	1	0	1
18000242	18	              WHEN EIBAID = DFHCLEAR	0	0	0
18000243	18	                EXEC CICS SEND CONTROL	0	0	1
18000244	18	                   ERASE	0	0	1
18000245	18	                   FREEKB	0	0	1
18000246	18	                END-EXEC	0	0	1
18000248	18	                EXEC CICS RETURN	0	0	1
18000249	18	                END-EXEC	0	0	1
18000251	18	      *	1	0	0
18000252	18	      *       When enter is pressed then process the content	1	0	1
18000253	18	      *	1	0	1
18000254	18	              WHEN EIBAID = DFHENTER	0	0	0
18000255	18	                 PERFORM PROCESS-MAP	0	0	1
18000257	18	      *	1	0	0
18000258	18	      *       When Pf5 is pressed then process the content	1	0	1
18000259	18	      *	1	0	1
18000260	18	              WHEN EIBAID = DFHPF5	0	0	0
18000261	18	                 PERFORM PROCESS-MAP	0	0	1
18000263	18	      *	1	0	0
18000264	18	      *       When anything else happens, send the invalid key message	1	0	1
18000265	18	      *	1	0	1
18000266	18	              WHEN OTHER	0	0	0
18000267	18	                 MOVE LOW-VALUES TO BNK1UAO	0	0	1
18000268	18	                 MOVE 'Invalid key pressed.' TO MESSAGEO	0	0	1
18000269	18	                 MOVE -1 TO ACCNOL	0	0	1
18000270	18	                 SET SEND-DATAONLY-ALARM TO TRUE	0	0	1
18000271	18	                 PERFORM SEND-MAP	0	0	1
18000273	18	           END-EVALUATE.	0	0	1
18000275	18	      *	1	0	0
18000276	18	      *    If it is not the first time through, set the return	1	0	1
18000277	18	      *    information accordingly.	1	0	1
18000278	18	      *	1	0	1
18000279	18	      *	1	0	1
18000280	18	           IF EIBCALEN NOT = ZERO	0	0	0
18000281	18	              MOVE COMM-EYE            TO WS-COMM-EYE	0	0	1
18000282	18	              MOVE COMM-CUSTNO         TO WS-COMM-CUSTNO	0	0	1
18000283	18	              MOVE COMM-SCODE          TO WS-COMM-SCODE	0	0	1
18000284	18	              MOVE COMM-ACCNO          TO WS-COMM-ACCNO	0	0	1
18000285	18	              MOVE COMM-ACC-TYPE       TO WS-COMM-ACC-TYPE	0	0	1
18000286	18	              MOVE COMM-INT-RATE       TO WS-COMM-INT-RATE	0	0	1
18000287	18	              MOVE COMM-OPENED         TO WS-COMM-OPENED	0	0	1
18000288	18	              MOVE COMM-OVERDRAFT      TO WS-COMM-OVERDRAFT	0	0	1
18000289	18	              MOVE COMM-LAST-STMT-DT   TO WS-COMM-LAST-STMT-DT	0	0	1
18000290	18	              MOVE COMM-NEXT-STMT-DT   TO WS-COMM-NEXT-STMT-DT	0	0	1
18000291	18	              MOVE COMM-AVAIL-BAL      TO WS-COMM-AVAIL-BAL	0	0	1
18000292	18	              MOVE COMM-ACTUAL-BAL     TO WS-COMM-ACTUAL-BAL	0	0	1
18000293	18	           END-IF.	0	0	1
18000295	18	           EXEC CICS	0	0	1
18000296	18	              RETURN TRANSID('OUAC')	0	0	1
18000297	18	              COMMAREA(WS-COMM-AREA)	0	0	1
18000298	18	              LENGTH(99)	0	0	1
18000299	18	              RESP(WS-CICS-RESP)	0	0	1
18000300	18	              RESP2(WS-CICS-RESP2)	0	0	1
18000301	18	           END-EXEC.	0	0	1
18000303	18	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
18000304	18	      *	1	0	0
18000305	18	      *       Preserve the RESP and RESP2, then set up the	1	0	1
18000306	18	      *       standard ABEND info before getting the applid,	1	0	1
18000307	18	      *       date/time etc. and linking to the Abend Handler	1	0	1
18000308	18	      *       program.	1	0	1
18000309	18	      *	1	0	1
18000310	18	              INITIALIZE ABNDINFO-REC	0	0	0
18000311	18	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
18000312	18	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
18000313	18	      *	1	0	0
18000314	18	      *       Get supplemental information	1	0	1
18000315	18	      *	1	0	1
18000316	18	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
18000317	18	              END-EXEC	0	0	1
18000319	18	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
18000320	18	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
18000322	18	              PERFORM POPULATE-TIME-DATE	0	0	1
18000324	18	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
18000325	18	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
18000326	18	                    ':' DELIMITED BY SIZE,	0	0	1
18000327	18	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
18000328	18	                     ':' DELIMITED BY SIZE,	0	0	1
18000329	18	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
18000330	18	                     INTO ABND-TIME	0	0	1
18000331	18	              END-STRING	0	0	1
18000333	18	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
18000334	18	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
18000336	18	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
18000337	18	              END-EXEC	0	0	1
18000339	18	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
18000341	18	              STRING 'A010 - RETURN TRANSID(OUAC) FAIL.'	0	0	1
18000342	18	                    DELIMITED BY SIZE,	0	0	1
18000343	18	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
18000344	18	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
18000345	18	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
18000346	18	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
18000347	18	                    INTO ABND-FREEFORM	0	0	1
18000348	18	              END-STRING	0	0	1
18000350	18	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
18000351	18	                        COMMAREA(ABNDINFO-REC)	0	0	1
18000352	18	              END-EXEC	0	0	1
18000354	18	              INITIALIZE WS-FAIL-INFO	0	0	1
18000355	18	              MOVE 'BNK1UAC - A010 - RETURN TRANSID(OUAC) FAIL' TO	0	0	1
18000356	18	                 WS-CICS-FAIL-MSG	0	0	1
18000357	18	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
18000358	18	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
18000359	18	              PERFORM ABEND-THIS-TASK	0	0	1
18000360	18	           END-IF.	0	0	1
18000362	18	       A999.	0	0	1
18000363	18	           EXIT.	0	0	1
18000366	18	       PROCESS-MAP SECTION.	0	0	1
18000367	18	       PM010.	0	0	1
18000368	18	      *	1	0	0
18000369	18	      *    Retrieve the data from the map	1	0	1
18000370	18	      *	1	0	1
18000371	18	           PERFORM RECEIVE-MAP.	0	0	0
18000372	18	           MOVE 'Y' TO VALID-DATA-SW	0	0	1
18000373	18	      *	1	0	0
18000374	18	      *    If enter was pressed, validate the received data	1	0	1
18000375	18	      *	1	0	1
18000376	18	           IF EIBAID = DFHENTER	0	0	0
18000377	18	              PERFORM EDIT-DATA	0	0	1
18000378	18	      *	1	0	0
18000379	18	      *       If the data passes validation go on to	1	0	1
18000380	18	      *       get the account	1	0	1
18000381	18	      *	1	0	1
18000382	18	              IF VALID-DATA-SW = 'Y'	0	0	0
18000383	18	                 PERFORM INQ-ACC-DATA	0	0	1
18000384	18	              END-IF	0	0	1
18000386	18	           END-IF.	0	0	1
18000388	18	      *	1	0	0
18000389	18	      *    If Pf5 was pressed, validate the received data	1	0	1
18000390	18	      *	1	0	1
18000391	18	           IF EIBAID = DFHPF5	0	0	0
18000392	18	              PERFORM VALIDATE-DATA	0	0	1
18000394	18	      *	1	0	0
18000395	18	      *       If the data passes validation go on to	1	0	1
18000396	18	      *       update the account	1	0	1
18000397	18	      *	1	0	1
18000398	18	              IF VALID-DATA-SW = 'Y'	0	0	0
18000399	18	                 PERFORM UPD-ACC-DATA	0	0	1
18000400	18	              END-IF	0	0	1
18000402	18	           END-IF.	0	0	1
18000404	18	           SET SEND-DATAONLY-ALARM TO TRUE.	0	0	1
18000405	18	      *	1	0	0
18000406	18	      *    Output the data to the screen	1	0	1
18000407	18	      *	1	0	1
18000408	18	           PERFORM SEND-MAP.	0	0	0
18000410	18	       PM999.	0	0	1
18000411	18	           EXIT.	0	0	1
18000414	18	       RECEIVE-MAP SECTION.	0	0	1
18000415	18	       RM010.	0	0	1
18000416	18	      *	1	0	0
18000417	18	      *    Retrieve the data	1	0	1
18000418	18	      *	1	0	1
18000419	18	           EXEC CICS	0	0	0
18000420	18	              RECEIVE MAP('BNK1UA')	0	0	1
18000421	18	              MAPSET('BNK1UAM')	0	0	1
18000422	18	              INTO(BNK1UAI)	0	0	1
18000423	18	              RESP(WS-CICS-RESP)	0	0	1
18000424	18	              RESP2(WS-CICS-RESP2)	0	0	1
18000425	18	           END-EXEC.	0	0	1
18000427	18	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
18000428	18	      *	1	0	0
18000429	18	      *       Preserve the RESP and RESP2, then set up the	1	0	1
18000430	18	      *       standard ABEND info before getting the applid,	1	0	1
18000431	18	      *       date/time etc. and linking to the Abend Handler	1	0	1
18000432	18	      *       program.	1	0	1
18000433	18	      *	1	0	1
18000434	18	              INITIALIZE ABNDINFO-REC	0	0	0
18000435	18	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
18000436	18	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
18000437	18	      *	1	0	0
18000438	18	      *       Get supplemental information	1	0	1
18000439	18	      *	1	0	1
18000440	18	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
18000441	18	              END-EXEC	0	0	1
18000443	18	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
18000444	18	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
18000446	18	              PERFORM POPULATE-TIME-DATE	0	0	1
18000448	18	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
18000449	18	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
18000450	18	                    ':' DELIMITED BY SIZE,	0	0	1
18000451	18	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
18000452	18	                     ':' DELIMITED BY SIZE,	0	0	1
18000453	18	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
18000454	18	                     INTO ABND-TIME	0	0	1
18000455	18	              END-STRING	0	0	1
18000457	18	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
18000458	18	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
18000460	18	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
18000461	18	              END-EXEC	0	0	1
18000463	18	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
18000465	18	              STRING 'RM010 - RECEIVE MAP FAIL.'	0	0	1
18000466	18	                    DELIMITED BY SIZE,	0	0	1
18000467	18	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
18000468	18	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
18000469	18	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
18000470	18	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
18000471	18	                    INTO ABND-FREEFORM	0	0	1
18000472	18	              END-STRING	0	0	1
18000474	18	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
18000475	18	                        COMMAREA(ABNDINFO-REC)	0	0	1
18000476	18	              END-EXEC	0	0	1
18000479	18	              INITIALIZE WS-FAIL-INFO	0	0	1
18000480	18	              MOVE 'BNKUAC - RM010 - RECEIVE MAP FAIL ' TO	0	0	1
18000481	18	                 WS-CICS-FAIL-MSG	0	0	1
18000482	18	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
18000483	18	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
18000484	18	              PERFORM ABEND-THIS-TASK	0	0	1
18000485	18	           END-IF.	0	0	1
18000487	18	       RM999.	0	0	1
18000488	18	           EXIT.	0	0	1
18000491	18	       EDIT-DATA SECTION.	0	0	1
18000492	18	       ED010.	0	0	1
18000493	18	      *	1	0	0
18000494	18	      *    Perform validation on the incoming fields	1	0	1
18000495	18	      *	1	0	1
18000496	18	           IF ACCNOI NOT NUMERIC	0	0	0
18000497	18	              MOVE 'Please enter an account number.   ' TO	0	0	1
18000498	18	                 MESSAGEO	0	0	1
18000499	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000500	18	           END-IF.	0	0	1
18000502	18	       ED999.	0	0	1
18000503	18	           EXIT.	0	0	1
18000506	18	       VALIDATE-DATA SECTION.	0	0	1
18000507	18	       VD010.	0	0	1
18000508	18	      *	1	0	0
18000509	18	      *    Perform more validation	1	0	1
18000510	18	      *	1	0	1
18000511	18	           IF ACTYPEI NOT = 'CURRENT ' AND	0	0	0
18000512	18	           ACTYPEI NOT = 'SAVING  ' AND	0	0	1
18000513	18	           ACTYPEI NOT = 'LOAN    ' AND	0	0	1
18000514	18	           ACTYPEI NOT = 'MORTGAGE' AND	0	0	1
18000515	18	           ACTYPEI NOT = 'ISA     '	0	0	1
18000517	18	              MOVE SPACES TO MESSAGEO	0	0	1
18000518	18	              STRING 'Account Type must be CURRENT, SAVING, LOAN, '	0	0	1
18000519	18	                 'MORTGAGE or ISA' DELIMITED BY SIZE,	0	0	1
18000520	18	                 '. Then press PF5.' DELIMITED BY SIZE	0	0	1
18000521	18	              INTO MESSAGEO	0	0	1
18000522	18	              MOVE -1 to ACTYPEL	0	0	1
18000523	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000524	18	           END-IF.	0	0	1
18000526	18	           IF INTRTL = ZERO	0	0	1
18000527	18	              MOVE SPACES TO MESSAGEO	0	0	1
18000528	18	              STRING 'Please supply a numeric interest rate '	0	0	1
18000529	18	                 'then press PF5.' DELIMITED BY SIZE	0	0	1
18000530	18	                 INTO MESSAGEO	0	0	1
18000531	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000532	18	              MOVE -1 TO INTRTL	0	0	1
18000533	18	              GO TO VD999	0	0	1
18000534	18	           END-IF.	0	0	1
18000536	18	           IF INTRTI(1:INTRTL) IS NOT NUMERIC	0	0	1
18000537	18	              MOVE ZERO TO WS-NUM-COUNT-TOTAL	0	0	1
18000538	18	              INSPECT INTRTI(1:INTRTL) TALLYING	0	0	1
18000539	18	                 WS-NUM-COUNT-TOTAL for ALL '0'	0	0	1
18000540	18	                 WS-NUM-COUNT-TOTAL for ALL '1'	0	0	1
18000541	18	                 WS-NUM-COUNT-TOTAL for ALL '2'	0	0	1
18000542	18	                 WS-NUM-COUNT-TOTAL for ALL '3'	0	0	1
18000543	18	                 WS-NUM-COUNT-TOTAL for ALL '4'	0	0	1
18000544	18	                 WS-NUM-COUNT-TOTAL for ALL '5'	0	0	1
18000545	18	                 WS-NUM-COUNT-TOTAL for ALL '6'	0	0	1
18000546	18	                 WS-NUM-COUNT-TOTAL for ALL '7'	0	0	1
18000547	18	                 WS-NUM-COUNT-TOTAL for ALL '8'	0	0	1
18000548	18	                 WS-NUM-COUNT-TOTAL for ALL '9'	0	0	1
18000549	18	                 WS-NUM-COUNT-TOTAL for ALL '.'	0	0	1
18000550	18	                 WS-NUM-COUNT-TOTAL for ALL '-'	0	0	1
18000551	18	                 WS-NUM-COUNT-TOTAL for ALL '+'	0	0	1
18000552	18	                 WS-NUM-COUNT-TOTAL for ALL ' '	0	0	1
18000554	18	      *	1	0	0
18000555	18	      *       So the idea here is that if there is a	1	0	1
18000556	18	      *       decimal point, the field is not numeric. But if it is	1	0	1
18000557	18	      *       1.1 then it is valid. So first of all we check to see	1	0	1
18000558	18	      *       that only the above chars are OK. We also want to	1	0	1
18000559	18	      *       tolerate the minus and plus signs. We don't support	1	0	1
18000560	18	      *       negative interest though.	1	0	1
18000561	18	      *       We tolerate trailing spaces too.	1	0	1
18000562	18	      *	1	0	1
18000563	18	              IF WS-NUM-COUNT-TOTAL < INTRTL	0	0	0
18000564	18	                 MOVE SPACES TO MESSAGEO	0	0	1
18000565	18	                 STRING 'Please supply a numeric interest rate'	0	0	1
18000566	18	                      DELIMITED BY SIZE,	0	0	1
18000567	18	                 INTO MESSAGEO	0	0	1
18000568	18	                 MOVE 'N' TO VALID-DATA-SW	0	0	1
18000569	18	                 MOVE -1 TO INTRTL	0	0	1
18000570	18	                 GO TO VD999	0	0	1
18000571	18	              END-IF	0	0	1
18000572	18	      *	1	0	0
18000573	18	      *       And let's check to make sure we only have	1	0	1
18000574	18	      *       0 to 1 decimal points.	1	0	1
18000575	18	      *	1	0	1
18000576	18	              MOVE ZERO TO WS-NUM-COUNT-POINT	0	0	0
18000577	18	              INSPECT INTRTI(1:INTRTL) TALLYING	0	0	1
18000578	18	                 WS-NUM-COUNT-POINT FOR ALL '.'	0	0	1
18000580	18	              IF WS-NUM-COUNT-POINT > 1	0	0	1
18000581	18	                 STRING 'Use one decimal point for interest rate '	0	0	1
18000582	18	                    DELIMITED BY SIZE,	0	0	1
18000583	18	                    'only' DELIMITED BY SIZE,	0	0	1
18000584	18	                 INTO MESSAGEO	0	0	1
18000585	18	                 MOVE 'N' TO VALID-DATA-SW	0	0	1
18000586	18	                 MOVE -1 TO INTRTL	0	0	1
18000587	18	                 GO TO VD999	0	0	1
18000588	18	              END-If	0	0	1
18000589	18	      *	1	0	0
18000590	18	      *       Now let's check to see if we have too	1	0	1
18000591	18	      *       many decimals!	1	0	1
18000592	18	      *	1	0	1
18000593	18	              IF WS-NUM-COUNT-POINT = 1	0	0	0
18000594	18	                 MOVE ZERO TO WS-NUM-COUNT-TOTAL	0	0	1
18000595	18	                 INSPECT INTRTI(1:INTRTL) TALLYING	0	0	1
18000596	18	                    WS-NUM-COUNT-TOTAL FOR CHARACTERS AFTER '.'	0	0	1
18000598	18	                 IF WS-NUM-COUNT-TOTAL > 2	0	0	1
18000599	18	      *	1	0	0
18000600	18	      *             There are more than 2 characters after the point	1	0	1
18000601	18	      *	1	0	1
18000602	18	                    MOVE ZERO TO WS-NUM-COUNT-TOTAL	0	0	0
18000603	18	                       WS-NUM-COUNT-POINT	0	0	1
18000604	18	                    INSPECT INTRTI(1:INTRTL) TALLYING	0	0	1
18000605	18	                       WS-NUM-COUNT-POINT FOR CHARACTERS BEFORE '.'	0	0	1
18000607	18	                    ADD 2 TO WS-NUM-COUNT-POINT	0	0	1
18000608	18	                       GIVING WS-NUM-COUNT-POINT	0	0	1
18000610	18	                    INSPECT INTRTI(WS-NUM-COUNT-POINT:INTRTL) TALLYING	0	0	1
18000611	18	                       WS-NUM-COUNT-TOTAL for ALL '0'	0	0	1
18000612	18	                       WS-NUM-COUNT-TOTAL for ALL '1'	0	0	1
18000613	18	                       WS-NUM-COUNT-TOTAL for ALL '2'	0	0	1
18000614	18	                       WS-NUM-COUNT-TOTAL for ALL '3'	0	0	1
18000615	18	                       WS-NUM-COUNT-TOTAL for ALL '4'	0	0	1
18000616	18	                       WS-NUM-COUNT-TOTAL for ALL '5'	0	0	1
18000617	18	                       WS-NUM-COUNT-TOTAL for ALL '6'	0	0	1
18000618	18	                       WS-NUM-COUNT-TOTAL for ALL '7'	0	0	1
18000619	18	                       WS-NUM-COUNT-TOTAL for ALL '8'	0	0	1
18000620	18	                       WS-NUM-COUNT-TOTAL for ALL '9'	0	0	1
18000621	18	                       WS-NUM-COUNT-TOTAL for ALL '-'	0	0	1
18000622	18	                       WS-NUM-COUNT-TOTAL for ALL '+'	0	0	1
18000623	18	                       AFTER '.'	0	0	1
18000625	18	                    IF WS-NUM-COUNT-TOTAL > 2	0	0	1
18000626	18	      *	1	0	0
18000627	18	      *                More than two of them are numeric	1	0	1
18000628	18	      *	1	0	1
18000629	18	                       MOVE SPACES TO MESSAGEO	0	0	0
18000630	18	                       STRING	0	0	1
18000631	18	                          'Only up to two decimal places '	0	0	1
18000632	18	                           DELIMITED BY SIZE,	0	0	1
18000633	18	                          'are supported' DELIMITED BY SIZE,	0	0	1
18000634	18	                       INTO MESSAGEO	0	0	1
18000636	18	                       MOVE 'N' TO VALID-DATA-SW	0	0	1
18000637	18	                       MOVE -1 TO INTRTL	0	0	1
18000638	18	                       GO TO VD999	0	0	1
18000639	18	                    END-IF	0	0	1
18000640	18	                 END-IF	0	0	1
18000641	18	              END-IF	0	0	1
18000642	18	           END-IF.	0	0	1
18000644	18	           COMPUTE INTRTI-COMP-1 = FUNCTION NUMVAL(INTRTI).	0	0	1
18000646	18	           IF INTRTI-COMP-1 < 0	0	0	1
18000647	18	              MOVE SPACES TO MESSAGEO	0	0	1
18000648	18	              STRING 'Please supply a zero or positive interest rate'	0	0	1
18000649	18	                 DELIMITED BY SIZE,	0	0	1
18000650	18	                 INTO MESSAGEO	0	0	1
18000651	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000652	18	              MOVE -1 TO INTRTL	0	0	1
18000653	18	              GO TO VD999	0	0	1
18000654	18	           END-IF.	0	0	1
18000656	18	           IF INTRTI-COMP-1 > 9999.99	0	0	1
18000657	18	              MOVE SPACES TO MESSAGEO	0	0	1
18000658	18	              STRING 'Please supply an interest rate less than '	0	0	1
18000659	18	                     DELIMITED BY SIZE,	0	0	1
18000660	18	                     '9999.99%' DELIMITED BY SIZE	0	0	1
18000661	18	              INTO MESSAGEO	0	0	1
18000662	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000663	18	              MOVE -1 TO INTRTL	0	0	1
18000664	18	              GO TO VD999	0	0	1
18000665	18	           END-IF.	0	0	1
18000667	18	           IF (ACTYPEI = 'LOAN    ' AND INTRTI = '0000.00') OR	0	0	1
18000668	18	           (ACTYPEI = 'MORTGAGE' AND INTRTI = '0000.00')	0	0	1
18000669	18	              MOVE SPACES TO MESSAGEO	0	0	1
18000670	18	              STRING	0	0	1
18000671	18	              'Interest rate cannot be 0 with this account type.'	0	0	1
18000672	18	              ' Correct and press PF5.' delimited by size into	0	0	1
18000673	18	                 MESSAGEO	0	0	1
18000674	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000675	18	              MOVE -1  TO INTRTL	0	0	1
18000676	18	              GO TO VD999	0	0	1
18000677	18	           END-IF.	0	0	1
18000679	18	           IF(OVERDRL = ZERO OR OVERDRI(1:OVERDRL) IS NOT NUMERIC)	0	0	1
18000680	18	               MOVE 'Overdraft must be numeric. Correct and press PF5.'	0	0	1
18000681	18	                  TO MESSAGEO	0	0	1
18000682	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000683	18	              MOVE -1  TO OVERDRL	0	0	1
18000684	18	              GO TO VD999	0	0	1
18000685	18	           END-IF.	0	0	1
18000687	18	           IF LSTMTDDI NOT NUMERIC OR	0	0	1
18000688	18	           LSTMTMMI NOT NUMERIC OR	0	0	1
18000689	18	           LSTMTYYI NOT NUMERIC	0	0	1
18000690	18	              MOVE 'Last statement date must be numeric      ' TO	0	0	1
18000691	18	                 MESSAGEO	0	0	1
18000692	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000693	18	              GO TO VD999	0	0	1
18000694	18	           END-IF.	0	0	1
18000696	18	           IF NSTMTDDI NOT NUMERIC OR	0	0	1
18000697	18	           NSTMTMMI NOT NUMERIC OR	0	0	1
18000698	18	           NSTMTYYI NOT NUMERIC	0	0	1
18000699	18	              MOVE 'Next statement date must be numeric      ' TO	0	0	1
18000700	18	                 MESSAGEO	0	0	1
18000701	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000702	18	              GO TO VD999	0	0	1
18000703	18	           END-IF.	0	0	1
18000705	18	           MOVE LSTMTDDI TO WS-LSTMTDDI.	0	0	1
18000706	18	           MOVE LSTMTMMI TO WS-LSTMTMMI.	0	0	1
18000707	18	           MOVE LSTMTYYI TO WS-LSTMTYYI.	0	0	1
18000709	18	           IF WS-LSTMTDDI > 31 OR	0	0	1
18000710	18	           WS-LSTMTDDI = 0 OR	0	0	1
18000711	18	           WS-LSTMTMMI > 12 OR	0	0	1
18000712	18	           WS-LSTMTMMI = 0	0	0	1
18000714	18	              MOVE 'Incorrect date for LAST STATEMENT.      '	0	0	1
18000715	18	                 TO MESSAGEO	0	0	1
18000716	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000717	18	           END-IF.	0	0	1
18000719	18	           IF (WS-LSTMTDDI = 31 AND WS-LSTMTMMI = 9) OR	0	0	1
18000720	18	           (WS-LSTMTDDI = 31 AND WS-LSTMTMMI = 4) OR	0	0	1
18000721	18	           (WS-LSTMTDDI = 31 AND WS-LSTMTMMI = 6) OR	0	0	1
18000722	18	           (WS-LSTMTDDI = 31 AND WS-LSTMTMMI = 11) OR	0	0	1
18000723	18	           (WS-LSTMTDDI > 29 AND WS-LSTMTMMI = 2)	0	0	1
18000724	18	               MOVE 'Incorrect date for LAST STATEMENT.      '	0	0	1
18000725	18	                  TO MESSAGEO	0	0	1
18000726	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000727	18	           END-IF.	0	0	1
18000729	18	           MOVE NSTMTDDI TO WS-NSTMTDDI.	0	0	1
18000730	18	           MOVE NSTMTMMI TO WS-NSTMTMMI.	0	0	1
18000731	18	           MOVE NSTMTYYI TO WS-NSTMTYYI.	0	0	1
18000733	18	           IF (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 9) OR	0	0	1
18000734	18	           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 4) OR	0	0	1
18000735	18	           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 6) OR	0	0	1
18000736	18	           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 11) OR	0	0	1
18000737	18	           (WS-NSTMTDDI > 29 AND WS-NSTMTMMI = 2)	0	0	1
18000738	18	              MOVE 'Incorrect date for NEXT STATEMENT.      '	0	0	1
18000739	18	                 TO MESSAGEO	0	0	1
18000740	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000741	18	           END-IF.	0	0	1
18000743	18	           IF (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 9) OR	0	0	1
18000744	18	           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 4) OR	0	0	1
18000745	18	           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 6) OR	0	0	1
18000746	18	           (WS-NSTMTDDI = 31 AND WS-NSTMTMMI = 11) OR	0	0	1
18000747	18	           (WS-NSTMTDDI > 29 AND WS-NSTMTMMI = 2)	0	0	1
18000748	18	               MOVE 'Incorrect date for NEXT STATEMENT.      '	0	0	1
18000749	18	                  TO MESSAGEO	0	0	1
18000750	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000751	18	           END-IF.	0	0	1
18000753	18	       VD999.	0	0	1
18000754	18	           EXIT.	0	0	1
18000757	18	       INQ-ACC-DATA SECTION.	0	0	1
18000758	18	       IAD010.	0	0	1
18000759	18	      *	1	0	0
18000760	18	      *    Set up the fields required by INQACC then link to it	1	0	1
18000761	18	      *	1	0	1
18000762	18	           INITIALIZE DFHCOMMAREA.	0	0	0
18000764	18	           MOVE ACCNOI TO COMM-ACCNO.	0	0	1
18000765	18	           SET COMM-PCB1-POINTER TO NULL.	0	0	1
18000767	18	           EXEC CICS LINK	0	0	1
18000768	18	              PROGRAM('INQACC')	0	0	1
18000769	18	              COMMAREA(DFHCOMMAREA)	0	0	1
18000770	18	              RESP(WS-CICS-RESP)	0	0	1
18000771	18	              RESP2(WS-CICS-RESP2)	0	0	1
18000772	18	              SYNCONRETURN	0	0	1
18000773	18	           END-EXEC.	0	0	1
18000775	18	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
18000776	18	      *	1	0	0
18000777	18	      *       Preserve the RESP and RESP2, then set up the	1	0	1
18000778	18	      *       standard ABEND info before getting the applid,	1	0	1
18000779	18	      *       date/time etc. and linking to the Abend Handler	1	0	1
18000780	18	      *       program.	1	0	1
18000781	18	      *	1	0	1
18000782	18	              INITIALIZE ABNDINFO-REC	0	0	0
18000783	18	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
18000784	18	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
18000785	18	      *	1	0	0
18000786	18	      *       Get supplemental information	1	0	1
18000787	18	      *	1	0	1
18000788	18	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
18000789	18	              END-EXEC	0	0	1
18000791	18	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
18000792	18	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
18000794	18	              PERFORM POPULATE-TIME-DATE	0	0	1
18000796	18	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
18000797	18	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
18000798	18	                    ':' DELIMITED BY SIZE,	0	0	1
18000799	18	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
18000800	18	                     ':' DELIMITED BY SIZE,	0	0	1
18000801	18	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
18000802	18	                     INTO ABND-TIME	0	0	1
18000803	18	              END-STRING	0	0	1
18000805	18	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
18000806	18	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
18000808	18	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
18000809	18	              END-EXEC	0	0	1
18000811	18	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
18000813	18	              STRING 'IAD010  - LINK INQACC FAIL.'	0	0	1
18000814	18	                    DELIMITED BY SIZE,	0	0	1
18000815	18	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
18000816	18	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
18000817	18	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
18000818	18	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
18000819	18	                    INTO ABND-FREEFORM	0	0	1
18000820	18	              END-STRING	0	0	1
18000822	18	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
18000823	18	                        COMMAREA(ABNDINFO-REC)	0	0	1
18000824	18	              END-EXEC	0	0	1
18000826	18	              INITIALIZE WS-FAIL-INFO	0	0	1
18000827	18	              MOVE 'BNK1UAC - IAD010 - LINK INQACC  FAIL      '	0	0	1
18000828	18	                 TO WS-CICS-FAIL-MSG	0	0	1
18000829	18	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
18000830	18	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
18000831	18	              PERFORM ABEND-THIS-TASK	0	0	1
18000832	18	           END-IF.	0	0	1
18000834	18	      *	1	0	0
18000835	18	      *    Is it a valid record or not?	1	0	1
18000836	18	      *	1	0	1
18000837	18	           IF COMM-ACC-TYPE = SPACES AND	0	0	0
18000838	18	           COMM-LAST-STMT-DT = ZERO	0	0	1
18000839	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18000840	18	              MOVE SPACES TO MESSAGEO	0	0	1
18000841	18	              MOVE 'This account number could not be found' TO	0	0	1
18000842	18	                 MESSAGEO	0	0	1
18000843	18	              MOVE -1 TO ACCNOL	0	0	1
18000844	18	           ELSE	0	0	1
18000845	18	              MOVE SPACES TO MESSAGEO	0	0	1
18000846	18	              MOVE 'Please amend fields and hit <pf5> to apply changes'	0	0	1
18000847	18	                 TO MESSAGEO	0	0	1
18000848	18	      *	1	0	0
18000849	18	      *       Move fields to the associated output fields	1	0	1
18000850	18	      *	1	0	1
18000852	18	              MOVE COMM-ACCNO       TO ACCNO2O	0	0	0
18000854	18	              MOVE COMM-CUSTNO      TO CUSTNOO	0	0	1
18000855	18	              MOVE COMM-SCODE       TO SORTCO	0	0	1
18000856	18	              MOVE COMM-ACC-TYPE    TO ACTYPEO	0	0	1
18000857	18	              MOVE COMM-INT-RATE    TO INTRT-PIC9	0	0	1
18000858	18	              MOVE INTRT-PIC9       TO INTRTO	0	0	1
18000859	18	              MOVE COMM-OPENED      TO WS-DATE-SPLIT	0	0	1
18000860	18	              MOVE WS-DATE-SPLIT-DD TO OPENDDO	0	0	1
18000861	18	              MOVE WS-DATE-SPLIT-MM TO OPENMMO	0	0	1
18000862	18	              MOVE WS-DATE-SPLIT-YY TO OPENYYO	0	0	1
18000863	18	              MOVE COMM-LAST-STMT-DT TO WS-DATE-SPLIT	0	0	1
18000864	18	              MOVE WS-DATE-SPLIT-DD TO LSTMTDDO	0	0	1
18000865	18	              MOVE WS-DATE-SPLIT-MM TO LSTMTMMO	0	0	1
18000866	18	              MOVE WS-DATE-SPLIT-YY TO LSTMTYYO	0	0	1
18000867	18	              MOVE COMM-NEXT-STMT-DT TO WS-DATE-SPLIT	0	0	1
18000868	18	              MOVE WS-DATE-SPLIT-DD TO NSTMTDDO	0	0	1
18000869	18	              MOVE WS-DATE-SPLIT-MM TO NSTMTMMO	0	0	1
18000870	18	              MOVE WS-DATE-SPLIT-YY TO NSTMTYYO	0	0	1
18000871	18	              MOVE COMM-OVERDRAFT   TO OVERDRO	0	0	1
18000872	18	              MOVE COMM-AVAIL-BAL   TO AVAILABLE-BALANCE-DISPLAY	0	0	1
18000873	18	              MOVE COMM-ACTUAL-BAL  TO ACTUAL-BALANCE-DISPLAY	0	0	1
18000874	18	              MOVE AVAILABLE-BALANCE-DISPLAY TO AVBALO	0	0	1
18000875	18	              MOVE ACTUAL-BALANCE-DISPLAY TO ACTBALO	0	0	1
18000877	18	              MOVE -1 TO ACCNOL	0	0	1
18000879	18	           END-IF.	0	0	1
18000881	18	       IAD999.	0	0	1
18000882	18	           EXIT.	0	0	1
18000885	18	       UPD-ACC-DATA SECTION.	0	0	1
18000886	18	       UAD010.	0	0	1
18000887	18	      *	1	0	0
18000888	18	      *    Set up the fields required by UPDACC then link to it	1	0	1
18000889	18	      *	1	0	1
18000890	18	           INITIALIZE DFHCOMMAREA.	0	0	0
18000892	18	           MOVE ACCNOI        TO COMM-ACCNO.	0	0	1
18000893	18	           IF ACCNOI = 99999999	0	0	1
18000894	18	             MOVE ACCNO2I        TO COMM-ACCNO	0	0	1
18000895	18	           END-IF	0	0	1
18000896	18	           MOVE CUSTNOI       TO COMM-CUSTNO.	0	0	1
18000897	18	           MOVE SORTCI        TO COMM-SCODE.	0	0	1
18000898	18	           MOVE ACTYPEI       TO COMM-ACC-TYPE.	0	0	1
18000899	18	           COMPUTE INTRTI-COMP-1 = FUNCTION NUMVAL(INTRTI).	0	0	1
18000900	18	           MOVE INTRTI-COMP-1 TO INT-RT-9.	0	0	1
18000901	18	           MOVE INT-RT-9      TO COMM-INT-RATE.	0	0	1
18000902	18	           MOVE OPENDDI       TO WS-DATE-SPLIT-DD.	0	0	1
18000903	18	           MOVE OPENMMI       TO  WS-DATE-SPLIT-MM.	0	0	1
18000904	18	           MOVE OPENYYI       TO WS-DATE-SPLIT-YY.	0	0	1
18000905	18	           MOVE WS-DATE-SPLIT TO COMM-OPENED.	0	0	1
18000906	18	           COMPUTE COMM-OVERDRAFT = FUNCTION NUMVAL(OVERDRI(1:OVERDRL)).	0	0	1
18000907	18	           MOVE LSTMTDDI      TO WS-DATE-SPLIT-DD.	0	0	1
18000908	18	           MOVE LSTMTMMI      TO WS-DATE-SPLIT-MM.	0	0	1
18000909	18	           MOVE LSTMTYYI      TO WS-DATE-SPLIT-YY.	0	0	1
18000910	18	           MOVE WS-DATE-SPLIT TO COMM-LAST-STMT-DT.	0	0	1
18000911	18	           MOVE NSTMTDDI      TO WS-DATE-SPLIT-DD.	0	0	1
18000912	18	           MOVE NSTMTMMI      TO WS-DATE-SPLIT-MM.	0	0	1
18000913	18	           MOVE NSTMTYYI      TO WS-DATE-SPLIT-YY.	0	0	1
18000914	18	           MOVE WS-DATE-SPLIT TO COMM-NEXT-STMT-DT.	0	0	1
18000916	18	      *	1	0	0
18000917	18	      *    Convert the screen formats for ACTBAL and AVBAL into proper	1	0	1
18000918	18	      *    numeric format (handling the decimal point and sign).	1	0	1
18000919	18	      *	1	0	1
18000920	18	           MOVE 0 TO WS-CONVERTED-VAL1.	0	0	0
18000921	18	           MOVE 0 TO WS-CONVERTED-VAL2.	0	0	1
18000922	18	           MOVE 0 TO WS-CONVERTED-VAL3.	0	0	1
18000923	18	           MOVE 0 TO WS-CONVERTED-VAL4.	0	0	1
18000925	18	           MOVE AVBALI        TO WS-CONVERT-PICX.	0	0	1
18000926	18	           COMPUTE WS-CONVERTED-VAL1 = WS-CONVERT-REMAIN / 100.	0	0	1
18000927	18	           COMPUTE WS-CONVERTED-VAL2 = WS-CONVERT-DEC.	0	0	1
18000928	18	           COMPUTE WS-CONVERTED-VAL3 = WS-CONVERTED-VAL1 +	0	0	1
18000929	18	                                           WS-CONVERTED-VAL2.	0	0	1
18000931	18	           IF WS-CONVERT-SIGN = '-'	0	0	1
18000932	18	              COMPUTE WS-CONVERTED-VAL4 = 0 - WS-CONVERTED-VAL3	0	0	1
18000933	18	           ELSE	0	0	1
18000934	18	              COMPUTE WS-CONVERTED-VAL4 = 0 + WS-CONVERTED-VAL3	0	0	1
18000935	18	           END-IF.	0	0	1
18000937	18	           MOVE WS-CONVERTED-VAL4 TO COMM-AVAIL-BAL.	0	0	1
18000939	18	           MOVE ACTBALI        TO WS-CONVERT-PICX.	0	0	1
18000940	18	           COMPUTE WS-CONVERTED-VAL1 = WS-CONVERT-REMAIN / 100.	0	0	1
18000941	18	           COMPUTE WS-CONVERTED-VAL2 = WS-CONVERT-DEC.	0	0	1
18000942	18	           COMPUTE WS-CONVERTED-VAL3 = WS-CONVERTED-VAL1 +	0	0	1
18000943	18	                                           WS-CONVERTED-VAL2.	0	0	1
18000945	18	           IF WS-CONVERT-SIGN = '-'	0	0	1
18000946	18	              COMPUTE WS-CONVERTED-VAL4 = 0 - WS-CONVERTED-VAL3	0	0	1
18000947	18	           ELSE	0	0	1
18000948	18	              COMPUTE WS-CONVERTED-VAL4 = 0 + WS-CONVERTED-VAL3	0	0	1
18000949	18	           END-IF.	0	0	1
18000951	18	           MOVE WS-CONVERTED-VAL4 TO COMM-ACTUAL-BAL.	0	0	1
18000952	18	           MOVE ' '           TO COMM-SUCCESS.	0	0	1
18000954	18	           EXEC CICS LINK	0	0	1
18000955	18	              PROGRAM('UPDACC')	0	0	1
18000956	18	              COMMAREA(DFHCOMMAREA)	0	0	1
18000957	18	              RESP(WS-CICS-RESP)	0	0	1
18000958	18	              RESP2(WS-CICS-RESP2)	0	0	1
18000959	18	              SYNCONRETURN	0	0	1
18000960	18	           END-EXEC.	0	0	1
18000962	18	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
18000963	18	      *	1	0	0
18000964	18	      *       Preserve the RESP and RESP2, then set up the	1	0	1
18000965	18	      *       standard ABEND info before getting the applid,	1	0	1
18000966	18	      *       date/time etc. and linking to the Abend Handler	1	0	1
18000967	18	      *       program.	1	0	1
18000968	18	      *	1	0	1
18000969	18	              INITIALIZE ABNDINFO-REC	0	0	0
18000970	18	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
18000971	18	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
18000972	18	      *	1	0	0
18000973	18	      *       Get supplemental information	1	0	1
18000974	18	      *	1	0	1
18000975	18	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
18000976	18	              END-EXEC	0	0	1
18000978	18	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
18000979	18	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
18000981	18	              PERFORM POPULATE-TIME-DATE	0	0	1
18000983	18	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
18000984	18	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
18000985	18	                    ':' DELIMITED BY SIZE,	0	0	1
18000986	18	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
18000987	18	                     ':' DELIMITED BY SIZE,	0	0	1
18000988	18	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
18000989	18	                     INTO ABND-TIME	0	0	1
18000990	18	              END-STRING	0	0	1
18000992	18	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
18000993	18	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
18000995	18	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
18000996	18	              END-EXEC	0	0	1
18000998	18	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
18001000	18	              STRING 'UAD010  - LINK UPDACC FAIL.'	0	0	1
18001001	18	                    DELIMITED BY SIZE,	0	0	1
18001002	18	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
18001003	18	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
18001004	18	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
18001005	18	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
18001006	18	                    INTO ABND-FREEFORM	0	0	1
18001007	18	              END-STRING	0	0	1
18001009	18	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
18001010	18	                        COMMAREA(ABNDINFO-REC)	0	0	1
18001011	18	              END-EXEC	0	0	1
18001013	18	              INITIALIZE WS-FAIL-INFO	0	0	1
18001014	18	              MOVE 'BNK1UAC - UAD010 - LINK UPDACC  FAIL      '	0	0	1
18001015	18	                 TO WS-CICS-FAIL-MSG	0	0	1
18001016	18	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
18001017	18	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
18001018	18	              PERFORM ABEND-THIS-TASK	0	0	1
18001019	18	           END-IF.	0	0	1
18001021	18	      *	1	0	0
18001022	18	      *    Has the update worked or not?	1	0	1
18001023	18	      *	1	0	1
18001024	18	           IF COMM-SUCCESS = 'N'	0	0	0
18001026	18	              MOVE 'N' TO VALID-DATA-SW	0	0	1
18001027	18	              MOVE SPACES TO MESSAGEO	0	0	1
18001028	18	              MOVE 'Update unsuccessful, try again later.    ' TO	0	0	1
18001029	18	                 MESSAGEO	0	0	1
18001030	18	           ELSE	0	0	1
18001031	18	              MOVE SPACES TO MESSAGEO	0	0	1
18001032	18	              MOVE 'Account update successfully applied.     '	0	0	1
18001033	18	                 TO MESSAGEO	0	0	1
18001034	18	      *	1	0	0
18001035	18	      *       Move fields to the associated output fields	1	0	1
18001036	18	      *	1	0	1
18001037	18	              MOVE COMM-ACCNO       TO ACCNO2O	0	0	0
18001038	18	              MOVE COMM-CUSTNO      TO CUSTNOO	0	0	1
18001039	18	              MOVE COMM-SCODE       TO SORTCO	0	0	1
18001040	18	              MOVE COMM-ACC-TYPE    TO ACTYPEO	0	0	1
18001041	18	              MOVE COMM-INT-RATE    TO INTRT-PIC9	0	0	1
18001042	18	              MOVE INTRT-PIC9       TO INTRTO	0	0	1
18001043	18	              MOVE COMM-OPENED      TO WS-DATE-SPLIT	0	0	1
18001044	18	              MOVE WS-DATE-SPLIT-DD TO OPENDDO	0	0	1
18001045	18	              MOVE WS-DATE-SPLIT-MM TO OPENMMO	0	0	1
18001046	18	              MOVE WS-DATE-SPLIT-YY TO OPENYYO	0	0	1
18001047	18	              MOVE COMM-LAST-STMT-DT TO WS-DATE-SPLIT	0	0	1
18001048	18	              MOVE WS-DATE-SPLIT-DD TO LSTMTDDO	0	0	1
18001049	18	              MOVE WS-DATE-SPLIT-MM TO LSTMTMMO	0	0	1
18001050	18	              MOVE WS-DATE-SPLIT-YY TO LSTMTYYO	0	0	1
18001051	18	              MOVE COMM-NEXT-STMT-DT TO WS-DATE-SPLIT	0	0	1
18001052	18	              MOVE WS-DATE-SPLIT-DD TO NSTMTDDO	0	0	1
18001053	18	              MOVE WS-DATE-SPLIT-MM TO NSTMTMMO	0	0	1
18001054	18	              MOVE WS-DATE-SPLIT-YY TO NSTMTYYO	0	0	1
18001055	18	              MOVE COMM-OVERDRAFT   TO OVERDRO	0	0	1
18001056	18	              MOVE COMM-AVAIL-BAL   TO AVAILABLE-BALANCE-DISPLAY	0	0	1
18001057	18	              MOVE COMM-ACTUAL-BAL  TO ACTUAL-BALANCE-DISPLAY	0	0	1
18001058	18	              MOVE AVAILABLE-BALANCE-DISPLAY TO AVBALO	0	0	1
18001059	18	              MOVE ACTUAL-BALANCE-DISPLAY TO ACTBALO	0	0	1
18001061	18	           END-IF.	0	0	1
18001064	18	       UAD999.	0	0	1
18001065	18	           EXIT.	0	0	1
18001068	18	       SEND-MAP SECTION.	0	0	1
18001069	18	       SM010.	0	0	1
18001070	18	      *	1	0	0
18001071	18	      *    If the map needs to have its data erased	1	0	1
18001072	18	      *	1	0	1
18001073	18	           IF SEND-ERASE	0	0	0
18001074	18	              EXEC CICS SEND MAP('BNK1UA')	0	0	1
18001075	18	                 MAPSET('BNK1UAM')	0	0	1
18001076	18	                 FROM(BNK1UAO)	0	0	1
18001077	18	                 ERASE	0	0	1
18001078	18	                 CURSOR	0	0	1
18001079	18	                 RESP(WS-CICS-RESP)	0	0	1
18001080	18	                 RESP2(WS-CICS-RESP2)	0	0	1
18001081	18	              END-EXEC	0	0	1
18001083	18	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
18001084	18	      *	1	0	0
18001085	18	      *          Preserve the RESP and RESP2, then set up the	1	0	1
18001086	18	      *          standard ABEND info before getting the applid,	1	0	1
18001087	18	      *          date/time etc. and linking to the Abend Handler	1	0	1
18001088	18	      *          program.	1	0	1
18001089	18	      *	1	0	1
18001090	18	                 INITIALIZE ABNDINFO-REC	0	0	0
18001091	18	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
18001092	18	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
18001093	18	      *	1	0	0
18001094	18	      *          Get supplemental information	1	0	1
18001095	18	      *	1	0	1
18001096	18	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
18001097	18	                 END-EXEC	0	0	1
18001099	18	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
18001100	18	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
18001102	18	                 PERFORM POPULATE-TIME-DATE	0	0	1
18001104	18	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
18001105	18	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
18001106	18	                       ':' DELIMITED BY SIZE,	0	0	1
18001107	18	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
18001108	18	                        ':' DELIMITED BY SIZE,	0	0	1
18001109	18	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
18001110	18	                        INTO ABND-TIME	0	0	1
18001111	18	                 END-STRING	0	0	1
18001113	18	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
18001114	18	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
18001116	18	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
18001117	18	                 END-EXEC	0	0	1
18001119	18	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
18001121	18	                 STRING 'SM010 - SEND MAP ERASE FAIL.'	0	0	1
18001122	18	                       DELIMITED BY SIZE,	0	0	1
18001123	18	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
18001124	18	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
18001125	18	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
18001126	18	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
18001127	18	                       INTO ABND-FREEFORM	0	0	1
18001128	18	                 END-STRING	0	0	1
18001130	18	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
18001131	18	                           COMMAREA(ABNDINFO-REC)	0	0	1
18001132	18	                 END-EXEC	0	0	1
18001135	18	                 INITIALIZE WS-FAIL-INFO	0	0	1
18001136	18	                 MOVE 'BNK1UAC - SM010 - SEND MAP ERASE FAIL '	0	0	1
18001137	18	                    TO WS-CICS-FAIL-MSG	0	0	1
18001138	18	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
18001139	18	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
18001140	18	                 PERFORM ABEND-THIS-TASK	0	0	1
18001141	18	              END-IF	0	0	1
18001143	18	              GO TO SM999	0	0	1
18001144	18	           END-IF.	0	0	1
18001146	18	      *	1	0	0
18001147	18	      *    If the map just needs a resend of only the data	1	0	1
18001148	18	      *	1	0	1
18001149	18	           IF SEND-DATAONLY	0	0	0
18001150	18	              EXEC CICS SEND MAP('BNK1UA')	0	0	1
18001151	18	                 MAPSET('BNK1UAM')	0	0	1
18001152	18	                 FROM(BNK1UAO)	0	0	1
18001153	18	                 DATAONLY	0	0	1
18001154	18	                 CURSOR	0	0	1
18001155	18	                 RESP(WS-CICS-RESP)	0	0	1
18001156	18	                 RESP2(WS-CICS-RESP2)	0	0	1
18001157	18	              END-EXEC	0	0	1
18001159	18	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
18001160	18	      *	1	0	0
18001161	18	      *          Preserve the RESP and RESP2, then set up the	1	0	1
18001162	18	      *          standard ABEND info before getting the applid,	1	0	1
18001163	18	      *          date/time etc. and linking to the Abend Handler	1	0	1
18001164	18	      *          program.	1	0	1
18001165	18	      *	1	0	1
18001166	18	                 INITIALIZE ABNDINFO-REC	0	0	0
18001167	18	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
18001168	18	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
18001169	18	      *	1	0	0
18001170	18	      *          Get supplemental information	1	0	1
18001171	18	      *	1	0	1
18001172	18	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
18001173	18	                 END-EXEC	0	0	1
18001175	18	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
18001176	18	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
18001178	18	                 PERFORM POPULATE-TIME-DATE	0	0	1
18001180	18	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
18001181	18	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
18001182	18	                       ':' DELIMITED BY SIZE,	0	0	1
18001183	18	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
18001184	18	                        ':' DELIMITED BY SIZE,	0	0	1
18001185	18	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
18001186	18	                        INTO ABND-TIME	0	0	1
18001187	18	                 END-STRING	0	0	1
18001189	18	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
18001190	18	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
18001192	18	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
18001193	18	                 END-EXEC	0	0	1
18001195	18	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
18001197	18	                 STRING 'SM010 - SEND MAP DATAONLY FAIL.'	0	0	1
18001198	18	                       DELIMITED BY SIZE,	0	0	1
18001199	18	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
18001200	18	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
18001201	18	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
18001202	18	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
18001203	18	                       INTO ABND-FREEFORM	0	0	1
18001204	18	                 END-STRING	0	0	1
18001206	18	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
18001207	18	                           COMMAREA(ABNDINFO-REC)	0	0	1
18001208	18	                 END-EXEC	0	0	1
18001210	18	                 INITIALIZE WS-FAIL-INFO	0	0	1
18001211	18	                 MOVE 'BNK1UAC - SM010 - SEND MAP DATAONLY FAIL '	0	0	1
18001212	18	                    TO WS-CICS-FAIL-MSG	0	0	1
18001213	18	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
18001214	18	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
18001215	18	                 PERFORM ABEND-THIS-TASK	0	0	1
18001216	18	              END-IF	0	0	1
18001218	18	              GO TO SM999	0	0	1
18001219	18	           END-IF.	0	0	1
18001221	18	      *	1	0	0
18001222	18	      *    If we have elected to send the map and a beep	1	0	1
18001223	18	      *	1	0	1
18001224	18	           IF SEND-DATAONLY-ALARM	0	0	0
18001225	18	              EXEC CICS SEND MAP('BNK1UA')	0	0	1
18001226	18	                 MAPSET('BNK1UAM')	0	0	1
18001227	18	                 FROM(BNK1UAO)	0	0	1
18001228	18	                 DATAONLY	0	0	1
18001229	18	                 ALARM	0	0	1
18001230	18	                 CURSOR	0	0	1
18001231	18	                 RESP(WS-CICS-RESP)	0	0	1
18001232	18	                 RESP2(WS-CICS-RESP2)	0	0	1
18001233	18	              END-EXEC	0	0	1
18001235	18	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
18001236	18	      *	1	0	0
18001237	18	      *          Preserve the RESP and RESP2, then set up the	1	0	1
18001238	18	      *          standard ABEND info before getting the applid,	1	0	1
18001239	18	      *          date/time etc. and linking to the Abend Handler	1	0	1
18001240	18	      *          program.	1	0	1
18001241	18	      *	1	0	1
18001242	18	                 INITIALIZE ABNDINFO-REC	0	0	0
18001243	18	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
18001244	18	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
18001245	18	      *	1	0	0
18001246	18	      *          Get supplemental information	1	0	1
18001247	18	      *	1	0	1
18001248	18	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
18001249	18	                 END-EXEC	0	0	1
18001251	18	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
18001252	18	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
18001254	18	                 PERFORM POPULATE-TIME-DATE	0	0	1
18001256	18	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
18001257	18	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
18001258	18	                       ':' DELIMITED BY SIZE,	0	0	1
18001259	18	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
18001260	18	                        ':' DELIMITED BY SIZE,	0	0	1
18001261	18	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
18001262	18	                        INTO ABND-TIME	0	0	1
18001263	18	                 END-STRING	0	0	1
18001265	18	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
18001266	18	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
18001268	18	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
18001269	18	                 END-EXEC	0	0	1
18001271	18	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
18001273	18	                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL.'	0	0	1
18001274	18	                       DELIMITED BY SIZE,	0	0	1
18001275	18	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
18001276	18	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
18001277	18	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
18001278	18	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
18001279	18	                       INTO ABND-FREEFORM	0	0	1
18001280	18	                 END-STRING	0	0	1
18001282	18	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
18001283	18	                           COMMAREA(ABNDINFO-REC)	0	0	1
18001284	18	                 END-EXEC	0	0	1
18001287	18	                 INITIALIZE WS-FAIL-INFO	0	0	1
18001288	18	                 MOVE 'BNK1UAC - SM010 - SEND MAP DATAONLY ALARM FAIL '	0	0	1
18001289	18	                    TO WS-CICS-FAIL-MSG	0	0	1
18001290	18	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
18001291	18	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
18001292	18	                 PERFORM ABEND-THIS-TASK	0	0	1
18001293	18	              END-IF	0	0	1
18001295	18	           END-IF.	0	0	1
18001297	18	       SM999.	0	0	1
18001298	18	           EXIT.	0	0	1
18001301	18	       SEND-TERMINATION-MSG SECTION.	0	0	1
18001302	18	       STM010.	0	0	1
18001303	18	      *	1	0	0
18001304	18	      *    Send the termination message	1	0	1
18001305	18	      *	1	0	1
18001306	18	           EXEC CICS SEND TEXT	0	0	0
18001307	18	              FROM(END-OF-SESSION-MESSAGE)	0	0	1
18001308	18	              ERASE	0	0	1
18001309	18	              FREEKB	0	0	1
18001310	18	              RESP(WS-CICS-RESP)	0	0	1
18001311	18	              RESP2(WS-CICS-RESP2)	0	0	1
18001312	18	           END-EXEC.	0	0	1
18001314	18	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
18001315	18	      *	1	0	0
18001316	18	      *       Preserve the RESP and RESP2, then set up the	1	0	1
18001317	18	      *       standard ABEND info before getting the applid,	1	0	1
18001318	18	      *       date/time etc. and linking to the Abend Handler	1	0	1
18001319	18	      *       program.	1	0	1
18001320	18	      *	1	0	1
18001321	18	              INITIALIZE ABNDINFO-REC	0	0	0
18001322	18	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
18001323	18	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
18001324	18	      *	1	0	0
18001325	18	      *       Get supplemental information	1	0	1
18001326	18	      *	1	0	1
18001327	18	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
18001328	18	              END-EXEC	0	0	1
18001330	18	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
18001331	18	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
18001333	18	              PERFORM POPULATE-TIME-DATE	0	0	1
18001335	18	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
18001336	18	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
18001337	18	                     ':' DELIMITED BY SIZE,	0	0	1
18001338	18	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
18001339	18	                     ':' DELIMITED BY SIZE,	0	0	1
18001340	18	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
18001341	18	                     INTO ABND-TIME	0	0	1
18001342	18	              END-STRING	0	0	1
18001344	18	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
18001345	18	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
18001347	18	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
18001348	18	              END-EXEC	0	0	1
18001350	18	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
18001352	18	              STRING 'STM010 - SEND TEXT FAIL.'	0	0	1
18001353	18	                    DELIMITED BY SIZE,	0	0	1
18001354	18	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
18001355	18	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
18001356	18	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
18001357	18	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
18001358	18	                    INTO ABND-FREEFORM	0	0	1
18001359	18	              END-STRING	0	0	1
18001361	18	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
18001362	18	                        COMMAREA(ABNDINFO-REC)	0	0	1
18001363	18	              END-EXEC	0	0	1
18001366	18	              INITIALIZE WS-FAIL-INFO	0	0	1
18001367	18	              MOVE 'BNK1UAC - STM010 - SEND TEXT FAIL'	0	0	1
18001368	18	                 TO WS-CICS-FAIL-MSG	0	0	1
18001369	18	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
18001370	18	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
18001371	18	              PERFORM ABEND-THIS-TASK	0	0	1
18001372	18	           END-IF.	0	0	1
18001374	18	       STM999.	0	0	1
18001375	18	           EXIT.	0	0	1
18001378	18	       ABEND-THIS-TASK SECTION.	0	0	1
18001379	18	       ATT010.	0	0	1
18001380	18	           DISPLAY WS-FAIL-INFO.	0	0	1
18001381	18	           EXEC CICS ABEND	0	0	1
18001382	18	              ABCODE('HBNK')	0	0	1
18001383	18	              NODUMP	0	0	1
18001384	18	           END-EXEC.	0	0	1
18001386	18	       ATT999.	0	0	1
18001387	18	           EXIT.	0	0	1
18001390	18	       POPULATE-TIME-DATE SECTION.	0	0	1
18001391	18	       PTD010.	0	0	1
18001393	18	           EXEC CICS ASKTIME	0	0	1
18001394	18	              ABSTIME(WS-U-TIME)	0	0	1
18001395	18	           END-EXEC.	0	0	1
18001397	18	           EXEC CICS FORMATTIME	0	0	1
18001398	18	                     ABSTIME(WS-U-TIME)	0	0	1
18001399	18	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
18001400	18	                     TIME(WS-TIME-NOW)	0	0	1
18001401	18	                     DATESEP	0	0	1
18001402	18	           END-EXEC.	0	0	1
18001404	18	       PTD999.	0	0	1
18001405	18	           EXIT.	0	0	1
19000000	19	<<<< file not found >>>>	0	0	0
19000001	19	<<<< file not found >>>>	0	0	0
20000001	20	       CBL CICS('SP,EDF')	0	0	1
20000002	20	       CBL SQL	0	0	1
20000003	20	      ******************************************************************	1	0	0
20000004	20	      *                                                                *	1	0	1
20000005	20	      *  Copyright IBM Corp. 2023                                      *	1	0	1
20000006	20	      *                                                                *	1	0	1
20000007	20	      ******************************************************************	1	0	1
20000009	20	      ******************************************************************	1	0	1
20000010	20	      * This program takes an incoming customer number & retrieves	1	0	1
20000011	20	      * the associated accounts for it and stores these in an	1	0	1
20000012	20	      * array.	1	0	1
20000013	20	      *	1	0	1
20000014	20	      * Then it deletes the accounts one at a time and writes a	1	0	1
20000015	20	      * PROCTRAN delete account record out for each deleted account.	1	0	1
20000016	20	      *	1	0	1
20000017	20	      * When all accounts have been deleted, it deletes the customer	1	0	1
20000018	20	      * record (and writes out a customer delete record to PROCTRAN).	1	0	1
20000019	20	      *	1	0	1
20000020	20	      * If there is a failure at any time after we have started to	1	0	1
20000021	20	      * delete things then abend (or else the records will be out	1	0	1
20000022	20	      * of step). The only failure excluded from this, is where we	1	0	1
20000023	20	      * go to delete an account and it had already been deleted (if	1	0	1
20000024	20	      * this happens then we can just continue).	1	0	1
20000025	20	      *	1	0	1
20000026	20	      ******************************************************************	1	0	1
20000028	20	       IDENTIFICATION DIVISION.	0	0	0
20000029	20	       PROGRAM-ID. DELCUS.	0	0	1
20000030	20	       AUTHOR. Jon Collett.	0	0	1
20000032	20	       ENVIRONMENT DIVISION.	0	0	1
20000033	20	       CONFIGURATION SECTION.	0	0	1
20000034	20	      * SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
20000035	20	       SOURCE-COMPUTER.  IBM-370.	0	0	0
20000036	20	       OBJECT-COMPUTER.  IBM-370.	0	0	1
20000037	20	       INPUT-OUTPUT SECTION.	0	0	1
20000039	20	       DATA DIVISION.	0	0	1
20000040	20	       FILE SECTION.	0	0	1
20000042	20	       WORKING-STORAGE SECTION.	0	0	1
20000044	20	       COPY SORTCODE.	0	0	1
20000048	20	       01 SYSIDERR-RETRY               PIC 999.	0	0	1
20000049	20	       01 FILE-RETRY                   PIC 999.	0	0	1
20000050	20	       01 WS-EXIT-RETRY-LOOP           PIC X VALUE ' '.	0	0	1
20000053	20	      * PROCTRAN DB2 copybook	1	0	0
20000054	20	           EXEC SQL	0	0	0
20000055	20	              INCLUDE PROCDB2	0	0	1
20000056	20	           END-EXEC.	0	0	1
20000058	20	      * PROCTRAN host variables for DB2	1	0	0
20000059	20	       01 HOST-PROCTRAN-ROW.	0	0	0
20000060	20	           03 HV-PROCTRAN-EYECATCHER   PIC X(4).	0	0	1
20000061	20	           03 HV-PROCTRAN-SORT-CODE    PIC X(6).	0	0	1
20000062	20	           03 HV-PROCTRAN-ACC-NUMBER   PIC X(8).	0	0	1
20000063	20	           03 HV-PROCTRAN-DATE         PIC X(10).	0	0	1
20000064	20	           03 HV-PROCTRAN-TIME         PIC X(6).	0	0	1
20000065	20	           03 HV-PROCTRAN-REF          PIC X(12).	0	0	1
20000066	20	           03 HV-PROCTRAN-TYPE         PIC X(3).	0	0	1
20000067	20	           03 HV-PROCTRAN-DESC         PIC X(40).	0	0	1
20000068	20	           03 HV-PROCTRAN-AMOUNT       PIC S9(10)V99 COMP-3.	0	0	1
20000070	20	      * Pull in the SQL COMMAREA	1	0	0
20000071	20	        EXEC SQL	0	0	0
20000072	20	          INCLUDE SQLCA	0	0	1
20000073	20	        END-EXEC.	0	0	1
20000075	20	       01 WS-CICS-WORK-AREA.	0	0	1
20000076	20	           05 WS-CICS-RESP             PIC S9(8) COMP.	0	0	1
20000077	20	           05 WS-CICS-RESP2            PIC S9(8) COMP.	0	0	1
20000079	20	       01 EXIT-BROWSE-LOOP             PIC X VALUE 'N'.	0	0	1
20000081	20	       01 OUTPUT-DATA.	0	0	1
20000082	20	           COPY ACCOUNT.	0	0	1
20000084	20	       01 OUTPUT-CUST-DATA.	0	0	1
20000085	20	           COPY CUSTOMER.	0	0	1
20000087	20	       01 PROCTRAN-AREA.	0	0	1
20000088	20	           COPY PROCTRAN.	0	0	1
20000090	20	       01 PROCTRAN-RIDFLD                 PIC S9(8) COMP.	0	0	1
20000091	20	       77 PROCTRAN-RETRY                  PIC 999.	0	0	1
20000093	20	       01 ACCOUNT-ACT-BAL-STORE           PIC S9(10)V99 VALUE 0.	0	0	1
20000095	20	       01 RETURNED-DATA.	0	0	1
20000096	20	           03 RETURNED-EYE-CATCHER        PIC X(4).	0	0	1
20000097	20	           03 RETURNED-CUST-NO            PIC 9(10).	0	0	1
20000098	20	           03 RETURNED-KEY.	0	0	1
20000099	20	              05 RETURNED-SORT-CODE       PIC 9(6).	0	0	1
20000100	20	              05 RETURNED-NUMBER          PIC 9(8).	0	0	1
20000101	20	           03 RETURNED-TYPE               PIC X(8).	0	0	1
20000102	20	           03 RETURNED-INTEREST-RATE      PIC 9(4)V99.	0	0	1
20000103	20	           03 RETURNED-OPENED             PIC 9(8).	0	0	1
20000104	20	           03 RETURNED-OVERDRAFT-LIMIT    PIC 9(8).	0	0	1
20000105	20	           03 RETURNED-LAST-STMT-DATE     PIC 9(8).	0	0	1
20000106	20	           03 RETURNED-NEXT-STMT-DATE     PIC 9(8).	0	0	1
20000107	20	           03 RETURNED-AVAILABLE-BALANCE  PIC S9(10)V99.	0	0	1
20000108	20	           03 RETURNED-ACTUAL-BALANCE     PIC S9(10)V99.	0	0	1
20000110	20	       01 ACCTCUST-DESIRED-KEY PIC 9(10) BINARY.	0	0	1
20000112	20	       01 DB2-DATE-REFORMAT.	0	0	1
20000113	20	          03 DB2-DATE-REF-YR           PIC 9(4).	0	0	1
20000114	20	          03 FILLER                    PIC X.	0	0	1
20000115	20	          03 DB2-DATE-REF-MNTH         PIC 99.	0	0	1
20000116	20	          03 FILLER                    PIC X.	0	0	1
20000117	20	          03 DB2-DATE-REF-DAY          PIC 99.	0	0	1
20000119	20	       01 DB2-EXIT-LOOP                PIC X.	0	0	1
20000120	20	       01 FETCH-DATA-CNT               PIC 9(4) COMP.	0	0	1
20000121	20	       01 WS-CUST-ALT-KEY-LEN          PIC S9(4) COMP VALUE +10.	0	0	1
20000123	20	       01 WS-EIBTASKN12                PIC 9(12) VALUE 0.	0	0	1
20000125	20	       01 WS-CNT                       PIC S9(4) COMP VALUE 0.	0	0	1
20000127	20	       01 CUSTOMER-KY.	0	0	1
20000128	20	          03 REQUIRED-SORT-CODE        PIC 9(6)  VALUE 0.	0	0	1
20000129	20	      *   03 REQUIRED-ACC-NUM          PIC 9(8)  VALUE 0.	1	0	0
20000133	20	       01 WS-ACC-KEY-LEN               PIC S9(4) COMP VALUE +14.	0	0	0
20000134	20	       01 WS-ACC-NUM                   PIC S9(4) COMP VALUE 0.	0	0	1
20000136	20	       01 WS-CUST-KEY-LEN              PIC S9(4) COMP VALUE +16.	0	0	1
20000137	20	       01 WS-CUST-NUM                  PIC S9(4) COMP VALUE 0.	0	0	1
20000139	20	       01 DESIRED-KEY-ACCTCUST.	0	0	1
20000140	20	           03 DESIRED-KEY-CUSTOMER-ACCTCUST   PIC 9(10).	0	0	1
20000141	20	           03 DESIRED-KEY-SORTCODE-ACCTCUST   PIC 9(6).	0	0	1
20000143	20	       01 DESIRED-KEY.	0	0	1
20000144	20	           03 DESIRED-KEY-SORTCODE     PIC 9(6).	0	0	1
20000145	20	           03 DESIRED-KEY-CUSTOMER     PIC 9(10).	0	0	1
20000147	20	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
20000148	20	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
20000149	20	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
20000150	20	          03 WS-ORIG-DATE-DD              PIC 99.	0	0	1
20000151	20	          03 FILLER                       PIC X.	0	0	1
20000152	20	          03 WS-ORIG-DATE-MM              PIC 99.	0	0	1
20000153	20	          03 FILLER                       PIC X.	0	0	1
20000154	20	          03 WS-ORIG-DATE-YYYY            PIC 9999.	0	0	1
20000156	20	       01 WS-ORIG-DATE-GRP-X.	0	0	1
20000157	20	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
20000158	20	          03 FILLER                     PIC X VALUE '.'.	0	0	1
20000159	20	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
20000160	20	          03 FILLER                     PIC X VALUE '.'.	0	0	1
20000161	20	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
20000163	20	       01 REMIX-STMT-DATE              PIC 9(8).	0	0	1
20000165	20	       01 WS-APPLID                    PIC X(8).	0	0	1
20000167	20	       01 VAR-REMIX.	0	0	1
20000168	20	          03 REMIX-SCODE               PIC 9(6).	0	0	1
20000169	20	          03 REMIX-CHAR REDEFINES REMIX-SCODE.	0	0	1
20000170	20	             05 REMIX-SCODE-CHAR           PIC X(6).	0	0	1
20000172	20	      *	1	0	0
20000173	20	      * The CUSTOMER storage area	1	0	1
20000174	20	      *	1	0	1
20000175	20	       01 WS-STOREDC-CUSTOMER.	0	0	0
20000176	20	          03 WS-STOREDC-EYECATCHER           PIC X(4).	0	0	1
20000177	20	          03 WS-STOREDC-SORTCODE             PIC 9(6).	0	0	1
20000178	20	          03 WS-STOREDC-NUMBER               PIC 9(10).	0	0	1
20000179	20	          03 WS-STOREDC-NAME                 PIC X(60).	0	0	1
20000180	20	          03 WS-STOREDC-ADDRESS              PIC X(160).	0	0	1
20000181	20	          03 WS-STOREDC-DATE-OF-BIRTH        PIC X(10).	0	0	1
20000182	20	          03 WS-STOREDC-CREDIT-SCORE         PIC 9(3).	0	0	1
20000183	20	          03 WS-STOREDC-CS-REVIEW-DATE       PIC X(10).	0	0	1
20000187	20	       01 WS-NONE-LEFT                 PIC X VALUE 'N'.	0	0	1
20000189	20	       01 WS-EXIT-FETCH                PIC X VALUE 'N'.	0	0	1
20000191	20	       01 SQLCODE-DISPLAY              PIC S9(8) DISPLAY	0	0	1
20000192	20	                                         SIGN LEADING SEPARATE.	0	0	1
20000194	20	       01 DELACC-COMMAREA.	0	0	1
20000195	20	          03 DELACC-COMM-EYE           PIC X(4).	0	0	1
20000196	20	          03 DELACC-COMM-CUSTNO        PIC X(10).	0	0	1
20000197	20	          03 DELACC-COMM-SCODE         PIC X(6).	0	0	1
20000198	20	          03 DELACC-COMM-ACCNO         PIC 9(8).	0	0	1
20000199	20	          03 DELACC-COMM-ACC-TYPE      PIC X(8).	0	0	1
20000200	20	          03 DELACC-COMM-INT-RATE      PIC 9(4)V99.	0	0	1
20000201	20	          03 DELACC-COMM-OPENED        PIC 9(8).	0	0	1
20000202	20	          03 DELACC-COMM-OVERDRAFT     PIC 9(8).	0	0	1
20000203	20	          03 DELACC-COMM-LAST-STMT-DT  PIC 9(8).	0	0	1
20000204	20	          03 DELACC-COMM-NEXT-STMT-DT  PIC 9(8).	0	0	1
20000205	20	          03 DELACC-COMM-AVAIL-BAL     PIC S9(10)V99.	0	0	1
20000206	20	          03 DELACC-COMM-ACTUAL-BAL    PIC S9(10)V99.	0	0	1
20000207	20	          03 DELACC-COMM-SUCCESS       PIC X.	0	0	1
20000208	20	          03 DELACC-COMM-FAIL-CD       PIC X.	0	0	1
20000209	20	          03 DELACC-COMM-DEL-SUCCESS   PIC X.	0	0	1
20000210	20	          03 DELACC-COMM-DEL-FAIL-CD   PIC X.	0	0	1
20000211	20	          03 DELACC-COMM-APPLID        PIC X(8).	0	0	1
20000212	20	          03 DELACC-COMM-PCB1          POINTER.	0	0	1
20000213	20	          03 DELACC-COMM-PCB2          POINTER.	0	0	1
20000216	20	       01 WS-TOKEN                     PIC S9(8) BINARY.	0	0	1
20000217	20	       01 WS-INDEX                     PIC S9(8) BINARY.	0	0	1
20000219	20	       01 INQACCCU-PROGRAM         PIC X(8) VALUE 'INQACCCU'.	0	0	1
20000220	20	       01 INQACCCU-COMMAREA.	0	0	1
20000221	20	          COPY INQACCCU.	0	0	1
20000223	20	       01 STORM-DRAIN-CONDITION       PIC X(20).	0	0	1
20000224	20	       01 INQCUST-PROGRAM          PIC X(8) VALUE 'INQCUST '.	0	0	1
20000225	20	       01 INQCUST-COMMAREA.	0	0	1
20000226	20	          COPY INQCUST.	0	0	1
20000228	20	       01 WS-TIME-DATA.	0	0	1
20000229	20	           03 WS-TIME-NOW                  PIC 9(6).	0	0	1
20000230	20	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
20000231	20	              05 WS-TIME-NOW-GRP-HH     PIC 99.	0	0	1
20000232	20	              05 WS-TIME-NOW-GRP-MM     PIC 99.	0	0	1
20000233	20	              05 WS-TIME-NOW-GRP-SS     PIC 99.	0	0	1
20000235	20	       01 WS-ABEND-PGM                  PIC X(8) VALUE 'ABNDPROC'.	0	0	1
20000237	20	       01 ABNDINFO-REC.	0	0	1
20000238	20	           COPY ABNDINFO.	0	0	1
20000240	20	       LINKAGE SECTION.	0	0	1
20000241	20	       01 DFHCOMMAREA.	0	0	1
20000242	20	           COPY DELCUS.	0	0	1
20000245	20	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
20000246	20	       PREMIERE SECTION.	0	0	1
20000247	20	       A010.	0	0	1
20000249	20	           MOVE SORTCODE TO REQUIRED-SORT-CODE	0	0	1
20000250	20	                            REQUIRED-SORT-CODE OF CUSTOMER-KY	0	0	1
20000251	20	                            DESIRED-KEY-SORTCODE.	0	0	1
20000253	20	           MOVE COMM-CUSTNO OF DFHCOMMAREA	0	0	1
20000254	20	             TO DESIRED-KEY-CUSTOMER.	0	0	1
20000256	20	           INITIALIZE INQCUST-COMMAREA.	0	0	1
20000257	20	           MOVE COMM-CUSTNO OF DFHCOMMAREA TO	0	0	1
20000258	20	              INQCUST-CUSTNO.	0	0	1
20000260	20	           EXEC CICS LINK PROGRAM(INQCUST-PROGRAM)	0	0	1
20000261	20	                     COMMAREA(INQCUST-COMMAREA)	0	0	1
20000262	20	           END-EXEC.	0	0	1
20000264	20	           IF INQCUST-INQ-SUCCESS = 'N'	0	0	1
20000265	20	             MOVE 'N' TO COMM-DEL-SUCCESS	0	0	1
20000266	20	             MOVE INQCUST-INQ-FAIL-CD TO COMM-DEL-FAIL-CD	0	0	1
20000267	20	             EXEC CICS RETURN	0	0	1
20000268	20	             END-EXEC	0	0	1
20000269	20	           END-IF.	0	0	1
20000271	20	           PERFORM GET-ACCOUNTS	0	0	1
20000272	20	      *	1	0	0
20000273	20	      *          If there are related accounts found then delete	1	0	1
20000274	20	      *          them.	1	0	1
20000275	20	      *	1	0	1
20000276	20	           IF NUMBER-OF-ACCOUNTS > 0	0	0	0
20000277	20	             PERFORM DELETE-ACCOUNTS	0	0	1
20000278	20	           END-IF	0	0	1
20000280	20	      *	1	0	0
20000281	20	      *    Having deleted the accounts and written the	1	0	1
20000282	20	      *    details to the PROCTRAN datastore, if we haven't abended	1	0	1
20000283	20	      *    then we must go on to delete the CUSTOMER record	1	0	1
20000284	20	      *	1	0	1
20000286	20	           PERFORM DEL-CUST-VSAM	0	0	0
20000289	20	           MOVE 'Y' TO COMM-DEL-SUCCESS.	0	0	1
20000290	20	           MOVE ' ' TO COMM-DEL-FAIL-CD.	0	0	1
20000292	20	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
20000294	20	       A999.	0	0	1
20000295	20	           EXIT.	0	0	1
20000298	20	       DELETE-ACCOUNTS SECTION.	0	0	1
20000299	20	       DA010.	0	0	1
20000301	20	      *	1	0	0
20000302	20	      *    Go through the entries (accounts) in the array,	1	0	1
20000303	20	      *    and for each one link to DELACC to delete that	1	0	1
20000304	20	      *    account.	1	0	1
20000305	20	      *	1	0	1
20000306	20	           PERFORM VARYING WS-INDEX FROM 1 BY 1	0	0	0
20000307	20	           UNTIL WS-INDEX > NUMBER-OF-ACCOUNTS	0	0	1
20000308	20	              INITIALIZE DELACC-COMMAREA	0	0	1
20000309	20	              MOVE WS-APPLID TO DELACC-COMM-APPLID	0	0	1
20000310	20	              MOVE COMM-ACCNO(WS-INDEX) TO DELACC-COMM-ACCNO	0	0	1
20000312	20	              EXEC CICS LINK PROGRAM('DELACC  ')	0	0	1
20000313	20	                       COMMAREA(DELACC-COMMAREA)	0	0	1
20000314	20	              END-EXEC	0	0	1
20000316	20	           END-PERFORM.	0	0	1
20000318	20	       DA999.	0	0	1
20000319	20	           EXIT.	0	0	1
20000322	20	       GET-ACCOUNTS SECTION.	0	0	1
20000323	20	       GAC010.	0	0	1
20000324	20	      *	1	0	0
20000325	20	      *    Link to INQACCCU to get all of the accounts for a	1	0	1
20000326	20	      *    given customer number.	1	0	1
20000327	20	      *	1	0	1
20000328	20	           MOVE COMM-CUSTNO OF DFHCOMMAREA	0	0	0
20000329	20	              TO CUSTOMER-NUMBER OF INQACCCU-COMMAREA.	0	0	1
20000330	20	           MOVE 20 TO NUMBER-OF-ACCOUNTS IN INQACCCU-COMMAREA.	0	0	1
20000331	20	           SET COMM-PCB-POINTER OF INQACCCU-COMMAREA	0	0	1
20000332	20	              TO DELACC-COMM-PCB1	0	0	1
20000334	20	           EXEC CICS LINK PROGRAM('INQACCCU')	0	0	1
20000335	20	                     COMMAREA(INQACCCU-COMMAREA)	0	0	1
20000336	20	                     SYNCONRETURN	0	0	1
20000337	20	           END-EXEC.	0	0	1
20000339	20	       GAC999.	0	0	1
20000340	20	           EXIT.	0	0	1
20000343	20	       DEL-CUST-VSAM SECTION.	0	0	1
20000344	20	       DCV010.	0	0	1
20000346	20	      *	1	0	0
20000347	20	      *    Read the CUSTOMER record and store the details	1	0	1
20000348	20	      *    for inclusion on PROCTRAN later, then delete the CUSTOMER	1	0	1
20000349	20	      *    record and write to PROCTRAN.	1	0	1
20000350	20	      *	1	0	1
20000351	20	           INITIALIZE OUTPUT-CUST-DATA.	0	0	0
20000353	20	           EXEC CICS READ FILE('CUSTOMER')	0	0	1
20000354	20	                RIDFLD(DESIRED-KEY)	0	0	1
20000355	20	                INTO(OUTPUT-CUST-DATA)	0	0	1
20000356	20	                UPDATE	0	0	1
20000357	20	                TOKEN(WS-TOKEN)	0	0	1
20000358	20	                RESP(WS-CICS-RESP)	0	0	1
20000359	20	                RESP2(WS-CICS-RESP2)	0	0	1
20000360	20	           END-EXEC.	0	0	1
20000362	20	           IF WS-CICS-RESP = DFHRESP(SYSIDERR)	0	0	1
20000363	20	              PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1	0	0	1
20000364	20	              UNTIL SYSIDERR-RETRY > 100	0	0	1
20000365	20	              OR WS-CICS-RESP = DFHRESP(NORMAL)	0	0	1
20000366	20	              OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)	0	0	1
20000368	20	                 EXEC CICS DELAY FOR SECONDS(3)	0	0	1
20000369	20	                 END-EXEC	0	0	1
20000371	20	                 EXEC CICS READ FILE('CUSTOMER')	0	0	1
20000372	20	                    RIDFLD(DESIRED-KEY)	0	0	1
20000373	20	                    INTO(OUTPUT-CUST-DATA)	0	0	1
20000374	20	                    UPDATE	0	0	1
20000375	20	                    TOKEN(WS-TOKEN)	0	0	1
20000376	20	                    RESP(WS-CICS-RESP)	0	0	1
20000377	20	                    RESP2(WS-CICS-RESP2)	0	0	1
20000378	20	                 END-EXEC	0	0	1
20000380	20	              END-PERFORM	0	0	1
20000382	20	           END-IF	0	0	1
20000384	20	           IF WS-CICS-RESP = DFHRESP(NOTFND)	0	0	1
20000385	20	      *	1	0	0
20000386	20	      *       Someone else has deleted it	1	0	1
20000387	20	      *	1	0	1
20000388	20	              GO TO DCV999	0	0	0
20000389	20	           END-IF	0	0	1
20000391	20	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
20000392	20	      *	1	0	0
20000393	20	      *       Preserve the RESP and RESP2, then set up the	1	0	1
20000394	20	      *       standard ABEND info before getting the applid,	1	0	1
20000395	20	      *       date/time etc. and linking to the Abend Handler	1	0	1
20000396	20	      *       program.	1	0	1
20000397	20	      *	1	0	1
20000398	20	              INITIALIZE ABNDINFO-REC	0	0	0
20000399	20	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
20000400	20	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
20000401	20	      *	1	0	0
20000402	20	      *       Get supplemental information	1	0	1
20000403	20	      *	1	0	1
20000404	20	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
20000405	20	              END-EXEC	0	0	1
20000407	20	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
20000408	20	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
20000410	20	              PERFORM POPULATE-TIME-DATE	0	0	1
20000412	20	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
20000413	20	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
20000414	20	                    ':' DELIMITED BY SIZE,	0	0	1
20000415	20	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
20000416	20	                     ':' DELIMITED BY SIZE,	0	0	1
20000417	20	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
20000418	20	                     INTO ABND-TIME	0	0	1
20000419	20	              END-STRING	0	0	1
20000421	20	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
20000422	20	              MOVE 'WPV6'      TO ABND-CODE	0	0	1
20000424	20	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
20000425	20	              END-EXEC	0	0	1
20000427	20	              MOVE ZEROS    TO ABND-SQLCODE	0	0	1
20000429	20	              STRING 'DCV010 - Unable to READ CUSTOMER VSAM rec '	0	0	1
20000430	20	                    DELIMITED BY SIZE,	0	0	1
20000431	20	                    'for key:' DESIRED-KEY DELIMITED BY SIZE,	0	0	1
20000432	20	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
20000433	20	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
20000434	20	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
20000435	20	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
20000436	20	                    INTO ABND-FREEFORM	0	0	1
20000437	20	              END-STRING	0	0	1
20000439	20	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
20000440	20	                        COMMAREA(ABNDINFO-REC)	0	0	1
20000441	20	              END-EXEC	0	0	1
20000443	20	              DISPLAY 'In DELCUS (DCV010) '	0	0	1
20000444	20	              'UNABLE TO READ CUSTOMER VSAM REC'	0	0	1
20000445	20	              ' RESP CODE=' WS-CICS-RESP, ' RESP2=' WS-CICS-RESP2	0	0	1
20000446	20	              'FOR KEY=' DESIRED-KEY	0	0	1
20000448	20	              EXEC CICS ABEND	0	0	1
20000449	20	                 ABCODE ('WPV6')	0	0	1
20000450	20	              END-EXEC	0	0	1
20000452	20	           END-IF.	0	0	1
20000454	20	           MOVE CUSTOMER-EYECATCHER TO WS-STOREDC-EYECATCHER	0	0	1
20000455	20	                                        COMM-EYE IN DFHCOMMAREA.	0	0	1
20000456	20	           MOVE CUSTOMER-SORTCODE   TO WS-STOREDC-SORTCODE	0	0	1
20000457	20	                                       COMM-SCODE IN DFHCOMMAREA.	0	0	1
20000458	20	           MOVE CUSTOMER-NUMBER OF CUSTOMER-RECORD	0	0	1
20000459	20	              TO WS-STOREDC-NUMBER COMM-CUSTNO IN DFHCOMMAREA.	0	0	1
20000460	20	           MOVE CUSTOMER-NAME       TO WS-STOREDC-NAME	0	0	1
20000461	20	                                       COMM-NAME IN DFHCOMMAREA.	0	0	1
20000462	20	           MOVE CUSTOMER-ADDRESS    TO WS-STOREDC-ADDRESS	0	0	1
20000463	20	                                       COMM-ADDR IN DFHCOMMAREA.	0	0	1
20000464	20	           MOVE CUSTOMER-DATE-OF-BIRTH(1:2)	0	0	1
20000465	20	              TO WS-STOREDC-DATE-OF-BIRTH(1:2)	0	0	1
20000466	20	                 COMM-BIRTH-DAY IN DFHCOMMAREA.	0	0	1
20000467	20	           MOVE '/'                 TO WS-STOREDC-DATE-OF-BIRTH(3:1).	0	0	1
20000468	20	           MOVE CUSTOMER-DATE-OF-BIRTH(3:2)	0	0	1
20000469	20	              TO WS-STOREDC-DATE-OF-BIRTH(4:2)	0	0	1
20000470	20	                 COMM-BIRTH-MONTH IN DFHCOMMAREA.	0	0	1
20000471	20	           MOVE '/'                 TO WS-STOREDC-DATE-OF-BIRTH(6:1).	0	0	1
20000473	20	           MOVE CUSTOMER-DATE-OF-BIRTH(5:4)	0	0	1
20000474	20	              TO WS-STOREDC-DATE-OF-BIRTH(7:4)	0	0	1
20000475	20	                 COMM-BIRTH-YEAR IN DFHCOMMAREA.	0	0	1
20000477	20	           MOVE CUSTOMER-CREDIT-SCORE TO WS-STOREDC-CREDIT-SCORE	0	0	1
20000478	20	                                         COMM-CREDIT-SCORE.	0	0	1
20000479	20	           MOVE CUSTOMER-CS-REVIEW-DATE(1:2)	0	0	1
20000480	20	             TO WS-STOREDC-CS-REVIEW-DATE(1:2)	0	0	1
20000481	20	                COMM-CS-REVIEW-DD IN DFHCOMMAREA.	0	0	1
20000482	20	           MOVE '/'                 TO WS-STOREDC-CS-REVIEW-DATE(3:1).	0	0	1
20000483	20	           MOVE CUSTOMER-CS-REVIEW-DATE(3:2)	0	0	1
20000484	20	             TO WS-STOREDC-CS-REVIEW-DATE(4:2)	0	0	1
20000485	20	                COMM-CS-REVIEW-MM IN DFHCOMMAREA.	0	0	1
20000486	20	           MOVE '/'                 TO WS-STOREDC-CS-REVIEW-DATE(6:1).	0	0	1
20000487	20	           MOVE CUSTOMER-CS-REVIEW-DATE(5:4)	0	0	1
20000488	20	             TO WS-STOREDC-CS-REVIEW-DATE(7:4)	0	0	1
20000489	20	                COMM-CS-REVIEW-YYYY IN DFHCOMMAREA.	0	0	1
20000491	20	           EXEC CICS	0	0	1
20000492	20	              DELETE FILE ('CUSTOMER')	0	0	1
20000493	20	              TOKEN(WS-TOKEN)	0	0	1
20000494	20	              RESP(WS-CICS-RESP)	0	0	1
20000495	20	              RESP2(WS-CICS-RESP2)	0	0	1
20000496	20	           END-EXEC.	0	0	1
20000498	20	           IF WS-CICS-RESP = DFHRESP(SYSIDERR)	0	0	1
20000500	20	              PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1	0	0	1
20000501	20	              UNTIL SYSIDERR-RETRY > 100	0	0	1
20000502	20	              OR WS-CICS-RESP = DFHRESP(NORMAL)	0	0	1
20000503	20	              OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)	0	0	1
20000505	20	                 EXEC CICS DELAY FOR SECONDS(3)	0	0	1
20000506	20	                 END-EXEC	0	0	1
20000508	20	                 EXEC CICS DELETE FILE ('CUSTOMER')	0	0	1
20000509	20	                    TOKEN(WS-TOKEN)	0	0	1
20000510	20	                    RESP(WS-CICS-RESP)	0	0	1
20000511	20	                    RESP2(WS-CICS-RESP2)	0	0	1
20000512	20	                 END-EXEC	0	0	1
20000513	20	              END-PERFORM	0	0	1
20000515	20	           END-IF	0	0	1
20000517	20	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
20000518	20	      *	1	0	0
20000519	20	      *       Preserve the RESP and RESP2, then set up the	1	0	1
20000520	20	      *       standard ABEND info before getting the applid,	1	0	1
20000521	20	      *       date/time etc. and linking to the Abend Handler	1	0	1
20000522	20	      *       program.	1	0	1
20000523	20	      *	1	0	1
20000524	20	              INITIALIZE ABNDINFO-REC	0	0	0
20000525	20	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
20000526	20	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
20000527	20	      *	1	0	0
20000528	20	      *       Get supplemental information	1	0	1
20000529	20	      *	1	0	1
20000530	20	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
20000531	20	              END-EXEC	0	0	1
20000533	20	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
20000534	20	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
20000536	20	              PERFORM POPULATE-TIME-DATE	0	0	1
20000538	20	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
20000539	20	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
20000540	20	                    ':' DELIMITED BY SIZE,	0	0	1
20000541	20	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
20000542	20	                     ':' DELIMITED BY SIZE,	0	0	1
20000543	20	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
20000544	20	                     INTO ABND-TIME	0	0	1
20000545	20	              END-STRING	0	0	1
20000547	20	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
20000548	20	              MOVE 'WPV7'      TO ABND-CODE	0	0	1
20000550	20	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
20000551	20	              END-EXEC	0	0	1
20000553	20	              MOVE ZEROS    TO ABND-SQLCODE	0	0	1
20000555	20	              STRING 'DCV010(2) - Unbale to DELETE CUSTOMER VSAM rec '	0	0	1
20000556	20	                    DELIMITED BY SIZE,	0	0	1
20000557	20	                    'for key:' DESIRED-KEY DELIMITED BY SIZE,	0	0	1
20000558	20	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
20000559	20	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
20000560	20	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
20000561	20	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
20000562	20	                    INTO ABND-FREEFORM	0	0	1
20000563	20	              END-STRING	0	0	1
20000565	20	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
20000566	20	                        COMMAREA(ABNDINFO-REC)	0	0	1
20000567	20	              END-EXEC	0	0	1
20000569	20	              DISPLAY 'In DELCUS (DCV010) '	0	0	1
20000570	20	              'UNABLE TO DELETE CUSTOMER VSAM REC'	0	0	1
20000571	20	              ' RESP CODE=' WS-CICS-RESP, ' RESP2=' WS-CICS-RESP2	0	0	1
20000572	20	              'FOR KEY=' DESIRED-KEY	0	0	1
20000574	20	              EXEC CICS ABEND	0	0	1
20000575	20	                 ABCODE ('WPV7')	0	0	1
20000576	20	              END-EXEC	0	0	1
20000578	20	           END-IF.	0	0	1
20000580	20	           PERFORM WRITE-PROCTRAN-CUST.	0	0	1
20000582	20	       DCV999.	0	0	1
20000583	20	           EXIT.	0	0	1
20000586	20	       WRITE-PROCTRAN-CUST SECTION.	0	0	1
20000587	20	       WPC010.	0	0	1
20000589	20	      *	1	0	0
20000590	20	      *    Record the CUSTOMER deletion on PROCTRAN	1	0	1
20000591	20	      *	1	0	1
20000592	20	              PERFORM WRITE-PROCTRAN-CUST-DB2.	0	0	0
20000593	20	       WPC999.	0	0	1
20000594	20	           EXIT.	0	0	1
20000597	20	       WRITE-PROCTRAN-CUST-DB2 SECTION.	0	0	1
20000598	20	       WPCD010.	0	0	1
20000600	20	           INITIALIZE HOST-PROCTRAN-ROW.	0	0	1
20000601	20	           INITIALIZE WS-EIBTASKN12.	0	0	1
20000603	20	           MOVE 'PRTR' TO HV-PROCTRAN-EYECATCHER.	0	0	1
20000604	20	           MOVE WS-STOREDC-SORTCODE	0	0	1
20000605	20	              TO HV-PROCTRAN-SORT-CODE.	0	0	1
20000606	20	           MOVE ZEROS TO HV-PROCTRAN-ACC-NUMBER.	0	0	1
20000607	20	           MOVE EIBTASKN TO WS-EIBTASKN12.	0	0	1
20000608	20	           MOVE WS-EIBTASKN12 TO HV-PROCTRAN-REF.	0	0	1
20000610	20	      *	1	0	0
20000611	20	      * Populate the time and date	1	0	1
20000612	20	      *	1	0	1
20000613	20	           EXEC CICS ASKTIME	0	0	0
20000614	20	              ABSTIME(WS-U-TIME)	0	0	1
20000615	20	           END-EXEC.	0	0	1
20000617	20	           EXEC CICS FORMATTIME	0	0	1
20000618	20	                     ABSTIME(WS-U-TIME)	0	0	1
20000619	20	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
20000620	20	                     TIME(HV-PROCTRAN-TIME)	0	0	1
20000621	20	                     DATESEP('.')	0	0	1
20000622	20	           END-EXEC.	0	0	1
20000624	20	           MOVE WS-ORIG-DATE TO WS-ORIG-DATE-GRP-X.	0	0	1
20000625	20	           MOVE WS-ORIG-DATE-GRP-X TO HV-PROCTRAN-DATE.	0	0	1
20000627	20	           MOVE WS-STOREDC-SORTCODE      TO HV-PROCTRAN-DESC(1:6).	0	0	1
20000628	20	           MOVE WS-STOREDC-NUMBER        TO HV-PROCTRAN-DESC(7:10).	0	0	1
20000629	20	           MOVE WS-STOREDC-NAME          TO HV-PROCTRAN-DESC(17:14).	0	0	1
20000630	20	           MOVE WS-STOREDC-DATE-OF-BIRTH TO HV-PROCTRAN-DESC(31:10).	0	0	1
20000632	20	           MOVE 'ODC'         TO HV-PROCTRAN-TYPE.	0	0	1
20000633	20	           MOVE ZEROS         TO HV-PROCTRAN-AMOUNT.	0	0	1
20000636	20	           EXEC SQL	0	0	1
20000637	20	              INSERT INTO PROCTRAN	0	0	1
20000638	20	                     (	0	0	1
20000639	20	                      PROCTRAN_EYECATCHER,	0	0	1
20000640	20	                      PROCTRAN_SORTCODE,	0	0	1
20000641	20	                      PROCTRAN_NUMBER,	0	0	1
20000642	20	                      PROCTRAN_DATE,	0	0	1
20000643	20	                      PROCTRAN_TIME,	0	0	1
20000644	20	                      PROCTRAN_REF,	0	0	1
20000645	20	                      PROCTRAN_TYPE,	0	0	1
20000646	20	                      PROCTRAN_DESC,	0	0	1
20000647	20	                      PROCTRAN_AMOUNT	0	0	1
20000648	20	                     )	0	0	1
20000649	20	              VALUES	0	0	1
20000650	20	                     (	0	0	1
20000651	20	                      :HV-PROCTRAN-EYECATCHER,	0	0	1
20000652	20	                      :HV-PROCTRAN-SORT-CODE,	0	0	1
20000653	20	                      :HV-PROCTRAN-ACC-NUMBER,	0	0	1
20000654	20	                      :HV-PROCTRAN-DATE,	0	0	1
20000655	20	                      :HV-PROCTRAN-TIME,	0	0	1
20000656	20	                      :HV-PROCTRAN-REF,	0	0	1
20000657	20	                      :HV-PROCTRAN-TYPE,	0	0	1
20000658	20	                      :HV-PROCTRAN-DESC,	0	0	1
20000659	20	                      :HV-PROCTRAN-AMOUNT	0	0	1
20000660	20	                     )	0	0	1
20000661	20	           END-EXEC.	0	0	1
20000663	20	      *	1	0	0
20000664	20	      * Check the SQLCODE	1	0	1
20000665	20	      *	1	0	1
20000666	20	           IF SQLCODE NOT = 0	0	0	0
20000667	20	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
20000668	20	      *	1	0	0
20000669	20	      *       Preserve the RESP and RESP2, then set up the	1	0	1
20000670	20	      *       standard ABEND info before getting the applid,	1	0	1
20000671	20	      *       date/time etc. and linking to the Abend Handler	1	0	1
20000672	20	      *       program.	1	0	1
20000673	20	      *	1	0	1
20000674	20	              INITIALIZE ABNDINFO-REC	0	0	0
20000675	20	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
20000676	20	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
20000677	20	      *	1	0	0
20000678	20	      *       Get supplemental information	1	0	1
20000679	20	      *	1	0	1
20000680	20	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
20000681	20	              END-EXEC	0	0	1
20000683	20	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
20000684	20	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
20000686	20	              PERFORM POPULATE-TIME-DATE	0	0	1
20000688	20	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
20000689	20	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
20000690	20	                    ':' DELIMITED BY SIZE,	0	0	1
20000691	20	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
20000692	20	                     ':' DELIMITED BY SIZE,	0	0	1
20000693	20	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
20000694	20	                     INTO ABND-TIME	0	0	1
20000695	20	              END-STRING	0	0	1
20000697	20	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
20000698	20	              MOVE 'HWPT'      TO ABND-CODE	0	0	1
20000700	20	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
20000701	20	              END-EXEC	0	0	1
20000703	20	              MOVE SQLCODE-DISPLAY   TO ABND-SQLCODE	0	0	1
20000705	20	              STRING 'WPCD010 - Unable to WRITE to PROCTRAN DB2 '	0	0	1
20000706	20	                    DELIMITED BY SIZE,	0	0	1
20000707	20	                    'datastore with the following data:'	0	0	1
20000708	20	                    DELIMITED BY SIZE,	0	0	1
20000709	20	                    HOST-PROCTRAN-ROW DELIMITED BY SIZE,	0	0	1
20000710	20	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
20000711	20	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
20000712	20	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
20000713	20	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
20000714	20	                    INTO ABND-FREEFORM	0	0	1
20000715	20	              END-STRING	0	0	1
20000717	20	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
20000718	20	                        COMMAREA(ABNDINFO-REC)	0	0	1
20000719	20	              END-EXEC	0	0	1
20000721	20	              DISPLAY 'In DELCUS(WPCD010) '	0	0	1
20000722	20	              'UNABLE TO WRITE TO PROCTRAN DB2 DATASTORE'	0	0	1
20000723	20	              ' SQLCODE=' SQLCODE-DISPLAY	0	0	1
20000724	20	              'WITH THE FOLLOWING DATA:' HOST-PROCTRAN-ROW	0	0	1
20000726	20	              EXEC CICS ABEND	0	0	1
20000727	20	                 ABCODE('HWPT')	0	0	1
20000728	20	                 NODUMP	0	0	1
20000729	20	              END-EXEC	0	0	1
20000731	20	           END-IF.	0	0	1
20000733	20	       WPCD999.	0	0	1
20000734	20	           EXIT.	0	0	1
20000737	20	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
20000738	20	       GMOFH010.	0	0	1
20000740	20	           GOBACK.	0	0	1
20000742	20	       GMOFH999.	0	0	1
20000743	20	           EXIT.	0	0	1
20000746	20	       POPULATE-TIME-DATE SECTION.	0	0	1
20000747	20	       PTD010.	0	0	1
20000749	20	           EXEC CICS ASKTIME	0	0	1
20000750	20	              ABSTIME(WS-U-TIME)	0	0	1
20000751	20	           END-EXEC.	0	0	1
20000753	20	           EXEC CICS FORMATTIME	0	0	1
20000754	20	                     ABSTIME(WS-U-TIME)	0	0	1
20000755	20	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
20000756	20	                     TIME(WS-TIME-NOW)	0	0	1
20000757	20	                     DATESEP	0	0	1
20000758	20	           END-EXEC.	0	0	1
20000760	20	       PTD999.	0	0	1
20000761	20	           EXIT.	0	0	1
21000000	21	<<<< file not found >>>>	0	0	0
21000001	21	<<<< file not found >>>>	0	0	0
22000000	22	<<<< file not found >>>>	0	0	0
22000001	22	<<<< file not found >>>>	0	0	0
23000000	23	<<<< file not found >>>>	0	0	0
23000001	23	<<<< file not found >>>>	0	0	0
24000000	24	<<<< file not found >>>>	0	0	0
24000001	24	<<<< file not found >>>>	0	0	0
25000000	25	<<<< file not found >>>>	0	0	0
25000001	25	<<<< file not found >>>>	0	0	0
26000001	26	       CBL CICS('SP,EDF')	0	0	1
26000002	26	      ******************************************************************	1	0	0
26000003	26	      *                                                                *	1	0	1
26000004	26	      *  Copyright IBM Corp. 2023                                      *	1	0	1
26000005	26	      *                                                                *	1	0	1
26000006	26	      ******************************************************************	1	0	1
26000007	26	       IDENTIFICATION DIVISION.	0	0	0
26000008	26	       PROGRAM-ID. GETSCODE.	0	0	1
26000009	26	       AUTHOR. James O'Grady.	0	0	1
26000012	26	       ENVIRONMENT DIVISION.	0	0	1
26000013	26	       CONFIGURATION SECTION.	0	0	1
26000014	26	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
26000015	26	       SOURCE-COMPUTER.  IBM-370.	0	0	0
26000016	26	       OBJECT-COMPUTER.  IBM-370.	0	0	1
26000018	26	       INPUT-OUTPUT SECTION.	0	0	1
26000021	26	       DATA DIVISION.	0	0	1
26000022	26	       FILE SECTION.	0	0	1
26000025	26	       WORKING-STORAGE SECTION.	0	0	1
26000028	26	       COPY SORTCODE REPLACING ==SORTCODE== BY ==LITERAL-SORTCODE==.	0	0	1
26000031	26	       LINKAGE SECTION.	0	0	1
26000032	26	       01 DFHCOMMAREA.	0	0	1
26000033	26	           COPY GETSCODE.	0	0	1
26000036	26	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
26000037	26	       PREMIERE SECTION.	0	0	1
26000038	26	       A010.	0	0	1
26000039	26	           MOVE LITERAL-SORTCODE	0	0	1
26000040	26	           TO SORTCODE OF DFHCOMMAREA.	0	0	1
26000043	26	           EXEC CICS RETURN	0	0	1
26000044	26	           END-EXEC.	0	0	1
26000046	26	           GOBACK.	0	0	1
27000000	27	<<<< file not found >>>>	0	0	0
27000001	27	<<<< file not found >>>>	0	0	0
28000001	28	       CBL CICS('SP,EDF')	0	0	1
28000002	28	       CBL SQL	0	0	1
28000003	28	      ******************************************************************	1	0	0
28000004	28	      *                                                                *	1	0	1
28000005	28	      *  Copyright IBM Corp. 2023                                      *	1	0	1
28000006	28	      *                                                                *	1	0	1
28000007	28	      ******************************************************************	1	0	1
28000008	28	      ******************************************************************	1	0	1
28000009	28	      * This program takes customer information from the BMS	1	0	1
28000010	28	      * application (name, address and DOB) and should get the SORTCODE,	1	0	1
28000011	28	      * determine which datastore to use (VSAM or DB2), then enqueue	1	0	1
28000012	28	      * the counter for CUSTOMER, increment the counter and get	1	0	1
28000013	28	      * that number.	1	0	1
28000014	28	      *	1	0	1
28000015	28	      * It then performs a credit check on multiple	1	0	1
28000016	28	      * credit agencies (using Async API), waits for 3 seconds and	1	0	1
28000017	28	      * aggregates and averages the returned credit scores.	1	0	1
28000018	28	      *	1	0	1
28000019	28	      * If no data is returned, from the credit checks, then	1	0	1
28000020	28	      * set the credit score to 0 and mark the credit	1	0	1
28000021	28	      * score review date as today (so another attempt at credit	1	0	1
28000022	28	      * scoring will be carried out later).	1	0	1
28000023	28	      *	1	0	1
28000024	28	      * Next, attempt to update the CUSTOMER datastore & if that is	1	0	1
28000025	28	      * successful, write a rec to the PROCTRAN datastore.	1	0	1
28000026	28	      *	1	0	1
28000027	28	      * If all of that works, then DEQUEUE the named counter	1	0	1
28000028	28	      * and return the SORTCODE and CUSTOMER number.	1	0	1
28000029	28	      *	1	0	1
28000030	28	      * If for any reason the write to the CUSTOMER or PROCTRAN	1	0	1
28000031	28	      * datatsore is unsuccessful, then we need to decrement the Named	1	0	1
28000032	28	      * Counter (restoring it to the start position) and DEQUEUE the	1	0	1
28000033	28	      * Named Counter.	1	0	1
28000034	28	      *	1	0	1
28000035	28	      ******************************************************************	1	0	1
28000037	28	       IDENTIFICATION DIVISION.	0	0	0
28000038	28	       PROGRAM-ID. CRECUST.	0	0	1
28000039	28	       AUTHOR. Jon Collett.	0	0	1
28000041	28	       ENVIRONMENT DIVISION.	0	0	1
28000042	28	       CONFIGURATION SECTION.	0	0	1
28000043	28	      * SOURCE-COMPUTER.  IBM-370 WITH DEBUGGING MODE.	1	0	0
28000044	28	       SOURCE-COMPUTER.  IBM-370.	0	0	0
28000045	28	       OBJECT-COMPUTER.  IBM-370.	0	0	1
28000047	28	       INPUT-OUTPUT SECTION.	0	0	1
28000049	28	       DATA DIVISION.	0	0	1
28000050	28	       FILE SECTION.	0	0	1
28000052	28	       WORKING-STORAGE SECTION.	0	0	1
28000055	28	       COPY SORTCODE.	0	0	1
28000059	28	       01 SYSIDERR-RETRY                PIC 999.	0	0	1
28000061	28	      * PROCTRAN DB2 copybook	1	0	0
28000062	28	          EXEC SQL	0	0	0
28000063	28	             INCLUDE PROCDB2	0	0	1
28000064	28	          END-EXEC.	0	0	1
28000066	28	      * PROCTRAN host variables for DB2	1	0	0
28000067	28	       01 HOST-PROCTRAN-ROW.	0	0	0
28000068	28	          03 HV-PROCTRAN-EYECATCHER     PIC X(4).	0	0	1
28000069	28	          03 HV-PROCTRAN-SORT-CODE      PIC X(6).	0	0	1
28000070	28	          03 HV-PROCTRAN-ACC-NUMBER     PIC X(8).	0	0	1
28000071	28	          03 HV-PROCTRAN-DATE           PIC X(10).	0	0	1
28000072	28	          03 HV-PROCTRAN-TIME           PIC X(6).	0	0	1
28000073	28	          03 HV-PROCTRAN-REF            PIC X(12).	0	0	1
28000074	28	          03 HV-PROCTRAN-TYPE           PIC X(3).	0	0	1
28000075	28	          03 HV-PROCTRAN-DESC           PIC X(40).	0	0	1
28000076	28	          03 HV-PROCTRAN-AMOUNT         PIC S9(10)V99 COMP-3.	0	0	1
28000078	28	      * Pull in the SQL COMMAREA	1	0	0
28000079	28	       EXEC SQL	0	0	0
28000080	28	          INCLUDE SQLCA	0	0	1
28000081	28	       END-EXEC.	0	0	1
28000083	28	       01 PROCTRAN-AREA.	0	0	1
28000084	28	          COPY PROCTRAN.	0	0	1
28000086	28	       01 PROCTRAN-RIDFLD               PIC S9(8) COMP.	0	0	1
28000088	28	       01 WS-CICS-WORK-AREA.	0	0	1
28000089	28	          05 WS-CICS-RESP               PIC S9(8) COMP.	0	0	1
28000090	28	          05 WS-CICS-RESP2              PIC S9(8) COMP.	0	0	1
28000092	28	       01 WS-CUSTOMER-NO-NUM            PIC 9(10).	0	0	1
28000094	28	       01 WS-TIME-DATA.	0	0	1
28000095	28	          03 WS-TIME-NOW                PIC 9(6).	0	0	1
28000096	28	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
28000097	28	             05 WS-TIME-NOW-GRP-HH      PIC 99.	0	0	1
28000098	28	             05 WS-TIME-NOW-GRP-MM      PIC 99.	0	0	1
28000099	28	             05 WS-TIME-NOW-GRP-SS      PIC 99.	0	0	1
28000101	28	       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.	0	0	1
28000102	28	       01 ABNDINFO-REC.	0	0	1
28000103	28	           COPY ABNDINFO.	0	0	1
28000105	28	       LOCAL-STORAGE SECTION.	0	0	1
28000106	28	       01 FILE-RETRY                    PIC 999.	0	0	1
28000107	28	       01 WS-EXIT-RETRY-LOOP            PIC X         VALUE ' '.	0	0	1
28000109	28	       01 OUTPUT-DATA.	0	0	1
28000110	28	           COPY CUSTOMER.	0	0	1
28000112	28	       01 RETURN-DATA.	0	0	1
28000113	28	          03 RETURN-DATA-EYECATCHER     PIC X(4).	0	0	1
28000114	28	          03 RETURN-DATA-NUMBER         PIC 9(10) DISPLAY.	0	0	1
28000115	28	          03 RETURN-DATA-NAME           PIC X(60).	0	0	1
28000116	28	          03 RETURN-DATA-ADDRESS        PIC X(160).	0	0	1
28000117	28	          03 RETURN-DATA-DATE-OF-BIRTH  PIC 9(8).	0	0	1
28000120	28	       01 CUSTOMER-KY.	0	0	1
28000121	28	          03 REQUIRED-SORT-CODE         PIC 9(6)      VALUE 0.	0	0	1
28000122	28	          03 REQUIRED-CUST-NUMBER       PIC 9(10)     VALUE 0.	0	0	1
28000124	28	       01 RANDOM-CUSTOMER               PIC 9(10)     VALUE 0.	0	0	1
28000125	28	       01 HIGHEST-CUST-NUMBER           PIC 9(10)     VALUE 0.	0	0	1
28000127	28	       01 EXIT-VSAM-READ                PIC X         VALUE 'N'.	0	0	1
28000128	28	       01 EXIT-DB2-READ                 PIC X         VALUE 'N'.	0	0	1
28000130	28	       01 WS-V-RETRIED                  PIC X         VALUE 'N'.	0	0	1
28000131	28	       01 WS-D-RETRIED                  PIC X         VALUE 'N'.	0	0	1
28000133	28	       01 SQLCODE-DISPLAY               PIC S9(8) DISPLAY	0	0	1
28000134	28	             SIGN LEADING SEPARATE.	0	0	1
28000137	28	      *	1	0	0
28000138	28	      * CUSTOMER NCS definitions	1	0	1
28000139	28	      *	1	0	1
28000140	28	       01 NCS-CUST-NO-STUFF.	0	0	0
28000141	28	          03 NCS-CUST-NO-NAME.	0	0	1
28000142	28	             05 NCS-CUST-NO-ACT-NAME    PIC X(8)	0	0	1
28000143	28	                                                      VALUE 'CBSACUST'.	0	0	1
28000144	28	             05 NCS-CUST-NO-TEST-SORT   PIC X(6)	0	0	1
28000145	28	                                                      VALUE '      '.	0	0	1
28000146	28	             05 NCS-CUST-NO-FILL        PIC XX	0	0	1
28000147	28	                                                      VALUE '  '.	0	0	1
28000149	28	          03 NCS-CUST-NO-INC            PIC 9(16) COMP	0	0	1
28000150	28	                                                      VALUE 0.	0	0	1
28000151	28	          03 NCS-CUST-NO-VALUE          PIC 9(16) COMP	0	0	1
28000152	28	                                                      VALUE 0.	0	0	1
28000154	28	          03 NCS-CUST-NO-RESP           PIC XX        VALUE '00'.	0	0	1
28000156	28	       01 WS-DISP-CUST-NO-VAL           PIC S9(18) DISPLAY.	0	0	1
28000158	28	       01 WS-CUST-REC-LEN               PIC S9(4) COMP	0	0	1
28000159	28	                                                      VALUE 0.	0	0	1
28000161	28	       01 NCS-UPDATED                   PIC X         VALUE 'N'.	0	0	1
28000163	28	       01 WS-U-TIME                     PIC S9(15) COMP-3.	0	0	1
28000164	28	       01 WS-ORIG-DATE                  PIC X(10).	0	0	1
28000165	28	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
28000166	28	          03 WS-ORIG-DATE-DD            PIC 99.	0	0	1
28000167	28	          03 FILLER                     PIC X.	0	0	1
28000168	28	          03 WS-ORIG-DATE-MM            PIC 99.	0	0	1
28000169	28	          03 FILLER                     PIC X.	0	0	1
28000170	28	          03 WS-ORIG-DATE-YYYY          PIC 9999.	0	0	1
28000172	28	       01 WS-ORIG-DATE-GRP-X.	0	0	1
28000173	28	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
28000174	28	          03 FILLER                     PIC X         VALUE '.'.	0	0	1
28000175	28	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
28000176	28	          03 FILLER                     PIC X         VALUE '.'.	0	0	1
28000177	28	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
28000179	28	       01 STORED-SORTCODE               PIC X(6)      VALUE SPACES.	0	0	1
28000180	28	       01 STORED-CUSTNO                 PIC X(10)     VALUE SPACES.	0	0	1
28000181	28	       01 STORED-NAME                   PIC X(60)     VALUE SPACES.	0	0	1
28000182	28	       01 STORED-DOB                    PIC X(10)     VALUE SPACES.	0	0	1
28000184	28	       01 WS-EIBTASKN12                 PIC 9(12)     VALUE 0.	0	0	1
28000185	28	       77 PROCTRAN-RETRY                PIC 999.	0	0	1
28000187	28	       01 CUSTOMER-KY2.	0	0	1
28000188	28	          03 REQUIRED-SORT-CODE2        PIC 9(6)      VALUE 0.	0	0	1
28000189	28	          03 REQUIRED-CUST-NUMBER2      PIC 9(10)     VALUE 0.	0	0	1
28000191	28	       01 CUSTOMER-KY2-BYTES REDEFINES CUSTOMER-KY2	0	0	1
28000192	28	                                        PIC X(16).	0	0	1
28000194	28	       01 HIGHEST-CUST-NUMBER           PIC 9(10)     VALUE 0.	0	0	1
28000195	28	       01 WS-CC-CNT                     PIC 9         VALUE 0.	0	0	1
28000196	28	       01 WS-FINISHED-FETCHING          PIC X         VALUE 'N'.	0	0	1
28000197	28	       01 WS-RETRIEVED-CNT              PIC 9         VALUE 0.	0	0	1
28000198	28	       01 WS-CHANNEL-NAME               PIC X(16)     VALUE SPACES.	0	0	1
28000199	28	       01 WS-CREDIT-CHECK-ERROR         PIC X         VALUE 'N'.	0	0	1
28000200	28	       01 WS-ACTUAL-CS-SCR              PIC 9(6)      VALUE 0.	0	0	1
28000201	28	       01 WS-TOTAL-CS-SCR               PIC 9(6)      VALUE 0.	0	0	1
28000203	28	       01 WS-CHILD-TOKENS.	0	0	1
28000204	28	          03 WS-ANY-CHILD-TKN           PIC X(16).	0	0	1
28000205	28	          03 WS-ANY-CHILD-FETCH-TKN     PIC X(16).	0	0	1
28000207	28	       01 WS-ANY-CHILD-FETCH-CHAN       PIC X(16).	0	0	1
28000208	28	       01 WS-ANY-CHILD-FETCH-ABCODE     PIC X(4)      VALUE SPACES.	0	0	1
28000209	28	       01 WS-CHILD-ISSUED-CNT           PIC 9         VALUE 0.	0	0	1
28000211	28	       01 WS-CHILD-ARRAY.	0	0	1
28000212	28	          03 WS-CHILD-DETAILS OCCURS 9 TIMES.	0	0	1
28000213	28	             05 WS-CHILD-CHAN           PIC X(16).	0	0	1
28000214	28	             05 WS-CHILD-TKN            PIC X(16).	0	0	1
28000216	28	       01 WS-CHILD-RECEIVED-CNT         PIC 9         VALUE 0.	0	0	1
28000217	28	       01 WS-RECEIVE-CHILD-ARRAY.	0	0	1
28000218	28	          03 WS-RECEIVE-CHILD-DTLS OCCURS 9 TIMES.	0	0	1
28000219	28	             05 WS-RECEIVE-CHILD-CHAN   PIC X(16).	0	0	1
28000221	28	       01 WS-CHILD-FETCH-COMPST         PIC S9(8) COMP.	0	0	1
28000223	28	       01 WS-CHILD-DATA.	0	0	1
28000224	28	          03 WS-CHILD-DATA-EYECATCHER   PIC X(4).	0	0	1
28000225	28	          03 WS-CHLD-DATA-KEY.	0	0	1
28000226	28	             05 WS-CHILD-DATA-SORTCODE  PIC 9(6) DISPLAY.	0	0	1
28000227	28	             05 WS-CHILD-DATA-NUMBER    PIC 9(10) DISPLAY.	0	0	1
28000228	28	          03 WS-CHILD-DATA-NAME         PIC X(60).	0	0	1
28000229	28	          03 WS-CHILD-DATA-ADDRESS      PIC X(160).	0	0	1
28000230	28	          03 WS-CHILD-DATA-DATE-OF-BIRTH	0	0	1
28000231	28	                                        PIC 9(8).	0	0	1
28000232	28	          03 WS-CHILD-DATA-DOB-GROUP	0	0	1
28000233	28	                REDEFINES WS-CHILD-DATA-DATE-OF-BIRTH.	0	0	1
28000234	28	             05 WS-CHILD-DATA-BIRTH-DAY PIC 99.	0	0	1
28000235	28	             05 WS-CHILD-DATA-BIRTH-MONTH	0	0	1
28000236	28	                                        PIC 99.	0	0	1
28000237	28	             05 WS-CHILD-DATA-BIRTH-YEAR	0	0	1
28000238	28	                                        PIC 9999.	0	0	1
28000239	28	          03 WS-CHILD-DATA-CREDIT-SCORE PIC 999.	0	0	1
28000240	28	          03 WS-CHILD-DATA-CS-REVIEW-DATE	0	0	1
28000241	28	                                        PIC 9(8).	0	0	1
28000242	28	          03 WS-CHILD-DATA-SUCCESS      PIC X.	0	0	1
28000243	28	          03 WS-CHILD-DATA-FAIL-CODE    PIC X.	0	0	1
28000245	28	       01 WS-CONTAINER-NAME             PIC X(16)     VALUE SPACES.	0	0	1
28000246	28	       01 WS-CHILD-CONTAINER-LEN        PIC S9(8) COMP	0	0	1
28000247	28	                                                      VALUE 0.	0	0	1
28000248	28	       01 WS-RUN-TRANSID                PIC X(4)      VALUE SPACES.	0	0	1
28000250	28	       01 CICSTSLEVEL                   PIC X(6)      VALUE SPACES.	0	0	1
28000252	28	       01 WS-CICSTS-LEVEL-DATA.	0	0	1
28000253	28	          03 WS-CICSTSLEVEL             PIC X(6).	0	0	1
28000254	28	          03 WS-CICSTS-LEVEL-NUM-GRP REDEFINES WS-CICSTSLEVEL.	0	0	1
28000255	28	             05 WS-CICSTS-LEVEL-NUM-VV  PIC 99.	0	0	1
28000256	28	             05 WS-CICSTS-LEVEL-NUM-RR  PIC 99.	0	0	1
28000257	28	             05 WS-CICSTS-LEVEL-NUM-MM  PIC 99.	0	0	1
28000259	28	       01 WS-CURRENT-DATE-DATA.	0	0	1
28000260	28	          03 WS-CURRENT-DATE.	0	0	1
28000261	28	             05 WS-CURRENT-YYYY         PIC 9(4).	0	0	1
28000262	28	             05 WS-CURRENT-MM           PIC 99.	0	0	1
28000263	28	             05 WS-CURRENT-DD           PIC 99.	0	0	1
28000264	28	          03 WS-CURRENT-TIME.	0	0	1
28000265	28	             05 WS-CURRENT-HOURS        PIC 99.	0	0	1
28000266	28	             05 WS-CURRENT-MINS         PIC 99.	0	0	1
28000267	28	             05 WS-CURRENT-SECS         PIC 99.	0	0	1
28000268	28	             05 WS-CURRENT-MILLI        PIC 99.	0	0	1
28000269	28	          03 WS-DIFFERENCE-FROM-GMT     PIC S9(4).	0	0	1
28000271	28	       01 WS-CURRENT-DATE-9             PIC 9(8)      VALUE 0.	0	0	1
28000272	28	       01 WS-TODAY-INT                  PIC 9(8)      VALUE 0.	0	0	1
28000273	28	       01 WS-REVIEW-DATE-ADD            PIC 99        VALUE 0.	0	0	1
28000274	28	       01 WS-NEW-REVIEW-DATE-INT        PIC 9(8)      VALUE 0.	0	0	1
28000275	28	       01 WS-NEW-REVIEW-YYYYMMDD        PIC 9(8)      VALUE 0.	0	0	1
28000276	28	       01 WS-PUT-CONT-NAME              PIC X(16)     VALUE SPACES.	0	0	1
28000277	28	       01 WS-PUT-CONT-LEN               PIC S9(8) COMP	0	0	1
28000278	28	                                                      VALUE 0.	0	0	1
28000280	28	       01 WS-SEED                       PIC S9(15) COMP.	0	0	1
28000282	28	       01 STORM-DRAIN-CONDITION         PIC X(20).	0	0	1
28000284	28	       01 WS-DATE-OF-BIRTH-ERROR        PIC X         VALUE 'N'.	0	0	1
28000285	28	       01 WS-DATE-OF-BIRTH-LILLIAN      PIC S9(9) BINARY.	0	0	1
28000287	28	       01 DATE-OF-BIRTH-FORMAT.	0	0	1
28000288	28	          03 DATE-OF-BIRTH-FORMAT-LENGTH	0	0	1
28000289	28	                                        PIC S9(4) BINARY	0	0	1
28000290	28	                                                      VALUE 10.	0	0	1
28000291	28	          03 DATE-OF-BIRTH-FORMAT-TEXT  PIC X(8)      VALUE 'YYYYMMDD'.	0	0	1
28000293	28	       01 DATE-OF-BIRTH-FOR-CEEDAYS.	0	0	1
28000294	28	          03 DATE-OF-BIRTH-CEEDAYS-LENGTH	0	0	1
28000295	28	                                        PIC S9(4) BINARY	0	0	1
28000296	28	                                                      VALUE 10.	0	0	1
28000297	28	          03 CEEDAYS-YEAR               PIC 9999.	0	0	1
28000298	28	          03 CEEDAYS-MONTH              PIC 99.	0	0	1
28000299	28	          03 CEEDAYS-DAY                PIC 99.	0	0	1
28000301	28	       01 FC.	0	0	1
28000302	28	          02 CONDITION-TOKEN-VALUE.	0	0	1
28000303	28	           COPY  CEEIGZCT.	0	0	1
28000304	28	             03 CASE-1-CONDITION-ID.	0	0	1
28000305	28	                04 SEVERITY             PIC S9(4) BINARY.	0	0	1
28000306	28	                04 MSG-NO               PIC S9(4) BINARY.	0	0	1
28000307	28	             03 CASE-2-CONDITION-ID	0	0	1
28000308	28	                   REDEFINES CASE-1-CONDITION-ID.	0	0	1
28000309	28	                04 CLASS-CODE           PIC S9(4) BINARY.	0	0	1
28000310	28	                04 CAUSE-CODE           PIC S9(4) BINARY.	0	0	1
28000311	28	             03 CASE-SEV-CTL            PIC X.	0	0	1
28000312	28	             03 FACILITY-ID             PIC XXX.	0	0	1
28000313	28	          02 I-S-INFO                   PIC S9(9) BINARY.	0	0	1
28000315	28	       01 WS-TODAY-LILLIAN              PIC S9(9) BINARY.	0	0	1
28000316	28	       01 WS-TODAY-SECONDS COMP-2.	0	0	1
28000317	28	       01 WS-TODAY-GREGORIAN.	0	0	1
28000318	28	          03 WS-TODAY-G-YEAR            PIC 9(4).	0	0	1
28000319	28	          03 WS-TODAY-G-MONTH           PIC 9(2).	0	0	1
28000320	28	          03 WS-TODAY-G-DAY             PIC 9(2).	0	0	1
28000321	28	          03 WS-TODAY-G-HOURS           PIC 9(2).	0	0	1
28000322	28	          03 WS-TODAY-G-MINUTES         PIC 9(2).	0	0	1
28000323	28	          03 WS-TODAY-G-SECONDS         PIC 9(2).	0	0	1
28000324	28	          03 WS-TODAY-G-MILLISECONDS    PIC 999.	0	0	1
28000326	28	       01 CHRDATE.	0	0	1
28000327	28	          02 VSTRING-LENGTH             PIC S9(4) BINARY.	0	0	1
28000328	28	          02 VSTRING-TEXT.	0	0	1
28000329	28	             03 VSTRING-CHAR            PIC X	0	0	1
28000330	28	                   OCCURS 0 TO 256 TIMES	0	0	1
28000331	28	                   DEPENDING ON VSTRING-LENGTH	0	0	1
28000332	28	                   OF CHRDATE.	0	0	1
28000333	28	       01 PICSTR.	0	0	1
28000334	28	          02 VSTRING-LENGTH             PIC S9(4) BINARY.	0	0	1
28000335	28	          02 VSTRING-TEXT.	0	0	1
28000336	28	             03 VSTRING-CHAR            PIC X	0	0	1
28000337	28	                   OCCURS 0 TO 256 TIMES	0	0	1
28000338	28	                   DEPENDING ON VSTRING-LENGTH	0	0	1
28000339	28	                   OF PICSTR.	0	0	1
28000340	28	       01 LILIAN                        PIC S9(9) BINARY.	0	0	1
28000342	28	       01 WS-CUSTOMER-AGE               PIC S9999.	0	0	1
28000344	28	       01 CUSTOMER-CONTROL.	0	0	1
28000345	28	           COPY CUSTCTRL.	0	0	1
28000348	28	       LINKAGE SECTION.	0	0	1
28000349	28	       01 DFHCOMMAREA.	0	0	1
28000350	28	           COPY CRECUST.	0	0	1
28000353	28	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
28000354	28	       PREMIERE SECTION.	0	0	1
28000355	28	       P010.	0	0	1
28000357	28	           MOVE SORTCODE TO REQUIRED-SORT-CODE.	0	0	1
28000360	28	      *	1	0	0
28000361	28	      *    Derive the date and time	1	0	1
28000362	28	      *	1	0	1
28000364	28	           PERFORM POPULATE-TIME-DATE.	0	0	0
28000366	28	      *	1	0	0
28000367	28	      *    Perform the Asynchronous credit check	1	0	1
28000368	28	      *	1	0	1
28000369	28	           PERFORM CREDIT-CHECK.	0	0	0
28000371	28	           IF WS-CREDIT-CHECK-ERROR = 'Y'	0	0	1
28000372	28	              MOVE 0 TO COMM-CREDIT-SCORE	0	0	1
28000374	28	              STRING WS-ORIG-DATE-DD DELIMITED BY SIZE,	0	0	1
28000375	28	                     WS-ORIG-DATE-MM DELIMITED BY SIZE,	0	0	1
28000376	28	                     WS-ORIG-DATE-YYYY DELIMITED BY SIZE	0	0	1
28000377	28	                     INTO COMM-CS-REVIEW-DATE	0	0	1
28000378	28	              END-STRING	0	0	1
28000380	28	              MOVE 'N' TO COMM-SUCCESS	0	0	1
28000381	28	              MOVE 'G' TO COMM-FAIL-CODE	0	0	1
28000383	28	              DISPLAY 'WS-CREDIT-CHECK-ERROR = Y, '	0	0	1
28000384	28	                       ' RESP='	0	0	1
28000385	28	                       WS-CICS-RESP ' RESP2=' WS-CICS-RESP2	0	0	1
28000386	28	              DISPLAY '   Exiting CRECUST. COMMAREA='	0	0	1
28000387	28	                       DFHCOMMAREA	0	0	1
28000388	28	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000390	28	           END-IF.	0	0	1
28000392	28	           PERFORM DATE-OF-BIRTH-CHECK.	0	0	1
28000394	28	           IF WS-DATE-OF-BIRTH-ERROR = 'Y'	0	0	1
28000396	28	              MOVE 'N' TO COMM-SUCCESS	0	0	1
28000397	28	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000399	28	           END-IF.	0	0	1
28000401	28	      *	1	0	0
28000402	28	      *    Enqueue the named counter for customer	1	0	1
28000403	28	      *	1	0	1
28000404	28	           PERFORM ENQ-NAMED-COUNTER.	0	0	0
28000406	28	      *	1	0	0
28000407	28	      *    Get the next CUSTOMER number from the CUSTOMER Named Counter	1	0	1
28000408	28	      *	1	0	1
28000409	28	           PERFORM UPD-NCS.	0	0	0
28000411	28	      *	1	0	0
28000412	28	      *    Update the datastore	1	0	1
28000413	28	      *	1	0	1
28000414	28	           PERFORM WRITE-CUSTOMER-VSAM.	0	0	0
28000417	28	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
28000419	28	       P999.	0	0	1
28000420	28	           EXIT.	0	0	1
28000423	28	       POPULATE-TIME-DATE SECTION.	0	0	1
28000424	28	       PTD010.	0	0	1
28000426	28	           EXEC CICS ASKTIME	0	0	1
28000427	28	              ABSTIME(WS-U-TIME)	0	0	1
28000428	28	           END-EXEC.	0	0	1
28000430	28	           EXEC CICS FORMATTIME	0	0	1
28000431	28	                     ABSTIME(WS-U-TIME)	0	0	1
28000432	28	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
28000433	28	                     TIME(PROC-TRAN-TIME OF PROCTRAN-AREA )	0	0	1
28000434	28	                     DATESEP	0	0	1
28000435	28	           END-EXEC.	0	0	1
28000437	28	       PTD999.	0	0	1
28000438	28	           EXIT.	0	0	1
28000441	28	       ENQ-NAMED-COUNTER SECTION.	0	0	1
28000442	28	       ENC010.	0	0	1
28000443	28	           MOVE SORTCODE TO	0	0	1
28000444	28	              NCS-CUST-NO-TEST-SORT.	0	0	1
28000446	28	           EXEC CICS ENQ	0	0	1
28000447	28	              RESOURCE(NCS-CUST-NO-NAME)	0	0	1
28000448	28	              LENGTH(16)	0	0	1
28000449	28	              RESP(WS-CICS-RESP)	0	0	1
28000450	28	              RESP2(WS-CICS-RESP2)	0	0	1
28000451	28	           END-EXEC.	0	0	1
28000453	28	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
28000454	28	             MOVE 'N' TO COMM-SUCCESS	0	0	1
28000455	28	             MOVE '3' TO COMM-FAIL-CODE	0	0	1
28000456	28	             PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000457	28	           END-IF.	0	0	1
28000459	28	       ENC999.	0	0	1
28000460	28	           EXIT.	0	0	1
28000463	28	       DEQ-NAMED-COUNTER SECTION.	0	0	1
28000464	28	       DNC010.	0	0	1
28000466	28	           MOVE SORTCODE TO	0	0	1
28000467	28	              NCS-CUST-NO-TEST-SORT.	0	0	1
28000469	28	      D    EXEC CICS ASKTIME ABSTIME(START-DEQ) END-EXEC	0	0	1
28000471	28	           EXEC CICS DEQ	0	0	1
28000472	28	              RESOURCE(NCS-CUST-NO-NAME)	0	0	1
28000473	28	              LENGTH(16)	0	0	1
28000474	28	              RESP(WS-CICS-RESP)	0	0	1
28000475	28	              RESP2(WS-CICS-RESP2)	0	0	1
28000476	28	           END-EXEC.	0	0	1
28000478	28	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
28000479	28	             MOVE 'N' TO COMM-SUCCESS	0	0	1
28000480	28	             MOVE '5' TO COMM-FAIL-CODE	0	0	1
28000481	28	             PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000482	28	           END-IF.	0	0	1
28000484	28	       DNC999.	0	0	1
28000485	28	           EXIT.	0	0	1
28000488	28	       UPD-NCS SECTION.	0	0	1
28000489	28	       UN010.	0	0	1
28000490	28	      *	1	0	0
28000491	28	      *    Update the Named Counter Server	1	0	1
28000492	28	      *	1	0	1
28000493	28	           MOVE 1 TO NCS-CUST-NO-INC.	0	0	0
28000495	28	           PERFORM GET-LAST-CUSTOMER-VSAM	0	0	1
28000497	28	           MOVE 'Y' TO NCS-UPDATED.	0	0	1
28000499	28	       UN999.	0	0	1
28000500	28	           EXIT.	0	0	1
28000505	28	       CREDIT-CHECK SECTION.	0	0	1
28000506	28	       CC010.	0	0	1
28000507	28	      *	1	0	0
28000508	28	      *    Carry out the Credit Check Asynchronously	1	0	1
28000509	28	      *	1	0	1
28000512	28	      *	1	0	1
28000513	28	      *    Retrieve the table of transaction IDs to use &	1	0	1
28000514	28	      *    initiate each Asynchronous transaction	1	0	1
28000515	28	      *	1	0	1
28000516	28	           MOVE 'CIPCREDCHANN    ' TO WS-CHANNEL-NAME.	0	0	0
28000517	28	           MOVE 0 TO WS-CHILD-ISSUED-CNT.	0	0	1
28000519	28	           COMPUTE WS-PUT-CONT-LEN = LENGTH OF DFHCOMMAREA.	0	0	1
28000521	28	           PERFORM VARYING WS-CC-CNT FROM 1 BY 1	0	0	1
28000522	28	           UNTIL WS-CC-CNT > 5	0	0	1
28000524	28	      *	1	0	0
28000525	28	      *       Use transactions OCR1 - OCR5	1	0	1
28000526	28	      *	1	0	1
28000527	28	              STRING 'OCR' DELIMITED BY SIZE,	0	0	0
28000528	28	                      WS-CC-CNT DELIMITED BY SIZE	0	0	1
28000529	28	                 INTO WS-RUN-TRANSID	0	0	1
28000530	28	              END-STRING	0	0	1
28000532	28	              EVALUATE WS-CC-CNT	0	0	1
28000533	28	                 WHEN 1	0	0	1
28000534	28	                    MOVE 'CIPA            ' TO WS-PUT-CONT-NAME	0	0	1
28000535	28	                 WHEN 2	0	0	1
28000536	28	                    MOVE 'CIPB            ' TO WS-PUT-CONT-NAME	0	0	1
28000537	28	                 WHEN 3	0	0	1
28000538	28	                    MOVE 'CIPC            ' TO WS-PUT-CONT-NAME	0	0	1
28000539	28	                 WHEN 4	0	0	1
28000540	28	                    MOVE 'CIPD            ' TO WS-PUT-CONT-NAME	0	0	1
28000541	28	                 WHEN 5	0	0	1
28000542	28	                    MOVE 'CIPE            ' TO WS-PUT-CONT-NAME	0	0	1
28000543	28	                 WHEN 6	0	0	1
28000544	28	                    MOVE 'CIPF            ' TO WS-PUT-CONT-NAME	0	0	1
28000545	28	                 WHEN 7	0	0	1
28000546	28	                    MOVE 'CIPG            ' TO WS-PUT-CONT-NAME	0	0	1
28000547	28	                 WHEN 8	0	0	1
28000548	28	                    MOVE 'CIPH            ' TO WS-PUT-CONT-NAME	0	0	1
28000549	28	                 WHEN 9	0	0	1
28000550	28	                    MOVE 'CIPI            ' TO WS-PUT-CONT-NAME	0	0	1
28000552	28	              END-EVALUATE	0	0	1
28000554	28	      *	1	0	0
28000555	28	      *       Pass the details of the customer into a container	1	0	1
28000556	28	      *	1	0	1
28000557	28	              EXEC CICS PUT CONTAINER(WS-PUT-CONT-NAME)	0	0	0
28000558	28	                            FROM(DFHCOMMAREA)	0	0	1
28000559	28	                            FLENGTH(WS-PUT-CONT-LEN)	0	0	1
28000560	28	                            CHANNEL(WS-CHANNEL-NAME)	0	0	1
28000561	28	                            RESP(WS-CICS-RESP)	0	0	1
28000562	28	                            RESP2(WS-CICS-RESP2)	0	0	1
28000563	28	              END-EXEC	0	0	1
28000565	28	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
28000566	28	                 MOVE 'N' TO COMM-SUCCESS	0	0	1
28000567	28	                 MOVE 'A' TO COMM-FAIL-CODE	0	0	1
28000569	28	                 DISPLAY 'Unsuccessful attempt to PUT CONTAINER. '	0	0	1
28000570	28	                         'CONTAINER=' WS-PUT-CONT-NAME 'CHANNEL='	0	0	1
28000571	28	                         WS-CHANNEL-NAME '. FLENGTH ='	0	0	1
28000572	28	                         WS-PUT-CONT-LEN '.'	0	0	1
28000573	28	                 DISPLAY '    RESP=' WS-CICS-RESP ' RESP2='	0	0	1
28000574	28	                         WS-CICS-RESP2	0	0	1
28000576	28	                 PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000577	28	              END-IF	0	0	1
28000579	28	      *	1	0	0
28000580	28	      *       Issue the ASYNC transaction	1	0	1
28000581	28	      *	1	0	1
28000582	28	              EXEC CICS RUN TRANSID(WS-RUN-TRANSID)	0	0	0
28000583	28	                   CHANNEL(WS-CHANNEL-NAME)	0	0	1
28000584	28	                   CHILD(WS-ANY-CHILD-TKN)	0	0	1
28000585	28	                   RESP(WS-CICS-RESP)	0	0	1
28000586	28	                   RESP2(WS-CICS-RESP2)	0	0	1
28000587	28	              END-EXEC	0	0	1
28000589	28	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
28000590	28	                 MOVE 'N' TO COMM-SUCCESS	0	0	1
28000591	28	                 MOVE 'B' TO COMM-FAIL-CODE	0	0	1
28000593	28	                 DISPLAY 'Unsuccessful attempt to RUN TRANSID. '	0	0	1
28000594	28	                         'TRANSID=' WS-RUN-TRANSID 'CHANNEL='	0	0	1
28000595	28	                         WS-CHANNEL-NAME '. TOKEN='	0	0	1
28000596	28	                         WS-ANY-CHILD-TKN	0	0	1
28000597	28	                 DISPLAY '    RESP=' WS-CICS-RESP ' RESP2='	0	0	1
28000598	28	                         WS-CICS-RESP2	0	0	1
28000600	28	                 PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000601	28	              END-IF	0	0	1
28000603	28	      *	1	0	0
28000604	28	      *       Store away the CHANNEL and the TKN into an array	1	0	1
28000605	28	      *       for later use.	1	0	1
28000606	28	      *	1	0	1
28000607	28	              ADD 1 TO WS-CHILD-ISSUED-CNT	0	0	0
28000608	28	              MOVE WS-CHANNEL-NAME TO	0	0	1
28000609	28	                 WS-CHILD-CHAN (WS-CHILD-ISSUED-CNT)	0	0	1
28000610	28	              MOVE WS-ANY-CHILD-TKN TO	0	0	1
28000611	28	                 WS-CHILD-TKN (WS-CHILD-ISSUED-CNT)	0	0	1
28000613	28	      D       DISPLAY 'WS-CHILD-ARRAY=' WS-CHILD-ARRAY	0	0	1
28000616	28	           END-PERFORM.	0	0	1
28000618	28	      *	1	0	0
28000619	28	      *    Having sent all of the ASYNC requests, delay for	1	0	1
28000620	28	      *    3 seconds (to allow the request time to be processed)	1	0	1
28000621	28	      *    and then FETCH any data	1	0	1
28000622	28	      *	1	0	1
28000623	28	           EXEC CICS DELAY	0	0	0
28000624	28	              FOR SECONDS(3)	0	0	1
28000625	28	           END-EXEC.	0	0	1
28000627	28	           MOVE 'N' TO WS-FINISHED-FETCHING.	0	0	1
28000628	28	           MOVE 0 TO WS-RETRIEVED-CNT.	0	0	1
28000629	28	           MOVE 0 TO WS-TOTAL-CS-SCR.	0	0	1
28000631	28	           PERFORM UNTIL WS-FINISHED-FETCHING = 'Y'	0	0	1
28000633	28	              MOVE SPACES TO WS-ANY-CHILD-FETCH-ABCODE	0	0	1
28000635	28	      *	1	0	0
28000636	28	      *       Fetch an available reply immediately (without	1	0	1
28000637	28	      *       waiting).	1	0	1
28000638	28	      *	1	0	1
28000639	28	              EXEC CICS FETCH ANY(WS-ANY-CHILD-FETCH-TKN)	0	0	0
28000640	28	                   CHANNEL(WS-ANY-CHILD-FETCH-CHAN)	0	0	1
28000641	28	                   NOSUSPEND	0	0	1
28000642	28	                   COMPSTATUS(WS-CHILD-FETCH-COMPST)	0	0	1
28000643	28	                   ABCODE(WS-ANY-CHILD-FETCH-ABCODE)	0	0	1
28000644	28	                   RESP(WS-CICS-RESP)	0	0	1
28000645	28	                   RESP2(WS-CICS-RESP2)	0	0	1
28000646	28	              END-EXEC	0	0	1
28000648	28	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
28000649	28	      *	1	0	0
28000650	28	      *          Check to see if the response was NOTFINISHED	1	0	1
28000651	28	      *          this means that not all credit agencies replied in	1	0	1
28000652	28	      *          time (for example we asked 5 and only 4 replied in	1	0	1
28000653	28	      *          the required time frame). So there is no more data	1	0	1
28000654	28	      *          to retrieve (the outstanding reply remains	1	0	1
28000655	28	      *          outstanding).	1	0	1
28000656	28	      *	1	0	1
28000657	28	                 IF WS-CICS-RESP = DFHRESP(NOTFINISHED) AND	0	0	0
28000658	28	                 WS-CICS-RESP2 = 52	0	0	1
28000660	28	      *	1	0	0
28000661	28	      *             If we retrieved nothing at all then it is an	1	0	1
28000662	28	      *             error	1	0	1
28000663	28	      *	1	0	1
28000664	28	                    IF WS-RETRIEVED-CNT = 0	0	0	0
28000665	28	                       MOVE 'Y' TO WS-FINISHED-FETCHING	0	0	1
28000666	28	                       MOVE 0 TO COMM-CREDIT-SCORE	0	0	1
28000667	28	                       MOVE 'Y' TO WS-CREDIT-CHECK-ERROR	0	0	1
28000669	28	                       STRING WS-ORIG-DATE-DD DELIMITED BY SIZE,	0	0	1
28000670	28	                              WS-ORIG-DATE-MM DELIMITED BY SIZE,	0	0	1
28000671	28	                              WS-ORIG-DATE-YYYY DELIMITED BY SIZE	0	0	1
28000672	28	                              INTO COMM-CS-REVIEW-DATE	0	0	1
28000673	28	                       END-STRING	0	0	1
28000675	28	                       MOVE 'N' TO COMM-SUCCESS	0	0	1
28000676	28	                       MOVE 'C' TO COMM-FAIL-CODE	0	0	1
28000678	28	                       DISPLAY 'EXEC CICS FETCH ANY failed. RESP='	0	0	1
28000679	28	                          WS-CICS-RESP ' RESP2=' WS-CICS-RESP2	0	0	1
28000680	28	                       DISPLAY '   NOTFINISHED (no data) was returned'	0	0	1
28000681	28	                       DISPLAY '   Exiting CRECUST. COMMAREA='	0	0	1
28000682	28	                          DFHCOMMAREA	0	0	1
28000683	28	                       PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000685	28	                    ELSE	0	0	1
28000686	28	      *	1	0	0
28000687	28	      *                If we have previously retrieved some data from	1	0	1
28000688	28	      *                the credit checking agency/agencies then	1	0	1
28000689	28	      *                calculate the average credit score and a	1	0	1
28000690	28	      *                new random review date (sometime in the	1	0	1
28000691	28	      *                next 21 days)	1	0	1
28000692	28	      *	1	0	1
28000693	28	                       MOVE 'Y' TO WS-FINISHED-FETCHING	0	0	0
28000694	28	                       MOVE 'N' TO WS-CREDIT-CHECK-ERROR	0	0	1
28000695	28	      *	1	0	0
28000696	28	      *                Compute the average credit score from those	1	0	1
28000697	28	      *                credit agencies that responded	1	0	1
28000698	28	      *	1	0	1
28000699	28	                       COMPUTE WS-ACTUAL-CS-SCR = WS-TOTAL-CS-SCR /	0	0	0
28000700	28	                          WS-RETRIEVED-CNT	0	0	1
28000701	28	                       MOVE WS-ACTUAL-CS-SCR TO COMM-CREDIT-SCORE	0	0	1
28000703	28	      *	1	0	0
28000704	28	      *                Get today's date	1	0	1
28000705	28	      *	1	0	1
28000706	28	                       MOVE FUNCTION CURRENT-DATE	0	0	0
28000707	28	                          TO WS-CURRENT-DATE-DATA	0	0	1
28000709	28	                       MOVE WS-CURRENT-DATE-DATA (1:8)	0	0	1
28000710	28	                          TO WS-CURRENT-DATE-9	0	0	1
28000712	28	                      COMPUTE WS-TODAY-INT =	0	0	1
28000713	28	                          FUNCTION INTEGER-OF-DATE (WS-CURRENT-DATE-9)	0	0	1
28000715	28	      *	1	0	0
28000716	28	      *                Set up a random Credit Score review date	1	0	1
28000717	28	      *                within the next 21 days.	1	0	1
28000718	28	      *	1	0	1
28000719	28	                       MOVE EIBTASKN           TO WS-SEED	0	0	0
28000721	28	                       COMPUTE WS-REVIEW-DATE-ADD = ((21 - 1)	0	0	1
28000722	28	                                   * FUNCTION RANDOM(WS-SEED)) + 1	0	0	1
28000724	28	                       COMPUTE WS-NEW-REVIEW-DATE-INT =	0	0	1
28000725	28	                          WS-TODAY-INT + WS-REVIEW-DATE-ADD	0	0	1
28000727	28	      *	1	0	0
28000728	28	      *                Convert the integer date back to YYYYMMDD	1	0	1
28000729	28	      *                format	1	0	1
28000730	28	      *	1	0	1
28000731	28	                       COMPUTE WS-NEW-REVIEW-YYYYMMDD = FUNCTION	0	0	0
28000732	28	                          DATE-OF-INTEGER (WS-NEW-REVIEW-DATE-INT)	0	0	1
28000734	28	                       MOVE WS-NEW-REVIEW-YYYYMMDD(1:4) TO	0	0	1
28000735	28	                          COMM-CS-REVIEW-DATE(5:4)	0	0	1
28000736	28	                       MOVE WS-NEW-REVIEW-YYYYMMDD(5:2) TO	0	0	1
28000737	28	                          COMM-CS-REVIEW-DATE(3:2)	0	0	1
28000738	28	                       MOVE WS-NEW-REVIEW-YYYYMMDD(7:2) TO	0	0	1
28000739	28	                          COMM-CS-REVIEW-DATE(1:2)	0	0	1
28000741	28	                    END-IF	0	0	1
28000742	28	                 END-IF	0	0	1
28000743	28	      *	1	0	0
28000744	28	      *          Check to see if the response was INVREQ	1	0	1
28000745	28	      *          this means that the parent never had any children	1	0	1
28000746	28	      *	1	0	1
28000747	28	                 IF WS-CICS-RESP = DFHRESP(INVREQ) AND	0	0	0
28000748	28	                 WS-CICS-RESP2 = 1	0	0	1
28000750	28	                    MOVE 0 TO COMM-CREDIT-SCORE	0	0	1
28000752	28	                    STRING WS-ORIG-DATE-DD DELIMITED BY SIZE,	0	0	1
28000753	28	                           WS-ORIG-DATE-MM DELIMITED BY SIZE,	0	0	1
28000754	28	                           WS-ORIG-DATE-YYYY DELIMITED BY SIZE	0	0	1
28000755	28	                           INTO COMM-CS-REVIEW-DATE	0	0	1
28000756	28	                    END-STRING	0	0	1
28000758	28	                    MOVE 'N' TO COMM-SUCCESS	0	0	1
28000759	28	                    MOVE 'D' TO COMM-FAIL-CODE	0	0	1
28000761	28	                    DISPLAY 'EXEC CICS FETCH ANY failed. RESP='	0	0	1
28000762	28	                       WS-CICS-RESP ' RESP2=' WS-CICS-RESP2	0	0	1
28000763	28	                    DISPLAY '   INVREQ (no data) was returned'	0	0	1
28000764	28	                    DISPLAY '   Exiting CRECUST. COMMAREA='	0	0	1
28000765	28	                       DFHCOMMAREA	0	0	1
28000766	28	                    PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000768	28	                 END-IF	0	0	1
28000770	28	      *	1	0	0
28000771	28	      *          Check to see if we are finished yet.	1	0	1
28000772	28	      *	1	0	1
28000773	28	                 IF WS-CICS-RESP = DFHRESP(NOTFND) AND	0	0	0
28000774	28	                 WS-CICS-RESP2 = 1	0	0	1
28000776	28	      *	1	0	0
28000777	28	      *             If we retrieved nothing at all then it is an	1	0	1
28000778	28	      *             error	1	0	1
28000779	28	      *	1	0	1
28000780	28	                    IF WS-RETRIEVED-CNT = 0	0	0	0
28000781	28	                       MOVE 'Y' TO WS-FINISHED-FETCHING	0	0	1
28000782	28	                       MOVE 0 TO COMM-CREDIT-SCORE	0	0	1
28000784	28	                       STRING WS-ORIG-DATE-DD DELIMITED BY SIZE,	0	0	1
28000785	28	                              WS-ORIG-DATE-MM DELIMITED BY SIZE,	0	0	1
28000786	28	                              WS-ORIG-DATE-YYYY DELIMITED BY SIZE	0	0	1
28000787	28	                              INTO COMM-CS-REVIEW-DATE	0	0	1
28000788	28	                       END-STRING	0	0	1
28000789	28	                       MOVE 'Y' TO WS-CREDIT-CHECK-ERROR	0	0	1
28000791	28	                    ELSE	0	0	1
28000792	28	      *	1	0	0
28000793	28	      *                If we have previously retrieved data from the	1	0	1
28000794	28	      *                credit checking agency/agencies then calculate	1	0	1
28000795	28	      *                the average credit score and a new random	1	0	1
28000796	28	      *                review date (sometime in the next 21 days)	1	0	1
28000797	28	      *	1	0	1
28000798	28	                       MOVE 'Y' TO WS-FINISHED-FETCHING	0	0	0
28000799	28	                       MOVE 'N' TO WS-CREDIT-CHECK-ERROR	0	0	1
28000800	28	      *	1	0	0
28000801	28	      *                Compute the average credit score from those	1	0	1
28000802	28	      *                credit agencies that responded	1	0	1
28000803	28	      *	1	0	1
28000804	28	                       COMPUTE WS-ACTUAL-CS-SCR = WS-TOTAL-CS-SCR /	0	0	0
28000805	28	                          WS-RETRIEVED-CNT	0	0	1
28000806	28	                       MOVE WS-ACTUAL-CS-SCR TO COMM-CREDIT-SCORE	0	0	1
28000808	28	      *	1	0	0
28000809	28	      *                Get today's date	1	0	1
28000810	28	      *	1	0	1
28000811	28	                       MOVE FUNCTION CURRENT-DATE	0	0	0
28000812	28	                          TO WS-CURRENT-DATE-DATA	0	0	1
28000814	28	                       MOVE WS-CURRENT-DATE-DATA (1:8)	0	0	1
28000815	28	                          TO WS-CURRENT-DATE-9	0	0	1
28000817	28	                      COMPUTE WS-TODAY-INT =	0	0	1
28000818	28	                          FUNCTION INTEGER-OF-DATE (WS-CURRENT-DATE-9)	0	0	1
28000819	28	      *	1	0	0
28000820	28	      *                Set up a random Credit Score review date	1	0	1
28000821	28	      *                within the next 21 days.	1	0	1
28000822	28	      *	1	0	1
28000823	28	                       MOVE EIBTASKN           TO WS-SEED	0	0	0
28000825	28	                       COMPUTE WS-REVIEW-DATE-ADD = ((21 - 1)	0	0	1
28000826	28	                                   * FUNCTION RANDOM(WS-SEED)) + 1	0	0	1
28000828	28	                       COMPUTE WS-NEW-REVIEW-DATE-INT =	0	0	1
28000829	28	                          WS-TODAY-INT + WS-REVIEW-DATE-ADD	0	0	1
28000831	28	      *	1	0	0
28000832	28	      *                Convert the integer date back to YYYYMMDD	1	0	1
28000833	28	      *                format	1	0	1
28000834	28	      *	1	0	1
28000835	28	                       COMPUTE WS-NEW-REVIEW-YYYYMMDD = FUNCTION	0	0	0
28000836	28	                          DATE-OF-INTEGER (WS-NEW-REVIEW-DATE-INT)	0	0	1
28000838	28	                       MOVE WS-NEW-REVIEW-YYYYMMDD(1:4) TO	0	0	1
28000839	28	                          COMM-CS-REVIEW-DATE(5:4)	0	0	1
28000840	28	                       MOVE WS-NEW-REVIEW-YYYYMMDD(5:2) TO	0	0	1
28000841	28	                          COMM-CS-REVIEW-DATE(3:2)	0	0	1
28000842	28	                       MOVE WS-NEW-REVIEW-YYYYMMDD(7:2) TO	0	0	1
28000843	28	                          COMM-CS-REVIEW-DATE(1:2)	0	0	1
28000845	28	                    END-IF	0	0	1
28000846	28	                 END-IF	0	0	1
28000847	28	              ELSE	0	0	1
28000849	28	      *       If it is a NORMAL RESPONSE code we need to check	1	0	0
28000850	28	      *       the COMP-STATUS	1	0	1
28000851	28	      *	1	0	1
28000853	28	                 EVALUATE WS-CHILD-FETCH-COMPST	0	0	0
28000855	28	                    WHEN DFHVALUE(NORMAL)	0	0	1
28000856	28	      *	1	0	0
28000857	28	      *                Set up the correct container name	1	0	1
28000858	28	      *	1	0	1
28000859	28	                       EVALUATE WS-ANY-CHILD-FETCH-TKN	0	0	0
28000861	28	                          WHEN WS-CHILD-TKN(1)	0	0	1
28000862	28	                             MOVE 'CIPA            '	0	0	1
28000863	28	                                TO WS-CONTAINER-NAME	0	0	1
28000864	28	                          WHEN WS-CHILD-TKN(2)	0	0	1
28000865	28	                             MOVE 'CIPB            '	0	0	1
28000866	28	                                TO WS-CONTAINER-NAME	0	0	1
28000867	28	                          WHEN WS-CHILD-TKN(3)	0	0	1
28000868	28	                             MOVE 'CIPC            '	0	0	1
28000869	28	                                TO WS-CONTAINER-NAME	0	0	1
28000870	28	                          WHEN WS-CHILD-TKN(4)	0	0	1
28000871	28	                             MOVE 'CIPD            '	0	0	1
28000872	28	                                TO WS-CONTAINER-NAME	0	0	1
28000873	28	                          WHEN WS-CHILD-TKN(5)	0	0	1
28000874	28	                             MOVE 'CIPE            '	0	0	1
28000875	28	                                TO WS-CONTAINER-NAME	0	0	1
28000876	28	                          WHEN WS-CHILD-TKN(6)	0	0	1
28000877	28	                             MOVE 'CIPF            '	0	0	1
28000878	28	                                TO WS-CONTAINER-NAME	0	0	1
28000879	28	                          WHEN WS-CHILD-TKN(7)	0	0	1
28000880	28	                             MOVE 'CIPG            '	0	0	1
28000881	28	                                TO WS-CONTAINER-NAME	0	0	1
28000882	28	                          WHEN WS-CHILD-TKN(8)	0	0	1
28000883	28	                             MOVE 'CIPH            '	0	0	1
28000884	28	                                TO WS-CONTAINER-NAME	0	0	1
28000885	28	                          WHEN WS-CHILD-TKN(9)	0	0	1
28000886	28	                             MOVE 'CIPI            '	0	0	1
28000887	28	                                TO WS-CONTAINER-NAME	0	0	1
28000888	28	                       END-EVALUATE	0	0	1
28000890	28	                       MOVE 261 TO WS-CHILD-CONTAINER-LEN	0	0	1
28000892	28	                       EXEC CICS GET CONTAINER(WS-CONTAINER-NAME)	0	0	1
28000893	28	                            CHANNEL(WS-ANY-CHILD-FETCH-CHAN)	0	0	1
28000894	28	                            INTO(WS-CHILD-DATA)	0	0	1
28000895	28	                            FLENGTH(WS-CHILD-CONTAINER-LEN)	0	0	1
28000896	28	                            RESP(WS-CICS-RESP)	0	0	1
28000897	28	                            RESP2(WS-CICS-RESP2)	0	0	1
28000898	28	                       END-EXEC	0	0	1
28000900	28	                       IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
28000901	28	                          MOVE 0 TO COMM-CREDIT-SCORE	0	0	1
28000903	28	                          STRING WS-ORIG-DATE-DD DELIMITED BY SIZE,	0	0	1
28000904	28	                                 WS-ORIG-DATE-MM DELIMITED BY SIZE,	0	0	1
28000905	28	                                 WS-ORIG-DATE-YYYY DELIMITED BY SIZE	0	0	1
28000906	28	                                 INTO COMM-CS-REVIEW-DATE	0	0	1
28000907	28	                          END-STRING	0	0	1
28000909	28	                          MOVE 'N' TO COMM-SUCCESS	0	0	1
28000910	28	                          MOVE 'E' TO COMM-FAIL-CODE	0	0	1
28000912	28	                          DISPLAY 'EXEC CICS FETCH ANY worked, '	0	0	1
28000913	28	                             'but GET CONTAINER failed.'	0	0	1
28000914	28	                             ' CONTAINER='  WS-CONTAINER-NAME	0	0	1
28000915	28	                             ' CHANNEL=' WS-ANY-CHILD-FETCH-CHAN	0	0	1
28000916	28	                             ' RESP='	0	0	1
28000917	28	                             WS-CICS-RESP ' RESP2=' WS-CICS-RESP2	0	0	1
28000919	28	                          DISPLAY '   Exiting CRECUST. COMMAREA='	0	0	1
28000920	28	                             DFHCOMMAREA	0	0	1
28000921	28	                          PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000922	28	                       END-IF	0	0	1
28000924	28	      *	1	0	0
28000925	28	      *                If the GET CONTAINER was successful	1	0	1
28000926	28	      *	1	0	1
28000927	28	                       COMPUTE WS-RETRIEVED-CNT =	0	0	0
28000928	28	                          WS-RETRIEVED-CNT + 1	0	0	1
28000929	28	                       COMPUTE WS-TOTAL-CS-SCR =	0	0	1
28000930	28	                          WS-TOTAL-CS-SCR + WS-CHILD-DATA-CREDIT-SCORE	0	0	1
28000932	28	                    WHEN DFHVALUE(ABEND)	0	0	1
28000933	28	      *	1	0	0
28000934	28	      *                You are here because the completion status from	1	0	1
28000935	28	      *                the FETCH ANY is ABEND, so deal with that.	1	0	1
28000936	28	      *	1	0	1
28000937	28	                       MOVE 0 TO COMM-CREDIT-SCORE	0	0	0
28000939	28	                       STRING WS-ORIG-DATE-DD DELIMITED BY SIZE,	0	0	1
28000940	28	                              WS-ORIG-DATE-MM DELIMITED BY SIZE,	0	0	1
28000941	28	                              WS-ORIG-DATE-YYYY DELIMITED BY SIZE	0	0	1
28000942	28	                              INTO COMM-CS-REVIEW-DATE	0	0	1
28000943	28	                       END-STRING	0	0	1
28000945	28	                       MOVE 'N' TO COMM-SUCCESS	0	0	1
28000946	28	                       MOVE 'F' TO COMM-FAIL-CODE	0	0	1
28000948	28	                       PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000951	28	                    WHEN DFHVALUE(SECERROR)	0	0	1
28000952	28	      *	1	0	0
28000953	28	      *                The completion status from the FETCH ANY is	1	0	1
28000954	28	      *                SECERROR	1	0	1
28000955	28	      *	1	0	1
28000956	28	                       MOVE 0 TO COMM-CREDIT-SCORE	0	0	0
28000958	28	                       STRING WS-ORIG-DATE-DD DELIMITED BY SIZE,	0	0	1
28000959	28	                              WS-ORIG-DATE-MM DELIMITED BY SIZE,	0	0	1
28000960	28	                              WS-ORIG-DATE-YYYY DELIMITED BY SIZE	0	0	1
28000961	28	                              INTO COMM-CS-REVIEW-DATE	0	0	1
28000962	28	                       END-STRING	0	0	1
28000964	28	                       MOVE 'N' TO COMM-SUCCESS	0	0	1
28000965	28	                       MOVE 'G' TO COMM-FAIL-CODE	0	0	1
28000967	28	                       DISPLAY 'EXEC CICS FETCH ANY worked, '	0	0	1
28000968	28	                          'but COMP-STATUS = SECERROR.'	0	0	1
28000969	28	                          ' RESP='	0	0	1
28000970	28	                          WS-CICS-RESP ' RESP2=' WS-CICS-RESP2	0	0	1
28000971	28	                       DISPLAY '   Exiting CRECUST. COMMAREA='	0	0	1
28000972	28	                          DFHCOMMAREA	0	0	1
28000973	28	                       PERFORM GET-ME-OUT-OF-HERE	0	0	1
28000976	28	                    WHEN OTHER	0	0	1
28000977	28	      *	1	0	0
28000978	28	      *                This catches any other completion status values	1	0	1
28000979	28	      *                from the FETCH ANY.	1	0	1
28000980	28	      *	1	0	1
28000981	28	                       MOVE 0 TO COMM-CREDIT-SCORE	0	0	0
28000983	28	                       STRING WS-ORIG-DATE-DD DELIMITED BY SIZE,	0	0	1
28000984	28	                              WS-ORIG-DATE-MM DELIMITED BY SIZE,	0	0	1
28000985	28	                              WS-ORIG-DATE-YYYY DELIMITED BY SIZE	0	0	1
28000986	28	                              INTO COMM-CS-REVIEW-DATE	0	0	1
28000987	28	                       END-STRING	0	0	1
28000989	28	                       MOVE 'N' TO COMM-SUCCESS	0	0	1
28000990	28	                       MOVE 'H' TO COMM-FAIL-CODE	0	0	1
28000992	28	                       DISPLAY 'EXEC CICS FETCH ANY worked, '	0	0	1
28000993	28	                          'but COMP-STATUS IS UNKNOWN.'	0	0	1
28000994	28	                          ' RESP='	0	0	1
28000995	28	                          WS-CICS-RESP ' RESP2=' WS-CICS-RESP2	0	0	1
28000996	28	                       DISPLAY '   Exiting CRECUST. COMMAREA='	0	0	1
28000997	28	                          DFHCOMMAREA	0	0	1
28000998	28	                       PERFORM GET-ME-OUT-OF-HERE	0	0	1
28001000	28	                 END-EVALUATE	0	0	1
28001002	28	              END-IF	0	0	1
28001004	28	           END-PERFORM.	0	0	1
28001007	28	       CC999.	0	0	1
28001008	28	           EXIT.	0	0	1
28001011	28	       WRITE-CUSTOMER-VSAM SECTION.	0	0	1
28001012	28	       WCV010.	0	0	1
28001013	28	      *	1	0	0
28001014	28	      *    Write a record to the CUSTOMER VSAM file	1	0	1
28001015	28	      *	1	0	1
28001016	28	           INITIALIZE OUTPUT-DATA.	0	0	0
28001018	28	           MOVE 'CUST'              TO CUSTOMER-EYECATCHER.	0	0	1
28001019	28	           MOVE SORTCODE            TO CUSTOMER-SORTCODE.	0	0	1
28001020	28	           MOVE NCS-CUST-NO-VALUE   TO CUSTOMER-NUMBER.	0	0	1
28001021	28	           MOVE COMM-NAME           TO CUSTOMER-NAME.	0	0	1
28001022	28	           MOVE COMM-ADDRESS        TO CUSTOMER-ADDRESS.	0	0	1
28001023	28	           MOVE COMM-DATE-OF-BIRTH  TO CUSTOMER-DATE-OF-BIRTH.	0	0	1
28001024	28	           MOVE COMM-CREDIT-SCORE   TO CUSTOMER-CREDIT-SCORE.	0	0	1
28001025	28	           MOVE COMM-CS-REVIEW-DATE TO CUSTOMER-CS-REVIEW-DATE.	0	0	1
28001027	28	           COMPUTE WS-CUST-REC-LEN = LENGTH OF OUTPUT-DATA.	0	0	1
28001029	28	           EXEC CICS WRITE	0	0	1
28001030	28	                FILE('CUSTOMER')	0	0	1
28001031	28	                FROM(OUTPUT-DATA)	0	0	1
28001032	28	                RIDFLD(CUSTOMER-KEY)	0	0	1
28001033	28	                LENGTH(WS-CUST-REC-LEN)	0	0	1
28001034	28	                KEYLENGTH(16)	0	0	1
28001035	28	                RESP(WS-CICS-RESP)	0	0	1
28001036	28	                RESP2(WS-CICS-RESP2)	0	0	1
28001037	28	           END-EXEC.	0	0	1
28001039	28	           IF WS-CICS-RESP = DFHRESP(SYSIDERR)	0	0	1
28001040	28	              PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1	0	0	1
28001041	28	              UNTIL SYSIDERR-RETRY > 100	0	0	1
28001042	28	              OR WS-CICS-RESP = DFHRESP(NORMAL)	0	0	1
28001043	28	              OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)	0	0	1
28001045	28	                 EXEC CICS DELAY FOR SECONDS(3)	0	0	1
28001046	28	                 END-EXEC	0	0	1
28001048	28	                 EXEC CICS WRITE	0	0	1
28001049	28	                    FILE('CUSTOMER')	0	0	1
28001050	28	                    FROM(OUTPUT-DATA)	0	0	1
28001051	28	                    RIDFLD(CUSTOMER-KEY)	0	0	1
28001052	28	                    LENGTH(WS-CUST-REC-LEN)	0	0	1
28001053	28	                    KEYLENGTH(16)	0	0	1
28001054	28	                    RESP(WS-CICS-RESP)	0	0	1
28001055	28	                    RESP2(WS-CICS-RESP2)	0	0	1
28001056	28	                 END-EXEC	0	0	1
28001058	28	              END-PERFORM	0	0	1
28001059	28	           END-IF	0	0	1
28001061	28	      *	1	0	0
28001062	28	      *    Check if the WRITE was unsuccessful and take action.	1	0	1
28001063	28	      *	1	0	1
28001064	28	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	0
28001065	28	              MOVE 'N' TO COMM-SUCCESS	0	0	1
28001066	28	              MOVE '1' TO COMM-FAIL-CODE	0	0	1
28001067	28	              PERFORM DEQ-NAMED-COUNTER	0	0	1
28001068	28	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
28001069	28	           END-IF.	0	0	1
28001071	28	           INITIALIZE CUSTOMER-CONTROL	0	0	1
28001072	28	           MOVE ZERO TO CUSTOMER-CONTROL-SORTCODE	0	0	1
28001073	28	           MOVE ALL '9' TO CUSTOMER-CONTROL-NUMBER	0	0	1
28001075	28	           EXEC CICS READ FILE('CUSTOMER')	0	0	1
28001076	28	                RIDFLD(CUSTOMER-CONTROL-KEY)	0	0	1
28001077	28	                INTO(CUSTOMER-CONTROL)	0	0	1
28001078	28	                UPDATE	0	0	1
28001079	28	           END-EXEC	0	0	1
28001081	28	           ADD 1 TO NUMBER-OF-CUSTOMERS IN CUSTOMER-CONTROL-RECORD	0	0	1
28001082	28	           GIVING NUMBER-OF-CUSTOMERS IN CUSTOMER-CONTROL-RECORD	0	0	1
28001083	28	           MOVE CUSTOMER-NUMBER OF CUSTOMER-RECORD TO	0	0	1
28001084	28	           LAST-CUSTOMER-NUMBER IN CUSTOMER-CONTROL-RECORD	0	0	1
28001086	28	           EXEC CICS REWRITE FILE('CUSTOMER')	0	0	1
28001087	28	                FROM(CUSTOMER-CONTROL)	0	0	1
28001088	28	           END-EXEC	0	0	1
28001090	28	      *	1	0	0
28001091	28	      *    If the WRITE was successful then WRITE to PROCTRAN datastore	1	0	1
28001092	28	      *	1	0	1
28001093	28	           MOVE CUSTOMER-SORTCODE OF OUTPUT-DATA TO STORED-SORTCODE.	0	0	0
28001094	28	           MOVE CUSTOMER-NUMBER OF OUTPUT-DATA TO STORED-CUSTNO.	0	0	1
28001095	28	           MOVE CUSTOMER-NAME TO STORED-NAME.	0	0	1
28001096	28	           MOVE CUSTOMER-DATE-OF-BIRTH(1:2) TO STORED-DOB(1:2).	0	0	1
28001097	28	           MOVE '/' TO STORED-DOB(3:1).	0	0	1
28001098	28	           MOVE CUSTOMER-DATE-OF-BIRTH(3:2) TO STORED-DOB(4:2).	0	0	1
28001099	28	           MOVE '/' TO STORED-DOB(6:1).	0	0	1
28001100	28	           MOVE CUSTOMER-DATE-OF-BIRTH(5:4) TO STORED-DOB(7:4).	0	0	1
28001102	28	           PERFORM WRITE-PROCTRAN.	0	0	1
28001104	28	           PERFORM DEQ-NAMED-COUNTER.	0	0	1
28001106	28	      *	1	0	0
28001107	28	      *    Set up the missing data in the COMM AREA ready for return	1	0	1
28001108	28	      *	1	0	1
28001109	28	           MOVE CUSTOMER-SORTCODE OF OUTPUT-DATA	0	0	0
28001110	28	              TO COMM-SORTCODE.	0	0	1
28001111	28	           MOVE CUSTOMER-NUMBER OF OUTPUT-DATA	0	0	1
28001112	28	              TO COMM-NUMBER	0	0	1
28001113	28	           MOVE 'CUST' TO COMM-EYECATCHER.	0	0	1
28001114	28	           MOVE 'Y' TO COMM-SUCCESS.	0	0	1
28001115	28	           MOVE ' ' TO COMM-FAIL-CODE.	0	0	1
28001117	28	       WCV999.	0	0	1
28001118	28	           EXIT.	0	0	1
28001121	28	       WRITE-PROCTRAN SECTION.	0	0	1
28001122	28	       WP010.	0	0	1
28001123	28	              PERFORM WRITE-PROCTRAN-DB2.	0	0	1
28001125	28	       WP999.	0	0	1
28001126	28	           EXIT.	0	0	1
28001129	28	       WRITE-PROCTRAN-DB2 SECTION.	0	0	1
28001130	28	       WPD010.	0	0	1
28001131	28	      *	1	0	0
28001132	28	      *    Record the creation of a new CUSTOMER on PROCTRAN	1	0	1
28001133	28	      *	1	0	1
28001134	28	           INITIALIZE HOST-PROCTRAN-ROW.	0	0	0
28001135	28	           INITIALIZE WS-EIBTASKN12.	0	0	1
28001137	28	           MOVE 'PRTR' TO HV-PROCTRAN-EYECATCHER.	0	0	1
28001138	28	           MOVE SORTCODE TO HV-PROCTRAN-SORT-CODE.	0	0	1
28001139	28	           MOVE ZEROS TO HV-PROCTRAN-ACC-NUMBER.	0	0	1
28001140	28	           MOVE EIBTASKN TO WS-EIBTASKN12.	0	0	1
28001141	28	           MOVE WS-EIBTASKN12 TO HV-PROCTRAN-REF.	0	0	1
28001143	28	      *	1	0	0
28001144	28	      *    Populate the time and date	1	0	1
28001145	28	      *	1	0	1
28001146	28	           EXEC CICS ASKTIME	0	0	0
28001147	28	              ABSTIME(WS-U-TIME)	0	0	1
28001148	28	           END-EXEC.	0	0	1
28001150	28	           EXEC CICS FORMATTIME	0	0	1
28001151	28	                     ABSTIME(WS-U-TIME)	0	0	1
28001152	28	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
28001153	28	                     TIME(HV-PROCTRAN-TIME)	0	0	1
28001154	28	                     DATESEP('.')	0	0	1
28001155	28	           END-EXEC.	0	0	1
28001157	28	           MOVE WS-ORIG-DATE TO WS-ORIG-DATE-GRP-X.	0	0	1
28001158	28	           MOVE WS-ORIG-DATE-GRP-X TO HV-PROCTRAN-DATE.	0	0	1
28001160	28	           MOVE STORED-SORTCODE TO HV-PROCTRAN-DESC(1:6).	0	0	1
28001161	28	           MOVE STORED-CUSTNO TO HV-PROCTRAN-DESC(7:10).	0	0	1
28001162	28	           MOVE STORED-NAME   TO HV-PROCTRAN-DESC(17:14).	0	0	1
28001163	28	           MOVE STORED-DOB    TO HV-PROCTRAN-DESC(31:10).	0	0	1
28001165	28	           MOVE 'OCC'         TO HV-PROCTRAN-TYPE.	0	0	1
28001166	28	           MOVE ZEROS         TO HV-PROCTRAN-AMOUNT.	0	0	1
28001168	28	           EXEC SQL	0	0	1
28001169	28	              INSERT INTO PROCTRAN	0	0	1
28001170	28	                     (	0	0	1
28001171	28	                      PROCTRAN_EYECATCHER,	0	0	1
28001172	28	                      PROCTRAN_SORTCODE,	0	0	1
28001173	28	                      PROCTRAN_NUMBER,	0	0	1
28001174	28	                      PROCTRAN_DATE,	0	0	1
28001175	28	                      PROCTRAN_TIME,	0	0	1
28001176	28	                      PROCTRAN_REF,	0	0	1
28001177	28	                      PROCTRAN_TYPE,	0	0	1
28001178	28	                      PROCTRAN_DESC,	0	0	1
28001179	28	                      PROCTRAN_AMOUNT	0	0	1
28001180	28	                     )	0	0	1
28001181	28	              VALUES	0	0	1
28001182	28	                     (	0	0	1
28001183	28	                      :HV-PROCTRAN-EYECATCHER,	0	0	1
28001184	28	                      :HV-PROCTRAN-SORT-CODE,	0	0	1
28001185	28	                      :HV-PROCTRAN-ACC-NUMBER,	0	0	1
28001186	28	                      :HV-PROCTRAN-DATE,	0	0	1
28001187	28	                      :HV-PROCTRAN-TIME,	0	0	1
28001188	28	                      :HV-PROCTRAN-REF,	0	0	1
28001189	28	                      :HV-PROCTRAN-TYPE,	0	0	1
28001190	28	                      :HV-PROCTRAN-DESC,	0	0	1
28001191	28	                      :HV-PROCTRAN-AMOUNT	0	0	1
28001192	28	                     )	0	0	1
28001193	28	           END-EXEC.	0	0	1
28001195	28	      *	1	0	0
28001196	28	      *    Check the SQLCODE	1	0	1
28001197	28	      *	1	0	1
28001198	28	           IF SQLCODE NOT = 0	0	0	0
28001199	28	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
28001200	28	      *	1	0	0
28001201	28	      *       Preserve the RESP and RESP2, then set up the	1	0	1
28001202	28	      *       standard ABEND info before getting the applid,	1	0	1
28001203	28	      *       date/time etc. and linking to the Abend Handler	1	0	1
28001204	28	      *       program.	1	0	1
28001205	28	      *	1	0	1
28001206	28	              INITIALIZE ABNDINFO-REC	0	0	0
28001207	28	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
28001208	28	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
28001209	28	      *	1	0	0
28001210	28	      *       Get supplemental information	1	0	1
28001211	28	      *	1	0	1
28001212	28	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
28001213	28	              END-EXEC	0	0	1
28001215	28	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
28001216	28	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
28001218	28	              PERFORM POPULATE-TIME-DATE2	0	0	1
28001220	28	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
28001221	28	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
28001222	28	                    ':' DELIMITED BY SIZE,	0	0	1
28001223	28	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
28001224	28	                     ':' DELIMITED BY SIZE,	0	0	1
28001225	28	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
28001226	28	                     INTO ABND-TIME	0	0	1
28001227	28	              END-STRING	0	0	1
28001229	28	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
28001230	28	              MOVE 'HWPT'      TO ABND-CODE	0	0	1
28001232	28	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
28001233	28	              END-EXEC	0	0	1
28001235	28	              MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE	0	0	1
28001237	28	              STRING 'WPD010  - Unable to write to PROCTRAN DB2 '	0	0	1
28001238	28	                    DELIMITED BY SIZE,	0	0	1
28001239	28	                    'datastore with the following data:'	0	0	1
28001240	28	                    DELIMITED BY SIZE,	0	0	1
28001241	28	                    HOST-PROCTRAN-ROW	0	0	1
28001242	28	                    DELIMITED BY SIZE,	0	0	1
28001243	28	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
28001244	28	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
28001245	28	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
28001246	28	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
28001247	28	                    INTO ABND-FREEFORM	0	0	1
28001248	28	              END-STRING	0	0	1
28001250	28	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
28001251	28	                        COMMAREA(ABNDINFO-REC)	0	0	1
28001252	28	              END-EXEC	0	0	1
28001254	28	              DISPLAY 'In CRECUST(WPD010) '	0	0	1
28001255	28	              'UNABLE TO WRITE TO PROCTRAN DB2 DATASTORE'	0	0	1
28001256	28	              ' SQLCODE=' SQLCODE-DISPLAY	0	0	1
28001257	28	              'WITH THE FOLLOWING DATA:' HOST-PROCTRAN-ROW	0	0	1
28001260	28	              PERFORM DEQ-NAMED-COUNTER	0	0	1
28001262	28	              EXEC CICS ABEND	0	0	1
28001263	28	                    ABCODE ('HWPT')	0	0	1
28001264	28	              END-EXEC	0	0	1
28001265	28	           END-IF.	0	0	1
28001267	28	       WPD999.	0	0	1
28001268	28	           EXIT.	0	0	1
28001271	28	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
28001272	28	       GMOFH010.	0	0	1
28001273	28	      *	1	0	0
28001274	28	      *    Finish	1	0	1
28001275	28	      *	1	0	1
28001276	28	           EXEC CICS RETURN	0	0	0
28001277	28	           END-EXEC.	0	0	1
28001279	28	       GMOFH999.	0	0	1
28001280	28	           EXIT.	0	0	1
28001283	28	       GET-LAST-CUSTOMER-VSAM SECTION.	0	0	1
28001284	28	       GLCV010.	0	0	1
28001286	28	           INITIALIZE CUSTOMER-CONTROL	0	0	1
28001287	28	           MOVE ZERO TO CUSTOMER-CONTROL-SORTCODE	0	0	1
28001288	28	           MOVE ALL '9' TO CUSTOMER-CONTROL-NUMBER	0	0	1
28001290	28	           EXEC CICS READ FILE('CUSTOMER')	0	0	1
28001291	28	                     RIDFLD(CUSTOMER-CONTROL-KEY)	0	0	1
28001292	28	                     UPDATE	0	0	1
28001293	28	                     INTO(CUSTOMER-CONTROL)	0	0	1
28001294	28	                     RESP(WS-CICS-RESP)	0	0	1
28001295	28	                     RESP2(WS-CICS-RESP2)	0	0	1
28001296	28	           END-EXEC	0	0	1
28001298	28	           IF WS-CICS-RESP = DFHRESP(SYSIDERR)	0	0	1
28001299	28	             PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1	0	0	1
28001300	28	             UNTIL SYSIDERR-RETRY > 100	0	0	1
28001301	28	             OR WS-CICS-RESP = DFHRESP(NORMAL)	0	0	1
28001302	28	             OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)	0	0	1
28001303	28	               EXEC CICS DELAY FOR SECONDS(3)	0	0	1
28001304	28	               END-EXEC	0	0	1
28001306	28	               EXEC CICS READ FILE('CUSTOMER')	0	0	1
28001307	28	                         RIDFLD(CUSTOMER-CONTROL-KEY)	0	0	1
28001308	28	                         UPDATE	0	0	1
28001309	28	                         INTO(CUSTOMER-CONTROL)	0	0	1
28001310	28	                         RESP(WS-CICS-RESP)	0	0	1
28001311	28	                         RESP2(WS-CICS-RESP2)	0	0	1
28001312	28	               END-EXEC	0	0	1
28001314	28	             END-PERFORM	0	0	1
28001315	28	           ELSE	0	0	1
28001316	28	             IF WS-CICS-RESP IS NOT = DFHRESP(NORMAL)	0	0	1
28001317	28	               MOVE 'N' TO COMM-SUCCESS	0	0	1
28001318	28	               MOVE '4' TO COMM-FAIL-CODE	0	0	1
28001319	28	               PERFORM DEQ-NAMED-COUNTER	0	0	1
28001320	28	               PERFORM GET-ME-OUT-OF-HERE	0	0	1
28001321	28	             END-IF	0	0	1
28001322	28	           END-IF.	0	0	1
28001323	28	           ADD 1 TO LAST-CUSTOMER-NUMBER IN CUSTOMER-CONTROL	0	0	1
28001324	28	           GIVING LAST-CUSTOMER-NUMBER IN CUSTOMER-CONTROL	0	0	1
28001326	28	           EXEC CICS REWRITE FILE('CUSTOMER')	0	0	1
28001327	28	                FROM(CUSTOMER-CONTROL)	0	0	1
28001328	28	                RESP(WS-CICS-RESP)	0	0	1
28001329	28	                RESP2(WS-CICS-RESP2)	0	0	1
28001330	28	           END-EXEC	0	0	1
28001332	28	           IF WS-CICS-RESP = DFHRESP(SYSIDERR)	0	0	1
28001333	28	              PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1	0	0	1
28001334	28	              UNTIL SYSIDERR-RETRY > 100	0	0	1
28001335	28	              OR WS-CICS-RESP = DFHRESP(NORMAL)	0	0	1
28001336	28	              OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)	0	0	1
28001337	28	                 EXEC CICS DELAY FOR SECONDS(3)	0	0	1
28001338	28	                 END-EXEC	0	0	1
28001340	28	                 EXEC CICS REWRITE FILE('CUSTOMER')	0	0	1
28001341	28	                    FROM(CUSTOMER-CONTROL)	0	0	1
28001342	28	                    RESP(WS-CICS-RESP)	0	0	1
28001343	28	                    RESP2(WS-CICS-RESP2)	0	0	1
28001344	28	                 END-EXEC	0	0	1
28001345	28	              END-PERFORM	0	0	1
28001346	28	           ELSE	0	0	1
28001347	28	              IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	1
28001348	28	                 MOVE 'N' TO COMM-SUCCESS	0	0	1
28001349	28	                 MOVE '4' TO COMM-FAIL-CODE	0	0	1
28001351	28	                 PERFORM DEQ-NAMED-COUNTER	0	0	1
28001352	28	                 PERFORM GET-ME-OUT-OF-HERE	0	0	1
28001353	28	              END-IF	0	0	1
28001354	28	           END-IF	0	0	1
28001356	28	           MOVE LAST-CUSTOMER-NUMBER OF CUSTOMER-CONTROL  TO	0	0	1
28001357	28	              COMM-NUMBER CUSTOMER-NUMBER REQUIRED-CUST-NUMBER2	0	0	1
28001358	28	              NCS-CUST-NO-VALUE.	0	0	1
28001360	28	       GLCV999.	0	0	1
28001361	28	           EXIT.	0	0	1
28001364	28	       DATE-OF-BIRTH-CHECK SECTION.	0	0	1
28001365	28	       DOBC010.	0	0	1
28001366	28	      *	1	0	0
28001367	28	      *    Ensure that the Date Of Birth is valid	1	0	1
28001368	28	      *	1	0	1
28001369	28	           IF COMM-BIRTH-YEAR < 1601	0	0	0
28001370	28	              MOVE 'Y' TO WS-DATE-OF-BIRTH-ERROR	0	0	1
28001371	28	              MOVE 'O' TO COMM-FAIL-CODE	0	0	1
28001372	28	              GO TO DOBC999	0	0	1
28001373	28	           END-IF.	0	0	1
28001375	28	           MOVE COMM-BIRTH-YEAR TO CEEDAYS-YEAR.	0	0	1
28001376	28	           MOVE COMM-BIRTH-MONTH TO CEEDAYS-MONTH.	0	0	1
28001377	28	           MOVE COMM-BIRTH-DAY TO CEEDAYS-DAY.	0	0	1
28001379	28	           CALL "CEEDAYS" USING DATE-OF-BIRTH-FOR-CEEDAYS	0	0	1
28001380	28	                                DATE-OF-BIRTH-FORMAT,	0	0	1
28001381	28	                                WS-DATE-OF-BIRTH-LILLIAN,	0	0	1
28001382	28	                                FC.	0	0	1
28001384	28	           IF NOT CEE000 OF FC THEN	0	0	1
28001385	28	              MOVE 'Y' TO WS-DATE-OF-BIRTH-ERROR	0	0	1
28001386	28	              MOVE 'Z' TO COMM-FAIL-CODE	0	0	1
28001387	28	              DISPLAY 'CEEDAYS failed, FORMAT LENGTH 10 with msg '	0	0	1
28001388	28	                 MSG-NO OF FC	0	0	1
28001389	28	                 ' for date YYYYMMDD' DATE-OF-BIRTH-FOR-CEEDAYS	0	0	1
28001390	28	              GO TO DOBC999	0	0	1
28001391	28	           END-IF.	0	0	1
28001393	28	           CALL "CEELOCT" USING WS-TODAY-LILLIAN,	0	0	1
28001394	28	                                WS-TODAY-SECONDS,	0	0	1
28001395	28	                                WS-TODAY-GREGORIAN,	0	0	1
28001396	28	                                FC.	0	0	1
28001398	28	           IF NOT CEE000 OF FC THEN	0	0	1
28001399	28	              MOVE 'Y' TO WS-DATE-OF-BIRTH-ERROR	0	0	1
28001400	28	              DISPLAY 'CEEDLOCT failed with msg '	0	0	1
28001401	28	                 MSG-NO OF FC	0	0	1
28001402	28	              GO TO DOBC999	0	0	1
28001403	28	           END-IF.	0	0	1
28001405	28	           SUBTRACT COMM-BIRTH-YEAR FROM WS-TODAY-G-YEAR	0	0	1
28001406	28	              GIVING WS-CUSTOMER-AGE	0	0	1
28001408	28	           IF WS-CUSTOMER-AGE > 150	0	0	1
28001409	28	              MOVE 'Y' TO WS-DATE-OF-BIRTH-ERROR	0	0	1
28001410	28	              MOVE 'O' TO COMM-FAIL-CODE	0	0	1
28001411	28	              GO TO DOBC999	0	0	1
28001412	28	           END-IF.	0	0	1
28001414	28	           IF WS-TODAY-LILLIAN < WS-DATE-OF-BIRTH-LILLIAN	0	0	1
28001415	28	                        MOVE 'Y' TO WS-DATE-OF-BIRTH-ERROR	0	0	1
28001416	28	              MOVE 'Y' TO COMM-FAIL-CODE	0	0	1
28001417	28	           END-IF.	0	0	1
28001419	28	       DOBC999.	0	0	1
28001420	28	           EXIT.	0	0	1
28001423	28	       POPULATE-TIME-DATE2 SECTION.	0	0	1
28001424	28	       PTD2010.	0	0	1
28001425	28	      D    DISPLAY 'POPULATE-TIME-DATE2 SECTION'.	0	0	1
28001427	28	           EXEC CICS ASKTIME	0	0	1
28001428	28	              ABSTIME(WS-U-TIME)	0	0	1
28001429	28	           END-EXEC.	0	0	1
28001431	28	           EXEC CICS FORMATTIME	0	0	1
28001432	28	                     ABSTIME(WS-U-TIME)	0	0	1
28001433	28	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
28001434	28	                     TIME(WS-TIME-NOW)	0	0	1
28001435	28	                     DATESEP	0	0	1
28001436	28	           END-EXEC.	0	0	1
28001438	28	       PTD2999.	0	0	1
28001439	28	           EXIT.	0	0	1
29000000	29	<<<< file not found >>>>	0	0	0
29000001	29	<<<< file not found >>>>	0	0	0
30000000	30	<<<< file not found >>>>	0	0	0
30000001	30	<<<< file not found >>>>	0	0	0
31000000	31	<<<< file not found >>>>	0	0	0
31000001	31	<<<< file not found >>>>	0	0	0
32000001	32	       CBL CICS('SP,EDF')	0	0	1
32000002	32	       CBL SQL	0	0	1
32000003	32	      ******************************************************************	1	0	0
32000004	32	      *                                                                *	1	0	1
32000005	32	      *  Copyright IBM Corp. 2023                                      *	1	0	1
32000006	32	      *                                                                *	1	0	1
32000007	32	      ******************************************************************	1	0	1
32000008	32	      ******************************************************************	1	0	1
32000009	32	      * This program takes account information from the BMS	1	0	1
32000010	32	      * application (cust no, name, address and DOB) and then enqueues	1	0	1
32000011	32	      * the Named Counter for ACCOUNT, increments the counter and takes	1	0	1
32000012	32	      * the new account number, & attempt to update the ACCOUNT	1	0	1
32000013	32	      * datastore on DB2. If that is successful, write a rec to	1	0	1
32000014	32	      * the PROCTRAN datastore. Then, if all of that works, DEQUEUE	1	0	1
32000015	32	      * the named counter and return the ACCOUNT number.	1	0	1
32000016	32	      * If for any reason the write to the ACCOUNT or PROCTRAN	1	0	1
32000017	32	      * datatsore is unsuccessful, then we need to decrement the Named	1	0	1
32000018	32	      * Counter (restoring it to the start position) and DEQUEUE the	1	0	1
32000019	32	      * Named Counter.	1	0	1
32000020	32	      *	1	0	1
32000021	32	      *	1	0	1
32000022	32	      ******************************************************************	1	0	1
32000024	32	       IDENTIFICATION DIVISION.	0	0	0
32000025	32	       PROGRAM-ID. CREACC.	0	0	1
32000026	32	       AUTHOR. Jon Collett.	0	0	1
32000028	32	       ENVIRONMENT DIVISION.	0	0	1
32000029	32	       CONFIGURATION SECTION.	0	0	1
32000030	32	      * SOURCE-COMPUTER.  IBM-370 WITH DEBUGGING MODE.	1	0	0
32000031	32	       SOURCE-COMPUTER.  IBM-370.	0	0	0
32000032	32	       OBJECT-COMPUTER.  IBM-370.	0	0	1
32000034	32	       INPUT-OUTPUT SECTION.	0	0	1
32000036	32	       DATA DIVISION.	0	0	1
32000037	32	       FILE SECTION.	0	0	1
32000039	32	       WORKING-STORAGE SECTION.	0	0	1
32000042	32	       COPY SORTCODE.	0	0	1
32000046	32	       77 SYSIDERR-RETRY PIC 999.	0	0	1
32000048	32	      * Get the ACCOUNT DB2 copybook	1	0	0
32000049	32	           EXEC SQL	0	0	0
32000050	32	              INCLUDE ACCDB2	0	0	1
32000051	32	           END-EXEC.	0	0	1
32000053	32	      * ACCOUNT Host variables for DB2	1	0	0
32000054	32	       01 HOST-ACCOUNT-ROW.	0	0	0
32000055	32	          03 HV-ACCOUNT-EYECATCHER          PIC X(4).	0	0	1
32000056	32	          03 HV-ACCOUNT-CUST-NO             PIC X(10).	0	0	1
32000057	32	          03 HV-ACCOUNT-SORTCODE            PIC X(6).	0	0	1
32000058	32	          03 HV-ACCOUNT-ACC-NO              PIC X(8).	0	0	1
32000059	32	          03 HV-ACCOUNT-ACC-TYPE            PIC X(8).	0	0	1
32000060	32	          03 HV-ACCOUNT-INT-RATE            PIC S9(4)V99 COMP-3.	0	0	1
32000061	32	          03 HV-ACCOUNT-OPENED              PIC X(10).	0	0	1
32000062	32	          03 HV-ACCOUNT-OPENED-GROUP REDEFINES HV-ACCOUNT-OPENED.	0	0	1
32000063	32	             05 HV-ACCOUNT-OPENED-DAY       PIC XX.	0	0	1
32000064	32	             05 HV-ACCOUNT-OPENED-DELIM1    PIC X.	0	0	1
32000065	32	             05 HV-ACCOUNT-OPENED-MONTH     PIC XX.	0	0	1
32000066	32	             05 HV-ACCOUNT-OPENED-DELIM2    PIC X.	0	0	1
32000067	32	             05 HV-ACCOUNT-OPENED-YEAR      PIC X(4).	0	0	1
32000068	32	          03 HV-ACCOUNT-OVERDRAFT-LIM       PIC S9(9) COMP.	0	0	1
32000069	32	          03 HV-ACCOUNT-LAST-STMT           PIC X(10).	0	0	1
32000070	32	          03 HV-ACCOUNT-LAST-STMT-GROUP	0	0	1
32000071	32	             REDEFINES HV-ACCOUNT-LAST-STMT.	0	0	1
32000072	32	             05 HV-ACCOUNT-LAST-STMT-DAY    PIC XX.	0	0	1
32000073	32	             05 HV-ACCOUNT-LAST-STMT-DELIM1 PIC X.	0	0	1
32000074	32	             05 HV-ACCOUNT-LAST-STMT-MONTH  PIC XX.	0	0	1
32000075	32	             05 HV-ACCOUNT-LAST-STMT-DELIM2 PIC X.	0	0	1
32000076	32	             05 HV-ACCOUNT-LAST-STMT-YEAR   PIC X(4).	0	0	1
32000077	32	          03 HV-ACCOUNT-NEXT-STMT           PIC X(10).	0	0	1
32000078	32	          03 HV-ACCOUNT-NEXT-STMT-GROUP	0	0	1
32000079	32	             REDEFINES HV-ACCOUNT-NEXT-STMT.	0	0	1
32000080	32	             05 HV-ACCOUNT-NEXT-STMT-DAY    PIC XX.	0	0	1
32000081	32	             05 HV-ACCOUNT-NEXT-STMT-DELIM1 PIC X.	0	0	1
32000082	32	             05 HV-ACCOUNT-NEXT-STMT-MONTH  PIC XX.	0	0	1
32000083	32	             05 HV-ACCOUNT-NEXT-STMT-DELIM2 PIC X.	0	0	1
32000084	32	             05 HV-ACCOUNT-NEXT-STMT-YEAR   PIC X(4).	0	0	1
32000085	32	          03 HV-ACCOUNT-AVAIL-BAL           PIC S9(10)V99 COMP-3.	0	0	1
32000086	32	          03 HV-ACCOUNT-ACTUAL-BAL          PIC S9(10)V99 COMP-3.	0	0	1
32000089	32	       01 SQLCODE-DISPLAY                   PIC S9(8) DISPLAY	0	0	1
32000090	32	           SIGN LEADING SEPARATE.	0	0	1
32000092	32	      * PROCTRAN DB2 copybook	1	0	0
32000093	32	          EXEC SQL	0	0	0
32000094	32	             INCLUDE PROCDB2	0	0	1
32000095	32	          END-EXEC.	0	0	1
32000097	32	      * PROCTRAN host variables for DB2	1	0	0
32000098	32	       01 HOST-PROCTRAN-ROW.	0	0	0
32000099	32	          03 HV-PROCTRAN-EYECATCHER         PIC X(4).	0	0	1
32000100	32	          03 HV-PROCTRAN-SORT-CODE          PIC X(6).	0	0	1
32000101	32	          03 HV-PROCTRAN-ACC-NUMBER         PIC X(8).	0	0	1
32000102	32	          03 HV-PROCTRAN-DATE               PIC X(10).	0	0	1
32000103	32	          03 HV-PROCTRAN-TIME               PIC X(6).	0	0	1
32000104	32	          03 HV-PROCTRAN-REF                PIC X(12).	0	0	1
32000105	32	          03 HV-PROCTRAN-TYPE               PIC X(3).	0	0	1
32000106	32	          03 HV-PROCTRAN-DESC               PIC X(40).	0	0	1
32000107	32	          03 HV-PROCTRAN-AMOUNT             PIC S9(10)V99 COMP-3.	0	0	1
32000109	32	      * CONTROL Host variables for DB2	1	0	0
32000110	32	       01 HOST-CONTROL-ROW.	0	0	0
32000111	32	           03 HV-CONTROL-NAME                  PIC X(32).	0	0	1
32000112	32	           03 HV-CONTROL-VALUE-NUM             PIC S9(9) COMP.	0	0	1
32000113	32	           03 HV-CONTROL-VALUE-STR             PIC X(40).	0	0	1
32000116	32	      * Pull in the SQL COMMAREA	1	0	0
32000117	32	       EXEC SQL	0	0	0
32000118	32	          INCLUDE SQLCA	0	0	1
32000119	32	       END-EXEC.	0	0	1
32000121	32	       01 PROCTRAN-AREA.	0	0	1
32000122	32	          COPY PROCTRAN.	0	0	1
32000124	32	       01 PROCTRAN-RIDFLD                   PIC S9(8) COMP.	0	0	1
32000126	32	       01 PROCTRAN-RETRY                    PIC 999.	0	0	1
32000127	32	       01 WS-EXIT-RETRY-LOOP                PIC X VALUE ' '.	0	0	1
32000129	32	       01 WS-CICS-WORK-AREA.	0	0	1
32000130	32	          05 WS-CICS-RESP                   PIC S9(8) COMP.	0	0	1
32000131	32	          05 WS-CICS-RESP2                  PIC S9(8) COMP.	0	0	1
32000132	32	          05 WS-EIBRESP-DISPLAY             PIC S9(8) DISPLAY	0	0	1
32000133	32	                                               SIGN LEADING SEPARATE.	0	0	1
32000135	32	       01 WS-CUSTOMER-NO-NUM                PIC 9(10).	0	0	1
32000137	32	       LOCAL-STORAGE SECTION.	0	0	1
32000138	32	       01 FILE-RETRY                        PIC 999.	0	0	1
32000140	32	       01 OUTPUT-DATA.	0	0	1
32000141	32	           COPY ACCOUNT.	0	0	1
32000143	32	       01 OUTPUTC-DATA.	0	0	1
32000144	32	           COPY CUSTOMER.	0	0	1
32000146	32	       01 RETURN-DATA.	0	0	1
32000147	32	          03 RETURN-DATA-EYECATCHER         PIC X(4).	0	0	1
32000148	32	          03 RETURN-DATA-NUMBER             PIC 9(10) DISPLAY.	0	0	1
32000149	32	          03 RETURN-DATA-NAME               PIC X(60).	0	0	1
32000150	32	          03 RETURN-DATA-ADDRESS            PIC X(160).	0	0	1
32000151	32	          03 RETURN-DATA-DATE-OF-BIRTH      PIC 9(8).	0	0	1
32000154	32	       01 CUSTOMER-KY.	0	0	1
32000155	32	          03 REQUIRED-SORT-CODE             PIC 9(6) VALUE 0.	0	0	1
32000156	32	          03 REQUIRED-CUST-NUMBER           PIC 9(10) VALUE 0.	0	0	1
32000158	32	       01 ACCOUNT-KY.	0	0	1
32000159	32	          03 REQUIRED-SORT-CODE2            PIC 9(6) VALUE 0.	0	0	1
32000160	32	          03 REQUIRED-ACC-NUMBER            PIC 9(8) VALUE 0.	0	0	1
32000162	32	       01 RANDOM-CUSTOMER                   PIC 9(10) VALUE 0.	0	0	1
32000163	32	       01 HIGHEST-CUST-NUMBER               PIC 9(10) VALUE 0.	0	0	1
32000165	32	       01 EXIT-VSAM-READ                    PIC X VALUE 'N'.	0	0	1
32000166	32	       01 EXIT-DB2-READ                     PIC X VALUE 'N'.	0	0	1
32000168	32	       01 WS-V-RETRIED                      PIC X VALUE 'N'.	0	0	1
32000169	32	       01 WS-D-RETRIED                      PIC X VALUE 'N'.	0	0	1
32000171	32	       01 WS-ERROR                          PIC X(40) VALUE ALL '#'.	0	0	1
32000173	32	      *	1	0	0
32000174	32	      * CUSTOMER NCS definitions	1	0	1
32000175	32	      *	1	0	1
32000176	32	       01 NCS-ACC-NO-STUFF.	0	0	0
32000177	32	          03 NCS-ACC-NO-NAME.	0	0	1
32000178	32	             05 NCS-ACC-NO-ACT-NAME         PIC X(8)	0	0	1
32000179	32	                                 VALUE 'CBSAACCT'.	0	0	1
32000180	32	             05 NCS-ACC-NO-TEST-SORT        PIC X(6)	0	0	1
32000181	32	                                 VALUE '      '.	0	0	1
32000182	32	             05 NCS-ACC-NO-FILL             PIC XX	0	0	1
32000183	32	                                 VALUE '  '.	0	0	1
32000185	32	          03 NCS-ACC-NO-INC                 PIC 9(16) COMP	0	0	1
32000186	32	                                 VALUE 0.	0	0	1
32000187	32	          03 NCS-ACC-NO-VALUE               PIC 9(16) COMP	0	0	1
32000188	32	                                 VALUE 0.	0	0	1
32000190	32	          03 NCS-ACC-NO-RESP                PIC XX VALUE '00'.	0	0	1
32000194	32	       01 WS-DISP-CUST-NO-VAL               PIC S9(18) DISPLAY.	0	0	1
32000196	32	       01 WS-ACC-REC-LEN                    PIC S9(4) COMP VALUE 0.	0	0	1
32000198	32	       01 NCS-UPDATED                       PIC X VALUE 'N'.	0	0	1
32000200	32	       01 WS-U-TIME                         PIC S9(15) COMP-3.	0	0	1
32000201	32	       01 WS-ORIG-DATE                      PIC X(10).	0	0	1
32000202	32	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
32000203	32	          03 WS-ORIG-DATE-DD                PIC 99.	0	0	1
32000204	32	          03 FILLER                         PIC X.	0	0	1
32000205	32	          03 WS-ORIG-DATE-MM                PIC 99.	0	0	1
32000206	32	          03 FILLER                         PIC X.	0	0	1
32000207	32	          03 WS-ORIG-DATE-YYYY              PIC 9999.	0	0	1
32000209	32	       01 DONT-CARE                         PIC 9(8) BINARY.	0	0	1
32000210	32	       01 LEAP-YEAR                         PIC 9(8) BINARY.	0	0	1
32000212	32	       01 WS-ORIG-DATE-GRP-X.	0	0	1
32000213	32	          03 WS-ORIG-DATE-DD-X              PIC XX.	0	0	1
32000214	32	          03 FILLER                         PIC X VALUE '.'.	0	0	1
32000215	32	          03 WS-ORIG-DATE-MM-X              PIC XX.	0	0	1
32000216	32	          03 FILLER                         PIC X VALUE '.'.	0	0	1
32000217	32	          03 WS-ORIG-DATE-YYYY-X            PIC X(4).	0	0	1
32000219	32	       01 WS-STDT-X                         PIC X(8).	0	0	1
32000220	32	       01 WS-STDT-9  REDEFINES WS-STDT-X.	0	0	1
32000221	32	          03 WS-STDT-9-NUM                  PIC 9(8).	0	0	1
32000222	32	       01 WS-STDT-9-NUMERIC                 PIC 9(8).	0	0	1
32000224	32	       01 WS-INTEGER                        PIC S9(9) COMP VALUE 0.	0	0	1
32000226	32	       01 WS-FUTURE-DATE                    PIC 9(8).	0	0	1
32000227	32	       01 WS-FUT REDEFINES WS-FUTURE-DATE.	0	0	1
32000228	32	          03 WS-FUTURE-YY                   PIC 9(4).	0	0	1
32000229	32	          03 WS-FUTURE-MM                   PIC 99.	0	0	1
32000230	32	          03 WS-FUTURE-DD                   PIC 99.	0	0	1
32000232	32	       01 WS-FUTURE-CONV.	0	0	1
32000233	32	          03 WS-FUT-9                       PIC 9(8).	0	0	1
32000234	32	          03 WS-FUT-X REDEFINES WS-FUT-9.	0	0	1
32000235	32	             05 WS-FUT-X-YY                 PIC X(4).	0	0	1
32000236	32	             05 WS-FUT-X-MM                 PIC XX.	0	0	1
32000237	32	             05 WS-FUT-X-DD                 PIC XX.	0	0	1
32000239	32	       01 NCS-ACC-NO-DISP                   PIC 9(16) VALUE 0.	0	0	1
32000241	32	       01 STORED-SORTCODE                   PIC X(6)  VALUE SPACES.	0	0	1
32000242	32	       01 STORED-CUSTNO                     PIC X(10) VALUE SPACES.	0	0	1
32000243	32	       01 STORED-ACCTYPE                    PIC X(8)  VALUE SPACES.	0	0	1
32000244	32	       01 STORED-LST-STMT                   PIC X(8)  VALUE SPACES.	0	0	1
32000245	32	       01 STORED-NXT-STMT                   PIC X(8)  VALUE SPACES.	0	0	1
32000246	32	       01 STORED-ACCNO                      PIC X(8)  VALUE SPACES.	0	0	1
32000248	32	       01 WS-EIBTASKN12                     PIC 9(12) VALUE 0.	0	0	1
32000250	32	       01 ACCOUNT-KY3.	0	0	1
32000251	32	          03 REQUIRED-SORT-CODE3            PIC 9(6) VALUE 0.	0	0	1
32000252	32	          03 REQUIRED-ACCT-NUMBER3          PIC 9(8) VALUE 0.	0	0	1
32000254	32	       01 ACCOUNT-KY3-BYTES REDEFINES ACCOUNT-KY3 PIC X(14).	0	0	1
32000256	32	       01 INQCUST-COMMAREA.	0	0	1
32000257	32	          COPY INQCUST.	0	0	1
32000259	32	       01 INQACCCU-COMMAREA.	0	0	1
32000260	32	           COPY INQACCCU REPLACING ==NUMBER-OF-ACCOUNTS.==	0	0	1
32000261	32	           BY ==NUMBER-OF-ACCOUNTS IN INQACCCU-COMMAREA.==.	0	0	1
32000263	32	       01 STORM-DRAIN-CONDITION             PIC X(20).	0	0	1
32000265	32	       01 ACCOUNT-CONTROL.	0	0	1
32000266	32	          COPY ACCTCTRL.	0	0	1
32000269	32	       01 WS-TIME-DATA.	0	0	1
32000270	32	           03 WS-TIME-NOW                   PIC 9(6).	0	0	1
32000271	32	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
32000272	32	              05 WS-TIME-NOW-GRP-HH         PIC 99.	0	0	1
32000273	32	              05 WS-TIME-NOW-GRP-MM         PIC 99.	0	0	1
32000274	32	              05 WS-TIME-NOW-GRP-SS         PIC 99.	0	0	1
32000276	32	       01 WS-ABEND-PGM                      PIC X(8) VALUE 'ABNDPROC'.	0	0	1
32000278	32	       01 ABNDINFO-REC.	0	0	1
32000279	32	           COPY ABNDINFO.	0	0	1
32000281	32	       LINKAGE SECTION.	0	0	1
32000282	32	       01 DFHCOMMAREA.	0	0	1
32000283	32	           COPY CREACC.	0	0	1
32000286	32	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
32000287	32	       PREMIERE SECTION.	0	0	1
32000288	32	       P010.	0	0	1
32000290	32	           MOVE SORTCODE TO	0	0	1
32000291	32	              REQUIRED-SORT-CODE	0	0	1
32000292	32	              REQUIRED-SORT-CODE2.	0	0	1
32000294	32	           MOVE ZERO TO ACCOUNT-NUMBER.	0	0	1
32000295	32	           INITIALIZE INQCUST-COMMAREA	0	0	1
32000297	32	      *	1	0	0
32000298	32	      *    We need to validate that the supplied CUSTOMER actually	1	0	1
32000299	32	      *    exists by linking to INQCUST.	1	0	1
32000300	32	      *	1	0	1
32000302	32	           MOVE COMM-CUSTNO IN DFHCOMMAREA TO INQCUST-CUSTNO.	0	0	0
32000304	32	           EXEC CICS LINK PROGRAM('INQCUST ')	0	0	1
32000305	32	                     COMMAREA(INQCUST-COMMAREA)	0	0	1
32000306	32	                     RESP(WS-CICS-RESP)	0	0	1
32000307	32	           END-EXEC.	0	0	1
32000309	32	      *	1	0	0
32000310	32	      *    If the link failed for some reason, or the link to INQCUST	1	0	1
32000311	32	      *    indicated that customer information could not be	1	0	1
32000312	32	      *    successfully retrieved then set fail flags and finished.	1	0	1
32000313	32	      *	1	0	1
32000314	32	           IF EIBRESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	0
32000315	32	           OR INQCUST-INQ-SUCCESS IS NOT EQUAL TO 'Y'	0	0	1
32000317	32	             MOVE 'N' TO COMM-SUCCESS IN DFHCOMMAREA	0	0	1
32000318	32	             MOVE '1' TO COMM-FAIL-CODE IN DFHCOMMAREA	0	0	1
32000320	32	             PERFORM GET-ME-OUT-OF-HERE	0	0	1
32000322	32	           END-IF	0	0	1
32000324	32	      *	1	0	0
32000325	32	      *    Link to INQACCCU to  get account information	1	0	1
32000326	32	      *	1	0	1
32000327	32	           PERFORM CUSTOMER-ACCOUNT-COUNT.	0	0	0
32000329	32	           IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	1
32000330	32	             DISPLAY 'Error counting accounts'	0	0	1
32000331	32	             MOVE 'N' to COMM-SUCCESS IN DFHCOMMAREA	0	0	1
32000332	32	             MOVE 'N' to COMM-SUCCESS IN INQACCCU-COMMAREA	0	0	1
32000333	32	             MOVE '9' TO COMM-FAIL-CODE IN DFHCOMMAREA	0	0	1
32000335	32	             PERFORM GET-ME-OUT-OF-HERE	0	0	1
32000336	32	           END-IF	0	0	1
32000338	32	           IF COMM-SUCCESS IN INQACCCU-COMMAREA = 'N'	0	0	1
32000339	32	             DISPLAY 'Error counting accounts'	0	0	1
32000340	32	             MOVE 'N' to COMM-SUCCESS IN DFHCOMMAREA	0	0	1
32000341	32	             MOVE '9' TO COMM-FAIL-CODE IN DFHCOMMAREA	0	0	1
32000343	32	             PERFORM GET-ME-OUT-OF-HERE	0	0	1
32000344	32	           END-IF	0	0	1
32000347	32	           IF NUMBER-OF-ACCOUNTS IN INQACCCU-COMMAREA > 9	0	0	1
32000348	32	             MOVE 'N' TO COMM-SUCCESS IN DFHCOMMAREA	0	0	1
32000349	32	             MOVE '8' TO COMM-FAIL-CODE IN DFHCOMMAREA	0	0	1
32000351	32	             PERFORM GET-ME-OUT-OF-HERE	0	0	1
32000352	32	           END-IF	0	0	1
32000354	32	      *	1	0	0
32000355	32	      *    Validate the type of account e.g. MORTGAGE etc.	1	0	1
32000356	32	      *	1	0	1
32000357	32	           PERFORM ACCOUNT-TYPE-CHECK	0	0	0
32000359	32	           IF COMM-SUCCESS OF DFHCOMMAREA = 'N'	0	0	1
32000360	32	             PERFORM GET-ME-OUT-OF-HERE	0	0	1
32000361	32	           END-IF	0	0	1
32000364	32	      *	1	0	0
32000365	32	      *    Having verified that the CUSTOMER exists we can now process	1	0	1
32000366	32	      *    the ACCOUNT information.  Enqueue the Named Counter for	1	0	1
32000367	32	      *    ACCOUNT.	1	0	1
32000368	32	      *	1	0	1
32000369	32	           PERFORM ENQ-NAMED-COUNTER.	0	0	0
32000371	32	      *	1	0	0
32000372	32	      *    Get the next ACCOUNT number from the ACCOUNT CONTROL Table	1	0	1
32000373	32	      *	1	0	1
32000374	32	           PERFORM FIND-NEXT-ACCOUNT.	0	0	0
32000376	32	           PERFORM WRITE-ACCOUNT-DB2	0	0	1
32000379	32	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
32000381	32	       P999.	0	0	1
32000382	32	           EXIT.	0	0	1
32000385	32	       ENQ-NAMED-COUNTER SECTION.	0	0	1
32000386	32	       ENC010.	0	0	1
32000388	32	           MOVE SORTCODE TO NCS-ACC-NO-TEST-SORT.	0	0	1
32000390	32	           EXEC CICS ENQ	0	0	1
32000391	32	              RESOURCE(NCS-ACC-NO-NAME)	0	0	1
32000392	32	              LENGTH(16)	0	0	1
32000393	32	              RESP(WS-CICS-RESP)	0	0	1
32000394	32	              RESP2(WS-CICS-RESP2)	0	0	1
32000395	32	           END-EXEC.	0	0	1
32000397	32	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
32000398	32	             MOVE 'N' TO COMM-SUCCESS IN DFHCOMMAREA	0	0	1
32000399	32	             MOVE '3' TO COMM-FAIL-CODE IN DFHCOMMAREA	0	0	1
32000400	32	             PERFORM GET-ME-OUT-OF-HERE	0	0	1
32000401	32	           END-IF.	0	0	1
32000403	32	       ENC999.	0	0	1
32000404	32	           EXIT.	0	0	1
32000407	32	       DEQ-NAMED-COUNTER SECTION.	0	0	1
32000408	32	       DNC010.	0	0	1
32000410	32	           MOVE SORTCODE TO NCS-ACC-NO-TEST-SORT.	0	0	1
32000412	32	           EXEC CICS DEQ	0	0	1
32000413	32	              RESOURCE(NCS-ACC-NO-NAME)	0	0	1
32000414	32	              LENGTH(16)	0	0	1
32000415	32	              RESP(WS-CICS-RESP)	0	0	1
32000416	32	              RESP2(WS-CICS-RESP2)	0	0	1
32000417	32	           END-EXEC.	0	0	1
32000419	32	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
32000420	32	             MOVE 'N' TO COMM-SUCCESS IN DFHCOMMAREA	0	0	1
32000421	32	             MOVE '5' TO COMM-FAIL-CODE IN DFHCOMMAREA	0	0	1
32000422	32	             PERFORM GET-ME-OUT-OF-HERE	0	0	1
32000423	32	           END-IF.	0	0	1
32000425	32	       DNC999.	0	0	1
32000426	32	           EXIT.	0	0	1
32000429	32	       FIND-NEXT-ACCOUNT SECTION.	0	0	1
32000430	32	       FNA010.	0	0	1
32000432	32	           MOVE 1 TO NCS-ACC-NO-INC.	0	0	1
32000434	32	           INITIALIZE OUTPUT-DATA.	0	0	1
32000436	32	      * <<sortcode>>-ACCOUNT-LAST	1	0	0
32000437	32	           MOVE SPACES TO HV-CONTROL-NAME	0	0	0
32000438	32	           MOVE ZERO TO HV-CONTROL-VALUE-NUM	0	0	1
32000439	32	           MOVE SPACES TO HV-CONTROL-VALUE-STR	0	0	1
32000440	32	           STRING REQUIRED-SORT-CODE DELIMITED BY SIZE	0	0	1
32000441	32	           '-' DELIMITED BY SIZE	0	0	1
32000442	32	           'ACCOUNT-LAST' DELIMITED BY SIZE	0	0	1
32000443	32	           INTO HV-CONTROL-NAME	0	0	1
32000444	32	           EXEC SQL	0	0	1
32000445	32	              SELECT CONTROL_NAME,	0	0	1
32000446	32	                       CONTROL_VALUE_NUM,	0	0	1
32000447	32	                       CONTROL_VALUE_STR	0	0	1
32000448	32	              INTO :HV-CONTROL-NAME,	0	0	1
32000449	32	                      :HV-CONTROL-VALUE-NUM,	0	0	1
32000450	32	                      :HV-CONTROL-VALUE-STR	0	0	1
32000451	32	              FROM CONTROL	0	0	1
32000452	32	              WHERE CONTROL_NAME = :HV-CONTROL-NAME	0	0	1
32000453	32	           END-EXEC.	0	0	1
32000455	32	           IF SQLCODE IS NOT EQUAL TO ZERO	0	0	1
32000457	32	             MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
32000459	32	      *	1	0	0
32000460	32	      *      Preserve the RESP and RESP2, then set up the	1	0	1
32000461	32	      *      standard ABEND info before getting the applid,	1	0	1
32000462	32	      *      date/time etc. and linking to the Abend Handler	1	0	1
32000463	32	      *      program.	1	0	1
32000464	32	      *	1	0	1
32000465	32	             INITIALIZE ABNDINFO-REC	0	0	0
32000466	32	             MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
32000467	32	             MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
32000468	32	      *	1	0	0
32000469	32	      *      Get supplemental information	1	0	1
32000470	32	      *	1	0	1
32000471	32	             EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
32000472	32	             END-EXEC	0	0	1
32000474	32	             MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
32000475	32	             MOVE EIBTRNID   TO ABND-TRANID	0	0	1
32000477	32	             PERFORM POPULATE-TIME-DATE2	0	0	1
32000479	32	             MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
32000480	32	             STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
32000481	32	                    ':' DELIMITED BY SIZE,	0	0	1
32000482	32	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
32000483	32	                     ':' DELIMITED BY SIZE,	0	0	1
32000484	32	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
32000485	32	                     INTO ABND-TIME	0	0	1
32000486	32	             END-STRING	0	0	1
32000488	32	             MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
32000489	32	             MOVE 'HNCS'      TO ABND-CODE	0	0	1
32000491	32	             EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
32000492	32	             END-EXEC	0	0	1
32000494	32	             MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE	0	0	1
32000496	32	             STRING 'FNAND010 - ACCOUNT NCS '	0	0	1
32000497	32	                    DELIMITED BY SIZE,	0	0	1
32000498	32	                    NCS-ACC-NO-NAME DELIMITED BY SIZE,	0	0	1
32000499	32	                    ' Cannot be accessed and DB2 SELECT failed.'	0	0	1
32000500	32	                    DELIMITED BY SIZE,	0	0	1
32000501	32	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
32000502	32	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
32000503	32	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
32000504	32	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
32000505	32	                    INTO ABND-FREEFORM	0	0	1
32000506	32	             END-STRING	0	0	1
32000508	32	             EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
32000509	32	                        COMMAREA(ABNDINFO-REC)	0	0	1
32000510	32	             END-EXEC	0	0	1
32000513	32	             DISPLAY 'CREACC - ACCOUNT NCS ' NCS-ACC-NO-NAME	0	0	1
32000514	32	                ' CANNOT BE ACCESSED AND DB2 SELECT FAILED. SQLCODE='	0	0	1
32000515	32	                SQLCODE-DISPLAY	0	0	1
32000517	32	             EXEC CICS ABEND	0	0	1
32000518	32	                       ABCODE('HNCS')	0	0	1
32000519	32	                       NODUMP	0	0	1
32000520	32	             END-EXEC	0	0	1
32000521	32	           ELSE	0	0	1
32000522	32	      D      MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
32000523	32	      D      DISPLAY 'SELECT WAS ' SQLCODE-DISPLAY ' AND FOUND '	0	0	1
32000524	32	      D        HV-CONTROL-VALUE-NUM	0	0	1
32000525	32	             ADD 1 TO HV-CONTROL-VALUE-NUM GIVING	0	0	1
32000526	32	             COMM-NUMBER ACCOUNT-NUMBER REQUIRED-ACCT-NUMBER3	0	0	1
32000527	32	             NCS-ACC-NO-VALUE HV-CONTROL-VALUE-NUM	0	0	1
32000529	32	             EXEC SQL	0	0	1
32000530	32	               UPDATE CONTROL	0	0	1
32000531	32	               SET CONTROL_VALUE_NUM = :HV-CONTROL-VALUE-NUM	0	0	1
32000532	32	               WHERE (CONTROL_NAME = :HV-CONTROL-NAME)	0	0	1
32000533	32	             END-EXEC	0	0	1
32000534	32	             IF SQLCODE IS NOT EQUAL TO ZERO	0	0	1
32000535	32	               MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
32000537	32	      *	1	0	0
32000538	32	      *        Preserve the RESP and RESP2, then set up the	1	0	1
32000539	32	      *        standard ABEND info before getting the applid,	1	0	1
32000540	32	      *        date/time etc. and linking to the Abend Handler	1	0	1
32000541	32	      *        program.	1	0	1
32000542	32	      *	1	0	1
32000543	32	               INITIALIZE ABNDINFO-REC	0	0	0
32000544	32	               MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
32000545	32	               MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
32000546	32	      *	1	0	0
32000547	32	      *        Get supplemental information	1	0	1
32000548	32	      *	1	0	1
32000549	32	               EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
32000550	32	               END-EXEC	0	0	1
32000552	32	               MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
32000553	32	               MOVE EIBTRNID   TO ABND-TRANID	0	0	1
32000555	32	               PERFORM POPULATE-TIME-DATE2	0	0	1
32000557	32	               MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
32000558	32	               STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
32000559	32	                    ':' DELIMITED BY SIZE,	0	0	1
32000560	32	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
32000561	32	                     ':' DELIMITED BY SIZE,	0	0	1
32000562	32	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
32000563	32	                     INTO ABND-TIME	0	0	1
32000564	32	               END-STRING	0	0	1
32000566	32	               MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
32000567	32	               MOVE 'HNCS'      TO ABND-CODE	0	0	1
32000569	32	               EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
32000570	32	               END-EXEC	0	0	1
32000572	32	               MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE	0	0	1
32000574	32	               STRING 'FNAND010(2) - ACCOUNT NCS '	0	0	1
32000575	32	                    DELIMITED BY SIZE,	0	0	1
32000576	32	                    NCS-ACC-NO-NAME DELIMITED BY SIZE,	0	0	1
32000577	32	                    ' Cannot be accessed and DB2 UPDATE failed.'	0	0	1
32000578	32	                    DELIMITED BY SIZE,	0	0	1
32000579	32	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
32000580	32	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
32000581	32	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
32000582	32	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
32000583	32	                    INTO ABND-FREEFORM	0	0	1
32000584	32	               END-STRING	0	0	1
32000586	32	               EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
32000587	32	                        COMMAREA(ABNDINFO-REC)	0	0	1
32000588	32	               END-EXEC	0	0	1
32000591	32	               DISPLAY 'CREACC - ACCOUNT NCS ' NCS-ACC-NO-NAME	0	0	1
32000592	32	                  ' CANNOT BE ACCESSED AND DB2 UPDATE FAILED. SQLCODE='	0	0	1
32000593	32	                SQLCODE-DISPLAY	0	0	1
32000595	32	               EXEC CICS ABEND	0	0	1
32000596	32	                         ABCODE('HNCS')	0	0	1
32000597	32	                         NODUMP	0	0	1
32000598	32	               END-EXEC	0	0	1
32000599	32	             END-IF	0	0	1
32000600	32	           END-IF	0	0	1
32000602	32	           MOVE NCS-ACC-NO-VALUE TO	0	0	1
32000603	32	           COMM-NUMBER ACCOUNT-NUMBER REQUIRED-ACCT-NUMBER3.	0	0	1
32000604	32	           MOVE SPACES TO HV-CONTROL-NAME	0	0	1
32000605	32	           MOVE ZERO TO HV-CONTROL-VALUE-NUM	0	0	1
32000606	32	           MOVE SPACES TO HV-CONTROL-VALUE-STR	0	0	1
32000607	32	           STRING SORTCODE DELIMITED BY SIZE	0	0	1
32000608	32	           '-' DELIMITED BY SIZE	0	0	1
32000609	32	           'ACCOUNT-COUNT' DELIMITED BY SIZE	0	0	1
32000610	32	           INTO HV-CONTROL-NAME	0	0	1
32000611	32	           EXEC SQL	0	0	1
32000612	32	              SELECT CONTROL_NAME,	0	0	1
32000613	32	                       CONTROL_VALUE_NUM,	0	0	1
32000614	32	                       CONTROL_VALUE_STR	0	0	1
32000615	32	              INTO :HV-CONTROL-NAME,	0	0	1
32000616	32	                      :HV-CONTROL-VALUE-NUM,	0	0	1
32000617	32	                      :HV-CONTROL-VALUE-STR	0	0	1
32000618	32	              FROM CONTROL	0	0	1
32000619	32	              WHERE CONTROL_NAME = :HV-CONTROL-NAME	0	0	1
32000620	32	           END-EXEC.	0	0	1
32000622	32	           IF SQLCODE IS NOT EQUAL TO ZERO	0	0	1
32000623	32	             MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
32000625	32	      *	1	0	0
32000626	32	      *      Preserve the RESP and RESP2, then set up the	1	0	1
32000627	32	      *      standard ABEND info before getting the applid,	1	0	1
32000628	32	      *      date/time etc. and linking to the Abend Handler	1	0	1
32000629	32	      *      program.	1	0	1
32000630	32	      *	1	0	1
32000631	32	             INITIALIZE ABNDINFO-REC	0	0	0
32000632	32	             MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
32000633	32	             MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
32000634	32	      *	1	0	0
32000635	32	      *      Get supplemental information	1	0	1
32000636	32	      *	1	0	1
32000637	32	             EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
32000638	32	             END-EXEC	0	0	1
32000640	32	             MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
32000641	32	             MOVE EIBTRNID   TO ABND-TRANID	0	0	1
32000643	32	             PERFORM POPULATE-TIME-DATE2	0	0	1
32000645	32	             MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
32000646	32	             STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
32000647	32	                    ':' DELIMITED BY SIZE,	0	0	1
32000648	32	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
32000649	32	                     ':' DELIMITED BY SIZE,	0	0	1
32000650	32	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
32000651	32	                     INTO ABND-TIME	0	0	1
32000652	32	             END-STRING	0	0	1
32000654	32	             MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
32000655	32	             MOVE 'HNCS'      TO ABND-CODE	0	0	1
32000657	32	             EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
32000658	32	             END-EXEC	0	0	1
32000660	32	             MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE	0	0	1
32000662	32	             STRING 'FNAND010(3) - ACCOUNT NCS '	0	0	1
32000663	32	                    DELIMITED BY SIZE,	0	0	1
32000664	32	                    NCS-ACC-NO-NAME DELIMITED BY SIZE,	0	0	1
32000665	32	                    ' Cannot be accessed and DB2 SELECT failed.'	0	0	1
32000666	32	                    DELIMITED BY SIZE,	0	0	1
32000667	32	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
32000668	32	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
32000669	32	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
32000670	32	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
32000671	32	                    INTO ABND-FREEFORM	0	0	1
32000672	32	             END-STRING	0	0	1
32000674	32	             EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
32000675	32	                        COMMAREA(ABNDINFO-REC)	0	0	1
32000676	32	             END-EXEC	0	0	1
32000679	32	             DISPLAY 'CREACC - ACCOUNT NCS ' NCS-ACC-NO-NAME	0	0	1
32000680	32	                ' CANNOT BE ACCESSED AND DB2 SELECT FAILED. SQLCODE='	0	0	1
32000681	32	                SQLCODE-DISPLAY	0	0	1
32000683	32	             EXEC CICS ABEND	0	0	1
32000684	32	                       ABCODE('HNCS')	0	0	1
32000685	32	                       NODUMP	0	0	1
32000686	32	             END-EXEC	0	0	1
32000687	32	           ELSE	0	0	1
32000688	32	      D      MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
32000689	32	      D      DISPLAY 'SELECT WAS ' SQLCODE-DISPLAY ' AND FOUND '	0	0	1
32000690	32	      D        HV-CONTROL-VALUE-NUM	0	0	1
32000691	32	             ADD 1 TO HV-CONTROL-VALUE-NUM GIVING	0	0	1
32000692	32	             HV-CONTROL-VALUE-NUM	0	0	1
32000694	32	             EXEC SQL	0	0	1
32000695	32	               UPDATE CONTROL	0	0	1
32000696	32	               SET CONTROL_VALUE_NUM = :HV-CONTROL-VALUE-NUM	0	0	1
32000697	32	               WHERE (CONTROL_NAME = :HV-CONTROL-NAME)	0	0	1
32000698	32	             END-EXEC	0	0	1
32000699	32	             IF SQLCODE IS NOT EQUAL TO ZERO	0	0	1
32000700	32	               MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
32000702	32	      *	1	0	0
32000703	32	      *        Preserve the RESP and RESP2, then set up the	1	0	1
32000704	32	      *        standard ABEND info before getting the applid,	1	0	1
32000705	32	      *        date/time etc. and linking to the Abend Handler	1	0	1
32000706	32	      *        program.	1	0	1
32000707	32	      *	1	0	1
32000708	32	               INITIALIZE ABNDINFO-REC	0	0	0
32000709	32	               MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
32000710	32	               MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
32000711	32	      *	1	0	0
32000712	32	      *        Get supplemental information	1	0	1
32000713	32	      *	1	0	1
32000714	32	               EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
32000715	32	               END-EXEC	0	0	1
32000717	32	               MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
32000718	32	               MOVE EIBTRNID   TO ABND-TRANID	0	0	1
32000720	32	               PERFORM POPULATE-TIME-DATE2	0	0	1
32000722	32	               MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
32000723	32	               STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
32000724	32	                    ':' DELIMITED BY SIZE,	0	0	1
32000725	32	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
32000726	32	                     ':' DELIMITED BY SIZE,	0	0	1
32000727	32	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
32000728	32	                     INTO ABND-TIME	0	0	1
32000729	32	               END-STRING	0	0	1
32000731	32	               MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
32000732	32	               MOVE 'HNCS'      TO ABND-CODE	0	0	1
32000734	32	               EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
32000735	32	               END-EXEC	0	0	1
32000737	32	               MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE	0	0	1
32000739	32	               STRING 'FNAND010(4) - ACCOUNT NCS '	0	0	1
32000740	32	                    DELIMITED BY SIZE,	0	0	1
32000741	32	                    NCS-ACC-NO-NAME DELIMITED BY SIZE,	0	0	1
32000742	32	                    ' Cannot be accessed and DB2 UPDATE failed.'	0	0	1
32000743	32	                    DELIMITED BY SIZE,	0	0	1
32000744	32	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
32000745	32	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
32000746	32	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
32000747	32	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
32000748	32	                    INTO ABND-FREEFORM	0	0	1
32000749	32	               END-STRING	0	0	1
32000751	32	               EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
32000752	32	                        COMMAREA(ABNDINFO-REC)	0	0	1
32000753	32	               END-EXEC	0	0	1
32000756	32	               DISPLAY 'CREACC - ACCOUNT NCS ' NCS-ACC-NO-NAME	0	0	1
32000757	32	                  ' CANNOT BE ACCESSED AND DB2 UPDATE FAILED. SQLCODE='	0	0	1
32000758	32	                SQLCODE-DISPLAY	0	0	1
32000760	32	               EXEC CICS ABEND	0	0	1
32000761	32	                         ABCODE('HNCS')	0	0	1
32000762	32	                         NODUMP	0	0	1
32000763	32	               END-EXEC	0	0	1
32000764	32	             END-IF	0	0	1
32000765	32	           END-IF.	0	0	1
32000767	32	       FNA999.	0	0	1
32000768	32	           EXIT.	0	0	1
32000771	32	      *	1	0	0
32000772	32	      * Write the DB2 ACCOUNT table	1	0	1
32000773	32	      *	1	0	1
32000774	32	       WRITE-ACCOUNT-DB2 SECTION.	0	0	0
32000775	32	       WAD010.	0	0	1
32000777	32	           INITIALIZE HOST-ACCOUNT-ROW.	0	0	1
32000778	32	           MOVE 'ACCT' TO HV-ACCOUNT-EYECATCHER.	0	0	1
32000779	32	           MOVE COMM-CUSTNO IN DFHCOMMAREA  TO HV-ACCOUNT-CUST-NO.	0	0	1
32000780	32	           MOVE SORTCODE  TO HV-ACCOUNT-SORTCODE.	0	0	1
32000782	32	           MOVE NCS-ACC-NO-VALUE TO NCS-ACC-NO-DISP.	0	0	1
32000783	32	           MOVE NCS-ACC-NO-DISP(9:8) TO HV-ACCOUNT-ACC-NO.	0	0	1
32000784	32	           MOVE COMM-ACC-TYPE IN DFHCOMMAREA    TO HV-ACCOUNT-ACC-TYPE.	0	0	1
32000785	32	           MOVE COMM-INT-RT      TO HV-ACCOUNT-INT-RATE.	0	0	1
32000786	32	           MOVE COMM-OVERDR-LIM  TO HV-ACCOUNT-OVERDRAFT-LIM.	0	0	1
32000787	32	           MOVE COMM-AVAIL-BAL IN DFHCOMMAREA   TO HV-ACCOUNT-AVAIL-BAL.	0	0	1
32000788	32	           MOVE COMM-ACT-BAL     TO HV-ACCOUNT-ACTUAL-BAL.	0	0	1
32000790	32	           PERFORM CALCULATE-DATES.	0	0	1
32000792	32	      *	1	0	0
32000793	32	      *    Convert gregorian date (YYYYMMDD) to an integer	1	0	1
32000794	32	      *	1	0	1
32000795	32	           STRING WS-ORIG-DATE-YYYY DELIMITED BY SIZE,	0	0	0
32000796	32	                  WS-ORIG-DATE-MM   DELIMITED BY SIZE,	0	0	1
32000797	32	                  WS-ORIG-DATE-DD   DELIMITED BY SIZE	0	0	1
32000798	32	           INTO WS-STDT-X.	0	0	1
32000800	32	           MOVE WS-STDT-9-NUM TO WS-STDT-9-NUMERIC.	0	0	1
32000802	32	           COMPUTE WS-INTEGER =	0	0	1
32000803	32	              FUNCTION INTEGER-OF-DATE(WS-STDT-9-NUMERIC).	0	0	1
32000805	32	      *	1	0	0
32000806	32	      *    Add 30 days to the date	1	0	1
32000807	32	      *	1	0	1
32000808	32	           COMPUTE WS-INTEGER = WS-INTEGER + 30.	0	0	0
32000810	32	      *	1	0	0
32000811	32	      *    Convert integer date back to a Gregorian date (YYYYMMDD)	1	0	1
32000812	32	      *	1	0	1
32000813	32	           COMPUTE WS-FUTURE-DATE =	0	0	0
32000814	32	              FUNCTION DATE-OF-INTEGER (WS-INTEGER).	0	0	1
32000816	32	      *	1	0	0
32000817	32	      *    Store the answer back in the  Next Statement Date	1	0	1
32000818	32	      *	1	0	1
32000819	32	           MOVE WS-FUTURE-DATE      TO WS-FUT-9.	0	0	0
32000820	32	           MOVE WS-FUT-X-YY         TO HV-ACCOUNT-NEXT-STMT-YEAR.	0	0	1
32000821	32	           MOVE '.'                 TO HV-ACCOUNT-NEXT-STMT-DELIM2.	0	0	1
32000822	32	           MOVE WS-FUT-X-MM         TO HV-ACCOUNT-NEXT-STMT-MONTH.	0	0	1
32000823	32	           MOVE '.'                 TO HV-ACCOUNT-NEXT-STMT-DELIM1.	0	0	1
32000824	32	           MOVE WS-FUT-X-DD         TO HV-ACCOUNT-NEXT-STMT-DAY.	0	0	1
32000826	32	           EXEC SQL	0	0	1
32000827	32	              INSERT INTO ACCOUNT	0	0	1
32000828	32	                     (ACCOUNT_EYECATCHER,	0	0	1
32000829	32	                      ACCOUNT_CUSTOMER_NUMBER,	0	0	1
32000830	32	                      ACCOUNT_SORTCODE,	0	0	1
32000831	32	                      ACCOUNT_NUMBER,	0	0	1
32000832	32	                      ACCOUNT_TYPE,	0	0	1
32000833	32	                      ACCOUNT_INTEREST_RATE,	0	0	1
32000834	32	                      ACCOUNT_OPENED,	0	0	1
32000835	32	                      ACCOUNT_OVERDRAFT_LIMIT,	0	0	1
32000836	32	                      ACCOUNT_LAST_STATEMENT,	0	0	1
32000837	32	                      ACCOUNT_NEXT_STATEMENT,	0	0	1
32000838	32	                      ACCOUNT_AVAILABLE_BALANCE,	0	0	1
32000839	32	                      ACCOUNT_ACTUAL_BALANCE	0	0	1
32000840	32	                      )	0	0	1
32000841	32	              VALUES (:HV-ACCOUNT-EYECATCHER,	0	0	1
32000842	32	                      :HV-ACCOUNT-CUST-NO,	0	0	1
32000843	32	                      :HV-ACCOUNT-SORTCODE,	0	0	1
32000844	32	                      :HV-ACCOUNT-ACC-NO,	0	0	1
32000845	32	                      :HV-ACCOUNT-ACC-TYPE,	0	0	1
32000846	32	                      :HV-ACCOUNT-INT-RATE,	0	0	1
32000847	32	                      :HV-ACCOUNT-OPENED,	0	0	1
32000848	32	                      :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
32000849	32	                      :HV-ACCOUNT-LAST-STMT,	0	0	1
32000850	32	                      :HV-ACCOUNT-NEXT-STMT,	0	0	1
32000851	32	                      :HV-ACCOUNT-AVAIL-BAL,	0	0	1
32000852	32	                      :HV-ACCOUNT-ACTUAL-BAL	0	0	1
32000853	32	                     )	0	0	1
32000854	32	           END-EXEC.	0	0	1
32000856	32	      *	1	0	0
32000857	32	      *    Check if the INSERT was unsuccessful and take action.	1	0	1
32000858	32	      *	1	0	1
32000859	32	           IF SQLCODE NOT = 0	0	0	0
32000860	32	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
32000861	32	              MOVE 'N' TO COMM-SUCCESS IN DFHCOMMAREA	0	0	1
32000862	32	              MOVE '7' TO COMM-FAIL-CODE IN DFHCOMMAREA	0	0	1
32000863	32	              PERFORM DEQ-NAMED-COUNTER	0	0	1
32000864	32	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
32000866	32	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
32000867	32	           END-IF.	0	0	1
32000869	32	      *	1	0	0
32000870	32	      *    If the INSERT was successful the WRITE to PROCTRAN datastore	1	0	1
32000871	32	      *	1	0	1
32000872	32	           MOVE HV-ACCOUNT-SORTCODE       TO STORED-SORTCODE.	0	0	0
32000873	32	           MOVE HV-ACCOUNT-ACC-NO         TO STORED-ACCNO.	0	0	1
32000874	32	           MOVE HV-ACCOUNT-CUST-NO        TO STORED-CUSTNO.	0	0	1
32000875	32	           MOVE HV-ACCOUNT-ACC-TYPE       TO STORED-ACCTYPE.	0	0	1
32000876	32	           MOVE HV-ACCOUNT-LAST-STMT(1:2) TO STORED-LST-STMT(1:2).	0	0	1
32000877	32	           MOVE HV-ACCOUNT-LAST-STMT(4:2) TO STORED-LST-STMT(3:2).	0	0	1
32000878	32	           MOVE HV-ACCOUNT-LAST-STMT(7:4) TO STORED-LST-STMT(5:4).	0	0	1
32000879	32	           MOVE HV-ACCOUNT-NEXT-STMT(1:2) TO STORED-NXT-STMT(1:2).	0	0	1
32000880	32	           MOVE HV-ACCOUNT-NEXT-STMT(4:2) TO STORED-NXT-STMT(3:2).	0	0	1
32000881	32	           MOVE HV-ACCOUNT-NEXT-STMT(7:4) TO STORED-NXT-STMT(5:4).	0	0	1
32000883	32	           PERFORM WRITE-PROCTRAN.	0	0	1
32000885	32	           PERFORM DEQ-NAMED-COUNTER.	0	0	1
32000887	32	      *	1	0	0
32000888	32	      *    Set up the missing data in the COMMAREA ready for return	1	0	1
32000889	32	      *	1	0	1
32000890	32	           MOVE HV-ACCOUNT-SORTCODE    TO COMM-SORTCODE.	0	0	0
32000891	32	           MOVE HV-ACCOUNT-ACC-NO      TO COMM-NUMBER.	0	0	1
32000893	32	           MOVE HV-ACCOUNT-OPENED-DAY(1:2)	0	0	1
32000894	32	             TO COMM-OPENED IN DFHCOMMAREA(1:2).	0	0	1
32000895	32	           MOVE HV-ACCOUNT-OPENED-MONTH(1:2)	0	0	1
32000896	32	             TO COMM-OPENED IN DFHCOMMAREA(3:2).	0	0	1
32000897	32	           MOVE HV-ACCOUNT-OPENED-YEAR(1:4)	0	0	1
32000898	32	             TO COMM-OPENED IN DFHCOMMAREA(5:4).	0	0	1
32000899	32	           MOVE HV-ACCOUNT-LAST-STMT-DAY(1:2)	0	0	1
32000900	32	              TO COMM-LAST-STMT-DT IN DFHCOMMAREA(1:2).	0	0	1
32000901	32	           MOVE HV-ACCOUNT-LAST-STMT-MONTH(1:2)	0	0	1
32000902	32	              TO COMM-LAST-STMT-DT IN DFHCOMMAREA(3:2).	0	0	1
32000903	32	           MOVE HV-ACCOUNT-LAST-STMT-YEAR(1:4)	0	0	1
32000904	32	              TO COMM-LAST-STMT-DT IN DFHCOMMAREA(5:4).	0	0	1
32000905	32	           MOVE HV-ACCOUNT-NEXT-STMT-DAY(1:2)	0	0	1
32000906	32	              TO COMM-NEXT-STMT-DT IN DFHCOMMAREA(1:2).	0	0	1
32000907	32	           MOVE HV-ACCOUNT-NEXT-STMT-MONTH(1:2)	0	0	1
32000908	32	              TO COMM-NEXT-STMT-DT IN DFHCOMMAREA(3:2).	0	0	1
32000909	32	           MOVE HV-ACCOUNT-NEXT-STMT-YEAR(1:4)	0	0	1
32000910	32	              TO COMM-NEXT-STMT-DT IN DFHCOMMAREA(5:4).	0	0	1
32000912	32	           MOVE 'ACCT'                 TO COMM-EYECATCHER.	0	0	1
32000913	32	           MOVE 'Y' TO COMM-SUCCESS IN DFHCOMMAREA.	0	0	1
32000914	32	           MOVE ' ' TO COMM-FAIL-CODE IN DFHCOMMAREA.	0	0	1
32000916	32	       WAD999.	0	0	1
32000917	32	           EXIT.	0	0	1
32000920	32	       WRITE-PROCTRAN SECTION.	0	0	1
32000921	32	       WP010.	0	0	1
32000923	32	               PERFORM WRITE-PROCTRAN-DB2.	0	0	1
32000924	32	       WP999.	0	0	1
32000925	32	           EXIT.	0	0	1
32000928	32	       WRITE-PROCTRAN-DB2 SECTION.	0	0	1
32000929	32	       WPD010.	0	0	1
32000930	32	      *	1	0	0
32000931	32	      *    Write the successfully processed transaction to the PROCTRAN	1	0	1
32000932	32	      *    table.	1	0	1
32000933	32	      *	1	0	1
32000934	32	           INITIALIZE HOST-PROCTRAN-ROW.	0	0	0
32000935	32	           INITIALIZE WS-EIBTASKN12.	0	0	1
32000937	32	           MOVE 'PRTR'   TO HV-PROCTRAN-EYECATCHER.	0	0	1
32000938	32	           MOVE SORTCODE TO HV-PROCTRAN-SORT-CODE.	0	0	1
32000939	32	           MOVE STORED-ACCNO TO HV-PROCTRAN-ACC-NUMBER.	0	0	1
32000940	32	           MOVE EIBTASKN TO WS-EIBTASKN12.	0	0	1
32000941	32	           MOVE WS-EIBTASKN12 TO HV-PROCTRAN-REF.	0	0	1
32000943	32	      *	1	0	0
32000944	32	      *    Populate the time and date	1	0	1
32000945	32	      *	1	0	1
32000946	32	           EXEC CICS ASKTIME	0	0	0
32000947	32	              ABSTIME(WS-U-TIME)	0	0	1
32000948	32	           END-EXEC.	0	0	1
32000950	32	           EXEC CICS FORMATTIME	0	0	1
32000951	32	                     ABSTIME(WS-U-TIME)	0	0	1
32000952	32	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
32000953	32	                     TIME(HV-PROCTRAN-TIME)	0	0	1
32000954	32	                     DATESEP('.')	0	0	1
32000955	32	           END-EXEC.	0	0	1
32000957	32	           MOVE WS-ORIG-DATE TO WS-ORIG-DATE-GRP-X.	0	0	1
32000958	32	           MOVE WS-ORIG-DATE-GRP-X TO HV-PROCTRAN-DATE.	0	0	1
32000960	32	           MOVE STORED-CUSTNO     TO HV-PROCTRAN-DESC(1:10).	0	0	1
32000961	32	           MOVE STORED-ACCTYPE    TO HV-PROCTRAN-DESC(11:8).	0	0	1
32000962	32	           MOVE STORED-LST-STMT   TO HV-PROCTRAN-DESC(19:8).	0	0	1
32000963	32	           MOVE STORED-NXT-STMT   TO HV-PROCTRAN-DESC(27:8).	0	0	1
32000964	32	           MOVE SPACES            TO HV-PROCTRAN-DESC(35:6).	0	0	1
32000966	32	           MOVE 'OCA'             TO HV-PROCTRAN-TYPE.	0	0	1
32000967	32	           MOVE 0                 TO HV-PROCTRAN-AMOUNT.	0	0	1
32000969	32	           EXEC SQL	0	0	1
32000970	32	              INSERT INTO PROCTRAN	0	0	1
32000971	32	                     (	0	0	1
32000972	32	                      PROCTRAN_EYECATCHER,	0	0	1
32000973	32	                      PROCTRAN_SORTCODE,	0	0	1
32000974	32	                      PROCTRAN_NUMBER,	0	0	1
32000975	32	                      PROCTRAN_DATE,	0	0	1
32000976	32	                      PROCTRAN_TIME,	0	0	1
32000977	32	                      PROCTRAN_REF,	0	0	1
32000978	32	                      PROCTRAN_TYPE,	0	0	1
32000979	32	                      PROCTRAN_DESC,	0	0	1
32000980	32	                      PROCTRAN_AMOUNT	0	0	1
32000981	32	                     )	0	0	1
32000982	32	              VALUES	0	0	1
32000983	32	                     (	0	0	1
32000984	32	                      :HV-PROCTRAN-EYECATCHER,	0	0	1
32000985	32	                      :HV-PROCTRAN-SORT-CODE,	0	0	1
32000986	32	                      :HV-PROCTRAN-ACC-NUMBER,	0	0	1
32000987	32	                      :HV-PROCTRAN-DATE,	0	0	1
32000988	32	                      :HV-PROCTRAN-TIME,	0	0	1
32000989	32	                      :HV-PROCTRAN-REF,	0	0	1
32000990	32	                      :HV-PROCTRAN-TYPE,	0	0	1
32000991	32	                      :HV-PROCTRAN-DESC,	0	0	1
32000992	32	                      :HV-PROCTRAN-AMOUNT	0	0	1
32000993	32	                     )	0	0	1
32000994	32	           END-EXEC.	0	0	1
32000996	32	      *	1	0	0
32000997	32	      *    Check the SQLCODE	1	0	1
32000998	32	      *	1	0	1
32000999	32	           IF SQLCODE NOT = 0	0	0	0
32001000	32	              DISPLAY 'In CREACC (WPD010) '	0	0	1
32001001	32	              'UNABLE TO WRITE TO PROCTRAN ROW DATASTORE'	0	0	1
32001002	32	              ' RESP CODE=' WS-CICS-RESP, ' RESP2=' WS-CICS-RESP2	0	0	1
32001003	32	              'WITH THE FOLLOWING DATA:' HOST-PROCTRAN-ROW	0	0	1
32001006	32	              PERFORM DEQ-NAMED-COUNTER	0	0	1
32001007	32	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
32001009	32	      *	1	0	0
32001010	32	      *       Preserve the RESP and RESP2, then set up the	1	0	1
32001011	32	      *       standard ABEND info before getting the applid,	1	0	1
32001012	32	      *       date/time etc. and linking to the Abend Handler	1	0	1
32001013	32	      *       program.	1	0	1
32001014	32	      *	1	0	1
32001015	32	              INITIALIZE ABNDINFO-REC	0	0	0
32001016	32	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
32001017	32	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
32001018	32	      *	1	0	0
32001019	32	      *       Get supplemental information	1	0	1
32001020	32	      *	1	0	1
32001021	32	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
32001022	32	              END-EXEC	0	0	1
32001024	32	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
32001025	32	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
32001027	32	              PERFORM POPULATE-TIME-DATE2	0	0	1
32001029	32	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
32001030	32	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
32001031	32	                    ':' DELIMITED BY SIZE,	0	0	1
32001032	32	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
32001033	32	                     ':' DELIMITED BY SIZE,	0	0	1
32001034	32	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
32001035	32	                     INTO ABND-TIME	0	0	1
32001036	32	              END-STRING	0	0	1
32001038	32	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
32001039	32	              MOVE 'HWPT'      TO ABND-CODE	0	0	1
32001041	32	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
32001042	32	              END-EXEC	0	0	1
32001044	32	              MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE	0	0	1
32001046	32	              STRING 'WPD010  - PROCTRAN DB2 INSERT issue.'	0	0	1
32001047	32	                    DELIMITED BY SIZE,	0	0	1
32001048	32	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
32001049	32	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
32001050	32	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
32001051	32	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
32001052	32	                    INTO ABND-FREEFORM	0	0	1
32001053	32	              END-STRING	0	0	1
32001055	32	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
32001056	32	                        COMMAREA(ABNDINFO-REC)	0	0	1
32001057	32	              END-EXEC	0	0	1
32001059	32	              EXEC CICS ABEND	0	0	1
32001060	32	                 ABCODE ('HWPT')	0	0	1
32001061	32	              END-EXEC	0	0	1
32001062	32	           END-IF.	0	0	1
32001064	32	       WPD999.	0	0	1
32001065	32	           EXIT.	0	0	1
32001068	32	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
32001069	32	       GMOFH010.	0	0	1
32001070	32	      *	1	0	0
32001071	32	      *    Finish	1	0	1
32001072	32	      *	1	0	1
32001073	32	           EXEC CICS RETURN	0	0	0
32001074	32	           END-EXEC.	0	0	1
32001076	32	       GMOFH999.	0	0	1
32001077	32	           EXIT.	0	0	1
32001080	32	       CUSTOMER-ACCOUNT-COUNT SECTION.	0	0	1
32001081	32	       CAC010.	0	0	1
32001082	32	           MOVE 20 TO NUMBER-OF-ACCOUNTS IN INQACCCU-COMMAREA.	0	0	1
32001083	32	           MOVE COMM-CUSTNO IN DFHCOMMAREA	0	0	1
32001084	32	             TO CUSTOMER-NUMBER IN INQACCCU-COMMAREA.	0	0	1
32001086	32	           SET COMM-PCB-POINTER TO NULL	0	0	1
32001088	32	           EXEC CICS LINK PROGRAM('INQACCCU')	0	0	1
32001089	32	                COMMAREA(INQACCCU-COMMAREA)	0	0	1
32001090	32	                RESP(WS-CICS-RESP)	0	0	1
32001091	32	                SYNCONRETURN	0	0	1
32001092	32	           END-EXEC.	0	0	1
32001094	32	       CAC999.	0	0	1
32001095	32	           EXIT.	0	0	1
32001098	32	       CALCULATE-DATES SECTION.	0	0	1
32001099	32	       CD010.	0	0	1
32001100	32	      *	1	0	0
32001101	32	      *    Store today's date as the ACCOUNT-OPENED date and calculate	1	0	1
32001102	32	      *    the LAST-STMT-DATE (which should be today) and the	1	0	1
32001103	32	      *    NEXT-STMT-DATE (which should be today + 30 days).	1	0	1
32001104	32	      *	1	0	1
32001106	32	      *	1	0	1
32001107	32	      *    Populate the time and date	1	0	1
32001108	32	      *	1	0	1
32001109	32	           EXEC CICS ASKTIME	0	0	0
32001110	32	              ABSTIME(WS-U-TIME)	0	0	1
32001111	32	           END-EXEC.	0	0	1
32001113	32	           EXEC CICS FORMATTIME	0	0	1
32001114	32	                     ABSTIME(WS-U-TIME)	0	0	1
32001115	32	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
32001116	32	                     TIME(PROC-TRAN-TIME OF PROCTRAN-AREA)	0	0	1
32001117	32	                     DATESEP	0	0	1
32001118	32	           END-EXEC.	0	0	1
32001120	32	      *	1	0	0
32001121	32	      *    Convert gregorian date (YYYYMMDD) to an integer	1	0	1
32001122	32	      *	1	0	1
32001124	32	           STRING WS-ORIG-DATE-YYYY DELIMITED BY SIZE,	0	0	0
32001125	32	                  WS-ORIG-DATE-MM   DELIMITED BY SIZE,	0	0	1
32001126	32	                  WS-ORIG-DATE-DD   DELIMITED BY SIZE	0	0	1
32001127	32	              INTO WS-STDT-X.	0	0	1
32001129	32	           MOVE WS-STDT-9-NUM TO WS-STDT-9-NUMERIC.	0	0	1
32001131	32	           COMPUTE WS-INTEGER =	0	0	1
32001132	32	              FUNCTION INTEGER-OF-DATE(WS-STDT-9-NUMERIC).	0	0	1
32001134	32	      *	1	0	0
32001135	32	      *    Add 30 days to the date	1	0	1
32001136	32	      *	1	0	1
32001137	32	           EVALUATE WS-ORIG-DATE-MM	0	0	0
32001138	32	              WHEN 1	0	0	1
32001139	32	              WHEN 3	0	0	1
32001140	32	              WHEN 5	0	0	1
32001141	32	              WHEN 7	0	0	1
32001142	32	              WHEN 8	0	0	1
32001143	32	              WHEN 10	0	0	1
32001144	32	              WHEN 12	0	0	1
32001145	32	                 COMPUTE WS-INTEGER = WS-INTEGER + 30	0	0	1
32001146	32	              WHEN 9	0	0	1
32001147	32	              WHEN 4	0	0	1
32001148	32	              WHEN 6	0	0	1
32001149	32	              WHEN 11	0	0	1
32001150	32	                 COMPUTE WS-INTEGER = WS-INTEGER + 30	0	0	1
32001151	32	              WHEN 2	0	0	1
32001152	32	                 COMPUTE WS-INTEGER = WS-INTEGER + 28	0	0	1
32001153	32	                 DIVIDE WS-ORIG-DATE-YYYY BY 4 GIVING DONT-CARE	0	0	1
32001154	32	                 REMAINDER LEAP-YEAR	0	0	1
32001156	32	                 IF LEAP-YEAR = ZERO	0	0	1
32001157	32	                    DIVIDE WS-ORIG-DATE-YYYY BY 100 GIVING DONT-CARE	0	0	1
32001158	32	                       REMAINDER LEAP-YEAR	0	0	1
32001160	32	                    IF LEAP-YEAR > 0	0	0	1
32001161	32	                       ADD 1 TO WS-INTEGER GIVING WS-INTEGER	0	0	1
32001162	32	                    ELSE	0	0	1
32001163	32	                       DIVIDE WS-ORIG-DATE-YYYY BY 400 GIVING DONT-CARE	0	0	1
32001164	32	                          REMAINDER LEAP-YEAR	0	0	1
32001165	32	                       IF LEAP-YEAR = ZERO	0	0	1
32001166	32	                         ADD 1 TO WS-INTEGER GIVING WS-INTEGER	0	0	1
32001167	32	                       END-IF	0	0	1
32001168	32	                    END-IF	0	0	1
32001169	32	                 END-IF	0	0	1
32001171	32	           END-EVALUATE.	0	0	1
32001174	32	      *	1	0	0
32001175	32	      *    Convert integer date back to a Gregorian date (YYYYMMDD)	1	0	1
32001176	32	      *	1	0	1
32001177	32	           COMPUTE WS-FUTURE-DATE =	0	0	0
32001178	32	              FUNCTION DATE-OF-INTEGER (WS-INTEGER).	0	0	1
32001180	32	      *	1	0	0
32001181	32	      *    Store the answer back in the Next Statement Date	1	0	1
32001182	32	      *	1	0	1
32001184	32	           MOVE WS-FUTURE-DATE(1:4) TO ACCOUNT-NEXT-STMT-DATE(5:4).	0	0	0
32001185	32	           MOVE WS-FUTURE-DATE(5:2) TO ACCOUNT-NEXT-STMT-DATE(3:2).	0	0	1
32001186	32	           MOVE WS-FUTURE-DATE(7:2) TO ACCOUNT-NEXT-STMT-DATE(1:2).	0	0	1
32001188	32	           MOVE WS-ORIG-DATE-DD   TO ACCOUNT-OPENED(1:2).	0	0	1
32001189	32	           MOVE WS-ORIG-DATE-MM   TO ACCOUNT-OPENED(3:2).	0	0	1
32001190	32	           MOVE WS-ORIG-DATE-YYYY TO ACCOUNT-OPENED(5:4).	0	0	1
32001191	32	           MOVE ACCOUNT-OPENED    TO ACCOUNT-LAST-STMT-DATE.	0	0	1
32001193	32	           MOVE WS-ORIG-DATE-DD   TO HV-ACCOUNT-OPENED-DAY.	0	0	1
32001194	32	           MOVE '.'               TO HV-ACCOUNT-OPENED-DELIM1.	0	0	1
32001195	32	           MOVE WS-ORIG-DATE-MM   TO HV-ACCOUNT-OPENED-MONTH.	0	0	1
32001196	32	           MOVE '.'               TO HV-ACCOUNT-OPENED-DELIM2.	0	0	1
32001197	32	           MOVE WS-ORIG-DATE-YYYY TO HV-ACCOUNT-OPENED-YEAR.	0	0	1
32001199	32	           MOVE WS-ORIG-DATE-DD   TO HV-ACCOUNT-LAST-STMT-DAY.	0	0	1
32001200	32	           MOVE '.'               TO HV-ACCOUNT-LAST-STMT-DELIM1.	0	0	1
32001201	32	           MOVE WS-ORIG-DATE-MM   TO HV-ACCOUNT-LAST-STMT-MONTH.	0	0	1
32001202	32	           MOVE '.'               TO HV-ACCOUNT-LAST-STMT-DELIM2.	0	0	1
32001203	32	           MOVE WS-ORIG-DATE-YYYY TO HV-ACCOUNT-LAST-STMT-YEAR.	0	0	1
32001205	32	       CD999.	0	0	1
32001206	32	           EXIT.	0	0	1
32001209	32	       ACCOUNT-TYPE-CHECK SECTION.	0	0	1
32001210	32	       ATC010.	0	0	1
32001211	32	      *	1	0	0
32001212	32	      *    Validate that only ISA, MORTGAGE, SAVING, CURRENT and LOAN	1	0	1
32001213	32	      *    are the only account types available.	1	0	1
32001214	32	      *	1	0	1
32001215	32	           EVALUATE TRUE	0	0	0
32001216	32	              WHEN COMM-ACC-TYPE IN DFHCOMMAREA(1:3) = 'ISA'	0	0	1
32001217	32	              WHEN COMM-ACC-TYPE IN DFHCOMMAREA(1:8) = 'MORTGAGE'	0	0	1
32001218	32	              WHEN COMM-ACC-TYPE IN DFHCOMMAREA(1:6) = 'SAVING'	0	0	1
32001219	32	              WHEN COMM-ACC-TYPE IN DFHCOMMAREA(1:7) = 'CURRENT'	0	0	1
32001220	32	              WHEN COMM-ACC-TYPE IN DFHCOMMAREA(1:4) = 'LOAN'	0	0	1
32001221	32	                 MOVE 'Y' TO COMM-SUCCESS OF DFHCOMMAREA	0	0	1
32001222	32	              WHEN OTHER	0	0	1
32001223	32	                 MOVE 'N' TO COMM-SUCCESS OF DFHCOMMAREA	0	0	1
32001224	32	                 MOVE 'A' TO COMM-FAIL-CODE IN DFHCOMMAREA	0	0	1
32001225	32	           END-EVALUATE.	0	0	1
32001227	32	       ATC999.	0	0	1
32001228	32	           EXIT.	0	0	1
32001231	32	       POPULATE-TIME-DATE2 SECTION.	0	0	1
32001232	32	       PTD2010.	0	0	1
32001233	32	      D    DISPLAY 'POPULATE-TIME-DATE2 SECTION'.	0	0	1
32001235	32	           EXEC CICS ASKTIME	0	0	1
32001236	32	              ABSTIME(WS-U-TIME)	0	0	1
32001237	32	           END-EXEC.	0	0	1
32001239	32	           EXEC CICS FORMATTIME	0	0	1
32001240	32	                     ABSTIME(WS-U-TIME)	0	0	1
32001241	32	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
32001242	32	                     TIME(WS-TIME-NOW)	0	0	1
32001243	32	                     DATESEP	0	0	1
32001244	32	           END-EXEC.	0	0	1
32001246	32	       PTD2999.	0	0	1
32001247	32	           EXIT.	0	0	1
33000000	33	<<<< file not found >>>>	0	0	0
33000001	33	<<<< file not found >>>>	0	0	0
34000001	34	       CBL CICS('SP,EDF')	0	0	1
34000002	34	      ******************************************************************	1	0	0
34000003	34	      *                                                                *	1	0	1
34000004	34	      *  Copyright IBM Corp. 2023                                      *	1	0	1
34000005	34	      *                                                                *	1	0	1
34000006	34	      ******************************************************************	1	0	1
34000007	34	      ******************************************************************	1	0	1
34000008	34	      * This program is the dummy credit agency, used for credit	1	0	1
34000009	34	      * scoring. Data is passed to the program via a channel and	1	0	1
34000010	34	      * container and the role of this program is to delay for a	1	0	1
34000011	34	      * random amount of time (between 0 and 3 seconds) and to	1	0	1
34000012	34	      * create a random credit score (between 1 and 999), then finish.	1	0	1
34000013	34	      *	1	0	1
34000014	34	      * The purpose of the initial delay is to emulate data being	1	0	1
34000015	34	      * returned to the parent program (this program is driven using	1	0	1
34000016	34	      * the Async API). There is a delay of 3 seconds in the parent	1	0	1
34000017	34	      * so what this means is there a 1 in 4 chance that data will be	1	0	1
34000018	34	      * returned withing the overall 3 second delay - this emulates	1	0	1
34000019	34	      * not always being able to get a timely reply back to the parent.	1	0	1
34000020	34	      *	1	0	1
34000021	34	      *	1	0	1
34000022	34	      ******************************************************************	1	0	1
34000024	34	       IDENTIFICATION DIVISION.	0	0	0
34000025	34	       PROGRAM-ID. CRDTAGY1.	0	0	1
34000026	34	       AUTHOR. Jon Collett.	0	0	1
34000028	34	       ENVIRONMENT DIVISION.	0	0	1
34000029	34	       CONFIGURATION SECTION.	0	0	1
34000030	34	      * SOURCE-COMPUTER.  IBM-370 WITH DEBUGGING MODE.	1	0	0
34000031	34	       SOURCE-COMPUTER.  IBM-370.	0	0	0
34000032	34	       OBJECT-COMPUTER.  IBM-370.	0	0	1
34000034	34	       INPUT-OUTPUT SECTION.	0	0	1
34000036	34	       DATA DIVISION.	0	0	1
34000037	34	       FILE SECTION.	0	0	1
34000039	34	       WORKING-STORAGE SECTION.	0	0	1
34000041	34	       COPY SORTCODE.	0	0	1
34000044	34	       01 WS-CONT-IN.	0	0	1
34000045	34	          03 WS-CONT-IN-EYECATCHER      PIC X(4).	0	0	1
34000046	34	          03 WS-CONT-IN-KEY.	0	0	1
34000047	34	             05 WS-CONT-IN-SORTCODE     PIC 9(6)  DISPLAY.	0	0	1
34000048	34	             05 WS-CONT-IN-NUMBER       PIC 9(10) DISPLAY.	0	0	1
34000049	34	          03 WS-CONT-IN-NAME            PIC X(60).	0	0	1
34000050	34	          03 WS-CONT-IN-ADDRESS         PIC X(160).	0	0	1
34000051	34	          03 WS-CONT-IN-DATE-OF-BIRTH   PIC 9(8).	0	0	1
34000052	34	          03 WS-CONT-IN-DOB-GROUP REDEFINES WS-CONT-IN-DATE-OF-BIRTH.	0	0	1
34000053	34	             05 WS-CONT-IN-BIRTH-DAY    PIC 99.	0	0	1
34000054	34	             05 WS-CONT-IN-BIRTH-MONTH  PIC 99.	0	0	1
34000055	34	             05 WS-CONT-IN-BIRTH-YEAR   PIC 9999.	0	0	1
34000056	34	          03 WS-CONT-IN-CREDIT-SCORE    PIC 999.	0	0	1
34000057	34	          03 WS-CONT-IN-CS-REVIEW-DATE  PIC 9(8).	0	0	1
34000058	34	          03 WS-CONT-IN-SUCCESS         PIC X.	0	0	1
34000059	34	          03 WS-CONT-IN-FAIL-CODE       PIC X.	0	0	1
34000061	34	       01 WS-CICS-WORK-AREA.	0	0	1
34000062	34	          05 WS-CICS-RESP               PIC S9(8) COMP.	0	0	1
34000063	34	          05 WS-CICS-RESP2              PIC S9(8) COMP.	0	0	1
34000065	34	       01 WS-DELAY-AMT                  PIC S9(8) COMP	0	0	1
34000066	34	                                                   VALUE 0.	0	0	1
34000069	34	       01 WS-CONTAINER-NAME             PIC X(16)  VALUE SPACES.	0	0	1
34000070	34	       01 WS-CHANNEL-NAME               PIC X(16)  VALUE SPACES.	0	0	1
34000072	34	       01 WS-CONTAINER-LEN              PIC S9(8) COMP	0	0	1
34000073	34	                                                   VALUE 0.	0	0	1
34000074	34	       01 WS-NEW-CREDSCORE              PIC 999    VALUE 0.	0	0	1
34000075	34	       01 WS-SEED                       PIC S9(15) COMP.	0	0	1
34000080	34	       01 WS-U-TIME                     PIC S9(15) COMP-3.	0	0	1
34000081	34	       01 WS-ORIG-DATE                  PIC X(10).	0	0	1
34000082	34	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
34000083	34	          03 WS-ORIG-DATE-DD            PIC 99.	0	0	1
34000084	34	          03 FILLER                     PIC X.	0	0	1
34000085	34	          03 WS-ORIG-DATE-MM            PIC 99.	0	0	1
34000086	34	          03 FILLER                     PIC X.	0	0	1
34000087	34	          03 WS-ORIG-DATE-YYYY          PIC 9999.	0	0	1
34000089	34	       01 WS-ORIG-DATE-GRP-X.	0	0	1
34000090	34	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
34000091	34	          03 FILLER                     PIC X      VALUE '.'.	0	0	1
34000092	34	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
34000093	34	          03 FILLER                     PIC X      VALUE '.'.	0	0	1
34000094	34	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
34000097	34	       01 WS-TIME-DATA.	0	0	1
34000098	34	          03 WS-TIME-NOW                PIC 9(6).	0	0	1
34000099	34	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
34000100	34	             05 WS-TIME-NOW-GRP-HH      PIC 99.	0	0	1
34000101	34	             05 WS-TIME-NOW-GRP-MM      PIC 99.	0	0	1
34000102	34	             05 WS-TIME-NOW-GRP-SS      PIC 99.	0	0	1
34000104	34	       01 WS-ABEND-PGM                  PIC X(8)   VALUE 'ABNDPROC'.	0	0	1
34000106	34	       01 ABNDINFO-REC.	0	0	1
34000107	34	           COPY ABNDINFO.	0	0	1
34000109	34	       LINKAGE SECTION.	0	0	1
34000112	34	       PROCEDURE DIVISION.	0	0	1
34000113	34	       PREMIERE SECTION.	0	0	1
34000114	34	       A010.	0	0	1
34000115	34	      *	1	0	0
34000116	34	      *    Generate a random  number of seconds between 0 & 3.	1	0	1
34000117	34	      *    This is the delay amount in seconds.	1	0	1
34000118	34	      *	1	0	1
34000120	34	           MOVE 'CIPA            ' TO WS-CONTAINER-NAME.	0	0	0
34000121	34	           MOVE 'CIPCREDCHANN    ' TO WS-CHANNEL-NAME.	0	0	1
34000122	34	           MOVE EIBTASKN           TO WS-SEED.	0	0	1
34000124	34	           COMPUTE WS-DELAY-AMT = ((3 - 1)	0	0	1
34000125	34	                            * FUNCTION RANDOM(WS-SEED)) + 1.	0	0	1
34000127	34	           EXEC CICS DELAY	0	0	1
34000128	34	                FOR SECONDS(WS-DELAY-AMT)	0	0	1
34000129	34	                RESP(WS-CICS-RESP)	0	0	1
34000130	34	                RESP2(WS-CICS-RESP2)	0	0	1
34000131	34	           END-EXEC.	0	0	1
34000133	34	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
34000134	34	      *	1	0	0
34000135	34	      *       Preserve the RESP and RESP2, then set up the	1	0	1
34000136	34	      *       standard ABEND info before getting the applid,	1	0	1
34000137	34	      *       date/time etc. and linking to the Abend Handler	1	0	1
34000138	34	      *       program.	1	0	1
34000139	34	      *	1	0	1
34000140	34	              INITIALIZE ABNDINFO-REC	0	0	0
34000141	34	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
34000142	34	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
34000143	34	      *	1	0	0
34000144	34	      *       Get supplemental information	1	0	1
34000145	34	      *	1	0	1
34000146	34	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
34000147	34	              END-EXEC	0	0	1
34000149	34	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
34000150	34	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
34000152	34	              PERFORM POPULATE-TIME-DATE	0	0	1
34000154	34	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
34000155	34	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
34000156	34	                      ':' DELIMITED BY SIZE,	0	0	1
34000157	34	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
34000158	34	                       ':' DELIMITED BY SIZE,	0	0	1
34000159	34	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
34000160	34	                       INTO ABND-TIME	0	0	1
34000161	34	              END-STRING	0	0	1
34000163	34	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
34000164	34	              MOVE 'PLOP'      TO ABND-CODE	0	0	1
34000166	34	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
34000167	34	              END-EXEC	0	0	1
34000169	34	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
34000171	34	              STRING 'A010  - *** The delay messed up! ***'	0	0	1
34000172	34	                      DELIMITED BY SIZE,	0	0	1
34000173	34	                      ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
34000174	34	                      ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
34000175	34	                      ' RESP2=' DELIMITED BY SIZE,	0	0	1
34000176	34	                      ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
34000177	34	                      INTO ABND-FREEFORM	0	0	1
34000178	34	              END-STRING	0	0	1
34000180	34	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
34000181	34	                          COMMAREA(ABNDINFO-REC)	0	0	1
34000182	34	              END-EXEC	0	0	1
34000184	34	              DISPLAY '*** The delay messed up ! ***'	0	0	1
34000185	34	              EXEC CICS ABEND	0	0	1
34000186	34	                 ABCODE('PLOP')	0	0	1
34000187	34	              END-EXEC	0	0	1
34000188	34	           END-IF.	0	0	1
34000190	34	           COMPUTE WS-CONTAINER-LEN = LENGTH OF WS-CONT-IN.	0	0	1
34000192	34	           EXEC CICS GET CONTAINER(WS-CONTAINER-NAME)	0	0	1
34000193	34	                     CHANNEL(WS-CHANNEL-NAME)	0	0	1
34000194	34	                     INTO(WS-CONT-IN)	0	0	1
34000195	34	                     FLENGTH(WS-CONTAINER-LEN)	0	0	1
34000196	34	                     RESP(WS-CICS-RESP)	0	0	1
34000197	34	                     RESP2(WS-CICS-RESP2)	0	0	1
34000198	34	           END-EXEC.	0	0	1
34000200	34	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
34000201	34	              DISPLAY 'CRDTAGY1 - UNABLE TO GET CONTAINER. RESP='	0	0	1
34000202	34	                 WS-CICS-RESP ', RESP2=' WS-CICS-RESP2	0	0	1
34000203	34	              DISPLAY 'CONTAINER=' WS-CONTAINER-NAME ' CHANNEL='	0	0	1
34000204	34	                       WS-CHANNEL-NAME ' FLENGTH='	0	0	1
34000205	34	                       WS-CONTAINER-LEN	0	0	1
34000206	34	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
34000207	34	           END-IF.	0	0	1
34000209	34	      *	1	0	0
34000210	34	      *    Now generate a credit score between 1 and 999. Because we	1	0	1
34000211	34	      *    used a SEED on the first RANDOM (above) we don't need to	1	0	1
34000212	34	      *    use a SEED again when using RANDOM for a subsequent time	1	0	1
34000213	34	      *	1	0	1
34000215	34	           COMPUTE WS-NEW-CREDSCORE = ((999 - 1)	0	0	0
34000216	34	                            * FUNCTION RANDOM) + 1.	0	0	1
34000218	34	           MOVE WS-NEW-CREDSCORE TO WS-CONT-IN-CREDIT-SCORE.	0	0	1
34000220	34	      *	1	0	0
34000221	34	      *    Now PUT the data back into a container	1	0	1
34000222	34	      *	1	0	1
34000223	34	           COMPUTE WS-CONTAINER-LEN = LENGTH OF WS-CONT-IN.	0	0	0
34000225	34	           EXEC CICS PUT CONTAINER(WS-CONTAINER-NAME)	0	0	1
34000226	34	                         FROM(WS-CONT-IN)	0	0	1
34000227	34	                         FLENGTH(WS-CONTAINER-LEN)	0	0	1
34000228	34	                         CHANNEL(WS-CHANNEL-NAME)	0	0	1
34000229	34	                         RESP(WS-CICS-RESP)	0	0	1
34000230	34	                         RESP2(WS-CICS-RESP2)	0	0	1
34000231	34	           END-EXEC.	0	0	1
34000233	34	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
34000234	34	              DISPLAY 'CRDTAGY1 - UNABLE TO PUT CONTAINER. RESP='	0	0	1
34000235	34	                 WS-CICS-RESP ', RESP2=' WS-CICS-RESP2	0	0	1
34000236	34	              DISPLAY  'CONTAINER='  WS-CONTAINER-NAME	0	0	1
34000237	34	              ' CHANNEL=' WS-CHANNEL-NAME ' FLENGTH='	0	0	1
34000238	34	                    WS-CONTAINER-LEN	0	0	1
34000239	34	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
34000240	34	           END-IF.	0	0	1
34000242	34	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
34000244	34	       A999.	0	0	1
34000245	34	           EXIT.	0	0	1
34000248	34	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
34000249	34	       GMOFH010.	0	0	1
34000251	34	           EXEC CICS RETURN	0	0	1
34000252	34	           END-EXEC.	0	0	1
34000254	34	       GMOFH999.	0	0	1
34000255	34	           EXIT.	0	0	1
34000258	34	       POPULATE-TIME-DATE SECTION.	0	0	1
34000259	34	       PTD010.	0	0	1
34000261	34	           EXEC CICS ASKTIME	0	0	1
34000262	34	              ABSTIME(WS-U-TIME)	0	0	1
34000263	34	           END-EXEC.	0	0	1
34000265	34	           EXEC CICS FORMATTIME	0	0	1
34000266	34	                     ABSTIME(WS-U-TIME)	0	0	1
34000267	34	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
34000268	34	                     TIME(WS-TIME-NOW)	0	0	1
34000269	34	                     DATESEP	0	0	1
34000270	34	           END-EXEC.	0	0	1
34000272	34	       PTD999.	0	0	1
34000273	34	           EXIT.	0	0	1
35000001	35	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	1
35000002	35	       CBL CICS('SP,EDF,DLI')	0	0	1
35000003	35	       CBL SQL	0	0	1
35000004	35	      ******************************************************************	1	0	0
35000005	35	      *                                                                *	1	0	1
35000006	35	      *  Copyright IBM Corp. 2023                                      *	1	0	1
35000007	35	      *                                                                *	1	0	1
35000008	35	      ******************************************************************	1	0	1
35000009	35	      ******************************************************************	1	0	1
35000010	35	      * This program gets called when someone updates the account	1	0	1
35000011	35	      * details (this excludes the balance which must be updated by	1	0	1
35000012	35	      * crediting or debitting money to/from the account).	1	0	1
35000013	35	      *	1	0	1
35000014	35	      * The program receives as input all of the fields which make	1	0	1
35000015	35	      * up the Account record.	1	0	1
35000016	35	      *	1	0	1
35000017	35	      * It then accesses DB2 datastore & updates the associated	1	0	1
35000018	35	      * Account record.	1	0	1
35000019	35	      *	1	0	1
35000020	35	      * Because it is only permissible to change a limited number of	1	0	1
35000021	35	      * fields on the Account record, and it is NOT possible to amend	1	0	1
35000022	35	      * the balance, no record needs to be written to PR0CTRAN (as the	1	0	1
35000023	35	      * the balance cannot be amended using this method). At the	1	0	1
35000024	35	      * current time, no details of the change are recorded (all that	1	0	1
35000025	35	      * can be amended is the Account Type, the Interest Rate,	1	0	1
35000026	35	      * the overdraft limit and the last and next statement dates). The	1	0	1
35000027	35	      * presentation layer is responsible for ensuring that the fields	1	0	1
35000028	35	      * are validated.	1	0	1
35000029	35	      *	1	0	1
35000030	35	      * If the Account cannot be updated then a failure flag is returned	1	0	1
35000031	35	      * to the calling program.	1	0	1
35000032	35	      *	1	0	1
35000033	35	      ******************************************************************	1	0	1
35000034	35	       IDENTIFICATION DIVISION.	0	0	0
35000035	35	       PROGRAM-ID. UPDACC.	0	0	1
35000036	35	       AUTHOR. Jon Collett.	0	0	1
35000038	35	       ENVIRONMENT DIVISION.	0	0	1
35000039	35	       CONFIGURATION SECTION.	0	0	1
35000040	35	      * SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
35000041	35	       SOURCE-COMPUTER.  IBM-370.	0	0	0
35000042	35	       OBJECT-COMPUTER.  IBM-370.	0	0	1
35000044	35	       INPUT-OUTPUT SECTION.	0	0	1
35000046	35	       DATA DIVISION.	0	0	1
35000047	35	       WORKING-STORAGE SECTION.	0	0	1
35000049	35	       COPY SORTCODE.	0	0	1
35000053	35	       77 SYSIDERR-RETRY                PIC 999.	0	0	1
35000055	35	      * Get the ACCOUNT DB2 copybook	1	0	0
35000056	35	           EXEC SQL	0	0	0
35000057	35	              INCLUDE ACCDB2	0	0	1
35000058	35	           END-EXEC.	0	0	1
35000060	35	      * ACCOUNT Host variables for DB2	1	0	0
35000061	35	       01 HOST-ACCOUNT-ROW.	0	0	0
35000062	35	          03 HV-ACCOUNT-EYECATCHER      PIC X(4).	0	0	1
35000063	35	          03 HV-ACCOUNT-CUST-NO         PIC X(10).	0	0	1
35000064	35	          03 HV-ACCOUNT-KEY.	0	0	1
35000065	35	             05 HV-ACCOUNT-SORTCODE     PIC X(6).	0	0	1
35000066	35	             05 HV-ACCOUNT-ACC-NO       PIC X(8).	0	0	1
35000067	35	          03 HV-ACCOUNT-ACC-TYPE        PIC X(8).	0	0	1
35000068	35	          03 HV-ACCOUNT-INT-RATE        PIC S9(4)V99 COMP-3.	0	0	1
35000069	35	          03 HV-ACCOUNT-OPENED          PIC X(10).	0	0	1
35000070	35	          03 HV-ACCOUNT-OVERDRAFT-LIM   PIC S9(9) COMP.	0	0	1
35000071	35	          03 HV-ACCOUNT-LAST-STMT       PIC X(10).	0	0	1
35000072	35	          03 HV-ACCOUNT-NEXT-STMT       PIC X(10).	0	0	1
35000073	35	          03 HV-ACCOUNT-AVAIL-BAL       PIC S9(10)V99 COMP-3.	0	0	1
35000074	35	          03 HV-ACCOUNT-ACTUAL-BAL      PIC S9(10)V99 COMP-3.	0	0	1
35000077	35	      * Pull in the SQL COMMAREA	1	0	0
35000078	35	        EXEC SQL	0	0	0
35000079	35	          INCLUDE SQLCA	0	0	1
35000080	35	        END-EXEC.	0	0	1
35000082	35	        01 SQLCODE-DISPLAY             PIC S9(8) DISPLAY	0	0	1
35000083	35	            SIGN LEADING SEPARATE.	0	0	1
35000085	35	       01 WS-CICS-WORK-AREA.	0	0	1
35000086	35	          05 WS-CICS-RESP               PIC S9(8) COMP.	0	0	1
35000087	35	          05 WS-CICS-RESP2              PIC S9(8) COMP.	0	0	1
35000090	35	       LOCAL-STORAGE SECTION.	0	0	1
35000091	35	       01 DB2-DATE-REFORMAT.	0	0	1
35000092	35	          03 DB2-DATE-REF-YR            PIC 9(4).	0	0	1
35000093	35	          03 FILLER                     PIC X.	0	0	1
35000094	35	          03 DB2-DATE-REF-MNTH          PIC 99.	0	0	1
35000095	35	          03 FILLER                     PIC X.	0	0	1
35000096	35	          03 DB2-DATE-REF-DAY           PIC 99.	0	0	1
35000099	35	       01 WS-ACC-DATA.	0	0	1
35000100	35	          COPY ACCOUNT.	0	0	1
35000102	35	       01 WS-EIBTASKN12                 PIC 9(12)     VALUE 0.	0	0	1
35000103	35	       01 WS-SQLCODE-DISP               PIC 9(9)      VALUE 0.	0	0	1
35000105	35	      *	1	0	0
35000106	35	      * Pull in the input and output data structures	1	0	1
35000107	35	      *	1	0	1
35000108	35	       01 DESIRED-ACC-KEY.	0	0	0
35000109	35	          03 DESIRED-SORT-CODE          PIC 9(6).	0	0	1
35000110	35	          03 DESIRED-ACC-NO             PIC 9(8).	0	0	1
35000112	35	       01 NEW-ACCOUNT-AVAILABLE-BALANCE PIC S9(10)V99 VALUE 0.	0	0	1
35000113	35	       01 NEW-ACCOUNT-ACTUAL-BALANCE    PIC S9(10)V99 VALUE 0.	0	0	1
35000114	35	       01 WS-ACC-REC-LEN                PIC S9(4) COMP	0	0	1
35000115	35	                                                      VALUE 0.	0	0	1
35000117	35	       01 WS-U-TIME                     PIC S9(15) COMP-3.	0	0	1
35000118	35	       01 WS-ORIG-DATE                  PIC X(10).	0	0	1
35000119	35	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
35000120	35	          03 WS-ORIG-DATE-DD            PIC 99.	0	0	1
35000121	35	          03 FILLER                     PIC X.	0	0	1
35000122	35	          03 WS-ORIG-DATE-MM            PIC 99.	0	0	1
35000123	35	          03 FILLER                     PIC X.	0	0	1
35000124	35	          03 WS-ORIG-DATE-YYYY          PIC 9999.	0	0	1
35000126	35	       01 WS-ORIG-DATE-GRP-X.	0	0	1
35000127	35	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
35000128	35	          03 FILLER                     PIC X         VALUE '.'.	0	0	1
35000129	35	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
35000130	35	          03 FILLER                     PIC X         VALUE '.'.	0	0	1
35000131	35	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
35000133	35	       01 REJ-REASON                    PIC XX        VALUE SPACES.	0	0	1
35000135	35	       01 CUSTOMER-KY.	0	0	1
35000136	35	          03 REQUIRED-SORT-CODE         PIC 9(6)      VALUE 0.	0	0	1
35000137	35	          03 REQUIRED-ACC-NUM           PIC 9(8)      VALUE 0.	0	0	1
35000139	35	       01 STORM-DRAIN-CONDITION         PIC X(20).	0	0	1
35000141	35	       01 WS-TIME-DATA.	0	0	1
35000142	35	          03 WS-TIME-NOW                PIC 9(6).	0	0	1
35000143	35	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
35000144	35	             05 WS-TIME-NOW-GRP-HH      PIC 99.	0	0	1
35000145	35	             05 WS-TIME-NOW-GRP-MM      PIC 99.	0	0	1
35000146	35	             05 WS-TIME-NOW-GRP-SS      PIC 99.	0	0	1
35000148	35	       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.	0	0	1
35000150	35	       01 ABNDINFO-REC.	0	0	1
35000151	35	           COPY ABNDINFO.	0	0	1
35000153	35	       LINKAGE SECTION.	0	0	1
35000154	35	       01 DFHCOMMAREA.	0	0	1
35000155	35	           COPY UPDACC.	0	0	1
35000157	35	       PROCEDURE DIVISION.	0	0	1
35000158	35	       PREMIERE SECTION.	0	0	1
35000159	35	       A010.	0	0	1
35000161	35	           MOVE SORTCODE TO COMM-SCODE.	0	0	1
35000162	35	           MOVE SORTCODE TO DESIRED-SORT-CODE.	0	0	1
35000164	35	      *	1	0	0
35000165	35	      *           Update the account information	1	0	1
35000166	35	      *	1	0	1
35000167	35	           PERFORM UPDATE-ACCOUNT-DB2	0	0	0
35000169	35	      *	1	0	0
35000170	35	      *    The COMMAREA values have now been set so all we need to do	1	0	1
35000171	35	      *    is finish	1	0	1
35000172	35	      *	1	0	1
35000174	35	           PERFORM GET-ME-OUT-OF-HERE.	0	0	0
35000176	35	       A999.	0	0	1
35000177	35	           EXIT.	0	0	1
35000180	35	       UPDATE-ACCOUNT-DB2 SECTION.	0	0	1
35000181	35	       UAD010.	0	0	1
35000183	35	      *	1	0	0
35000184	35	      *    Position ourself at the matching account record	1	0	1
35000185	35	      *	1	0	1
35000187	35	           MOVE COMM-ACCNO TO DESIRED-ACC-NO.	0	0	0
35000188	35	           MOVE DESIRED-SORT-CODE TO HV-ACCOUNT-SORTCODE.	0	0	1
35000189	35	           MOVE DESIRED-ACC-NO TO HV-ACCOUNT-ACC-NO.	0	0	1
35000191	35	           EXEC SQL	0	0	1
35000192	35	              SELECT ACCOUNT_EYECATCHER,	0	0	1
35000193	35	                     ACCOUNT_CUSTOMER_NUMBER,	0	0	1
35000194	35	                     ACCOUNT_SORTCODE,	0	0	1
35000195	35	                     ACCOUNT_NUMBER,	0	0	1
35000196	35	                     ACCOUNT_TYPE,	0	0	1
35000197	35	                     ACCOUNT_INTEREST_RATE,	0	0	1
35000198	35	                     ACCOUNT_OPENED,	0	0	1
35000199	35	                     ACCOUNT_OVERDRAFT_LIMIT,	0	0	1
35000200	35	                     ACCOUNT_LAST_STATEMENT,	0	0	1
35000201	35	                     ACCOUNT_NEXT_STATEMENT,	0	0	1
35000202	35	                     ACCOUNT_AVAILABLE_BALANCE,	0	0	1
35000203	35	                     ACCOUNT_ACTUAL_BALANCE	0	0	1
35000204	35	              INTO  :HV-ACCOUNT-EYECATCHER,	0	0	1
35000205	35	                    :HV-ACCOUNT-CUST-NO,	0	0	1
35000206	35	                    :HV-ACCOUNT-SORTCODE,	0	0	1
35000207	35	                    :HV-ACCOUNT-ACC-NO,	0	0	1
35000208	35	                    :HV-ACCOUNT-ACC-TYPE,	0	0	1
35000209	35	                    :HV-ACCOUNT-INT-RATE,	0	0	1
35000210	35	                    :HV-ACCOUNT-OPENED,	0	0	1
35000211	35	                    :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
35000212	35	                    :HV-ACCOUNT-LAST-STMT,	0	0	1
35000213	35	                    :HV-ACCOUNT-NEXT-STMT,	0	0	1
35000214	35	                    :HV-ACCOUNT-AVAIL-BAL,	0	0	1
35000215	35	                    :HV-ACCOUNT-ACTUAL-BAL	0	0	1
35000216	35	              FROM ACCOUNT	0	0	1
35000217	35	              WHERE  (ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND	0	0	1
35000218	35	                      ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO)	0	0	1
35000219	35	           END-EXEC.	0	0	1
35000221	35	      *	1	0	0
35000222	35	      *    Check that the READ was successful. If not mark the return	1	0	1
35000223	35	      *    field as not successful	1	0	1
35000224	35	      *	1	0	1
35000225	35	           IF SQLCODE NOT = 0	0	0	0
35000227	35	              MOVE 'N' TO COMM-SUCCESS	0	0	1
35000228	35	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
35000229	35	              DISPLAY 'ERROR: UPDACC returned ' SQLCODE-DISPLAY	0	0	1
35000230	35	              ' on SELECT'	0	0	1
35000231	35	              GO TO UAD999	0	0	1
35000233	35	           END-IF.	0	0	1
35000235	35	      *	1	0	0
35000236	35	      *    If the RESP CODE was OK then update the record	1	0	1
35000237	35	      *	1	0	1
35000238	35	      *	1	0	1
35000240	35	      * During BMS processing the whole account record is	1	0	1
35000241	35	      * returned in the comm area on the update. However, the same	1	0	1
35000242	35	      * is NOT true if the update is coming in via the API.	1	0	1
35000243	35	      *	1	0	1
35000244	35	      * For example, if the API update supplies an account type	1	0	1
35000245	35	      * change, and doesn't supply the other fields, the interest	1	0	1
35000246	35	      * rate and the overdraft limit will come in as zeros. If	1	0	1
35000247	35	      * the updater was only intending to change the account type	1	0	1
35000248	35	      * from a LOAN account into an ISA, in this situation it	1	0	1
35000249	35	      * would also update the overdraft limit and the interest rate	1	0	1
35000250	35	      * to be zero. This may not have been the intention.	1	0	1
35000251	35	      *	1	0	1
35000252	35	      * To avoid this, we will put a rule into the Customer Service	1	0	1
35000253	35	      * interface that on an account update you must always supply the	1	0	1
35000254	35	      * account type AND the interest rate AND the overdraft limit.	1	0	1
35000255	35	      * But that won't stop someone else from using the API directly	1	0	1
35000256	35	      * and unintentionally setting the overdraft and interest rate	1	0	1
35000257	35	      * to zeros when they update just the account type.	1	0	1
35000258	35	      *	1	0	1
35000259	35	      * The best that we can hope to do is to say if we receive	1	0	1
35000260	35	      * an account update and the account type contains all	1	0	1
35000261	35	      * spaces or it starts with a space, then we will reject that	1	0	1
35000262	35	      * update as not being valid. This let's through updates	1	0	1
35000263	35	      * where an account type IS supplied and the overdraft limit and	1	0	1
35000264	35	      * or the interest rate are zero.	1	0	1
35000265	35	      *	1	0	1
35000267	35	           IF (COMM-ACC-TYPE = SPACES OR COMM-ACC-TYPE(1:1) = ' ')	0	0	0
35000268	35	              MOVE 'N' TO COMM-SUCCESS	0	0	1
35000269	35	              DISPLAY 'ERROR: UPDACC has invalid account-type'	0	0	1
35000270	35	              GO TO UAD999	0	0	1
35000272	35	           END-IF.	0	0	1
35000274	35	           MOVE COMM-ACC-TYPE  TO HV-ACCOUNT-ACC-TYPE.	0	0	1
35000275	35	           MOVE COMM-OVERDRAFT TO HV-ACCOUNT-OVERDRAFT-LIM.	0	0	1
35000276	35	           MOVE COMM-INT-RATE  TO HV-ACCOUNT-INT-RATE.	0	0	1
35000278	35	           EXEC SQL	0	0	1
35000279	35	              UPDATE ACCOUNT	0	0	1
35000280	35	              SET ACCOUNT_TYPE = :HV-ACCOUNT-ACC-TYPE,	0	0	1
35000281	35	                  ACCOUNT_INTEREST_RATE = :HV-ACCOUNT-INT-RATE,	0	0	1
35000282	35	                  ACCOUNT_OVERDRAFT_LIMIT = :HV-ACCOUNT-OVERDRAFT-LIM	0	0	1
35000283	35	              WHERE (ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND	0	0	1
35000284	35	                     ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO)	0	0	1
35000285	35	           END-EXEC.	0	0	1
35000287	35	      *	1	0	0
35000288	35	      *    If the SQLCODE was NOT OK then we need to mark it as failed	1	0	1
35000289	35	      *	1	0	1
35000290	35	           IF SQLCODE NOT = 0	0	0	0
35000291	35	              MOVE 'N' TO COMM-SUCCESS	0	0	1
35000292	35	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
35000293	35	              DISPLAY 'ERROR: UPDACC returned ' SQLCODE-DISPLAY	0	0	1
35000294	35	              ' on UPDATE'	0	0	1
35000295	35	              GO TO UAD999	0	0	1
35000296	35	           END-IF.	0	0	1
35000298	35	      *	1	0	0
35000299	35	      *    If the SQLCODE was normal then we just need to set the	1	0	1
35000300	35	      *    SUCCESS CODE	1	0	1
35000301	35	      *	1	0	1
35000302	35	           MOVE HV-ACCOUNT-EYECATCHER TO COMM-EYE.	0	0	0
35000303	35	           MOVE HV-ACCOUNT-CUST-NO    TO COMM-CUSTNO.	0	0	1
35000304	35	           MOVE HV-ACCOUNT-SORTCODE   TO COMM-SCODE.	0	0	1
35000305	35	           MOVE HV-ACCOUNT-ACC-NO     TO COMM-ACCNO.	0	0	1
35000306	35	           MOVE HV-ACCOUNT-ACC-TYPE   TO COMM-ACC-TYPE.	0	0	1
35000307	35	           MOVE HV-ACCOUNT-INT-RATE   TO COMM-INT-RATE.	0	0	1
35000308	35	           INITIALIZE DB2-DATE-REFORMAT.	0	0	1
35000309	35	           MOVE HV-ACCOUNT-OPENED     TO DB2-DATE-REFORMAT.	0	0	1
35000310	35	           MOVE DB2-DATE-REF-YR       TO COMM-OPENED-YEAR.	0	0	1
35000311	35	           MOVE DB2-DATE-REF-MNTH     TO COMM-OPENED-MONTH.	0	0	1
35000312	35	           MOVE DB2-DATE-REF-DAY      TO COMM-OPENED-DAY.	0	0	1
35000313	35	           MOVE HV-ACCOUNT-OVERDRAFT-LIM TO COMM-OVERDRAFT.	0	0	1
35000314	35	           INITIALIZE DB2-DATE-REFORMAT.	0	0	1
35000315	35	           MOVE HV-ACCOUNT-LAST-STMT  TO DB2-DATE-REFORMAT.	0	0	1
35000316	35	           MOVE DB2-DATE-REF-YR       TO COMM-LASTST-YEAR.	0	0	1
35000317	35	           MOVE DB2-DATE-REF-MNTH     TO COMM-LASTST-MONTH.	0	0	1
35000318	35	           MOVE DB2-DATE-REF-DAY      TO COMM-LASTST-DAY.	0	0	1
35000319	35	           INITIALIZE DB2-DATE-REFORMAT.	0	0	1
35000320	35	           MOVE HV-ACCOUNT-NEXT-STMT  TO DB2-DATE-REFORMAT.	0	0	1
35000321	35	           MOVE DB2-DATE-REF-YR       TO COMM-NEXTST-YEAR.	0	0	1
35000322	35	           MOVE DB2-DATE-REF-MNTH     TO COMM-NEXTST-MONTH.	0	0	1
35000323	35	           MOVE DB2-DATE-REF-DAY      TO COMM-NEXTST-DAY.	0	0	1
35000324	35	           MOVE HV-ACCOUNT-AVAIL-BAL  TO COMM-AVAIL-BAL.	0	0	1
35000325	35	           MOVE HV-ACCOUNT-ACTUAL-BAL TO COMM-ACTUAL-BAL.	0	0	1
35000327	35	           MOVE 'Y' TO COMM-SUCCESS.	0	0	1
35000329	35	       UAD999.	0	0	1
35000330	35	           EXIT.	0	0	1
35000338	35	      *    MOVE COMM-ACC-TYPE     TO	1	0	0
35000339	35	      *       HV-ACCOUNT-ACC-TYPE.	1	0	1
35000340	35	      *    MOVE COMM-INT-RATE     TO	1	0	1
35000341	35	      *       HV-ACCOUNT-INT-RATE.	1	0	1
35000342	35	      *    MOVE COMM-OVERDRAFT    TO	1	0	1
35000343	35	      *       HV-ACCOUNT-OVERDRAFT-LIM.	1	0	1
35000344	35	      *    MOVE COMM-LAST-STMT-DT TO	1	0	1
35000345	35	      *       HV-ACCOUNT-LAST-STMT.	1	0	1
35000346	35	      *    MOVE COMM-NEXT-STMT-DT TO	1	0	1
35000347	35	      *       HV-ACCOUNT-NEXT-STMT.	1	0	1
35000348	35	      *	1	0	1
35000349	35	      *    MOVE HV-ACCOUNT-AVAIL-BAL TO COMM-AVAIL-BAL.	1	0	1
35000350	35	      *    MOVE HV-ACCOUNT-ACTUAL-BAL TO COMM-ACTUAL-BAL.	1	0	1
35000351	35	      *	1	0	1
35000352	35	      *    EXEC SQL	1	0	1
35000353	35	      *       UPDATE ACCOUNT	1	0	1
35000354	35	      *       SET ACCOUNT_TYPE = :HV-ACCOUNT-ACC-TYPE,	1	0	1
35000355	35	      *           ACCOUNT_INTEREST_RATE = :HV-ACCOUNT-INT-RATE,	1	0	1
35000356	35	      *           ACCOUNT_OVERDRAFT_LIMIT = :HV-ACCOUNT-OVERDRAFT-LIM	1	0	1
35000357	35	      *       WHERE (ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND	1	0	1
35000358	35	      *              ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO)	1	0	1
35000359	35	      *    END-EXEC.	1	0	1
35000360	35	      *	1	0	1
35000361	35	      *	1	0	1
35000362	35	      *    If the SQLCODE was NOT OK then we need to mark it as failed	1	0	1
35000363	35	      *	1	0	1
35000364	35	      *    IF SQLCODE NOT = 0	1	0	1
35000365	35	      *       MOVE 'N' TO COMM-SUCCESS	1	0	1
35000366	35	      *	1	0	1
35000367	35	      *       GO TO UAD999	1	0	1
35000368	35	      *	1	0	1
35000369	35	      *    END-IF.	1	0	1
35000370	35	      *	1	0	1
35000371	35	      *	1	0	1
35000372	35	      *    If the SQLCODE was normal then we just need to set the	1	0	1
35000373	35	      *    SUCCESS CODE	1	0	1
35000374	35	      *	1	0	1
35000375	35	      *    MOVE 'Y' TO COMM-SUCCESS.	1	0	1
35000376	35	      *	1	0	1
35000377	35	      *UAD999.	1	0	1
35000378	35	      *    EXIT.	1	0	1
35000381	35	       GET-ME-OUT-OF-HERE SECTION.	0	0	0
35000382	35	       GMOOH010.	0	0	1
35000384	35	           EXEC CICS RETURN	0	0	1
35000385	35	           END-EXEC.	0	0	1
35000387	35	       GMOOH999.	0	0	1
35000388	35	           EXIT.	0	0	1
35000391	35	       POPULATE-TIME-DATE SECTION.	0	0	1
35000392	35	       PTD010.	0	0	1
35000394	35	           EXEC CICS ASKTIME	0	0	1
35000395	35	              ABSTIME(WS-U-TIME)	0	0	1
35000396	35	           END-EXEC.	0	0	1
35000398	35	           EXEC CICS FORMATTIME	0	0	1
35000399	35	                     ABSTIME(WS-U-TIME)	0	0	1
35000400	35	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
35000401	35	                     TIME(WS-TIME-NOW)	0	0	1
35000402	35	                     DATESEP	0	0	1
35000403	35	           END-EXEC.	0	0	1
35000405	35	       PTD999.	0	0	1
35000406	35	           EXIT.	0	0	1
36000000	36	<<<< file not found >>>>	0	0	0
36000001	36	<<<< file not found >>>>	0	0	0
37000001	37	       CBL CICS('SP,EDF')	0	0	1
37000002	37	       CBL SQL	0	0	1
37000003	37	      ******************************************************************	1	0	0
37000004	37	      *                                                                *	1	0	1
37000005	37	      *  Copyright IBM Corp. 2023                                      *	1	0	1
37000006	37	      *                                                                *	1	0	1
37000007	37	      ******************************************************************	1	0	1
37000008	37	      ******************************************************************	1	0	1
37000009	37	      * This program takes an incoming account number it then accesses	1	0	1
37000010	37	      * the account datastore and retrieves the associated account	1	0	1
37000011	37	      * record matching on the customer number & the account_type	1	0	1
37000012	37	      * and then deletes it.	1	0	1
37000013	37	      *	1	0	1
37000014	37	      * If no matching customer_number and account_type combination can	1	0	1
37000015	37	      * found it will return an error flag and the visual1sation layer	1	0	1
37000016	37	      * should process this accordingly.	1	0	1
37000017	37	      *	1	0	1
37000018	37	      * Should there be any issues, the program will abend.	1	0	1
37000019	37	      *	1	0	1
37000020	37	      * It is assumed that the incoming customer number will be valid.	1	0	1
37000021	37	      *****************************************************************	1	0	1
37000023	37	       IDENTIFICATION DIVISION.	0	0	0
37000024	37	       PROGRAM-ID. DELACC.	0	0	1
37000025	37	       AUTHOR. Jon Collett.	0	0	1
37000028	37	       ENVIRONMENT DIVISION.	0	0	1
37000029	37	       CONFIGURATION SECTION.	0	0	1
37000030	37	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
37000031	37	       SOURCE-COMPUTER.  IBM-370.	0	0	0
37000032	37	       OBJECT-COMPUTER.  IBM-370.	0	0	1
37000034	37	       INPUT-OUTPUT SECTION.	0	0	1
37000036	37	       DATA DIVISION.	0	0	1
37000037	37	       FILE SECTION.	0	0	1
37000039	37	       WORKING-STORAGE SECTION.	0	0	1
37000041	37	       COPY SORTCODE.	0	0	1
37000045	37	       01 SYSIDERR-RETRY               PIC 999.	0	0	1
37000046	37	       01 FILE-RETRY                   PIC 999.	0	0	1
37000047	37	       01 WS-EXIT-RETRY-LOOP           PIC X VALUE ' '.	0	0	1
37000049	37	      * Get the ACCOUNT DB2 copybook	1	0	0
37000050	37	           EXEC SQL	0	0	0
37000051	37	              INCLUDE ACCDB2	0	0	1
37000052	37	           END-EXEC.	0	0	1
37000054	37	      * ACCOUNT Host variables for DB2	1	0	0
37000055	37	       01 HOST-ACCOUNT-ROW.	0	0	0
37000056	37	           03 HV-ACCOUNT-EYECATCHER     PIC X(4).	0	0	1
37000057	37	           03 HV-ACCOUNT-CUST-NO        PIC X(10).	0	0	1
37000058	37	           03 HV-ACCOUNT-SORTCODE       PIC X(6).	0	0	1
37000059	37	           03 HV-ACCOUNT-ACC-NO         PIC X(8).	0	0	1
37000060	37	           03 HV-ACCOUNT-ACC-TYPE       PIC X(8).	0	0	1
37000061	37	           03 HV-ACCOUNT-INT-RATE       PIC S9(4)V99 COMP-3.	0	0	1
37000062	37	           03 HV-ACCOUNT-OPENED         PIC X(10).	0	0	1
37000063	37	           03 HV-ACCOUNT-OVERDRAFT-LIM  PIC S9(9) COMP.	0	0	1
37000064	37	           03 HV-ACCOUNT-LAST-STMT      PIC X(10).	0	0	1
37000065	37	           03 HV-ACCOUNT-NEXT-STMT      PIC X(10).	0	0	1
37000066	37	           03 HV-ACCOUNT-AVAIL-BAL      PIC S9(10)V99 COMP-3.	0	0	1
37000067	37	           03 HV-ACCOUNT-ACTUAL-BAL     PIC S9(10)V99 COMP-3.	0	0	1
37000069	37	      * PROCTRAN DB2 copybook	1	0	0
37000070	37	           EXEC SQL	0	0	0
37000071	37	              INCLUDE PROCDB2	0	0	1
37000072	37	           END-EXEC.	0	0	1
37000074	37	      * PROCTRAN host variables for DB2	1	0	0
37000075	37	       01 HOST-PROCTRAN-ROW.	0	0	0
37000076	37	           03 HV-PROCTRAN-EYECATCHER    PIC X(4).	0	0	1
37000077	37	           03 HV-PROCTRAN-SORT-CODE     PIC X(6).	0	0	1
37000078	37	           03 HV-PROCTRAN-ACC-NUMBER    PIC X(8).	0	0	1
37000079	37	           03 HV-PROCTRAN-DATE          PIC X(10).	0	0	1
37000080	37	           03 HV-PROCTRAN-TIME          PIC X(6).	0	0	1
37000081	37	           03 HV-PROCTRAN-REF           PIC X(12).	0	0	1
37000082	37	           03 HV-PROCTRAN-TYPE          PIC X(3).	0	0	1
37000083	37	           03 HV-PROCTRAN-DESC          PIC X(40).	0	0	1
37000084	37	           03 HV-PROCTRAN-AMOUNT        PIC S9(10)V99 COMP-3.	0	0	1
37000086	37	      * Pull in the SQL COMMAREA	1	0	0
37000087	37	           EXEC SQL	0	0	0
37000088	37	              INCLUDE SQLCA	0	0	1
37000089	37	           END-EXEC.	0	0	1
37000091	37	       01 SQLCODE-DISPLAY              PIC S9(8) DISPLAY	0	0	1
37000092	37	           SIGN LEADING SEPARATE.	0	0	1
37000094	37	       01 WS-CICS-WORK-AREA.	0	0	1
37000095	37	           05 WS-CICS-RESP              PIC S9(8) COMP.	0	0	1
37000096	37	           05 WS-CICS-RESP2             PIC S9(8) COMP.	0	0	1
37000097	37	           05 WS-EIBRESP-DISPLAY        PIC S9(8) DISPLAY	0	0	1
37000098	37	                                   SIGN LEADING SEPARATE.	0	0	1
37000100	37	       01 WS-APPLID                    PIC X(8).	0	0	1
37000102	37	       01 EXIT-BROWSE-LOOP             PIC X VALUE 'N'.	0	0	1
37000104	37	       01 OUTPUT-DATA.	0	0	1
37000105	37	           COPY ACCOUNT.	0	0	1
37000107	37	       01 PROCTRAN-AREA.	0	0	1
37000108	37	          COPY PROCTRAN.	0	0	1
37000110	37	       01 PROCTRAN-RIDFLD              PIC S9(8) COMP.	0	0	1
37000111	37	       77 PROCTRAN-RETRY               PIC 999.	0	0	1
37000113	37	       01 ACCOUNT-ACT-BAL-STORE        PIC S9(10)V99 VALUE 0.	0	0	1
37000115	37	       01 RETURNED-DATA.	0	0	1
37000116	37	           03 RETURNED-EYE-CATCHER        PIC X(4).	0	0	1
37000117	37	           03 RETURNED-CUST-NO            PIC 9(10).	0	0	1
37000118	37	           03 RETURNED-KEY.	0	0	1
37000119	37	              05 RETURNED-SORT-CODE       PIC 9(6).	0	0	1
37000120	37	              05 RETURNED-NUMBER          PIC 9(8).	0	0	1
37000121	37	           03 RETURNED-TYPE               PIC X(8).	0	0	1
37000122	37	           03 RETURNED-INTEREST-RATE      PIC 9(4)V99.	0	0	1
37000123	37	           03 RETURNED-OPENED             PIC 9(8).	0	0	1
37000124	37	           03 RETURNED-OVERDRAFT-LIMIT    PIC 9(8).	0	0	1
37000125	37	           03 RETURNED-LAST-STMT-DATE     PIC 9(8).	0	0	1
37000126	37	           03 RETURNED-NEXT-STMT-DATE     PIC 9(8).	0	0	1
37000127	37	           03 RETURNED-AVAILABLE-BALANCE  PIC S9(10)V99.	0	0	1
37000128	37	           03 RETURNED-ACTUAL-BALANCE     PIC S9(10)V99.	0	0	1
37000130	37	       01 DESIRED-KEY                  PIC 9(10) BINARY.	0	0	1
37000133	37	       01 DB2-DATE-REFORMAT.	0	0	1
37000134	37	          03 DB2-DATE-REF-YR           PIC 9(4).	0	0	1
37000135	37	          03 FILLER                    PIC X.	0	0	1
37000136	37	          03 DB2-DATE-REF-MNTH         PIC 99.	0	0	1
37000137	37	          03 FILLER                    PIC X.	0	0	1
37000138	37	          03 DB2-DATE-REF-DAY          PIC 99.	0	0	1
37000140	37	       01 DATA-STORE-TYPE              PIC X.	0	0	1
37000141	37	          88 DATASTORE-TYPE-DB2           VALUE '2'.	0	0	1
37000142	37	          88 DATASTORE-TYPE-VSAM          VALUE 'V'.	0	0	1
37000144	37	       01 DB2-EXIT-LOOP                PIC X.	0	0	1
37000145	37	       01 FETCH-DATA-CNT               PIC 9(4) COMP.	0	0	1
37000146	37	       01 WS-CUST-ALT-KEY-LEN          PIC S9(4) COMP VALUE +10.	0	0	1
37000148	37	       01 WS-EIBTASKN12                PIC 9(12) VALUE 0.	0	0	1
37000150	37	       01 ACCOUNT-KEY-RID.	0	0	1
37000151	37	          03 REQUIRED-SORT-CODE        PIC 9(6)  VALUE 0.	0	0	1
37000152	37	          03 REQUIRED-ACC-NUM          PIC 9(8)  VALUE 0.	0	0	1
37000154	37	       01 MY-TCB                       PIC S9(8) BINARY.	0	0	1
37000156	37	       01 MY-TCB-STRING                PIC X(8).	0	0	1
37000158	37	       01 WS-ACC-KEY-LEN               PIC S9(4) COMP VALUE +14.	0	0	1
37000159	37	       01 WS-ACC-NUM                   PIC S9(4) COMP VALUE 0.	0	0	1
37000161	37	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
37000162	37	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
37000163	37	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
37000164	37	          03 WS-ORIG-DATE-DD              PIC 99.	0	0	1
37000165	37	          03 FILLER                       PIC X.	0	0	1
37000166	37	          03 WS-ORIG-DATE-MM              PIC 99.	0	0	1
37000167	37	          03 FILLER                       PIC X.	0	0	1
37000168	37	          03 WS-ORIG-DATE-YYYY            PIC 9999.	0	0	1
37000170	37	       01 WS-ORIG-DATE-GRP-X.	0	0	1
37000171	37	          03 WS-ORIG-DATE-DD-X         PIC XX.	0	0	1
37000172	37	          03 FILLER                    PIC X VALUE '.'.	0	0	1
37000173	37	          03 WS-ORIG-DATE-MM-X         PIC XX.	0	0	1
37000174	37	          03 FILLER                    PIC X VALUE '.'.	0	0	1
37000175	37	          03 WS-ORIG-DATE-YYYY-X       PIC X(4).	0	0	1
37000178	37	       01 WS-TOKEN                     PIC S9(8) BINARY.	0	0	1
37000181	37	       01 STORM-DRAIN-CONDITION        PIC X(20).	0	0	1
37000183	37	       01 ACCOUNT-CONTROL.	0	0	1
37000184	37	           COPY ACCTCTRL.	0	0	1
37000186	37	       01 WS-TIME-DATA.	0	0	1
37000187	37	           03 WS-TIME-NOW              PIC 9(6).	0	0	1
37000188	37	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
37000189	37	              05 WS-TIME-NOW-GRP-HH       PIC 99.	0	0	1
37000190	37	              05 WS-TIME-NOW-GRP-MM       PIC 99.	0	0	1
37000191	37	              05 WS-TIME-NOW-GRP-SS       PIC 99.	0	0	1
37000193	37	       01 WS-ABEND-PGM                    PIC X(8) VALUE 'ABNDPROC'.	0	0	1
37000195	37	       01 ABNDINFO-REC.	0	0	1
37000196	37	           COPY ABNDINFO.	0	0	1
37000199	37	       LINKAGE SECTION.	0	0	1
37000200	37	       COPY DELACC REPLACING DELACC-COMMAREA BY DFHCOMMAREA.	0	0	1
37000203	37	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
37000204	37	       PREMIERE SECTION.	0	0	1
37000205	37	       A010.	0	0	1
37000207	37	           MOVE SORTCODE TO REQUIRED-SORT-CODE OF ACCOUNT-KEY-RID.	0	0	1
37000209	37	      *	1	0	0
37000210	37	      *          Get the account record	1	0	1
37000211	37	      *	1	0	1
37000212	37	           PERFORM READ-ACCOUNT-DB2.	0	0	0
37000214	37	      *	1	0	0
37000215	37	      *          If a matching account record was successfully	1	0	1
37000216	37	      *          retrieved then delete it	1	0	1
37000217	37	      *	1	0	1
37000218	37	           IF DELACC-DEL-SUCCESS = 'Y'	0	0	0
37000220	37	             PERFORM DEL-ACCOUNT-DB2	0	0	1
37000221	37	             IF DELACC-DEL-SUCCESS = 'Y'	0	0	1
37000222	37	               PERFORM WRITE-PROCTRAN	0	0	1
37000223	37	             END-IF	0	0	1
37000224	37	           END-IF	0	0	1
37000227	37	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
37000229	37	       A999.	0	0	1
37000230	37	           EXIT.	0	0	1
37000233	37	      *	1	0	0
37000234	37	      * Read the DB2 datastore and process the data	1	0	1
37000235	37	      *	1	0	1
37000236	37	       READ-ACCOUNT-DB2 SECTION.	0	0	0
37000237	37	       RAD010.	0	0	1
37000239	37	      *	1	0	0
37000240	37	      *    Take the Account number from the comm area and retrieve	1	0	1
37000241	37	      *    the account record from the datastore.	1	0	1
37000242	37	      *	1	0	1
37000243	37	           MOVE DELACC-ACCNO	0	0	0
37000244	37	              TO HV-ACCOUNT-ACC-NO.	0	0	1
37000246	37	           MOVE SORTCODE TO HV-ACCOUNT-SORTCODE.	0	0	1
37000248	37	           EXEC SQL	0	0	1
37000249	37	              SELECT ACCOUNT_EYECATCHER,	0	0	1
37000250	37	                     ACCOUNT_CUSTOMER_NUMBER,	0	0	1
37000251	37	                     ACCOUNT_SORTCODE,	0	0	1
37000252	37	                     ACCOUNT_NUMBER,	0	0	1
37000253	37	                     ACCOUNT_TYPE,	0	0	1
37000254	37	                     ACCOUNT_INTEREST_RATE,	0	0	1
37000255	37	                     ACCOUNT_OPENED,	0	0	1
37000256	37	                     ACCOUNT_OVERDRAFT_LIMIT,	0	0	1
37000257	37	                     ACCOUNT_LAST_STATEMENT,	0	0	1
37000258	37	                     ACCOUNT_NEXT_STATEMENT,	0	0	1
37000259	37	                     ACCOUNT_AVAILABLE_BALANCE,	0	0	1
37000260	37	                     ACCOUNT_ACTUAL_BALANCE	0	0	1
37000261	37	              INTO  :HV-ACCOUNT-EYECATCHER,	0	0	1
37000262	37	                    :HV-ACCOUNT-CUST-NO,	0	0	1
37000263	37	                    :HV-ACCOUNT-SORTCODE,	0	0	1
37000264	37	                    :HV-ACCOUNT-ACC-NO,	0	0	1
37000265	37	                    :HV-ACCOUNT-ACC-TYPE,	0	0	1
37000266	37	                    :HV-ACCOUNT-INT-RATE,	0	0	1
37000267	37	                    :HV-ACCOUNT-OPENED,	0	0	1
37000268	37	                    :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
37000269	37	                    :HV-ACCOUNT-LAST-STMT,	0	0	1
37000270	37	                    :HV-ACCOUNT-NEXT-STMT,	0	0	1
37000271	37	                    :HV-ACCOUNT-AVAIL-BAL,	0	0	1
37000272	37	                    :HV-ACCOUNT-ACTUAL-BAL	0	0	1
37000273	37	              FROM ACCOUNT	0	0	1
37000274	37	              WHERE   ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO AND	0	0	1
37000275	37	                    ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE	0	0	1
37000276	37	           END-EXEC.	0	0	1
37000278	37	      *	1	0	0
37000279	37	      *    If the SQLCODE returned anything other than OK or row not	1	0	1
37000280	37	      *    found then we have a problem (so abend it)	1	0	1
37000281	37	      *	1	0	1
37000282	37	           IF SQLCODE NOT = 0 AND SQLCODE NOT = +100	0	0	0
37000283	37	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
37000284	37	      *	1	0	0
37000285	37	      *       Preserve the RESP and RESP2, then set up the	1	0	1
37000286	37	      *       standard ABEND info before getting the applid,	1	0	1
37000287	37	      *       date/time etc. and linking to the Abend Handler	1	0	1
37000288	37	      *       program.	1	0	1
37000289	37	      *	1	0	1
37000290	37	              INITIALIZE ABNDINFO-REC	0	0	0
37000291	37	              MOVE ZERO       TO ABND-RESPCODE	0	0	1
37000292	37	              MOVE ZERO       TO ABND-RESP2CODE	0	0	1
37000293	37	      *	1	0	0
37000294	37	      *       Get supplemental information	1	0	1
37000295	37	      *	1	0	1
37000296	37	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
37000297	37	              END-EXEC	0	0	1
37000299	37	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
37000300	37	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
37000302	37	              PERFORM POPULATE-TIME-DATE	0	0	1
37000304	37	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
37000305	37	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
37000306	37	                     ':' DELIMITED BY SIZE,	0	0	1
37000307	37	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
37000308	37	                     ':' DELIMITED BY SIZE,	0	0	1
37000309	37	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
37000310	37	                     INTO ABND-TIME	0	0	1
37000311	37	              END-STRING	0	0	1
37000314	37	              MOVE WS-U-TIME  TO ABND-UTIME-KEY	0	0	1
37000315	37	              MOVE 'HRAC'     TO ABND-CODE	0	0	1
37000317	37	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
37000318	37	              END-EXEC	0	0	1
37000320	37	              MOVE SQLCODE-DISPLAY      TO ABND-SQLCODE	0	0	1
37000322	37	              STRING 'RAD010 - Issue with ACCOUNT row select, for '	0	0	1
37000323	37	                     DELIMITED BY SIZE,	0	0	1
37000324	37	                     'Account ' HV-ACCOUNT-ACC-NO	0	0	1
37000325	37	                     DELIMITED BY SIZE,	0	0	1
37000326	37	                     'and SORTCODE ' HV-ACCOUNT-SORTCODE	0	0	1
37000327	37	                     DELIMITED BY SIZE,	0	0	1
37000328	37	                     ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
37000329	37	                     ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
37000330	37	                     ' RESP2=' DELIMITED BY SIZE	0	0	1
37000331	37	                     INTO ABND-FREEFORM	0	0	1
37000332	37	              END-STRING	0	0	1
37000335	37	              DISPLAY 'Issue with ACCOUNT row select. SQLCODE='	0	0	1
37000336	37	                 SQLCODE-DISPLAY ' . For Account ' HV-ACCOUNT-ACC-NO	0	0	1
37000337	37	                 ' and Sortcode' HV-ACCOUNT-SORTCODE	0	0	1
37000339	37	              EXEC CICS ABEND ABCODE('HRAC')	0	0	1
37000340	37	                   NODUMP	0	0	1
37000341	37	              END-EXEC	0	0	1
37000343	37	           END-IF.	0	0	1
37000345	37	      *	1	0	0
37000346	37	      *    If the account is not found, then we need to finish	1	0	1
37000347	37	      *    processing and return an error (via the COMM AREA) to the	1	0	1
37000348	37	      *    calling program	1	0	1
37000349	37	      *	1	0	1
37000350	37	           IF SQLCODE = +100	0	0	0
37000351	37	              INITIALIZE OUTPUT-DATA	0	0	1
37000352	37	              MOVE SORTCODE TO ACCOUNT-SORT-CODE OF OUTPUT-DATA	0	0	1
37000353	37	              MOVE DELACC-ACCNO TO ACCOUNT-NUMBER OF OUTPUT-DATA	0	0	1
37000354	37	              MOVE 'N' TO DELACC-DEL-SUCCESS	0	0	1
37000355	37	              MOVE '1' TO DELACC-DEL-FAIL-CD	0	0	1
37000356	37	              GO TO RAD999	0	0	1
37000357	37	           END-IF.	0	0	1
37000359	37	      *	1	0	0
37000360	37	      *    If the SQL return code was OK, then set the flags	1	0	1
37000361	37	      *    accordingly.	1	0	1
37000362	37	      *	1	0	1
37000363	37	           IF SQLCODE = 0	0	0	0
37000364	37	              MOVE ' ' TO DELACC-SUCCESS	0	0	1
37000365	37	              MOVE 'Y' TO DELACC-DEL-SUCCESS	0	0	1
37000366	37	              MOVE ' ' TO DELACC-DEL-FAIL-CD	0	0	1
37000367	37	           END-IF.	0	0	1
37000369	37	      *	1	0	0
37000370	37	      *    Return the ACCOUNT data to the COMMAREA	1	0	1
37000371	37	      *	1	0	1
37000372	37	           MOVE HV-ACCOUNT-EYECATCHER TO	0	0	0
37000373	37	              ACCOUNT-EYE-CATCHER OF OUTPUT-DATA.	0	0	1
37000374	37	           MOVE HV-ACCOUNT-CUST-NO TO	0	0	1
37000375	37	              ACCOUNT-CUST-NO OF OUTPUT-DATA.	0	0	1
37000376	37	           MOVE HV-ACCOUNT-SORTCODE TO	0	0	1
37000377	37	              ACCOUNT-SORT-CODE OF OUTPUT-DATA.	0	0	1
37000378	37	           MOVE HV-ACCOUNT-ACC-NO TO	0	0	1
37000379	37	              ACCOUNT-NUMBER OF OUTPUT-DATA.	0	0	1
37000380	37	           MOVE HV-ACCOUNT-ACC-TYPE TO	0	0	1
37000381	37	              ACCOUNT-TYPE OF OUTPUT-DATA.	0	0	1
37000382	37	           MOVE HV-ACCOUNT-INT-RATE TO	0	0	1
37000383	37	              ACCOUNT-INTEREST-RATE OF OUTPUT-DATA.	0	0	1
37000384	37	           MOVE HV-ACCOUNT-OPENED TO DB2-DATE-REFORMAT.	0	0	1
37000385	37	           MOVE DB2-DATE-REF-DAY TO	0	0	1
37000386	37	              ACCOUNT-OPENED-DAY OF OUTPUT-DATA.	0	0	1
37000387	37	           MOVE DB2-DATE-REF-MNTH TO	0	0	1
37000388	37	              ACCOUNT-OPENED-MONTH OF OUTPUT-DATA.	0	0	1
37000389	37	           MOVE DB2-DATE-REF-YR TO	0	0	1
37000390	37	              ACCOUNT-OPENED-YEAR OF OUTPUT-DATA.	0	0	1
37000391	37	           MOVE HV-ACCOUNT-OVERDRAFT-LIM TO	0	0	1
37000392	37	              ACCOUNT-OVERDRAFT-LIMIT OF OUTPUT-DATA.	0	0	1
37000393	37	           MOVE HV-ACCOUNT-LAST-STMT TO DB2-DATE-REFORMAT.	0	0	1
37000394	37	           MOVE DB2-DATE-REF-DAY TO	0	0	1
37000395	37	              ACCOUNT-LAST-STMT-DAY OF OUTPUT-DATA.	0	0	1
37000396	37	           MOVE DB2-DATE-REF-MNTH TO	0	0	1
37000397	37	              ACCOUNT-LAST-STMT-MONTH OF OUTPUT-DATA.	0	0	1
37000398	37	           MOVE DB2-DATE-REF-YR TO	0	0	1
37000399	37	              ACCOUNT-LAST-STMT-YEAR OF OUTPUT-DATA.	0	0	1
37000400	37	           MOVE HV-ACCOUNT-NEXT-STMT TO DB2-DATE-REFORMAT	0	0	1
37000401	37	           MOVE DB2-DATE-REF-DAY TO	0	0	1
37000402	37	              ACCOUNT-NEXT-STMT-DAY OF OUTPUT-DATA.	0	0	1
37000403	37	           MOVE DB2-DATE-REF-MNTH TO	0	0	1
37000404	37	              ACCOUNT-NEXT-STMT-MONTH OF OUTPUT-DATA.	0	0	1
37000405	37	           MOVE DB2-DATE-REF-YR TO	0	0	1
37000406	37	              ACCOUNT-NEXT-STMT-YEAR OF OUTPUT-DATA.	0	0	1
37000407	37	           MOVE HV-ACCOUNT-AVAIL-BAL TO	0	0	1
37000408	37	              ACCOUNT-AVAILABLE-BALANCE OF OUTPUT-DATA.	0	0	1
37000409	37	           MOVE HV-ACCOUNT-ACTUAL-BAL TO	0	0	1
37000410	37	              ACCOUNT-ACTUAL-BALANCE OF OUTPUT-DATA.	0	0	1
37000411	37	           MOVE HV-ACCOUNT-ACTUAL-BAL TO ACCOUNT-ACT-BAL-STORE.	0	0	1
37000413	37	           MOVE ACCOUNT-EYE-CATCHER       TO DELACC-EYE.	0	0	1
37000414	37	           MOVE ACCOUNT-CUST-NO           TO DELACC-CUSTNO.	0	0	1
37000415	37	           MOVE ACCOUNT-SORT-CODE         TO DELACC-SCODE.	0	0	1
37000416	37	           MOVE ACCOUNT-NUMBER            TO DELACC-ACCNO.	0	0	1
37000417	37	           MOVE ACCOUNT-TYPE              TO DELACC-ACC-TYPE.	0	0	1
37000418	37	           MOVE ACCOUNT-INTEREST-RATE     TO DELACC-INT-RATE.	0	0	1
37000419	37	           MOVE ACCOUNT-OPENED            TO DELACC-OPENED.	0	0	1
37000420	37	           MOVE ACCOUNT-OVERDRAFT-LIMIT   TO DELACC-OVERDRAFT.	0	0	1
37000421	37	           MOVE ACCOUNT-LAST-STMT-DATE    TO DELACC-LAST-STMT-DT.	0	0	1
37000422	37	           MOVE ACCOUNT-NEXT-STMT-DATE    TO DELACC-NEXT-STMT-DT.	0	0	1
37000423	37	           MOVE ACCOUNT-AVAILABLE-BALANCE TO DELACC-AVAIL-BAL.	0	0	1
37000424	37	           MOVE ACCOUNT-ACTUAL-BALANCE    TO DELACC-ACTUAL-BAL.	0	0	1
37000425	37	           MOVE ACCOUNT-ACTUAL-BALANCE    TO ACCOUNT-ACT-BAL-STORE.	0	0	1
37000427	37	       RAD999.	0	0	1
37000428	37	           EXIT.	0	0	1
37000431	37	       DEL-ACCOUNT-DB2 SECTION.	0	0	1
37000432	37	       DADB010.	0	0	1
37000434	37	      *	1	0	0
37000435	37	      *    Delete the ACCOUNT row where the SORTCODE and ACCOUNT	1	0	1
37000436	37	      *    NUMBER match.	1	0	1
37000437	37	      *	1	0	1
37000438	37	           EXEC SQL	0	0	0
37000439	37	              DELETE FROM ACCOUNT	0	0	1
37000440	37	              WHERE ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND	0	0	1
37000441	37	                    ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO	0	0	1
37000442	37	           END-EXEC.	0	0	1
37000444	37	           IF SQLCODE NOT = 0	0	0	1
37000445	37	              MOVE ' ' TO DELACC-SUCCESS	0	0	1
37000446	37	              MOVE 'N' TO DELACC-DEL-SUCCESS	0	0	1
37000447	37	              MOVE '3' TO DELACC-DEL-FAIL-CD	0	0	1
37000448	37	           END-IF.	0	0	1
37000450	37	       DADB999.	0	0	1
37000451	37	           EXIT.	0	0	1
37000454	37	       WRITE-PROCTRAN SECTION.	0	0	1
37000455	37	       WP010.	0	0	1
37000457	37	           PERFORM WRITE-PROCTRAN-DB2.	0	0	1
37000458	37	       WP999.	0	0	1
37000459	37	           EXIT.	0	0	1
37000462	37	       WRITE-PROCTRAN-DB2 SECTION.	0	0	1
37000463	37	       WPD010.	0	0	1
37000465	37	      *	1	0	0
37000466	37	      *    If the DELETE of the account row was successful then record	1	0	1
37000467	37	      *    this on the PROCTRAN datastore.	1	0	1
37000468	37	      *	1	0	1
37000469	37	           INITIALIZE HOST-PROCTRAN-ROW.	0	0	0
37000470	37	           INITIALIZE WS-EIBTASKN12.	0	0	1
37000472	37	           MOVE 'PRTR' TO HV-PROCTRAN-EYECATCHER.	0	0	1
37000473	37	           MOVE ACCOUNT-SORT-CODE  TO HV-PROCTRAN-SORT-CODE.	0	0	1
37000474	37	           MOVE ACCOUNT-NUMBER     TO HV-PROCTRAN-ACC-NUMBER.	0	0	1
37000475	37	           MOVE EIBTASKN           TO WS-EIBTASKN12.	0	0	1
37000476	37	           MOVE WS-EIBTASKN12      TO HV-PROCTRAN-REF.	0	0	1
37000478	37	      *	1	0	0
37000479	37	      *    Populate the time and date	1	0	1
37000480	37	      *	1	0	1
37000481	37	           EXEC CICS ASKTIME	0	0	0
37000482	37	              ABSTIME(WS-U-TIME)	0	0	1
37000483	37	           END-EXEC.	0	0	1
37000485	37	           EXEC CICS FORMATTIME	0	0	1
37000486	37	                     ABSTIME(WS-U-TIME)	0	0	1
37000487	37	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
37000488	37	                     TIME(HV-PROCTRAN-TIME)	0	0	1
37000489	37	                     DATESEP('.')	0	0	1
37000490	37	           END-EXEC.	0	0	1
37000492	37	           MOVE WS-ORIG-DATE TO WS-ORIG-DATE-GRP-X.	0	0	1
37000493	37	           MOVE WS-ORIG-DATE-GRP-X TO HV-PROCTRAN-DATE.	0	0	1
37000495	37	           MOVE ACCOUNT-CUST-NO    TO PROC-DESC-DELACC-CUSTOMER	0	0	1
37000496	37	            OF PROCTRAN-AREA	0	0	1
37000497	37	           MOVE ACCOUNT-TYPE       TO PROC-DESC-DELACC-ACCTYPE	0	0	1
37000498	37	            OF PROCTRAN-AREA	0	0	1
37000499	37	           MOVE ACCOUNT-LAST-STMT-DAY	0	0	1
37000500	37	             TO PROC-DESC-DELACC-LAST-DD  OF PROCTRAN-AREA	0	0	1
37000501	37	           MOVE ACCOUNT-LAST-STMT-MONTH	0	0	1
37000502	37	             TO PROC-DESC-DELACC-LAST-MM  OF PROCTRAN-AREA	0	0	1
37000503	37	           MOVE ACCOUNT-LAST-STMT-YEAR	0	0	1
37000504	37	             TO PROC-DESC-DELACC-LAST-YYYY  OF PROCTRAN-AREA	0	0	1
37000505	37	           MOVE ACCOUNT-NEXT-STMT-DAY	0	0	1
37000506	37	             TO PROC-DESC-DELACC-NEXT-DD  OF PROCTRAN-AREA	0	0	1
37000507	37	           MOVE ACCOUNT-NEXT-STMT-MONTH	0	0	1
37000508	37	             TO PROC-DESC-DELACC-NEXT-MM  OF PROCTRAN-AREA	0	0	1
37000509	37	           MOVE ACCOUNT-NEXT-STMT-YEAR	0	0	1
37000510	37	             TO PROC-DESC-DELACC-NEXT-YYYY  OF PROCTRAN-AREA	0	0	1
37000512	37	           SET PROC-DESC-DELACC-FLAG  OF PROCTRAN-AREA TO TRUE.	0	0	1
37000513	37	           SET PROC-TY-BRANCH-DELETE-ACCOUNT  OF PROCTRAN-AREA TO TRUE.	0	0	1
37000515	37	           MOVE PROC-TRAN-DESC  OF PROCTRAN-AREA TO HV-PROCTRAN-DESC	0	0	1
37000518	37	           MOVE PROC-TRAN-TYPE  OF PROCTRAN-AREA TO HV-PROCTRAN-TYPE.	0	0	1
37000519	37	           MOVE ACCOUNT-ACT-BAL-STORE    TO HV-PROCTRAN-AMOUNT.	0	0	1
37000521	37	           EXEC SQL	0	0	1
37000522	37	              INSERT INTO PROCTRAN	0	0	1
37000523	37	                     (	0	0	1
37000524	37	                      PROCTRAN_EYECATCHER,	0	0	1
37000525	37	                      PROCTRAN_SORTCODE,	0	0	1
37000526	37	                      PROCTRAN_NUMBER,	0	0	1
37000527	37	                      PROCTRAN_DATE,	0	0	1
37000528	37	                      PROCTRAN_TIME,	0	0	1
37000529	37	                      PROCTRAN_REF,	0	0	1
37000530	37	                      PROCTRAN_TYPE,	0	0	1
37000531	37	                      PROCTRAN_DESC,	0	0	1
37000532	37	                      PROCTRAN_AMOUNT	0	0	1
37000533	37	                     )	0	0	1
37000534	37	              VALUES	0	0	1
37000535	37	                     (	0	0	1
37000536	37	                      :HV-PROCTRAN-EYECATCHER,	0	0	1
37000537	37	                      :HV-PROCTRAN-SORT-CODE,	0	0	1
37000538	37	                      :HV-PROCTRAN-ACC-NUMBER,	0	0	1
37000539	37	                      :HV-PROCTRAN-DATE,	0	0	1
37000540	37	                      :HV-PROCTRAN-TIME,	0	0	1
37000541	37	                      :HV-PROCTRAN-REF,	0	0	1
37000542	37	                      :HV-PROCTRAN-TYPE,	0	0	1
37000543	37	                      :HV-PROCTRAN-DESC,	0	0	1
37000544	37	                      :HV-PROCTRAN-AMOUNT	0	0	1
37000545	37	                     )	0	0	1
37000546	37	           END-EXEC.	0	0	1
37000548	37	      *	1	0	0
37000549	37	      *    Check the SQLCODE	1	0	1
37000550	37	      *	1	0	1
37000552	37	           IF SQLCODE NOT = 0	0	0	0
37000553	37	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
37000555	37	      *       Preserve the RESP and RESP2, then set up the	1	0	0
37000556	37	      *       standard ABEND info before getting the applid,	1	0	1
37000557	37	      *       date/time etc. and linking to the Abend Handler	1	0	1
37000558	37	      *       program.	1	0	1
37000559	37	      *	1	0	1
37000560	37	              INITIALIZE ABNDINFO-REC	0	0	0
37000561	37	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
37000562	37	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
37000563	37	      *	1	0	0
37000564	37	      *       Get supplemental information	1	0	1
37000565	37	      *	1	0	1
37000566	37	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
37000567	37	              END-EXEC	0	0	1
37000569	37	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
37000570	37	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
37000572	37	              PERFORM POPULATE-TIME-DATE	0	0	1
37000574	37	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
37000575	37	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
37000576	37	                    ':' DELIMITED BY SIZE,	0	0	1
37000577	37	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
37000578	37	                     ':' DELIMITED BY SIZE,	0	0	1
37000579	37	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
37000580	37	                     INTO ABND-TIME	0	0	1
37000581	37	              END-STRING	0	0	1
37000583	37	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
37000584	37	              MOVE 'HWPT'      TO ABND-CODE	0	0	1
37000586	37	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
37000587	37	              END-EXEC	0	0	1
37000589	37	              MOVE SQLCODE-DISPLAY    TO ABND-SQLCODE	0	0	1
37000591	37	              STRING 'WPD010 - Unable to  WRITE to PROCTRAN row '	0	0	1
37000592	37	                    DELIMITED BY SIZE,	0	0	1
37000593	37	                    'datastore with the following data:'	0	0	1
37000594	37	                    DELIMITED BY SIZE,	0	0	1
37000595	37	                    HOST-PROCTRAN-ROW DELIMITED BY SIZE,	0	0	1
37000596	37	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
37000597	37	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
37000598	37	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
37000599	37	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
37000600	37	                    INTO ABND-FREEFORM	0	0	1
37000601	37	              END-STRING	0	0	1
37000603	37	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
37000604	37	                        COMMAREA(ABNDINFO-REC)	0	0	1
37000605	37	              END-EXEC	0	0	1
37000607	37	              DISPLAY 'In DELACC (WPD010) '	0	0	1
37000608	37	              'UNABLE TO WRITE TO PROCTRAN ROW DATASTORE'	0	0	1
37000609	37	              ' SQLCODE=' SQLCODE-DISPLAY	0	0	1
37000610	37	              'WITH THE FOLLOWING DATA:' HOST-PROCTRAN-ROW	0	0	1
37000612	37	              EXEC CICS ABEND	0	0	1
37000613	37	                 ABCODE ('HWPT')	0	0	1
37000614	37	              END-EXEC	0	0	1
37000616	37	           END-IF.	0	0	1
37000618	37	       WPD999.	0	0	1
37000619	37	           EXIT.	0	0	1
37000622	37	      *	1	0	0
37000623	37	      * Finish	1	0	1
37000624	37	      *	1	0	1
37000625	37	       GET-ME-OUT-OF-HERE SECTION.	0	0	0
37000626	37	       GMOFH010.	0	0	1
37000628	37	           GOBACK.	0	0	1
37000630	37	       GMOFH999.	0	0	1
37000631	37	           EXIT.	0	0	1
37000634	37	       POPULATE-TIME-DATE SECTION.	0	0	1
37000635	37	       PTD010.	0	0	1
37000637	37	           EXEC CICS ASKTIME	0	0	1
37000638	37	              ABSTIME(WS-U-TIME)	0	0	1
37000639	37	           END-EXEC.	0	0	1
37000641	37	           EXEC CICS FORMATTIME	0	0	1
37000642	37	                     ABSTIME(WS-U-TIME)	0	0	1
37000643	37	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
37000644	37	                     TIME(WS-TIME-NOW)	0	0	1
37000645	37	                     DATESEP	0	0	1
37000646	37	           END-EXEC.	0	0	1
37000648	37	       PTD999.	0	0	1
37000649	37	           EXIT.	0	0	1
38000000	38	<<<< file not found >>>>	0	0	0
38000001	38	<<<< file not found >>>>	0	0	0
39000001	39	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	1
39000002	39	       CBL CICS('SP,EDF,DLI')	0	0	1
39000003	39	      ******************************************************************	1	0	0
39000004	39	      *                                                                *	1	0	1
39000005	39	      *  Copyright IBM Corp. 2023                                      *	1	0	1
39000006	39	      *                                                                *	1	0	1
39000007	39	      ******************************************************************	1	0	1
39000008	39	      ******************************************************************	1	0	1
39000009	39	      * This program gets called when someone updates the customer	1	0	1
39000010	39	      * details.	1	0	1
39000011	39	      *	1	0	1
39000012	39	      * The program receives as input all of the fields which make	1	0	1
39000013	39	      * up the Customer record. It then accesses the VSAM datastore.	1	0	1
39000014	39	      *	1	0	1
39000015	39	      * Because it is only permissible to change a limited number of	1	0	1
39000016	39	      * fields on the Customer record, no record needs to be written to	1	0	1
39000017	39	      * PROCTRAN.	1	0	1
39000018	39	      *	1	0	1
39000019	39	      * The presentation layer is responsible for ensuring that the	1	0	1
39000020	39	      * fields are validated.	1	0	1
39000021	39	      *	1	0	1
39000022	39	      * If the Customer cannot be updated a failure flag is returned	1	0	1
39000023	39	      * to the calling program.	1	0	1
39000024	39	      *	1	0	1
39000025	39	      ******************************************************************	1	0	1
39000027	39	       IDENTIFICATION DIVISION.	0	0	0
39000028	39	       PROGRAM-ID. UPDCUST.	0	0	1
39000029	39	       AUTHOR. Jon Collett.	0	0	1
39000031	39	       ENVIRONMENT DIVISION.	0	0	1
39000032	39	       CONFIGURATION SECTION.	0	0	1
39000033	39	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
39000034	39	       SOURCE-COMPUTER.  IBM-370.	0	0	0
39000035	39	       OBJECT-COMPUTER.  IBM-370.	0	0	1
39000037	39	       INPUT-OUTPUT SECTION.	0	0	1
39000039	39	       DATA DIVISION.	0	0	1
39000040	39	       WORKING-STORAGE SECTION.	0	0	1
39000043	39	       COPY SORTCODE.	0	0	1
39000047	39	       77 SYSIDERR-RETRY               PIC 999.	0	0	1
39000050	39	       01 WS-CICS-WORK-AREA.	0	0	1
39000051	39	          03 WS-CICS-RESP              PIC S9(8) COMP.	0	0	1
39000052	39	          03 WS-CICS-RESP2             PIC S9(8) COMP.	0	0	1
39000055	39	       LOCAL-STORAGE SECTION.	0	0	1
39000056	39	       01 DB2-DATE-REFORMAT.	0	0	1
39000057	39	          03 DB2-DATE-REF-YR           PIC 9(4).	0	0	1
39000058	39	          03 FILLER                    PIC X.	0	0	1
39000059	39	          03 DB2-DATE-REF-MNTH         PIC 99.	0	0	1
39000060	39	          03 FILLER                    PIC X.	0	0	1
39000061	39	          03 DB2-DATE-REF-DAY          PIC 99.	0	0	1
39000064	39	       01 WS-CUST-DATA.	0	0	1
39000065	39	          COPY CUSTOMER.	0	0	1
39000067	39	       01 WS-EIBTASKN12                PIC 9(12) VALUE 0.	0	0	1
39000068	39	       01 WS-SQLCODE-DISP              PIC 9(9)  VALUE 0.	0	0	1
39000070	39	      *	1	0	0
39000071	39	      * Pull in the input and output data structures	1	0	1
39000072	39	      *	1	0	1
39000073	39	       01 DESIRED-CUST-KEY.	0	0	0
39000074	39	          03 DESIRED-SORT-CODE         PIC 9(6).	0	0	1
39000075	39	          03 DESIRED-CUSTNO            PIC 9(10).	0	0	1
39000077	39	       01 WS-CUST-REC-LEN              PIC S9(4) COMP VALUE 0.	0	0	1
39000079	39	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
39000080	39	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
39000082	39	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
39000083	39	          03 WS-ORIG-DATE-DD           PIC 99.	0	0	1
39000084	39	          03 FILLER                    PIC X.	0	0	1
39000085	39	          03 WS-ORIG-DATE-MM           PIC 99.	0	0	1
39000086	39	          03 FILLER                    PIC X.	0	0	1
39000087	39	          03 WS-ORIG-DATE-YYYY         PIC 9999.	0	0	1
39000089	39	       01 WS-ORIG-DATE-GRP-X.	0	0	1
39000090	39	          03 WS-ORIG-DATE-DD-X         PIC XX.	0	0	1
39000091	39	          03 FILLER                    PIC X VALUE '.'.	0	0	1
39000092	39	          03 WS-ORIG-DATE-MM-X         PIC XX.	0	0	1
39000093	39	          03 FILLER                    PIC X VALUE '.'.	0	0	1
39000094	39	          03 WS-ORIG-DATE-YYYY-X       PIC X(4).	0	0	1
39000096	39	       01 REJ-REASON                   PIC XX VALUE SPACES.	0	0	1
39000098	39	       01 WS-PASSED-DATA.	0	0	1
39000099	39	          02 WS-TEST-KEY               PIC X(4).	0	0	1
39000100	39	          02 WS-SORT-CODE              PIC 9(6).	0	0	1
39000101	39	          02 WS-CUSTOMER-RANGE.	0	0	1
39000102	39	             07 WS-CUSTOMER-RANGE-TOP     PIC X.	0	0	1
39000103	39	             07 WS-CUSTOMER-RANGE-MIDDLE  PIC X.	0	0	1
39000104	39	             07 WS-CUSTOMER-RANGE-BOTTOM  PIC X.	0	0	1
39000106	39	       01 WS-SORT-DIV.	0	0	1
39000107	39	          03 WS-SORT-DIV1              PIC XX.	0	0	1
39000108	39	          03 WS-SORT-DIV2              PIC XX.	0	0	1
39000109	39	          03 WS-SORT-DIV3              PIC XX.	0	0	1
39000111	39	       01 CUSTOMER-KY.	0	0	1
39000112	39	          03 REQUIRED-SORT-CODE        PIC 9(6)  VALUE 0.	0	0	1
39000113	39	          03 REQUIRED-ACC-NUM          PIC 9(8)  VALUE 0.	0	0	1
39000115	39	       01 STORM-DRAIN-CONDITION        PIC X(20).	0	0	1
39000117	39	       01 WS-UNSTR-TITLE               PIC X(9)  VALUE ' '.	0	0	1
39000118	39	       01 WS-TITLE-VALID               PIC X.	0	0	1
39000120	39	       01 WS-TIME-DATA.	0	0	1
39000121	39	           03 WS-TIME-NOW              PIC 9(6).	0	0	1
39000122	39	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
39000123	39	              05 WS-TIME-NOW-GRP-HH    PIC 99.	0	0	1
39000124	39	              05 WS-TIME-NOW-GRP-MM    PIC 99.	0	0	1
39000125	39	              05 WS-TIME-NOW-GRP-SS    PIC 99.	0	0	1
39000127	39	       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.	0	0	1
39000129	39	       01 ABNDINFO-REC.	0	0	1
39000130	39	           COPY ABNDINFO.	0	0	1
39000132	39	       LINKAGE SECTION.	0	0	1
39000133	39	       01 DFHCOMMAREA.	0	0	1
39000134	39	           COPY UPDCUST.	0	0	1
39000136	39	       PROCEDURE DIVISION.	0	0	1
39000137	39	       PREMIERE SECTION.	0	0	1
39000138	39	       A010.	0	0	1
39000140	39	           MOVE SORTCODE TO COMM-SCODE	0	0	1
39000141	39	                            DESIRED-SORT-CODE.	0	0	1
39000143	39	      *	1	0	0
39000144	39	      *    You can change the customer's name, but the title must	1	0	1
39000145	39	      *    be a valid one. Check that here	1	0	1
39000146	39	      *	1	0	1
39000147	39	           MOVE SPACES TO WS-UNSTR-TITLE.	0	0	0
39000148	39	           UNSTRING COMM-NAME DELIMITED BY SPACE	0	0	1
39000149	39	              INTO WS-UNSTR-TITLE.	0	0	1
39000151	39	           MOVE ' ' TO WS-TITLE-VALID.	0	0	1
39000153	39	           EVALUATE WS-UNSTR-TITLE	0	0	1
39000154	39	              WHEN 'Professor'	0	0	1
39000155	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000157	39	              WHEN 'Mr       '	0	0	1
39000158	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000160	39	              WHEN 'Mrs      '	0	0	1
39000161	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000163	39	              WHEN 'Miss     '	0	0	1
39000164	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000166	39	              WHEN 'Ms       '	0	0	1
39000167	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000169	39	              WHEN 'Dr       '	0	0	1
39000170	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000172	39	              WHEN 'Drs      '	0	0	1
39000173	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000175	39	              WHEN 'Lord     '	0	0	1
39000176	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000178	39	              WHEN 'Sir      '	0	0	1
39000179	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000181	39	              WHEN 'Lady     '	0	0	1
39000182	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000184	39	              WHEN '         '	0	0	1
39000185	39	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
39000187	39	              WHEN OTHER	0	0	1
39000188	39	                 MOVE 'N' TO WS-TITLE-VALID	0	0	1
39000189	39	           END-EVALUATE.	0	0	1
39000191	39	           IF WS-TITLE-VALID = 'N'	0	0	1
39000192	39	             MOVE 'N' TO COMM-UPD-SUCCESS	0	0	1
39000193	39	             MOVE 'T' TO COMM-UPD-FAIL-CD	0	0	1
39000194	39	             GOBACK	0	0	1
39000195	39	           END-IF	0	0	1
39000197	39	      *	1	0	0
39000198	39	      *          Update the CUSTOMER datastore	1	0	1
39000199	39	      *	1	0	1
39000200	39	           PERFORM UPDATE-CUSTOMER-VSAM	0	0	0
39000201	39	      *	1	0	0
39000202	39	      *    The COMMAREA values have now been set so all we need to do	1	0	1
39000203	39	      *    is finish	1	0	1
39000204	39	      *	1	0	1
39000205	39	           PERFORM GET-ME-OUT-OF-HERE.	0	0	0
39000207	39	       A999.	0	0	1
39000208	39	           EXIT.	0	0	1
39000211	39	       UPDATE-CUSTOMER-VSAM SECTION.	0	0	1
39000212	39	       UCV010.	0	0	1
39000214	39	      *	1	0	0
39000215	39	      *    Position at the matching CUSTOMER record and	1	0	1
39000216	39	      *    lock it.	1	0	1
39000217	39	      *	1	0	1
39000218	39	           MOVE COMM-CUSTNO TO DESIRED-CUSTNO.	0	0	0
39000220	39	           EXEC CICS READ FILE('CUSTOMER')	0	0	1
39000221	39	                RIDFLD(DESIRED-CUST-KEY)	0	0	1
39000222	39	                INTO(WS-CUST-DATA)	0	0	1
39000223	39	                UPDATE	0	0	1
39000224	39	                RESP(WS-CICS-RESP)	0	0	1
39000225	39	                RESP2(WS-CICS-RESP2)	0	0	1
39000226	39	           END-EXEC.	0	0	1
39000228	39	      *	1	0	0
39000229	39	      *    Check that the READ was successful. If not mark the return	1	0	1
39000230	39	      *    field as not successful	1	0	1
39000231	39	      *	1	0	1
39000232	39	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	0
39000234	39	              MOVE 'N' TO COMM-UPD-SUCCESS	0	0	1
39000236	39	              IF WS-CICS-RESP = DFHRESP(NOTFND)	0	0	1
39000237	39	                 MOVE '1' TO COMM-UPD-FAIL-CD	0	0	1
39000238	39	              ELSE	0	0	1
39000239	39	                 MOVE '2' TO COMM-UPD-FAIL-CD	0	0	1
39000240	39	              END-IF	0	0	1
39000242	39	              GO TO UCV999	0	0	1
39000244	39	           END-IF.	0	0	1
39000246	39	      *	1	0	0
39000247	39	      *    If the RESP CODE was OK then update the customer record	1	0	1
39000248	39	      *    but only if the COMM-AREA supplied name or address has	1	0	1
39000249	39	      *    been supplied. These fields will both be supplied every time	1	0	1
39000250	39	      *    if the update is being made via the BMS screen, but if the	1	0	1
39000251	39	      *    update is being made via the API, it is possible that neither	1	0	1
39000252	39	      *    fields are supplied, in that instance it would corrupt the	1	0	1
39000253	39	      *    backend data if we just updated it.	1	0	1
39000254	39	      *    So we will include a check to reject the update if the	1	0	1
39000255	39	      *    name and address are both empty or they both start with	1	0	1
39000256	39	      *    a space (a COMM_UPD-FAIL-CD of '4' gets returned & we exit).	1	0	1
39000257	39	      *    If the name is empty and not the address just update	1	0	1
39000258	39	      *    the address. If the address is empty and not the name,	1	0	1
39000259	39	      *    just update the name. If the name and address don't start	1	0	1
39000260	39	      *    with a space, then update them both.	1	0	1
39000261	39	      *	1	0	1
39000262	39	           IF (COMM-NAME = SPACES OR COMM-NAME(1:1) = ' ') AND	0	0	0
39000263	39	           (COMM-ADDR = SPACES OR COMM-ADDR(1:1) = ' ')	0	0	1
39000264	39	              MOVE 'N' TO COMM-UPD-SUCCESS	0	0	1
39000266	39	              MOVE '4' TO COMM-UPD-FAIL-CD	0	0	1
39000268	39	              GO TO UCV999	0	0	1
39000270	39	           END-IF.	0	0	1
39000272	39	           IF (COMM-NAME = SPACES OR COMM-NAME(1:1) = ' ') AND	0	0	1
39000273	39	           (COMM-ADDR NOT = SPACES OR COMM-ADDR(1:1) NOT = ' ')	0	0	1
39000274	39	              MOVE COMM-ADDR TO CUSTOMER-ADDRESS OF WS-CUST-DATA	0	0	1
39000275	39	           END-IF.	0	0	1
39000277	39	           IF (COMM-ADDR = SPACES OR COMM-ADDR(1:1) = ' ') AND	0	0	1
39000278	39	           (COMM-NAME NOT = SPACES OR COMM-NAME(1:1) NOT = ' ')	0	0	1
39000279	39	              MOVE COMM-NAME TO CUSTOMER-NAME OF WS-CUST-DATA	0	0	1
39000280	39	           END-IF.	0	0	1
39000282	39	           IF COMM-ADDR(1:1) NOT = ' ' AND COMM-NAME(1:1) NOT = ' '	0	0	1
39000283	39	              MOVE COMM-ADDR TO CUSTOMER-ADDRESS OF WS-CUST-DATA	0	0	1
39000284	39	              MOVE COMM-NAME TO CUSTOMER-NAME OF WS-CUST-DATA	0	0	1
39000285	39	           END-IF.	0	0	1
39000288	39	      *     MOVE COMM-NAME TO CUSTOMER-NAME OF WS-CUST-DATA.	1	0	0
39000289	39	      *     MOVE COMM-ADDR TO CUSTOMER-ADDRESS OF WS-CUST-DATA.	1	0	1
39000292	39	           COMPUTE WS-CUST-REC-LEN = LENGTH OF WS-CUST-DATA.	0	0	0
39000294	39	           EXEC CICS REWRITE	0	0	1
39000295	39	              FILE ('CUSTOMER')	0	0	1
39000296	39	              FROM (WS-CUST-DATA)	0	0	1
39000297	39	              LENGTH(WS-CUST-REC-LEN)	0	0	1
39000298	39	              RESP(WS-CICS-RESP)	0	0	1
39000299	39	              RESP2(WS-CICS-RESP2)	0	0	1
39000300	39	           END-EXEC.	0	0	1
39000302	39	      *	1	0	0
39000303	39	      *    If the RESP CODE for the REWRITE was NOT OK then we	1	0	1
39000304	39	      *    need to mark it as failed	1	0	1
39000305	39	      *	1	0	1
39000306	39	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	0
39000307	39	              MOVE 'N' TO COMM-UPD-SUCCESS	0	0	1
39000308	39	              MOVE '3' TO COMM-UPD-FAIL-CD	0	0	1
39000309	39	              GO TO UCV999	0	0	1
39000310	39	           END-IF.	0	0	1
39000312	39	      *	1	0	0
39000313	39	      *    If the RESP CODE was normal then we just need to set the	1	0	1
39000314	39	      *    SUCCESS CODE	1	0	1
39000315	39	      *	1	0	1
39000316	39	           MOVE CUSTOMER-EYECATCHER OF WS-CUST-DATA	0	0	0
39000317	39	              TO COMM-EYE.	0	0	1
39000318	39	           MOVE CUSTOMER-SORTCODE OF WS-CUST-DATA	0	0	1
39000319	39	              TO COMM-SCODE.	0	0	1
39000320	39	           MOVE CUSTOMER-NUMBER OF WS-CUST-DATA	0	0	1
39000321	39	              TO COMM-CUSTNO.	0	0	1
39000322	39	           MOVE CUSTOMER-NAME OF WS-CUST-DATA	0	0	1
39000323	39	              TO COMM-NAME.	0	0	1
39000324	39	           MOVE CUSTOMER-ADDRESS OF WS-CUST-DATA	0	0	1
39000325	39	              TO COMM-ADDR.	0	0	1
39000326	39	           MOVE CUSTOMER-DATE-OF-BIRTH OF WS-CUST-DATA	0	0	1
39000327	39	              TO COMM-DOB.	0	0	1
39000328	39	           MOVE CUSTOMER-CREDIT-SCORE OF WS-CUST-DATA	0	0	1
39000329	39	              TO COMM-CREDIT-SCORE.	0	0	1
39000330	39	           MOVE CUSTOMER-CS-REVIEW-DATE OF WS-CUST-DATA	0	0	1
39000331	39	              TO COMM-CS-REVIEW-DATE.	0	0	1
39000333	39	           MOVE 'Y' TO COMM-UPD-SUCCESS.	0	0	1
39000335	39	       UCV999.	0	0	1
39000336	39	           EXIT.	0	0	1
39000339	39	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
39000340	39	       GMOOH010.	0	0	1
39000342	39	           EXEC CICS RETURN	0	0	1
39000343	39	           END-EXEC.	0	0	1
39000345	39	       GMOOH999.	0	0	1
39000346	39	           EXIT.	0	0	1
39000349	39	       POPULATE-TIME-DATE SECTION.	0	0	1
39000350	39	       PTD010.	0	0	1
39000352	39	           EXEC CICS ASKTIME	0	0	1
39000353	39	              ABSTIME(WS-U-TIME)	0	0	1
39000354	39	           END-EXEC.	0	0	1
39000356	39	           EXEC CICS FORMATTIME	0	0	1
39000357	39	                     ABSTIME(WS-U-TIME)	0	0	1
39000358	39	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
39000359	39	                     TIME(WS-TIME-NOW)	0	0	1
39000360	39	                     DATESEP	0	0	1
39000361	39	           END-EXEC.	0	0	1
39000363	39	       PTD999.	0	0	1
39000364	39	           EXIT.	0	0	1
40000000	40	<<<< file not found >>>>	0	0	0
40000001	40	<<<< file not found >>>>	0	0	0
41000001	41	       CBL CICS('SP,EDF')	0	0	1
41000002	41	      ******************************************************************	1	0	0
41000003	41	      *                                                                *	1	0	1
41000004	41	      *  Copyright IBM Corp. 2023                                      *	1	0	1
41000005	41	      *                                                                *	1	0	1
41000006	41	      ******************************************************************	1	0	1
41000007	41	      ******************************************************************	1	0	1
41000008	41	      * This program is the dummy credit agency, used for credit	1	0	1
41000009	41	      * scoring. Data is passed to the program via a channel and	1	0	1
41000010	41	      * container and the role of this program is to delay for a	1	0	1
41000011	41	      * random amount of time (between 0 and 3 seconds) and to	1	0	1
41000012	41	      * create a random credit score (between 1 and 999), then finish.	1	0	1
41000013	41	      *	1	0	1
41000014	41	      * The purpose of the initial delay is to emulate data being	1	0	1
41000015	41	      * returned to the parent program (this program is driven using	1	0	1
41000016	41	      * the Async API). There is a delay of 3 seconds in the parent	1	0	1
41000017	41	      * so what this means is there a 1 in 4 chance that data will be	1	0	1
41000018	41	      * returned withing the overall 3 second delay - this emulates	1	0	1
41000019	41	      * not always being able to get a timely reply back to the parent.	1	0	1
41000020	41	      *	1	0	1
41000021	41	      *	1	0	1
41000022	41	      ******************************************************************	1	0	1
41000024	41	       IDENTIFICATION DIVISION.	0	0	0
41000025	41	       PROGRAM-ID. CRDTAGY2.	0	0	1
41000026	41	       AUTHOR. Jon Collett.	0	0	1
41000028	41	       ENVIRONMENT DIVISION.	0	0	1
41000029	41	       CONFIGURATION SECTION.	0	0	1
41000030	41	      *SOURCE-COMPUTER.  IBM-370 WITH DEBUGGING MODE.	1	0	0
41000031	41	       SOURCE-COMPUTER.  IBM-370.	0	0	0
41000032	41	       OBJECT-COMPUTER.  IBM-370.	0	0	1
41000034	41	       INPUT-OUTPUT SECTION.	0	0	1
41000036	41	       DATA DIVISION.	0	0	1
41000037	41	       FILE SECTION.	0	0	1
41000039	41	       WORKING-STORAGE SECTION.	0	0	1
41000041	41	       COPY SORTCODE.	0	0	1
41000044	41	       01 WS-CONT-IN.	0	0	1
41000045	41	          03 WS-CONT-IN-EYECATCHER      PIC X(4).	0	0	1
41000046	41	          03 WS-CONT-IN-KEY.	0	0	1
41000047	41	             05 WS-CONT-IN-SORTCODE     PIC 9(6) DISPLAY.	0	0	1
41000048	41	             05 WS-CONT-IN-NUMBER       PIC 9(10) DISPLAY.	0	0	1
41000049	41	          03 WS-CONT-IN-NAME            PIC X(60).	0	0	1
41000050	41	          03 WS-CONT-IN-ADDRESS         PIC X(160).	0	0	1
41000051	41	          03 WS-CONT-IN-DATE-OF-BIRTH   PIC 9(8).	0	0	1
41000052	41	          03 WS-CONT-IN-DOB-GROUP REDEFINES WS-CONT-IN-DATE-OF-BIRTH.	0	0	1
41000053	41	             05 WS-CONT-IN-BIRTH-DAY    PIC 99.	0	0	1
41000054	41	             05 WS-CONT-IN-BIRTH-MONTH  PIC 99.	0	0	1
41000055	41	             05 WS-CONT-IN-BIRTH-YEAR   PIC 9999.	0	0	1
41000056	41	          03 WS-CONT-IN-CREDIT-SCORE    PIC 999.	0	0	1
41000057	41	          03 WS-CONT-IN-CS-REVIEW-DATE  PIC 9(8).	0	0	1
41000058	41	          03 WS-CONT-IN-SUCCESS         PIC X.	0	0	1
41000059	41	          03 WS-CONT-IN-FAIL-CODE       PIC X.	0	0	1
41000061	41	       01 WS-CICS-WORK-AREA.	0	0	1
41000062	41	          05 WS-CICS-RESP               PIC S9(8) COMP.	0	0	1
41000063	41	          05 WS-CICS-RESP2              PIC S9(8) COMP.	0	0	1
41000066	41	       01 WS-DELAY-AMT                  PIC S9(8) COMP	0	0	1
41000067	41	                                                   VALUE 0.	0	0	1
41000069	41	       01 WS-CONTAINER-NAME             PIC X(16)  VALUE SPACES.	0	0	1
41000070	41	       01 WS-CHANNEL-NAME               PIC X(16)  VALUE SPACES.	0	0	1
41000072	41	       01 WS-CONTAINER-LEN              PIC S9(8) COMP	0	0	1
41000073	41	                                                   VALUE 0.	0	0	1
41000074	41	       01 WS-NEW-CREDSCORE              PIC 999    VALUE 0.	0	0	1
41000075	41	       01 WS-SEED                       PIC S9(15) COMP.	0	0	1
41000079	41	       01 WS-U-TIME                     PIC S9(15) COMP-3.	0	0	1
41000080	41	       01 WS-ORIG-DATE                  PIC X(10).	0	0	1
41000081	41	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
41000082	41	          03 WS-ORIG-DATE-DD            PIC 99.	0	0	1
41000083	41	          03 FILLER                     PIC X.	0	0	1
41000084	41	          03 WS-ORIG-DATE-MM            PIC 99.	0	0	1
41000085	41	          03 FILLER                     PIC X.	0	0	1
41000086	41	          03 WS-ORIG-DATE-YYYY          PIC 9999.	0	0	1
41000088	41	       01 WS-ORIG-DATE-GRP-X.	0	0	1
41000089	41	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
41000090	41	          03 FILLER                     PIC X      VALUE '.'.	0	0	1
41000091	41	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
41000092	41	          03 FILLER                     PIC X      VALUE '.'.	0	0	1
41000093	41	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
41000096	41	       01 WS-TIME-DATA.	0	0	1
41000097	41	          03 WS-TIME-NOW                PIC 9(6).	0	0	1
41000098	41	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
41000099	41	             05 WS-TIME-NOW-GRP-HH      PIC 99.	0	0	1
41000100	41	             05 WS-TIME-NOW-GRP-MM      PIC 99.	0	0	1
41000101	41	             05 WS-TIME-NOW-GRP-SS      PIC 99.	0	0	1
41000103	41	       01 WS-ABEND-PGM                  PIC X(8)   VALUE 'ABNDPROC'.	0	0	1
41000105	41	       01 ABNDINFO-REC.	0	0	1
41000106	41	           COPY ABNDINFO.	0	0	1
41000108	41	       LINKAGE SECTION.	0	0	1
41000111	41	       PROCEDURE DIVISION.	0	0	1
41000112	41	       PREMIERE SECTION.	0	0	1
41000113	41	       A010.	0	0	1
41000114	41	      *	1	0	0
41000115	41	      *    Generate a random  number of seconds between 0 & 3.	1	0	1
41000116	41	      *    This is the delay amount in seconds.	1	0	1
41000117	41	      *	1	0	1
41000119	41	           MOVE 'CIPB            ' TO WS-CONTAINER-NAME.	0	0	0
41000120	41	           MOVE 'CIPCREDCHANN    ' TO WS-CHANNEL-NAME.	0	0	1
41000121	41	           MOVE EIBTASKN           TO WS-SEED.	0	0	1
41000123	41	           COMPUTE WS-DELAY-AMT = ((3 - 1)	0	0	1
41000124	41	                            * FUNCTION RANDOM(WS-SEED)) + 1.	0	0	1
41000126	41	           EXEC CICS DELAY	0	0	1
41000127	41	                FOR SECONDS(WS-DELAY-AMT)	0	0	1
41000128	41	                RESP(WS-CICS-RESP)	0	0	1
41000129	41	                RESP2(WS-CICS-RESP2)	0	0	1
41000130	41	           END-EXEC.	0	0	1
41000132	41	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
41000133	41	      *	1	0	0
41000134	41	      *       Preserve the RESP and RESP2, then set up the	1	0	1
41000135	41	      *       standard ABEND info before getting the applid,	1	0	1
41000136	41	      *       date/time etc. and linking to the Abend Handler	1	0	1
41000137	41	      *       program.	1	0	1
41000138	41	      *	1	0	1
41000139	41	              INITIALIZE ABNDINFO-REC	0	0	0
41000140	41	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
41000141	41	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
41000142	41	      *	1	0	0
41000143	41	      *       Get supplemental information	1	0	1
41000144	41	      *	1	0	1
41000145	41	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
41000146	41	              END-EXEC	0	0	1
41000148	41	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
41000149	41	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
41000151	41	              PERFORM POPULATE-TIME-DATE	0	0	1
41000153	41	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
41000154	41	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
41000155	41	                      ':' DELIMITED BY SIZE,	0	0	1
41000156	41	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
41000157	41	                       ':' DELIMITED BY SIZE,	0	0	1
41000158	41	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
41000159	41	                       INTO ABND-TIME	0	0	1
41000160	41	              END-STRING	0	0	1
41000162	41	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
41000163	41	              MOVE 'PLOP'      TO ABND-CODE	0	0	1
41000165	41	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
41000166	41	              END-EXEC	0	0	1
41000168	41	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
41000170	41	              STRING 'A010  - *** The delay messed up! ***'	0	0	1
41000171	41	                      DELIMITED BY SIZE,	0	0	1
41000172	41	                      ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
41000173	41	                      ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
41000174	41	                      ' RESP2=' DELIMITED BY SIZE,	0	0	1
41000175	41	                      ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
41000176	41	                      INTO ABND-FREEFORM	0	0	1
41000177	41	              END-STRING	0	0	1
41000179	41	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
41000180	41	                          COMMAREA(ABNDINFO-REC)	0	0	1
41000181	41	              END-EXEC	0	0	1
41000184	41	              DISPLAY '*** The delay messed up ! ***'	0	0	1
41000185	41	              EXEC CICS ABEND	0	0	1
41000186	41	                 ABCODE('PLOP')	0	0	1
41000187	41	              END-EXEC	0	0	1
41000188	41	           END-IF.	0	0	1
41000191	41	           COMPUTE WS-CONTAINER-LEN = LENGTH OF WS-CONT-IN.	0	0	1
41000193	41	           EXEC CICS GET CONTAINER(WS-CONTAINER-NAME)	0	0	1
41000194	41	                     CHANNEL(WS-CHANNEL-NAME)	0	0	1
41000195	41	                     INTO(WS-CONT-IN)	0	0	1
41000196	41	                     FLENGTH(WS-CONTAINER-LEN)	0	0	1
41000197	41	                     RESP(WS-CICS-RESP)	0	0	1
41000198	41	                     RESP2(WS-CICS-RESP2)	0	0	1
41000199	41	           END-EXEC.	0	0	1
41000201	41	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
41000202	41	              DISPLAY 'CRDTAGY2 - UNABLE TO GET CONTAINER. RESP='	0	0	1
41000203	41	                 WS-CICS-RESP ', RESP2=' WS-CICS-RESP2	0	0	1
41000204	41	              DISPLAY 'CONTAINER=' WS-CONTAINER-NAME ' CHANNEL='	0	0	1
41000205	41	                       WS-CHANNEL-NAME ' FLENGTH='	0	0	1
41000206	41	                       WS-CONTAINER-LEN	0	0	1
41000207	41	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
41000208	41	           END-IF.	0	0	1
41000209	41	      *	1	0	0
41000210	41	      *    Now generate a credit score between 1 and 999. Because we	1	0	1
41000211	41	      *    used a SEED on the first RANDOM (above) we don't need to	1	0	1
41000212	41	      *    use a SEED again when using RANDOM for a subsequent time	1	0	1
41000213	41	      *	1	0	1
41000215	41	           COMPUTE WS-NEW-CREDSCORE = ((999 - 1)	0	0	0
41000216	41	                            * FUNCTION RANDOM) + 1.	0	0	1
41000218	41	           MOVE WS-NEW-CREDSCORE TO WS-CONT-IN-CREDIT-SCORE.	0	0	1
41000220	41	      *	1	0	0
41000221	41	      *    Now PUT the data back into a container	1	0	1
41000222	41	      *	1	0	1
41000223	41	           COMPUTE WS-CONTAINER-LEN = LENGTH OF WS-CONT-IN.	0	0	0
41000225	41	           EXEC CICS PUT CONTAINER(WS-CONTAINER-NAME)	0	0	1
41000226	41	                         FROM(WS-CONT-IN)	0	0	1
41000227	41	                         FLENGTH(WS-CONTAINER-LEN)	0	0	1
41000228	41	                         CHANNEL(WS-CHANNEL-NAME)	0	0	1
41000229	41	                         RESP(WS-CICS-RESP)	0	0	1
41000230	41	                         RESP2(WS-CICS-RESP2)	0	0	1
41000231	41	           END-EXEC.	0	0	1
41000233	41	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
41000234	41	              DISPLAY 'CRDTAGY2 - UNABLE TO PUT CONTAINER. RESP='	0	0	1
41000235	41	                 WS-CICS-RESP ', RESP2=' WS-CICS-RESP2	0	0	1
41000236	41	              DISPLAY  'CONTAINER='  WS-CONTAINER-NAME	0	0	1
41000237	41	              ' CHANNEL=' WS-CHANNEL-NAME ' FLENGTH='	0	0	1
41000238	41	                    WS-CONTAINER-LEN	0	0	1
41000239	41	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
41000240	41	           END-IF.	0	0	1
41000242	41	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
41000244	41	       A999.	0	0	1
41000245	41	           EXIT.	0	0	1
41000248	41	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
41000249	41	       GMOFH010.	0	0	1
41000251	41	           EXEC CICS RETURN	0	0	1
41000252	41	           END-EXEC.	0	0	1
41000254	41	       GMOFH999.	0	0	1
41000255	41	           EXIT.	0	0	1
41000258	41	       POPULATE-TIME-DATE SECTION.	0	0	1
41000259	41	       PTD010.	0	0	1
41000261	41	           EXEC CICS ASKTIME	0	0	1
41000262	41	              ABSTIME(WS-U-TIME)	0	0	1
41000263	41	           END-EXEC.	0	0	1
41000265	41	           EXEC CICS FORMATTIME	0	0	1
41000266	41	                     ABSTIME(WS-U-TIME)	0	0	1
41000267	41	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
41000268	41	                     TIME(WS-TIME-NOW)	0	0	1
41000269	41	                     DATESEP	0	0	1
41000270	41	           END-EXEC.	0	0	1
41000272	41	       PTD999.	0	0	1
41000273	41	           EXIT.	0	0	1
42000001	42	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	1
42000002	42	       CBL CICS('SP,EDF')	0	0	1
42000003	42	      ******************************************************************	1	0	0
42000004	42	      *                                                                *	1	0	1
42000005	42	      *  Copyright IBM Corp. 2023                                      *	1	0	1
42000006	42	      *                                                                *	1	0	1
42000007	42	      ******************************************************************	1	0	1
42000010	42	      ******************************************************************	1	0	1
42000011	42	      * This is the Create Customer program in the BANKING application	1	0	1
42000012	42	      * BMS suite.	1	0	1
42000013	42	      *	1	0	1
42000014	42	      ******************************************************************	1	0	1
42000015	42	       IDENTIFICATION DIVISION.	0	0	0
42000016	42	       PROGRAM-ID. BNK1CCS.	0	0	1
42000017	42	       AUTHOR. Jon Collett.	0	0	1
42000019	42	       ENVIRONMENT DIVISION.	0	0	1
42000020	42	       CONFIGURATION SECTION.	0	0	1
42000021	42	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
42000022	42	       SOURCE-COMPUTER.  IBM-370.	0	0	0
42000023	42	       OBJECT-COMPUTER.  IBM-370.	0	0	1
42000025	42	       INPUT-OUTPUT SECTION.	0	0	1
42000027	42	       DATA DIVISION.	0	0	1
42000028	42	       WORKING-STORAGE SECTION.	0	0	1
42000029	42	       01 WS-UCTRANS                  PIC S9(8) COMP VALUE 0.	0	0	1
42000030	42	       01 STORED-UCTRANS              PIC S9(8) COMP VALUE 0.	0	0	1
42000032	42	       01 WS-CICS-WORK-AREA.	0	0	1
42000033	42	          03 WS-CICS-RESP             PIC S9(8) COMP VALUE 0.	0	0	1
42000034	42	          03 WS-CICS-RESP2            PIC S9(8) COMP VALUE 0.	0	0	1
42000036	42	       01 WS-FAIL-INFO.	0	0	1
42000037	42	          03 FILLER                   PIC X(9)  VALUE 'BNK1CCS  '.	0	0	1
42000038	42	          03 WS-CICS-FAIL-MSG         PIC X(70) VALUE ' '.	0	0	1
42000039	42	          03 FILLER                   PIC X(6)  VALUE ' RESP='.	0	0	1
42000040	42	          03 WS-CICS-RESP-DISP        PIC 9(10) VALUE 0.	0	0	1
42000041	42	          03 FILLER                   PIC X(7)  VALUE ' RESP2='.	0	0	1
42000042	42	          03 WS-CICS-RESP2-DISP       PIC 9(10) VALUE 0.	0	0	1
42000043	42	          03 FILLER                   PIC X(15) VALUE ' ABENDING TASK.'.	0	0	1
42000044	42	       01 SWITCHES.	0	0	1
42000045	42	           03 VALID-DATA-SW           PIC X VALUE 'Y'.	0	0	1
42000046	42	              88 VALID-DATA           VALUE 'Y'.	0	0	1
42000048	42	       01 FLAGS.	0	0	1
42000049	42	           03 SEND-FLAG               PIC X.	0	0	1
42000050	42	              88 SEND-ERASE           VALUE '1'.	0	0	1
42000051	42	              88 SEND-DATAONLY        VALUE '2'.	0	0	1
42000052	42	              88 SEND-DATAONLY-ALARM  VALUE '3'.	0	0	1
42000054	42	       01 ACTION-ALPHA.	0	0	1
42000055	42	           03 ACTION-NUM              PIC 9.	0	0	1
42000057	42	      *	1	0	0
42000058	42	      * The end of session message	1	0	1
42000059	42	      *	1	0	1
42000060	42	       01 END-OF-SESSION-MESSAGE      PIC X(13) VALUE 'Session Ended'.	0	0	0
42000062	42	       01 RESPONSE-CODE               PIC S9(8) COMP.	0	0	1
42000064	42	       01 COMMUNICATION-AREA          PIC X.	0	0	1
42000066	42	       COPY BNK1CCM.	0	0	1
42000068	42	       COPY DFHAID.	0	0	1
42000070	42	       01 COMM-DOB-SPLIT.	0	0	1
42000071	42	          03 COMM-DOB-SPLIT-DD         PIC 99.	0	0	1
42000072	42	          03 COMM-DOB-SPLIT-MM         PIC 99.	0	0	1
42000073	42	          03 COMM-DOB-SPLIT-YYYY       PIC 9999.	0	0	1
42000075	42	       01 COMM-ADDR-SPLIT.	0	0	1
42000076	42	          03 COMM-ADDR-SPLIT1         PIC X(60).	0	0	1
42000077	42	          03 COMM-ADDR-SPLIT2         PIC X(60).	0	0	1
42000078	42	          03 COMM-ADDR-SPLIT3         PIC X(40).	0	0	1
42000080	42	       01 WS-COMM-AREA.	0	0	1
42000081	42	          03 WS-COMM-DATA               PIC X.	0	0	1
42000082	42	          03 WS-COMM-TERM               PIC S9(8) COMP.	0	0	1
42000084	42	       01 DATE-REFORMED.	0	0	1
42000085	42	          03 DOBDDI-CHAR               PIC XX.	0	0	1
42000086	42	          03 DOBDDI-REFORM REDEFINES DOBDDI-CHAR.	0	0	1
42000087	42	             05 DOBDDI-NUM             PIC 99.	0	0	1
42000088	42	          03 DOBMMI-CHAR               PIC XX.	0	0	1
42000089	42	          03 DOBMMI-REFORM REDEFINES DOBMMI-CHAR.	0	0	1
42000090	42	             05 DOBMMI-NUM             PIC 99.	0	0	1
42000091	42	          03 DOBYYI-CHAR               PIC XX.	0	0	1
42000092	42	          03 DOBYYI-REFORM REDEFINES DOBYYI-CHAR.	0	0	1
42000093	42	             05 DOBYYI-NUM             PIC 99.	0	0	1
42000095	42	       01 WS-ABCODE PIC XXXX.	0	0	1
42000097	42	       01 WS-ADDR-SPLIT.	0	0	1
42000098	42	          03 WS-ADDR-SPLIT1            PIC X(60).	0	0	1
42000099	42	          03 WS-ADDR-SPLIT2            PIC X(60).	0	0	1
42000100	42	          03 WS-ADDR-SPLIT3            PIC X(40).	0	0	1
42000102	42	       01 SUBPGM-PARMS.	0	0	1
42000103	42	          03 SUBPGM-EYECATCHER                 PIC X(4).	0	0	1
42000104	42	          03 SUBPGM-KEY.	0	0	1
42000105	42	             05 SUBPGM-SORTCODE                PIC 9(6) DISPLAY.	0	0	1
42000106	42	             05 SUBPGM-NUMBER                  PIC 9(10) DISPLAY.	0	0	1
42000107	42	          03 SUBPGM-NAME                       PIC X(60).	0	0	1
42000108	42	          03 SUBPGM-ADDRESS                    PIC X(160).	0	0	1
42000109	42	          03 SUBPGM-DATE-OF-BIRTH              PIC 9(8).	0	0	1
42000110	42	          03 SUBPGM-DOB-GROUP REDEFINES SUBPGM-DATE-OF-BIRTH.	0	0	1
42000111	42	             05 SUBPGM-BIRTH-DAY               PIC 99.	0	0	1
42000112	42	             05 SUBPGM-BIRTH-MONTH             PIC 99.	0	0	1
42000113	42	             05 SUBPGM-BIRTH-YEAR              PIC 9999.	0	0	1
42000114	42	          03 SUBPGM-CREDIT-SCORE               PIC 999.	0	0	1
42000115	42	          03 SUBPGM-CS-REVIEW-DATE             PIC 9(8).	0	0	1
42000116	42	          03 SUBPGM-SUCCESS                    PIC X.	0	0	1
42000117	42	          03 SUBPGM-FAIL-CODE                  PIC X.	0	0	1
42000119	42	       01 COMPANY-NAME-FULL PIC X(32).	0	0	1
42000121	42	       01 CURSOR-POSITION PIC S9(4) BINARY.	0	0	1
42000123	42	       01 WS-U-TIME                      PIC S9(15) COMP-3.	0	0	1
42000124	42	       01 WS-ORIG-DATE                   PIC X(10).	0	0	1
42000125	42	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
42000126	42	          03 WS-ORIG-DATE-DD             PIC 99.	0	0	1
42000127	42	          03 FILLER                      PIC X.	0	0	1
42000128	42	          03 WS-ORIG-DATE-MM             PIC 99.	0	0	1
42000129	42	          03 FILLER                      PIC X.	0	0	1
42000130	42	          03 WS-ORIG-DATE-YYYY           PIC 9999.	0	0	1
42000132	42	       01 WS-ORIG-DATE-GRP-X.	0	0	1
42000133	42	          03 WS-ORIG-DATE-DD-X           PIC XX.	0	0	1
42000134	42	          03 FILLER                      PIC X VALUE '.'.	0	0	1
42000135	42	          03 WS-ORIG-DATE-MM-X           PIC XX.	0	0	1
42000136	42	          03 FILLER                      PIC X VALUE '.'.	0	0	1
42000137	42	          03 WS-ORIG-DATE-YYYY-X         PIC X(4).	0	0	1
42000139	42	       01 WS-TIME-DATA.	0	0	1
42000140	42	           03 WS-TIME-NOW                  PIC 9(6).	0	0	1
42000141	42	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
42000142	42	              05 WS-TIME-NOW-GRP-HH     PIC 99.	0	0	1
42000143	42	              05 WS-TIME-NOW-GRP-MM     PIC 99.	0	0	1
42000144	42	              05 WS-TIME-NOW-GRP-SS     PIC 99.	0	0	1
42000146	42	       01 WS-ABEND-PGM                  PIC X(8) VALUE 'ABNDPROC'.	0	0	1
42000148	42	       01 ABNDINFO-REC.	0	0	1
42000149	42	           COPY ABNDINFO.	0	0	1
42000152	42	       LINKAGE SECTION.	0	0	1
42000153	42	       01 DFHCOMMAREA.	0	0	1
42000154	42	          03 DFHCOMMAREA-DATA                  PIC X(5).	0	0	1
42000157	42	       PROCEDURE DIVISION.	0	0	1
42000158	42	       PREMIERE SECTION.	0	0	1
42000159	42	       A010.	0	0	1
42000161	42	           EXEC CICS HANDLE ABEND	0	0	1
42000162	42	              LABEL(HANDLE-ABEND)	0	0	1
42000163	42	           END-EXEC.	0	0	1
42000165	42	           EVALUATE TRUE	0	0	1
42000166	42	      *	1	0	0
42000167	42	      *       Is it the first time through? If so, send the map	1	0	1
42000168	42	      *       with erased (empty) data fields.	1	0	1
42000169	42	      *	1	0	1
42000170	42	              WHEN EIBCALEN = ZERO	0	0	0
42000171	42	                 MOVE LOW-VALUE TO BNK1CCO	0	0	1
42000172	42	                 MOVE SPACES TO CUSTTITO	0	0	1
42000173	42	                 MOVE SPACES TO CHRISTNO	0	0	1
42000174	42	                 MOVE SPACES TO CUSTINSO	0	0	1
42000175	42	                 MOVE SPACES TO CUSTSNO	0	0	1
42000176	42	                 MOVE SPACES TO CUSTAD1O	0	0	1
42000177	42	                 MOVE SPACES TO CUSTAD2O	0	0	1
42000178	42	                 MOVE SPACES TO CUSTAD3O	0	0	1
42000180	42	                 MOVE -1 TO CUSTTITL	0	0	1
42000181	42	                 SET SEND-ERASE TO TRUE	0	0	1
42000182	42	                 MOVE SPACES TO MESSAGEO	0	0	1
42000184	42	                 PERFORM STORE-TERM-DEF	0	0	1
42000186	42	                 PERFORM SEND-MAP	0	0	1
42000188	42	                 MOVE ' '            TO WS-COMM-AREA	0	0	1
42000189	42	                 MOVE STORED-UCTRANS TO WS-COMM-TERM	0	0	1
42000191	42	      *	1	0	0
42000192	42	      *       If a PA key is pressed, just carry on	1	0	1
42000193	42	      *	1	0	1
42000194	42	              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3	0	0	0
42000195	42	                 CONTINUE	0	0	1
42000197	42	      *	1	0	0
42000198	42	      *       When Pf3 is pressed, return to the main menu	1	0	1
42000199	42	      *	1	0	1
42000200	42	              WHEN EIBAID = DFHPF3	0	0	0
42000202	42	      *	1	0	0
42000203	42	      *          Set the terminal UCTRAN back to	1	0	1
42000204	42	      *          its starting position	1	0	1
42000205	42	      *	1	0	1
42000206	42	                 PERFORM RESTORE-TERM-DEF	0	0	0
42000208	42	                 EXEC CICS RETURN	0	0	1
42000209	42	                    TRANSID('OMEN')	0	0	1
42000210	42	                    IMMEDIATE	0	0	1
42000211	42	                    RESP(WS-CICS-RESP)	0	0	1
42000212	42	                    RESP2(WS-CICS-RESP2)	0	0	1
42000213	42	                 END-EXEC	0	0	1
42000215	42	      *	1	0	0
42000216	42	      *       If Pf12 is pressed, then send a termination	1	0	1
42000217	42	      *       message.	1	0	1
42000218	42	      *	1	0	1
42000219	42	              WHEN EIBAID = DFHPF12	0	0	0
42000220	42	                 PERFORM SEND-TERMINATION-MSG	0	0	1
42000222	42	      *	1	0	0
42000223	42	      *          Set the terminal UCTRAN back to	1	0	1
42000224	42	      *          its starting position	1	0	1
42000225	42	      *	1	0	1
42000226	42	                 PERFORM RESTORE-TERM-DEF	0	0	0
42000228	42	                 EXEC CICS	0	0	1
42000229	42	                    RETURN	0	0	1
42000230	42	                 END-EXEC	0	0	1
42000232	42	      *	1	0	0
42000233	42	      *       When CLEAR is pressed	1	0	1
42000234	42	      *	1	0	1
42000235	42	              WHEN EIBAID = DFHCLEAR	0	0	0
42000236	42	                 EXEC CICS SEND MAP('BNK1CCM')	0	0	1
42000237	42	                           MAPONLY	0	0	1
42000238	42	                           ERASE	0	0	1
42000239	42	                           FREEKB	0	0	1
42000240	42	                 END-EXEC	0	0	1
42000242	42	      *	1	0	0
42000243	42	      *          Set the terminal UCTRAN back to	1	0	1
42000244	42	      *          its starting position	1	0	1
42000245	42	      *	1	0	1
42000246	42	                 PERFORM RESTORE-TERM-DEF	0	0	0
42000249	42	                 EXEC CICS RETURN TRANSID('OCCS')	0	0	1
42000250	42	                           COMMAREA(WS-COMM-AREA)	0	0	1
42000251	42	                 END-EXEC	0	0	1
42000253	42	      *	1	0	0
42000254	42	      *       When enter is pressed then process the content	1	0	1
42000255	42	      *	1	0	1
42000256	42	              WHEN EIBAID = DFHENTER	0	0	0
42000257	42	                 PERFORM PROCESS-MAP	0	0	1
42000259	42	      *	1	0	0
42000260	42	      *       When anything else happens, send the invalid key message	1	0	1
42000261	42	      *	1	0	1
42000262	42	              WHEN OTHER	0	0	0
42000263	42	                 MOVE DFHCOMMAREA TO WS-COMM-AREA	0	0	1
42000264	42	                 MOVE LOW-VALUES TO BNK1CCO	0	0	1
42000265	42	                 MOVE SPACES TO MESSAGEO	0	0	1
42000266	42	                 MOVE 'Invalid key pressed.' TO MESSAGEO	0	0	1
42000267	42	                 SET SEND-DATAONLY-ALARM TO TRUE	0	0	1
42000268	42	                 PERFORM SEND-MAP	0	0	1
42000271	42	           END-EVALUATE.	0	0	1
42000273	42	      *	1	0	0
42000274	42	      * Now RETURN	1	0	1
42000275	42	      *	1	0	1
42000276	42	           EXEC CICS	0	0	0
42000277	42	              RETURN TRANSID('OCCS')	0	0	1
42000278	42	              COMMAREA(WS-COMM-AREA)	0	0	1
42000279	42	              LENGTH(248)	0	0	1
42000280	42	              RESP(WS-CICS-RESP)	0	0	1
42000281	42	              RESP2(WS-CICS-RESP2)	0	0	1
42000282	42	           END-EXEC.	0	0	1
42000284	42	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
42000285	42	      *	1	0	0
42000286	42	      *       Preserve the RESP and RESP2, then set up the	1	0	1
42000287	42	      *       standard ABEND info before getting the applid,	1	0	1
42000288	42	      *       date/time etc. and linking to the Abend Handler	1	0	1
42000289	42	      *       program.	1	0	1
42000290	42	      *	1	0	1
42000291	42	              INITIALIZE ABNDINFO-REC	0	0	0
42000292	42	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
42000293	42	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
42000294	42	      *	1	0	0
42000295	42	      *       Get supplemental information	1	0	1
42000296	42	      *	1	0	1
42000297	42	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
42000298	42	              END-EXEC	0	0	1
42000300	42	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
42000301	42	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
42000303	42	              PERFORM POPULATE-TIME-DATE	0	0	1
42000305	42	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
42000306	42	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
42000307	42	                    ':' DELIMITED BY SIZE,	0	0	1
42000308	42	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
42000309	42	                     ':' DELIMITED BY SIZE,	0	0	1
42000310	42	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
42000311	42	                     INTO ABND-TIME	0	0	1
42000312	42	              END-STRING	0	0	1
42000314	42	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
42000315	42	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
42000317	42	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
42000318	42	              END-EXEC	0	0	1
42000320	42	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
42000322	42	              STRING 'A010 -RETURN TRANSID(OCCS) FAIL'	0	0	1
42000323	42	                    DELIMITED BY SIZE,	0	0	1
42000324	42	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
42000325	42	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
42000326	42	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
42000327	42	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
42000328	42	                    INTO ABND-FREEFORM	0	0	1
42000329	42	              END-STRING	0	0	1
42000331	42	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
42000332	42	                        COMMAREA(ABNDINFO-REC)	0	0	1
42000333	42	              END-EXEC	0	0	1
42000335	42	              INITIALIZE WS-FAIL-INFO	0	0	1
42000336	42	              MOVE 'BNK1CCS - A010 - RETURN TRANSID(OCCS) FAIL' TO	0	0	1
42000337	42	                 WS-CICS-FAIL-MSG	0	0	1
42000338	42	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
42000339	42	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
42000341	42	              PERFORM RESTORE-TERM-DEF	0	0	1
42000342	42	              PERFORM ABEND-THIS-TASK	0	0	1
42000343	42	           END-IF.	0	0	1
42000345	42	       A999.	0	0	1
42000346	42	           EXIT.	0	0	1
42000349	42	       PROCESS-MAP SECTION.	0	0	1
42000350	42	       PM010.	0	0	1
42000351	42	      *	1	0	0
42000352	42	      *    Retrieve the data from the map	1	0	1
42000353	42	      *	1	0	1
42000354	42	           MOVE DFHCOMMAREA TO WS-COMM-AREA.	0	0	0
42000356	42	           PERFORM RECEIVE-MAP.	0	0	1
42000358	42	      *	1	0	0
42000359	42	      *    Validate the received data	1	0	1
42000360	42	      *	1	0	1
42000361	42	           PERFORM EDIT-DATA.	0	0	0
42000362	42	      *	1	0	0
42000363	42	      *    If the data passes validation go on to	1	0	1
42000364	42	      *    create a CUSTOMER	1	0	1
42000365	42	      *	1	0	1
42000366	42	           IF VALID-DATA	0	0	0
42000367	42	              PERFORM CRE-CUST-DATA	0	0	1
42000368	42	           END-IF.	0	0	1
42000370	42	           SET SEND-DATAONLY-ALARM TO TRUE.	0	0	1
42000371	42	      *	1	0	0
42000372	42	      *    Output the data to the screen	1	0	1
42000373	42	      *	1	0	1
42000374	42	           PERFORM SEND-MAP.	0	0	0
42000376	42	       PM999.	0	0	1
42000377	42	           EXIT.	0	0	1
42000380	42	       RECEIVE-MAP SECTION.	0	0	1
42000381	42	       RM010.	0	0	1
42000382	42	      *	1	0	0
42000383	42	      *    Retrieve the data	1	0	1
42000384	42	      *	1	0	1
42000386	42	      *	1	0	1
42000387	42	      *    To ensure that we get the correct case and the terminal	1	0	1
42000388	42	      *    doesn't change the case from ower case to upper case we	1	0	1
42000389	42	      *    we need to turn off upper case translation, do the receive	1	0	1
42000390	42	      *    and then turn it on again.	1	0	1
42000391	42	      *	1	0	1
42000392	42	           EXEC CICS INQUIRE	0	0	0
42000393	42	                TERMINAL(EIBTRMID)	0	0	1
42000394	42	                UCTRANST(WS-UCTRANS)	0	0	1
42000395	42	                RESP(WS-CICS-RESP)	0	0	1
42000396	42	                RESP2(WS-CICS-RESP2)	0	0	1
42000397	42	           END-EXEC.	0	0	1
42000400	42	      *	1	0	0
42000401	42	      *    If Uppercase translation is switched on, then set it to	1	0	1
42000402	42	      *    NOUCTRAN(451).	1	0	1
42000403	42	      *	1	0	1
42000404	42	           IF WS-UCTRANS = DFHVALUE(UCTRAN) OR	0	0	0
42000405	42	           WS-UCTRANS = DFHVALUE(TRANIDONLY)	0	0	1
42000407	42	              MOVE DFHVALUE(NOUCTRAN) TO WS-UCTRANS	0	0	1
42000409	42	              EXEC CICS SET TERMINAL(EIBTRMID)	0	0	1
42000410	42	                 UCTRANST(WS-UCTRANS)	0	0	1
42000411	42	                 RESP(WS-CICS-RESP)	0	0	1
42000412	42	                 RESP2(WS-CICS-RESP2)	0	0	1
42000413	42	              END-EXEC	0	0	1
42000415	42	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
42000416	42	      *	1	0	0
42000417	42	      *          Preserve the RESP and RESP2, then set up the	1	0	1
42000418	42	      *          standard ABEND info before getting the applid,	1	0	1
42000419	42	      *          date/time etc. and linking to the Abend Handler	1	0	1
42000420	42	      *          program.	1	0	1
42000421	42	      *	1	0	1
42000422	42	                 INITIALIZE ABNDINFO-REC	0	0	0
42000423	42	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
42000424	42	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
42000425	42	      *	1	0	0
42000426	42	      *          Get supplemental information	1	0	1
42000427	42	      *	1	0	1
42000428	42	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
42000429	42	                 END-EXEC	0	0	1
42000431	42	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
42000432	42	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
42000434	42	                 PERFORM POPULATE-TIME-DATE	0	0	1
42000436	42	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
42000437	42	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
42000438	42	                       ':' DELIMITED BY SIZE,	0	0	1
42000439	42	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
42000440	42	                        ':' DELIMITED BY SIZE,	0	0	1
42000441	42	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
42000442	42	                        INTO ABND-TIME	0	0	1
42000443	42	                 END-STRING	0	0	1
42000445	42	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
42000446	42	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
42000448	42	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
42000449	42	                 END-EXEC	0	0	1
42000451	42	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
42000453	42	                 STRING 'RM010 -RM010 (1) - SET TERMINAL '	0	0	1
42000454	42	                      DELIMITED BY SIZE,	0	0	1
42000455	42	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
42000456	42	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
42000457	42	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
42000458	42	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
42000459	42	                       INTO ABND-FREEFORM	0	0	1
42000460	42	                 END-STRING	0	0	1
42000462	42	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
42000463	42	                           COMMAREA(ABNDINFO-REC)	0	0	1
42000464	42	                 END-EXEC	0	0	1
42000466	42	                 INITIALIZE WS-FAIL-INFO	0	0	1
42000467	42	                 MOVE 'BNK1CCS - RM010 (1) - SET TERMINAL UC FAIL ' TO	0	0	1
42000468	42	                    WS-CICS-FAIL-MSG	0	0	1
42000469	42	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
42000470	42	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
42000471	42	      D          DISPLAY 'Set terminal UC fail, going to'	0	0	1
42000472	42	      D                  'restore terminal.'	0	0	1
42000473	42	                 PERFORM RESTORE-TERM-DEF	0	0	1
42000474	42	                 PERFORM ABEND-THIS-TASK	0	0	1
42000475	42	              END-IF	0	0	1
42000476	42	           END-IF.	0	0	1
42000478	42	      *	1	0	0
42000479	42	      *    Receive the map AS IS	1	0	1
42000480	42	      *	1	0	1
42000481	42	           MOVE LOW-VALUES TO BNK1CCI.	0	0	0
42000482	42	           MOVE SPACES TO CUSTTITI.	0	0	1
42000483	42	           MOVE SPACES TO CHRISTNI.	0	0	1
42000484	42	           MOVE SPACES TO CUSTINSI.	0	0	1
42000485	42	           MOVE SPACES TO CUSTSNI.	0	0	1
42000486	42	           MOVE SPACES TO CUSTAD1I.	0	0	1
42000487	42	           MOVE SPACES TO CUSTAD2I.	0	0	1
42000488	42	           MOVE SPACES TO CUSTAD3I.	0	0	1
42000489	42	           MOVE 0 TO DOBDDI.	0	0	1
42000490	42	           MOVE 0 TO DOBMMI.	0	0	1
42000491	42	           MOVE 0 TO DOBYYI.	0	0	1
42000492	42	           MOVE 0 TO SORTCI.	0	0	1
42000493	42	           MOVE 0 TO CUSTNO2I.	0	0	1
42000494	42	           MOVE 0 TO CREDSCI.	0	0	1
42000495	42	           MOVE 0 TO SCRDTDDI.	0	0	1
42000496	42	           MOVE 0 TO SCRDTMMI.	0	0	1
42000497	42	           MOVE 0 TO SCRDTYYI.	0	0	1
42000498	42	           MOVE SPACES TO MESSAGEI.	0	0	1
42000500	42	           EXEC CICS	0	0	1
42000501	42	              RECEIVE MAP('BNK1CC')	0	0	1
42000502	42	              MAPSET('BNK1CCM')	0	0	1
42000503	42	              INTO(BNK1CCI)	0	0	1
42000504	42	              TERMINAL	0	0	1
42000505	42	              ASIS	0	0	1
42000506	42	              RESP(WS-CICS-RESP)	0	0	1
42000507	42	              RESP2(WS-CICS-RESP2)	0	0	1
42000508	42	           END-EXEC.	0	0	1
42000510	42	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
42000511	42	      *	1	0	0
42000512	42	      *       Preserve the RESP and RESP2, then set up the	1	0	1
42000513	42	      *       standard ABEND info before getting the applid,	1	0	1
42000514	42	      *       date/time etc. and linking to the Abend Handler	1	0	1
42000515	42	      *       program.	1	0	1
42000516	42	      *	1	0	1
42000517	42	              INITIALIZE ABNDINFO-REC	0	0	0
42000518	42	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
42000519	42	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
42000520	42	      *	1	0	0
42000521	42	      *       Get supplemental information	1	0	1
42000522	42	      *	1	0	1
42000523	42	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
42000524	42	              END-EXEC	0	0	1
42000526	42	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
42000527	42	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
42000529	42	              PERFORM POPULATE-TIME-DATE	0	0	1
42000531	42	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
42000532	42	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
42000533	42	                    ':' DELIMITED BY SIZE,	0	0	1
42000534	42	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
42000535	42	                     ':' DELIMITED BY SIZE,	0	0	1
42000536	42	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
42000537	42	                     INTO ABND-TIME	0	0	1
42000538	42	              END-STRING	0	0	1
42000540	42	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
42000541	42	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
42000543	42	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
42000544	42	              END-EXEC	0	0	1
42000546	42	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
42000548	42	              STRING 'RM010 - RM010 (2) - RECEIVE MAP FAIL '	0	0	1
42000549	42	                   DELIMITED BY SIZE,	0	0	1
42000550	42	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
42000551	42	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
42000552	42	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
42000553	42	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
42000554	42	                    INTO ABND-FREEFORM	0	0	1
42000555	42	              END-STRING	0	0	1
42000557	42	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
42000558	42	                        COMMAREA(ABNDINFO-REC)	0	0	1
42000559	42	              END-EXEC	0	0	1
42000562	42	              INITIALIZE WS-FAIL-INFO	0	0	1
42000563	42	              MOVE 'BNK1CCS - RM010 (2) - RECEIVE MAP FAIL ' TO	0	0	1
42000564	42	                 WS-CICS-FAIL-MSG	0	0	1
42000565	42	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
42000566	42	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
42000568	42	              PERFORM RESTORE-TERM-DEF	0	0	1
42000569	42	              PERFORM ABEND-THIS-TASK	0	0	1
42000570	42	           END-IF.	0	0	1
42000572	42	       RM999.	0	0	1
42000573	42	           EXIT.	0	0	1
42000576	42	       EDIT-DATA SECTION.	0	0	1
42000577	42	       ED010.	0	0	1
42000578	42	      *	1	0	0
42000579	42	      *    Perform validation on the incoming fields	1	0	1
42000580	42	      *	1	0	1
42000581	42	           IF CUSTNO2L > 0	0	0	0
42000582	42	              MOVE 'Please clear screen before creating new user'	0	0	1
42000583	42	                 TO MESSAGEO	0	0	1
42000584	42	              MOVE -1  TO CUSTTITL	0	0	1
42000585	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000586	42	              GO TO ED999	0	0	1
42000587	42	           END-IF	0	0	1
42000589	42	           IF CUSTTITL < 1 OR CUSTTITI = SPACES	0	0	1
42000590	42	           OR CUSTTITI = LOW-VALUES	0	0	1
42000591	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000593	42	              STRING 'Valid titles are: Mr,Mrs,Miss,Ms,Dr,Professor,'	0	0	1
42000594	42	                    DELIMITED BY SIZE,	0	0	1
42000595	42	                     'Drs,Lord,Sir,Lady' DELIMITED BY SIZE	0	0	1
42000596	42	              INTO MESSAGEO	0	0	1
42000597	42	              MOVE -1 TO CUSTTITL	0	0	1
42000598	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000599	42	              GO TO ED999	0	0	1
42000600	42	           END-IF.	0	0	1
42000602	42	           MOVE SPACES TO MESSAGEO.	0	0	1
42000604	42	           IF CUSTTITL > 0	0	0	1
42000606	42	              EVALUATE CUSTTITI	0	0	1
42000607	42	                 WHEN 'MR________'	0	0	1
42000608	42	                    MOVE 'Mr' TO CUSTTITI	0	0	1
42000609	42	                    CONTINUE	0	0	1
42000610	42	                 WHEN 'Mr________'	0	0	1
42000611	42	                    MOVE 'Mr' TO CUSTTITI	0	0	1
42000612	42	                    CONTINUE	0	0	1
42000613	42	                 WHEN 'MR        '	0	0	1
42000614	42	                    MOVE 'Mr' TO CUSTTITI	0	0	1
42000615	42	                    CONTINUE	0	0	1
42000616	42	                 WHEN 'Mr         '	0	0	1
42000617	42	                    CONTINUE	0	0	1
42000618	42	                 WHEN 'mr________'	0	0	1
42000619	42	                    MOVE 'Mr' TO CUSTTITI	0	0	1
42000620	42	                    CONTINUE	0	0	1
42000621	42	                 WHEN 'MRS_______'	0	0	1
42000622	42	                    MOVE 'Mrs' TO CUSTTITI	0	0	1
42000623	42	                    CONTINUE	0	0	1
42000624	42	                 WHEN 'Mrs_______'	0	0	1
42000625	42	                    MOVE 'Mrs' TO CUSTTITI	0	0	1
42000626	42	                    CONTINUE	0	0	1
42000627	42	                 WHEN 'MRS       '	0	0	1
42000628	42	                    MOVE 'Mrs' TO CUSTTITI	0	0	1
42000629	42	                    CONTINUE	0	0	1
42000630	42	                 WHEN 'Mrs       '	0	0	1
42000631	42	                    CONTINUE	0	0	1
42000632	42	                 WHEN 'mrs_______'	0	0	1
42000633	42	                    MOVE 'Mrs' TO CUSTTITI	0	0	1
42000634	42	                    CONTINUE	0	0	1
42000635	42	                 WHEN 'MISS______'	0	0	1
42000636	42	                    MOVE 'Miss' TO CUSTTITI	0	0	1
42000637	42	                    CONTINUE	0	0	1
42000638	42	                 WHEN 'Miss______'	0	0	1
42000639	42	                    MOVE 'Miss' TO CUSTTITI	0	0	1
42000640	42	                    CONTINUE	0	0	1
42000641	42	                 WHEN 'MISS      '	0	0	1
42000642	42	                    MOVE 'Miss' TO CUSTTITI	0	0	1
42000643	42	                    CONTINUE	0	0	1
42000644	42	                 WHEN 'Miss      '	0	0	1
42000645	42	                    MOVE 'Miss' TO CUSTTITI	0	0	1
42000646	42	                    CONTINUE	0	0	1
42000647	42	                 WHEN 'miss______'	0	0	1
42000648	42	                    MOVE 'Miss' TO CUSTTITI	0	0	1
42000649	42	                    CONTINUE	0	0	1
42000650	42	                 WHEN 'MS________'	0	0	1
42000651	42	                    MOVE 'Ms' TO CUSTTITI	0	0	1
42000652	42	                    CONTINUE	0	0	1
42000653	42	                 WHEN 'Ms________'	0	0	1
42000654	42	                    MOVE 'Ms' TO CUSTTITI	0	0	1
42000655	42	                    CONTINUE	0	0	1
42000656	42	                 WHEN 'ms________'	0	0	1
42000657	42	                    MOVE 'Ms' TO CUSTTITI	0	0	1
42000658	42	                    CONTINUE	0	0	1
42000659	42	                 WHEN 'MS        '	0	0	1
42000660	42	                    MOVE 'Ms' TO CUSTTITI	0	0	1
42000661	42	                    CONTINUE	0	0	1
42000662	42	                 WHEN 'Ms        '	0	0	1
42000663	42	                    MOVE 'Ms' TO CUSTTITI	0	0	1
42000664	42	                    CONTINUE	0	0	1
42000665	42	                 WHEN 'ms        '	0	0	1
42000666	42	                    MOVE 'Ms' TO CUSTTITI	0	0	1
42000667	42	                    CONTINUE	0	0	1
42000668	42	                 WHEN 'DR________'	0	0	1
42000669	42	                    MOVE 'Dr' TO CUSTTITI	0	0	1
42000670	42	                    CONTINUE	0	0	1
42000671	42	                 WHEN 'Dr________'	0	0	1
42000672	42	                    MOVE 'Dr' TO CUSTTITI	0	0	1
42000673	42	                    CONTINUE	0	0	1
42000674	42	                 WHEN 'DR        '	0	0	1
42000675	42	                    MOVE 'Dr' TO CUSTTITI	0	0	1
42000676	42	                    CONTINUE	0	0	1
42000677	42	                 WHEN 'Dr        '	0	0	1
42000678	42	                    MOVE 'Dr' TO CUSTTITI	0	0	1
42000679	42	                    CONTINUE	0	0	1
42000680	42	                 WHEN 'dr        '	0	0	1
42000681	42	                    MOVE 'Dr' TO CUSTTITI	0	0	1
42000682	42	                    CONTINUE	0	0	1
42000683	42	                 WHEN 'dr________'	0	0	1
42000684	42	                    MOVE 'Dr' TO CUSTTITI	0	0	1
42000685	42	                    CONTINUE	0	0	1
42000686	42	                 WHEN 'DRS_______'	0	0	1
42000687	42	                    MOVE 'Drs' TO CUSTTITI	0	0	1
42000688	42	                    CONTINUE	0	0	1
42000689	42	                 WHEN 'Drs_______'	0	0	1
42000690	42	                    MOVE 'Drs' TO CUSTTITI	0	0	1
42000691	42	                    CONTINUE	0	0	1
42000692	42	                 WHEN 'DRS       '	0	0	1
42000693	42	                    MOVE 'Drs' TO CUSTTITI	0	0	1
42000694	42	                    CONTINUE	0	0	1
42000695	42	                 WHEN 'Drs       '	0	0	1
42000696	42	                    MOVE 'Drs' TO CUSTTITI	0	0	1
42000697	42	                    CONTINUE	0	0	1
42000698	42	                 WHEN 'drs       '	0	0	1
42000699	42	                    MOVE 'Drs' TO CUSTTITI	0	0	1
42000700	42	                    CONTINUE	0	0	1
42000701	42	                 WHEN 'drs_______'	0	0	1
42000702	42	                    MOVE 'Drs' TO CUSTTITI	0	0	1
42000703	42	                    CONTINUE	0	0	1
42000704	42	                 WHEN 'PROFESSOR_'	0	0	1
42000705	42	                    MOVE 'Professor' TO CUSTTITI	0	0	1
42000706	42	                    CONTINUE	0	0	1
42000707	42	                 WHEN 'Professor_'	0	0	1
42000708	42	                    MOVE 'Professor' TO CUSTTITI	0	0	1
42000709	42	                    CONTINUE	0	0	1
42000710	42	                 WHEN 'PROFESSOR '	0	0	1
42000711	42	                    MOVE 'Professor' TO CUSTTITI	0	0	1
42000712	42	                    CONTINUE	0	0	1
42000713	42	                 WHEN 'Professor '	0	0	1
42000714	42	                    MOVE 'Professor' TO CUSTTITI	0	0	1
42000715	42	                    CONTINUE	0	0	1
42000716	42	                 WHEN 'LORD______'	0	0	1
42000717	42	                    MOVE 'Lord' TO CUSTTITI	0	0	1
42000718	42	                    CONTINUE	0	0	1
42000719	42	                 WHEN 'Lord______'	0	0	1
42000720	42	                    MOVE 'Lord' TO CUSTTITI	0	0	1
42000721	42	                    CONTINUE	0	0	1
42000722	42	                 WHEN 'LORD      '	0	0	1
42000723	42	                    MOVE 'Lord' TO CUSTTITI	0	0	1
42000724	42	                    CONTINUE	0	0	1
42000725	42	                 WHEN 'Lord      '	0	0	1
42000726	42	                    MOVE 'Lord' TO CUSTTITI	0	0	1
42000727	42	                    CONTINUE	0	0	1
42000728	42	                 WHEN 'lord      '	0	0	1
42000729	42	                    MOVE 'Lord' TO CUSTTITI	0	0	1
42000730	42	                    CONTINUE	0	0	1
42000731	42	                 WHEN 'lord______'	0	0	1
42000732	42	                    MOVE 'Lord' TO CUSTTITI	0	0	1
42000733	42	                    CONTINUE	0	0	1
42000734	42	                 WHEN 'LADY______'	0	0	1
42000735	42	                    MOVE 'Lady' TO CUSTTITI	0	0	1
42000736	42	                    CONTINUE	0	0	1
42000737	42	                 WHEN 'Lady______'	0	0	1
42000738	42	                    MOVE 'Lady' TO CUSTTITI	0	0	1
42000739	42	                    CONTINUE	0	0	1
42000740	42	                 WHEN 'LADY      '	0	0	1
42000741	42	                    MOVE 'Lady' TO CUSTTITI	0	0	1
42000742	42	                    CONTINUE	0	0	1
42000743	42	                 WHEN 'Lady      '	0	0	1
42000744	42	                    MOVE 'Lady' TO CUSTTITI	0	0	1
42000745	42	                    CONTINUE	0	0	1
42000746	42	                 WHEN 'lady      '	0	0	1
42000747	42	                    MOVE 'Lady' TO CUSTTITI	0	0	1
42000748	42	                    CONTINUE	0	0	1
42000749	42	                 WHEN 'lady______'	0	0	1
42000750	42	                    MOVE 'Lady' TO CUSTTITI	0	0	1
42000751	42	                    CONTINUE	0	0	1
42000752	42	                 WHEN 'SIR_______'	0	0	1
42000753	42	                    MOVE 'Sir' TO CUSTTITI	0	0	1
42000754	42	                    CONTINUE	0	0	1
42000755	42	                 WHEN 'Sir_______'	0	0	1
42000756	42	                    MOVE 'Sir' TO CUSTTITI	0	0	1
42000757	42	                    CONTINUE	0	0	1
42000758	42	                 WHEN 'SIR       '	0	0	1
42000759	42	                    MOVE 'Sir' TO CUSTTITI	0	0	1
42000760	42	                    CONTINUE	0	0	1
42000761	42	                 WHEN 'Sir       '	0	0	1
42000762	42	                    MOVE 'Sir' TO CUSTTITI	0	0	1
42000763	42	                    CONTINUE	0	0	1
42000764	42	                 WHEN 'sir       '	0	0	1
42000765	42	                    MOVE 'Sir' TO CUSTTITI	0	0	1
42000766	42	                    CONTINUE	0	0	1
42000767	42	                 WHEN 'sir_______'	0	0	1
42000768	42	                    MOVE 'Sir' TO CUSTTITI	0	0	1
42000769	42	                    CONTINUE	0	0	1
42000770	42	                 WHEN OTHER	0	0	1
42000771	42	                    MOVE SPACES TO MESSAGEO	0	0	1
42000773	42	                    STRING 'Valid titles are: Mr,Mrs,Miss,Ms,Dr,Drs,'	0	0	1
42000774	42	                       DELIMITED BY SIZE,	0	0	1
42000775	42	                       'Professor,Lord,Sir,Lady' DELIMITED BY SIZE	0	0	1
42000776	42	                       INTO MESSAGEO	0	0	1
42000777	42	                    MOVE 'N' TO VALID-DATA-SW	0	0	1
42000778	42	                    MOVE -1 TO CUSTTITL	0	0	1
42000779	42	                    GO TO ED999	0	0	1
42000780	42	              END-EVALUATE	0	0	1
42000781	42	           END-IF.	0	0	1
42000783	42	           IF CHRISTNL < 1 OR CHRISTNI = '____________________'	0	0	1
42000784	42	              OR CHRISTNI = SPACES	0	0	1
42000785	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000786	42	              MOVE 'Please supply a valid First Name  ' TO	0	0	1
42000787	42	                 MESSAGEO	0	0	1
42000788	42	              MOVE -1 TO CHRISTNL	0	0	1
42000790	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000791	42	              GO TO ED999	0	0	1
42000792	42	           END-IF.	0	0	1
42000794	42	           IF CUSTSNL < 1 OR CUSTSNI = '____________________'	0	0	1
42000795	42	              OR CUSTSNI = SPACES	0	0	1
42000796	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000797	42	              MOVE 'Please supply a valid Surname ' TO	0	0	1
42000798	42	                 MESSAGEO	0	0	1
42000800	42	              MOVE -1 TO CUSTSNL	0	0	1
42000801	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000802	42	              GO TO ED999	0	0	1
42000803	42	           END-IF.	0	0	1
42000805	42	           IF CUSTAD1I(1:1)= '_'  OR CUSTAD1L < 1	0	0	1
42000806	42	              OR CUSTAD1I = SPACES	0	0	1
42000808	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000809	42	              MOVE 'Please supply a valid Address Line 1 ' TO	0	0	1
42000810	42	                 MESSAGEO	0	0	1
42000811	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000812	42	              MOVE -1 TO CUSTAD1L	0	0	1
42000813	42	              GO TO ED999	0	0	1
42000814	42	           END-IF.	0	0	1
42000816	42	           IF DOBDDL < 1 OR DOBDDI = '__'	0	0	1
42000818	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000819	42	              MOVE 'Please supply a valid Date of Birth DD' TO	0	0	1
42000820	42	                 MESSAGEO	0	0	1
42000821	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000822	42	              MOVE -1 TO DOBDDL	0	0	1
42000823	42	              GO TO ED999	0	0	1
42000824	42	           END-IF.	0	0	1
42000826	42	           IF DOBMML < 1 OR DOBMMI = '__'	0	0	1
42000828	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000829	42	              MOVE 'Please supply a valid Date of Birth MM' TO	0	0	1
42000830	42	                 MESSAGEO	0	0	1
42000831	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000832	42	              MOVE -1 TO DOBMML	0	0	1
42000833	42	              GO TO ED999	0	0	1
42000834	42	           END-IF.	0	0	1
42000836	42	           IF DOBYYL < 4 OR DOBYYI = '____'	0	0	1
42000838	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000839	42	              MOVE 'Please supply a valid Date of Birth YYYY' TO	0	0	1
42000840	42	                 MESSAGEO	0	0	1
42000841	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000842	42	              MOVE -1 TO DOBYYL	0	0	1
42000843	42	              GO TO ED999	0	0	1
42000844	42	           END-IF.	0	0	1
42000846	42	           IF DOBDDI NOT NUMERIC	0	0	1
42000848	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000849	42	              MOVE 'Non numeric Date of Birth DD entered      ' TO	0	0	1
42000850	42	                 MESSAGEO	0	0	1
42000851	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000852	42	              MOVE -1 TO DOBDDL	0	0	1
42000853	42	              GO TO ED999	0	0	1
42000854	42	           END-IF.	0	0	1
42000856	42	           IF DOBMMI NOT NUMERIC	0	0	1
42000858	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000859	42	              MOVE 'Non numeric Date of Birth MM entered      ' TO	0	0	1
42000860	42	                 MESSAGEO	0	0	1
42000861	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000862	42	              MOVE -1 TO DOBMML	0	0	1
42000863	42	              GO TO ED999	0	0	1
42000864	42	           END-IF.	0	0	1
42000866	42	           IF DOBYYI NOT NUMERIC	0	0	1
42000868	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000869	42	              MOVE 'Non numeric Date of Birth YYYY entered  ' TO	0	0	1
42000870	42	                 MESSAGEO	0	0	1
42000871	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000872	42	              MOVE -1 TO DOBYYL	0	0	1
42000873	42	              GO TO ED999	0	0	1
42000874	42	           END-IF.	0	0	1
42000876	42	           MOVE DOBDDI TO DOBDDI-CHAR.	0	0	1
42000878	42	           IF DOBDDI-NUM < 01 OR DOBDDI-NUM > 31	0	0	1
42000880	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000881	42	              MOVE 'Please supply a valid Date of Birth (DD)    ' TO	0	0	1
42000882	42	                 MESSAGEO	0	0	1
42000883	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000884	42	              MOVE -1 TO DOBDDL	0	0	1
42000885	42	              GO TO ED999	0	0	1
42000886	42	           END-IF.	0	0	1
42000888	42	           MOVE DOBMMI TO DOBMMI-CHAR.	0	0	1
42000889	42	           IF DOBMMI-NUM < 01 OR DOBMMI-NUM > 12	0	0	1
42000891	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000892	42	              MOVE 'Please supply a valid Date of Birth (MM)    ' TO	0	0	1
42000893	42	                 MESSAGEO	0	0	1
42000894	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000895	42	              MOVE -1 TO DOBMML	0	0	1
42000896	42	              GO TO ED999	0	0	1
42000897	42	           END-IF.	0	0	1
42000899	42	           IF CUSTTITL < 1 OR CHRISTNL < 1 OR CUSTSNL < 1	0	0	1
42000900	42	           OR CUSTAD1L < 1 OR DOBDDL < 1 OR DOBMML < 1	0	0	1
42000901	42	           OR DOBYYL < 1	0	0	1
42000902	42	              MOVE SPACES TO MESSAGEO	0	0	1
42000903	42	              MOVE 'Missing expected data.               ' TO	0	0	1
42000904	42	                 MESSAGEO	0	0	1
42000905	42	              EVALUATE TRUE	0	0	1
42000906	42	                 WHEN CUSTTITL < 1	0	0	1
42000907	42	                    MOVE -1 TO CUSTTITL	0	0	1
42000909	42	                 WHEN CHRISTNL < 1	0	0	1
42000910	42	                    MOVE -1 TO CHRISTNL	0	0	1
42000912	42	                 WHEN CUSTSNL < 1	0	0	1
42000913	42	                    MOVE -1 TO CUSTSNL	0	0	1
42000915	42	                 WHEN CUSTAD1L < 1	0	0	1
42000916	42	                    MOVE -1 TO CUSTAD1L	0	0	1
42000918	42	                 WHEN DOBDDL < 1	0	0	1
42000919	42	                    MOVE -1 TO DOBDDL	0	0	1
42000921	42	                 WHEN DOBMML < 1	0	0	1
42000922	42	                    MOVE -1 TO DOBMML	0	0	1
42000924	42	                 WHEN DOBYYL < 1	0	0	1
42000925	42	                    MOVE -1 TO DOBYYL	0	0	1
42000927	42	              END-EVALUATE	0	0	1
42000929	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42000930	42	              GO TO ED999	0	0	1
42000931	42	           END-IF.	0	0	1
42000933	42	       ED999.	0	0	1
42000934	42	           EXIT.	0	0	1
42000937	42	       CRE-CUST-DATA SECTION.	0	0	1
42000938	42	       CCD010.	0	0	1
42000939	42	      *	1	0	0
42000940	42	      *    Set up the fields required by CRECUST then link to it	1	0	1
42000941	42	      *	1	0	1
42000942	42	           INITIALIZE SUBPGM-PARMS.	0	0	0
42000943	42	           MOVE 'CUST' TO SUBPGM-EYECATCHER.	0	0	1
42000944	42	           MOVE 'N' TO SUBPGM-SUCCESS.	0	0	1
42000946	42	      *	1	0	0
42000947	42	      *    Get rid of any underscores which may be present	1	0	1
42000948	42	      *	1	0	1
42000949	42	           INSPECT CUSTTITI REPLACING ALL '_' BY ' '.	0	0	0
42000950	42	           INSPECT CHRISTNI REPLACING ALL '_' BY ' '.	0	0	1
42000951	42	           INSPECT CUSTINSI REPLACING ALL '_' BY ' '.	0	0	1
42000952	42	           INSPECT CUSTSNI  REPLACING ALL '_' BY ' '.	0	0	1
42000954	42	           STRING CUSTTITI DELIMITED BY SPACE,	0	0	1
42000955	42	                  ' ' DELIMITED BY SIZE,	0	0	1
42000956	42	                  CHRISTNI DELIMITED BY SPACE,	0	0	1
42000957	42	                  ' ' DELIMITED BY SIZE,	0	0	1
42000958	42	                  CUSTINSI  DELIMITED BY SPACE,	0	0	1
42000959	42	                  ' ' DELIMITED BY SIZE,	0	0	1
42000960	42	                  CUSTSNI   DELIMITED BY SIZE	0	0	1
42000961	42	           INTO SUBPGM-NAME.	0	0	1
42000963	42	           INSPECT CUSTAD1I REPLACING ALL '_' BY ' '.	0	0	1
42000964	42	           INSPECT CUSTAD2I REPLACING ALL '_' BY ' '.	0	0	1
42000965	42	           INSPECT CUSTAD3I REPLACING ALL '_' BY ' '.	0	0	1
42000967	42	           STRING CUSTAD1I   DELIMITED BY SIZE,	0	0	1
42000968	42	                  CUSTAD2I   DELIMITED BY SIZE,	0	0	1
42000969	42	                  CUSTAD3I   DELIMITED BY SIZE	0	0	1
42000970	42	                  INTO SUBPGM-ADDRESS.	0	0	1
42000972	42	           MOVE DOBDDI TO SUBPGM-BIRTH-DAY.	0	0	1
42000973	42	           MOVE DOBMMI TO SUBPGM-BIRTH-MONTH.	0	0	1
42000974	42	           MOVE DOBYYI TO SUBPGM-BIRTH-YEAR.	0	0	1
42000976	42	           EXEC CICS LINK	0	0	1
42000977	42	              PROGRAM('CRECUST')	0	0	1
42000978	42	              COMMAREA(SUBPGM-PARMS)	0	0	1
42000979	42	              RESP(WS-CICS-RESP)	0	0	1
42000980	42	              RESP2(WS-CICS-RESP2)	0	0	1
42000981	42	              SYNCONRETURN	0	0	1
42000982	42	           END-EXEC.	0	0	1
42000984	42	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
42000985	42	      *	1	0	0
42000986	42	      *       Preserve the RESP and RESP2, then set up the	1	0	1
42000987	42	      *       standard ABEND info before getting the applid,	1	0	1
42000988	42	      *       date/time etc. and linking to the Abend Handler	1	0	1
42000989	42	      *       program.	1	0	1
42000990	42	      *	1	0	1
42000991	42	              INITIALIZE ABNDINFO-REC	0	0	0
42000992	42	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
42000993	42	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
42000994	42	      *	1	0	0
42000995	42	      *       Get supplemental information	1	0	1
42000996	42	      *	1	0	1
42000997	42	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
42000998	42	              END-EXEC	0	0	1
42001000	42	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
42001001	42	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
42001003	42	              PERFORM POPULATE-TIME-DATE	0	0	1
42001005	42	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
42001006	42	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
42001007	42	                    ':' DELIMITED BY SIZE,	0	0	1
42001008	42	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
42001009	42	                     ':' DELIMITED BY SIZE,	0	0	1
42001010	42	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
42001011	42	                     INTO ABND-TIME	0	0	1
42001012	42	              END-STRING	0	0	1
42001014	42	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
42001015	42	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
42001017	42	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
42001018	42	              END-EXEC	0	0	1
42001020	42	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
42001022	42	              STRING 'CCD010 - LINK CRECUST FAIL  '	0	0	1
42001023	42	                   DELIMITED BY SIZE,	0	0	1
42001024	42	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
42001025	42	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
42001026	42	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
42001027	42	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
42001028	42	                    INTO ABND-FREEFORM	0	0	1
42001029	42	              END-STRING	0	0	1
42001031	42	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
42001032	42	                        COMMAREA(ABNDINFO-REC)	0	0	1
42001033	42	              END-EXEC	0	0	1
42001035	42	              INITIALIZE WS-FAIL-INFO	0	0	1
42001036	42	              MOVE 'BNK1CCS - CCD010 - LINK CRECUST FAIL     '	0	0	1
42001037	42	                 TO WS-CICS-FAIL-MSG	0	0	1
42001038	42	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
42001039	42	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
42001041	42	              PERFORM RESTORE-TERM-DEF	0	0	1
42001042	42	              PERFORM ABEND-THIS-TASK	0	0	1
42001043	42	           END-IF.	0	0	1
42001045	42	      *	1	0	0
42001046	42	      *    Check to see if the creation was successful or not	1	0	1
42001047	42	      *	1	0	1
42001048	42	           IF SUBPGM-SUCCESS = 'N'	0	0	0
42001049	42	              MOVE SPACES TO MESSAGEO	0	0	1
42001050	42	              MOVE 'Sorry but unable to create Customer record '	0	0	1
42001051	42	                TO MESSAGEO	0	0	1
42001052	42	              IF SUBPGM-FAIL-CODE = 'O'	0	0	1
42001053	42	                MOVE 'Sorry, customer is too old. Please check D.O.B.'	0	0	1
42001054	42	                  to messageo	0	0	1
42001055	42	              END-IF	0	0	1
42001056	42	              IF SUBPGM-FAIL-CODE = 'Y'	0	0	1
42001057	42	                MOVE 'Sorry, customer D.O.B. is in the future.'	0	0	1
42001058	42	                  to messageo	0	0	1
42001059	42	              END-IF	0	0	1
42001060	42	              IF SUBPGM-FAIL-CODE = 'Z'	0	0	1
42001061	42	                MOVE 'Sorry, customer D.O.B. is invalid.'	0	0	1
42001062	42	                  to messageo	0	0	1
42001063	42	              END-IF	0	0	1
42001064	42	              MOVE 'N' TO VALID-DATA-SW	0	0	1
42001065	42	           END-IF.	0	0	1
42001067	42	           IF SUBPGM-SUCCESS = 'Y'	0	0	1
42001068	42	              MOVE SPACES TO MESSAGEO	0	0	1
42001069	42	              MOVE	0	0	1
42001070	42	                'The Customer record has been successfully created'	0	0	1
42001071	42	                TO MESSAGEO	0	0	1
42001073	42	              MOVE SUBPGM-SORTCODE    TO SORTCO	0	0	1
42001074	42	              MOVE SUBPGM-NUMBER      TO CUSTNO2O	0	0	1
42001075	42	           END-IF.	0	0	1
42001077	42	      *	1	0	0
42001078	42	      *    Set the values on the map	1	0	1
42001079	42	      *	1	0	1
42001080	42	           MOVE SUBPGM-BIRTH-YEAR     TO DOBYYO.	0	0	0
42001081	42	           MOVE SUBPGM-BIRTH-MONTH    TO DOBMMO.	0	0	1
42001082	42	           MOVE SUBPGM-BIRTH-DAY      TO DOBDDO.	0	0	1
42001083	42	           MOVE SUBPGM-ADDRESS        TO WS-ADDR-SPLIT.	0	0	1
42001084	42	           MOVE WS-ADDR-SPLIT1        TO CUSTAD1O.	0	0	1
42001085	42	           MOVE WS-ADDR-SPLIT2        TO CUSTAD2O.	0	0	1
42001086	42	           MOVE WS-ADDR-SPLIT3        TO CUSTAD3O.	0	0	1
42001087	42	           MOVE SUBPGM-CREDIT-SCORE   TO CREDSCO.	0	0	1
42001088	42	           MOVE SUBPGM-CS-REVIEW-DATE(1:2)	0	0	1
42001089	42	                                      TO SCRDTDDO.	0	0	1
42001090	42	           MOVE SUBPGM-CS-REVIEW-DATE(3:2)	0	0	1
42001091	42	                                      TO SCRDTMMO.	0	0	1
42001092	42	           MOVE SUBPGM-CS-REVIEW-DATE(5:4)	0	0	1
42001093	42	                                      TO SCRDTYYO.	0	0	1
42001095	42	       CCD999.	0	0	1
42001096	42	           EXIT.	0	0	1
42001099	42	       STORE-TERM-DEF SECTION.	0	0	1
42001100	42	       STD010.	0	0	1
42001102	42	      *	1	0	0
42001103	42	      *    Inquire on the terminal and store the UCTRANS settings	1	0	1
42001104	42	      *	1	0	1
42001105	42	           EXEC CICS INQUIRE	0	0	0
42001106	42	                TERMINAL(EIBTRMID)	0	0	1
42001107	42	                UCTRANST(WS-UCTRANS)	0	0	1
42001108	42	                RESP(WS-CICS-RESP)	0	0	1
42001109	42	                RESP2(WS-CICS-RESP2)	0	0	1
42001110	42	           END-EXEC.	0	0	1
42001112	42	      *	1	0	0
42001113	42	      *    Store the original UCTRAN value	1	0	1
42001114	42	      *	1	0	1
42001116	42	           MOVE WS-UCTRANS TO STORED-UCTRANS.	0	0	0
42001118	42	      *	1	0	0
42001119	42	      *    If Uppercase translation is switched on, then set it to	1	0	1
42001120	42	      *    NOUCTRAN(451).	1	0	1
42001121	42	      *	1	0	1
42001122	42	           IF WS-UCTRANS = DFHVALUE(UCTRAN) OR	0	0	0
42001123	42	           WS-UCTRANS = DFHVALUE(TRANIDONLY)	0	0	1
42001125	42	              MOVE DFHVALUE(NOUCTRAN) TO WS-UCTRANS	0	0	1
42001127	42	              EXEC CICS SET TERMINAL(EIBTRMID)	0	0	1
42001128	42	                 UCTRANST(WS-UCTRANS)	0	0	1
42001129	42	                 RESP(WS-CICS-RESP)	0	0	1
42001130	42	                 RESP2(WS-CICS-RESP2)	0	0	1
42001131	42	              END-EXEC	0	0	1
42001134	42	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
42001135	42	      *	1	0	0
42001136	42	      *          Preserve the RESP and RESP2, then set up the	1	0	1
42001137	42	      *          standard ABEND info before getting the applid,	1	0	1
42001138	42	      *          date/time etc. and linking to the Abend Handler	1	0	1
42001139	42	      *          program.	1	0	1
42001140	42	      *	1	0	1
42001141	42	                 INITIALIZE ABNDINFO-REC	0	0	0
42001142	42	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
42001143	42	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
42001144	42	      *	1	0	0
42001145	42	      *          Get supplemental information	1	0	1
42001146	42	      *	1	0	1
42001147	42	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
42001148	42	                 END-EXEC	0	0	1
42001150	42	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
42001151	42	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
42001153	42	                 PERFORM POPULATE-TIME-DATE	0	0	1
42001155	42	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
42001156	42	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
42001157	42	                       ':' DELIMITED BY SIZE,	0	0	1
42001158	42	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
42001159	42	                        ':' DELIMITED BY SIZE,	0	0	1
42001160	42	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
42001161	42	                        INTO ABND-TIME	0	0	1
42001162	42	                 END-STRING	0	0	1
42001164	42	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
42001165	42	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
42001167	42	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
42001168	42	                 END-EXEC	0	0	1
42001170	42	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
42001172	42	                 STRING 'STD010 - SET TERMINAL UC FAIL '	0	0	1
42001173	42	                      DELIMITED BY SIZE,	0	0	1
42001174	42	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
42001175	42	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
42001176	42	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
42001177	42	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
42001178	42	                       INTO ABND-FREEFORM	0	0	1
42001179	42	                 END-STRING	0	0	1
42001181	42	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
42001182	42	                           COMMAREA(ABNDINFO-REC)	0	0	1
42001183	42	                 END-EXEC	0	0	1
42001186	42	                 INITIALIZE WS-FAIL-INFO	0	0	1
42001187	42	                 MOVE 'BNK1CCS - STD010 - SET TERMINAL UC FAIL ' TO	0	0	1
42001188	42	                    WS-CICS-FAIL-MSG	0	0	1
42001189	42	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
42001190	42	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
42001192	42	                 PERFORM RESTORE-TERM-DEF	0	0	1
42001193	42	                 PERFORM ABEND-THIS-TASK	0	0	1
42001194	42	              END-IF	0	0	1
42001195	42	           END-IF.	0	0	1
42001197	42	       STD999.	0	0	1
42001198	42	           EXIT.	0	0	1
42001201	42	       RESTORE-TERM-DEF SECTION.	0	0	1
42001202	42	       RTD010.	0	0	1
42001203	42	      *	1	0	0
42001204	42	      *    We must now restore the UCTRAN setting back to what it	1	0	1
42001205	42	      *    was at the start	1	0	1
42001206	42	      *	1	0	1
42001207	42	           MOVE DFHCOMMAREA TO WS-COMM-AREA.	0	0	0
42001209	42	           MOVE WS-COMM-TERM TO WS-UCTRANS.	0	0	1
42001211	42	           EXEC CICS SET TERMINAL(EIBTRMID)	0	0	1
42001212	42	               UCTRANST(WS-UCTRANS)	0	0	1
42001213	42	               RESP(WS-CICS-RESP)	0	0	1
42001214	42	               RESP2(WS-CICS-RESP2)	0	0	1
42001215	42	           END-EXEC.	0	0	1
42001217	42	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
42001218	42	      *	1	0	0
42001219	42	      *       Preserve the RESP and RESP2, then set up the	1	0	1
42001220	42	      *       standard ABEND info before getting the applid,	1	0	1
42001221	42	      *       date/time etc. and linking to the Abend Handler	1	0	1
42001222	42	      *       program.	1	0	1
42001223	42	      *	1	0	1
42001224	42	              INITIALIZE ABNDINFO-REC	0	0	0
42001225	42	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
42001226	42	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
42001227	42	      *	1	0	0
42001228	42	      *       Get supplemental information	1	0	1
42001229	42	      *	1	0	1
42001230	42	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
42001231	42	              END-EXEC	0	0	1
42001233	42	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
42001234	42	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
42001236	42	              PERFORM POPULATE-TIME-DATE	0	0	1
42001238	42	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
42001239	42	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
42001240	42	                    ':' DELIMITED BY SIZE,	0	0	1
42001241	42	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
42001242	42	                     ':' DELIMITED BY SIZE,	0	0	1
42001243	42	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
42001244	42	                     INTO ABND-TIME	0	0	1
42001245	42	              END-STRING	0	0	1
42001247	42	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
42001248	42	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
42001250	42	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
42001251	42	              END-EXEC	0	0	1
42001253	42	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
42001255	42	              STRING 'RTD010 - SET TERMINAL UC FAIL '	0	0	1
42001256	42	                    DELIMITED BY SIZE,	0	0	1
42001257	42	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
42001258	42	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
42001259	42	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
42001260	42	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
42001261	42	                    INTO ABND-FREEFORM	0	0	1
42001262	42	              END-STRING	0	0	1
42001264	42	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
42001265	42	                        COMMAREA(ABNDINFO-REC)	0	0	1
42001266	42	              END-EXEC	0	0	1
42001268	42	              INITIALIZE WS-FAIL-INFO	0	0	1
42001269	42	              MOVE 'BNK1CCS - RTD010 - SET TERMINAL UC FAIL '	0	0	1
42001270	42	                 TO WS-CICS-FAIL-MSG	0	0	1
42001271	42	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
42001272	42	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
42001273	42	              PERFORM ABEND-THIS-TASK	0	0	1
42001274	42	           END-IF.	0	0	1
42001276	42	       RTD999.	0	0	1
42001277	42	           EXIT.	0	0	1
42001280	42	       SEND-MAP SECTION.	0	0	1
42001281	42	       SM010.	0	0	1
42001282	42	      *	1	0	0
42001283	42	      *    If the map needs to have its data erased	1	0	1
42001284	42	      *	1	0	1
42001285	42	           IF SEND-ERASE	0	0	0
42001286	42	              EXEC CICS SEND MAP('BNK1CC')	0	0	1
42001287	42	                  MAPSET('BNK1CCM')	0	0	1
42001288	42	                  FROM(BNK1CCO)	0	0	1
42001289	42	                  ERASE	0	0	1
42001290	42	                  CURSOR	0	0	1
42001291	42	                  RESP(WS-CICS-RESP)	0	0	1
42001292	42	                  RESP2(WS-CICS-RESP2)	0	0	1
42001293	42	              END-EXEC	0	0	1
42001295	42	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
42001296	42	      *	1	0	0
42001297	42	      *          Preserve the RESP and RESP2, then set up the	1	0	1
42001298	42	      *          standard ABEND info before getting the applid,	1	0	1
42001299	42	      *          date/time etc. and linking to the Abend Handler	1	0	1
42001300	42	      *          program.	1	0	1
42001301	42	      *	1	0	1
42001302	42	                 INITIALIZE ABNDINFO-REC	0	0	0
42001303	42	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
42001304	42	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
42001305	42	      *	1	0	0
42001306	42	      *          Get supplemental information	1	0	1
42001307	42	      *	1	0	1
42001308	42	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
42001309	42	                 END-EXEC	0	0	1
42001311	42	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
42001312	42	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
42001314	42	                 PERFORM POPULATE-TIME-DATE	0	0	1
42001316	42	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
42001317	42	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
42001318	42	                       ':' DELIMITED BY SIZE,	0	0	1
42001319	42	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
42001320	42	                        ':' DELIMITED BY SIZE,	0	0	1
42001321	42	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
42001322	42	                        INTO ABND-TIME	0	0	1
42001323	42	                 END-STRING	0	0	1
42001325	42	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
42001326	42	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
42001328	42	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
42001329	42	                 END-EXEC	0	0	1
42001331	42	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
42001333	42	                 STRING 'SM010 - SEND MAP ERASE FAIL '	0	0	1
42001334	42	                       DELIMITED BY SIZE,	0	0	1
42001335	42	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
42001336	42	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
42001337	42	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
42001338	42	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
42001339	42	                       INTO ABND-FREEFORM	0	0	1
42001340	42	                 END-STRING	0	0	1
42001342	42	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
42001343	42	                           COMMAREA(ABNDINFO-REC)	0	0	1
42001344	42	                 END-EXEC	0	0	1
42001347	42	                 INITIALIZE WS-FAIL-INFO	0	0	1
42001348	42	                 MOVE 'BNK1CCS - SM010 - SEND MAP ERASE FAIL '	0	0	1
42001349	42	                    TO WS-CICS-FAIL-MSG	0	0	1
42001350	42	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
42001351	42	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
42001353	42	                 PERFORM RESTORE-TERM-DEF	0	0	1
42001354	42	                 PERFORM ABEND-THIS-TASK	0	0	1
42001355	42	              END-IF	0	0	1
42001357	42	              GO TO SM999	0	0	1
42001358	42	           END-IF.	0	0	1
42001360	42	      *	1	0	0
42001361	42	      *    If the map just needs a resend of only the data	1	0	1
42001362	42	      *	1	0	1
42001363	42	           IF SEND-DATAONLY	0	0	0
42001364	42	              EXEC CICS SEND MAP('BNK1CC')	0	0	1
42001365	42	                 MAPSET('BNK1CCM')	0	0	1
42001366	42	                 FROM(BNK1CCO)	0	0	1
42001367	42	                 DATAONLY	0	0	1
42001368	42	                 CURSOR	0	0	1
42001369	42	                 RESP(WS-CICS-RESP)	0	0	1
42001370	42	                 RESP2(WS-CICS-RESP2)	0	0	1
42001371	42	              END-EXEC	0	0	1
42001373	42	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
42001374	42	      *	1	0	0
42001375	42	      *          Preserve the RESP and RESP2, then set up the	1	0	1
42001376	42	      *          standard ABEND info before getting the applid,	1	0	1
42001377	42	      *          date/time etc. and linking to the Abend Handler	1	0	1
42001378	42	      *          program.	1	0	1
42001379	42	      *	1	0	1
42001380	42	                 INITIALIZE ABNDINFO-REC	0	0	0
42001381	42	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
42001382	42	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
42001383	42	      *	1	0	0
42001384	42	      *          Get supplemental information	1	0	1
42001385	42	      *	1	0	1
42001386	42	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
42001387	42	                 END-EXEC	0	0	1
42001389	42	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
42001390	42	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
42001392	42	                 PERFORM POPULATE-TIME-DATE	0	0	1
42001394	42	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
42001395	42	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
42001396	42	                       ':' DELIMITED BY SIZE,	0	0	1
42001397	42	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
42001398	42	                        ':' DELIMITED BY SIZE,	0	0	1
42001399	42	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
42001400	42	                        INTO ABND-TIME	0	0	1
42001401	42	                 END-STRING	0	0	1
42001403	42	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
42001404	42	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
42001406	42	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
42001407	42	                 END-EXEC	0	0	1
42001409	42	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
42001411	42	                 STRING 'SM010 - SEND MAP DATAONLY FAIL '	0	0	1
42001412	42	                       DELIMITED BY SIZE,	0	0	1
42001413	42	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
42001414	42	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
42001415	42	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
42001416	42	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
42001417	42	                       INTO ABND-FREEFORM	0	0	1
42001418	42	                 END-STRING	0	0	1
42001420	42	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
42001421	42	                           COMMAREA(ABNDINFO-REC)	0	0	1
42001422	42	                 END-EXEC	0	0	1
42001424	42	                 INITIALIZE WS-FAIL-INFO	0	0	1
42001425	42	                 MOVE 'BNK1CCS - SM010 - SEND MAP DATAONLY FAIL '	0	0	1
42001426	42	                    TO WS-CICS-FAIL-MSG	0	0	1
42001427	42	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
42001428	42	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
42001430	42	                 PERFORM RESTORE-TERM-DEF	0	0	1
42001431	42	                 PERFORM ABEND-THIS-TASK	0	0	1
42001432	42	              END-IF	0	0	1
42001434	42	              GO TO SM999	0	0	1
42001435	42	           END-IF.	0	0	1
42001437	42	      *	1	0	0
42001438	42	      *    If we have elected to send the map and a beep	1	0	1
42001439	42	      *	1	0	1
42001440	42	           IF SEND-DATAONLY-ALARM	0	0	0
42001441	42	              EXEC CICS SEND MAP('BNK1CC')	0	0	1
42001442	42	                 MAPSET('BNK1CCM')	0	0	1
42001443	42	                 FROM(BNK1CCO)	0	0	1
42001444	42	                 ALARM	0	0	1
42001445	42	                 DATAONLY	0	0	1
42001446	42	                 CURSOR	0	0	1
42001447	42	                 RESP(WS-CICS-RESP)	0	0	1
42001448	42	                 RESP2(WS-CICS-RESP2)	0	0	1
42001449	42	              END-EXEC	0	0	1
42001451	42	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
42001452	42	      *	1	0	0
42001453	42	      *          Preserve the RESP and RESP2, then set up the	1	0	1
42001454	42	      *          standard ABEND info before getting the applid,	1	0	1
42001455	42	      *          date/time etc. and linking to the Abend Handler	1	0	1
42001456	42	      *          program.	1	0	1
42001457	42	      *	1	0	1
42001458	42	                 INITIALIZE ABNDINFO-REC	0	0	0
42001459	42	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
42001460	42	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
42001461	42	      *	1	0	0
42001462	42	      *          Get supplemental information	1	0	1
42001463	42	      *	1	0	1
42001464	42	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
42001465	42	                 END-EXEC	0	0	1
42001467	42	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
42001468	42	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
42001470	42	                 PERFORM POPULATE-TIME-DATE	0	0	1
42001472	42	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
42001473	42	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
42001474	42	                       ':' DELIMITED BY SIZE,	0	0	1
42001475	42	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
42001476	42	                        ':' DELIMITED BY SIZE,	0	0	1
42001477	42	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
42001478	42	                        INTO ABND-TIME	0	0	1
42001479	42	                 END-STRING	0	0	1
42001481	42	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
42001482	42	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
42001484	42	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
42001485	42	                 END-EXEC	0	0	1
42001487	42	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
42001489	42	                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL '	0	0	1
42001490	42	                       DELIMITED BY SIZE,	0	0	1
42001491	42	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
42001492	42	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
42001493	42	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
42001494	42	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
42001495	42	                       INTO ABND-FREEFORM	0	0	1
42001496	42	                 END-STRING	0	0	1
42001498	42	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
42001499	42	                           COMMAREA(ABNDINFO-REC)	0	0	1
42001500	42	                 END-EXEC	0	0	1
42001502	42	                 INITIALIZE WS-FAIL-INFO	0	0	1
42001503	42	                 MOVE 'BNK1CCS - SM010 - SEND MAP DATAONLY ALARM FAIL '	0	0	1
42001504	42	                    TO WS-CICS-FAIL-MSG	0	0	1
42001505	42	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
42001506	42	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
42001508	42	                 PERFORM RESTORE-TERM-DEF	0	0	1
42001509	42	                 PERFORM ABEND-THIS-TASK	0	0	1
42001510	42	              END-IF	0	0	1
42001512	42	           END-IF.	0	0	1
42001514	42	       SM999.	0	0	1
42001515	42	           EXIT.	0	0	1
42001518	42	       SEND-TERMINATION-MSG SECTION.	0	0	1
42001519	42	       STM010.	0	0	1
42001520	42	      *	1	0	0
42001521	42	      *    Send the termination message	1	0	1
42001522	42	      *	1	0	1
42001523	42	           EXEC CICS SEND TEXT	0	0	0
42001524	42	              FROM(END-OF-SESSION-MESSAGE)	0	0	1
42001525	42	              ERASE	0	0	1
42001526	42	              FREEKB	0	0	1
42001527	42	              RESP(WS-CICS-RESP)	0	0	1
42001528	42	              RESP2(WS-CICS-RESP2)	0	0	1
42001529	42	           END-EXEC.	0	0	1
42001531	42	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
42001532	42	      *	1	0	0
42001533	42	      *       Preserve the RESP and RESP2, then set up the	1	0	1
42001534	42	      *       standard ABEND info before getting the applid,	1	0	1
42001535	42	      *       date/time etc. and linking to the Abend Handler	1	0	1
42001536	42	      *       program.	1	0	1
42001537	42	      *	1	0	1
42001538	42	              INITIALIZE ABNDINFO-REC	0	0	0
42001539	42	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
42001540	42	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
42001541	42	      *	1	0	0
42001542	42	      *       Get supplemental information	1	0	1
42001543	42	      *	1	0	1
42001544	42	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
42001545	42	              END-EXEC	0	0	1
42001547	42	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
42001548	42	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
42001550	42	              PERFORM POPULATE-TIME-DATE	0	0	1
42001552	42	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
42001553	42	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
42001554	42	                    ':' DELIMITED BY SIZE,	0	0	1
42001555	42	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
42001556	42	                     ':' DELIMITED BY SIZE,	0	0	1
42001557	42	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
42001558	42	                     INTO ABND-TIME	0	0	1
42001559	42	              END-STRING	0	0	1
42001561	42	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
42001562	42	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
42001564	42	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
42001565	42	              END-EXEC	0	0	1
42001567	42	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
42001569	42	              STRING 'STM010 - SEND TEXT FAIL'	0	0	1
42001570	42	                    DELIMITED BY SIZE,	0	0	1
42001571	42	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
42001572	42	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
42001573	42	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
42001574	42	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
42001575	42	                    INTO ABND-FREEFORM	0	0	1
42001576	42	              END-STRING	0	0	1
42001578	42	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
42001579	42	                        COMMAREA(ABNDINFO-REC)	0	0	1
42001580	42	              END-EXEC	0	0	1
42001582	42	              INITIALIZE WS-FAIL-INFO	0	0	1
42001583	42	              MOVE 'BNK1CCS - STM010 - SEND TEXT FAIL'	0	0	1
42001584	42	                 TO WS-CICS-FAIL-MSG	0	0	1
42001585	42	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
42001586	42	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
42001588	42	              PERFORM RESTORE-TERM-DEF	0	0	1
42001589	42	              PERFORM ABEND-THIS-TASK	0	0	1
42001590	42	           END-IF.	0	0	1
42001592	42	       STM999.	0	0	1
42001593	42	           EXIT.	0	0	1
42001596	42	       ABEND-THIS-TASK SECTION.	0	0	1
42001597	42	       ATT010.	0	0	1
42001599	42	      *	1	0	0
42001600	42	      *    Restore the terminal UCTRAN back to its starting position	1	0	1
42001601	42	      *	1	0	1
42001602	42	           MOVE DFHCOMMAREA  TO WS-COMM-AREA.	0	0	0
42001603	42	           MOVE WS-COMM-TERM TO WS-UCTRANS.	0	0	1
42001605	42	           EXEC CICS SET TERMINAL(EIBTRMID)	0	0	1
42001606	42	               UCTRANST(WS-UCTRANS)	0	0	1
42001607	42	               RESP(WS-CICS-RESP)	0	0	1
42001608	42	               RESP2(WS-CICS-RESP2)	0	0	1
42001609	42	           END-EXEC.	0	0	1
42001611	42	           DISPLAY WS-FAIL-INFO.	0	0	1
42001613	42	           EXEC CICS ABEND	0	0	1
42001614	42	              ABCODE('HBNK')	0	0	1
42001615	42	              NODUMP	0	0	1
42001616	42	              CANCEL	0	0	1
42001617	42	           END-EXEC.	0	0	1
42001619	42	       ATT999.	0	0	1
42001620	42	           EXIT.	0	0	1
42001623	42	       POPULATE-TIME-DATE SECTION.	0	0	1
42001624	42	       PTD10.	0	0	1
42001626	42	           EXEC CICS ASKTIME	0	0	1
42001627	42	              ABSTIME(WS-U-TIME)	0	0	1
42001628	42	           END-EXEC.	0	0	1
42001630	42	           EXEC CICS FORMATTIME	0	0	1
42001631	42	                     ABSTIME(WS-U-TIME)	0	0	1
42001632	42	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
42001633	42	                     TIME(WS-TIME-NOW)	0	0	1
42001634	42	                     DATESEP	0	0	1
42001635	42	           END-EXEC.	0	0	1
42001637	42	       PTD999.	0	0	1
42001638	42	           EXIT.	0	0	1
42001641	42	       HANDLE-ABEND SECTION.	0	0	1
42001642	42	       HA010.	0	0	1
42001644	42	           PERFORM RESTORE-TERM-DEF.	0	0	1
42001646	42	           EXEC CICS ASSIGN ABCODE(WS-ABCODE)	0	0	1
42001647	42	           END-EXEC.	0	0	1
42001649	42	           EXEC CICS HANDLE ABEND CANCEL	0	0	1
42001650	42	           END-EXEC.	0	0	1
42001652	42	           EXEC CICS ABEND ABCODE(WS-ABCODE)	0	0	1
42001653	42	              NODUMP	0	0	1
42001654	42	           END-EXEC.	0	0	1
42001656	42	       HA999.	0	0	1
42001657	42	           EXIT.	0	0	1
43000000	43	<<<< file not found >>>>	0	0	0
43000001	43	<<<< file not found >>>>	0	0	0
44000001	44	       CBL CICS('SP,EDF')	0	0	1
44000002	44	      ******************************************************************	1	0	0
44000003	44	      *                                                                *	1	0	1
44000004	44	      *  Copyright IBM Corp. 2023                                      *	1	0	1
44000005	44	      *                                                                *	1	0	1
44000006	44	      ******************************************************************	1	0	1
44000007	44	      ******************************************************************	1	0	1
44000008	44	      * This program is the dummy credit agency, used for credit	1	0	1
44000009	44	      * scoring. Data is passed to the program via a channel and	1	0	1
44000010	44	      * container and the role of this program is to delay for a	1	0	1
44000011	44	      * random amount of time (between 0 and 3 seconds) and to	1	0	1
44000012	44	      * create a random credit score (between 1 and 999), then finish.	1	0	1
44000013	44	      *	1	0	1
44000014	44	      * The purpose of the initial delay is to emulate data being	1	0	1
44000015	44	      * returned to the parent program (this program is driven using	1	0	1
44000016	44	      * the Async API). There is a delay of 3 seconds in the parent	1	0	1
44000017	44	      * so what this means is there a 1 in 4 chance that data will be	1	0	1
44000018	44	      * returned withing the overall 3 second delay - this emulates	1	0	1
44000019	44	      * not always being able to get a timely reply back to the parent.	1	0	1
44000020	44	      *	1	0	1
44000021	44	      *	1	0	1
44000022	44	      ******************************************************************	1	0	1
44000024	44	       IDENTIFICATION DIVISION.	0	0	0
44000025	44	       PROGRAM-ID. CRDTAGY3.	0	0	1
44000026	44	       AUTHOR. Jon Collett.	0	0	1
44000028	44	       ENVIRONMENT DIVISION.	0	0	1
44000029	44	       CONFIGURATION SECTION.	0	0	1
44000030	44	      * SOURCE-COMPUTER.  IBM-370 WITH DEBUGGING MODE.	1	0	0
44000031	44	       SOURCE-COMPUTER.  IBM-370.	0	0	0
44000032	44	       OBJECT-COMPUTER.  IBM-370.	0	0	1
44000034	44	       INPUT-OUTPUT SECTION.	0	0	1
44000036	44	       DATA DIVISION.	0	0	1
44000037	44	       FILE SECTION.	0	0	1
44000039	44	       WORKING-STORAGE SECTION.	0	0	1
44000041	44	       COPY SORTCODE.	0	0	1
44000044	44	       01 WS-CONT-IN.	0	0	1
44000045	44	          03 WS-CONT-IN-EYECATCHER      PIC X(4).	0	0	1
44000046	44	          03 WS-CONT-IN-KEY.	0	0	1
44000047	44	             05 WS-CONT-IN-SORTCODE     PIC 9(6) DISPLAY.	0	0	1
44000048	44	             05 WS-CONT-IN-NUMBER       PIC 9(10) DISPLAY.	0	0	1
44000049	44	          03 WS-CONT-IN-NAME            PIC X(60).	0	0	1
44000050	44	          03 WS-CONT-IN-ADDRESS         PIC X(160).	0	0	1
44000051	44	          03 WS-CONT-IN-DATE-OF-BIRTH   PIC 9(8).	0	0	1
44000052	44	          03 WS-CONT-IN-DOB-GROUP REDEFINES WS-CONT-IN-DATE-OF-BIRTH.	0	0	1
44000053	44	             05 WS-CONT-IN-BIRTH-DAY    PIC 99.	0	0	1
44000054	44	             05 WS-CONT-IN-BIRTH-MONTH  PIC 99.	0	0	1
44000055	44	             05 WS-CONT-IN-BIRTH-YEAR   PIC 9999.	0	0	1
44000056	44	          03 WS-CONT-IN-CREDIT-SCORE    PIC 999.	0	0	1
44000057	44	          03 WS-CONT-IN-CS-REVIEW-DATE  PIC 9(8).	0	0	1
44000058	44	          03 WS-CONT-IN-SUCCESS         PIC X.	0	0	1
44000059	44	          03 WS-CONT-IN-FAIL-CODE       PIC X.	0	0	1
44000061	44	       01 WS-CICS-WORK-AREA.	0	0	1
44000062	44	          05 WS-CICS-RESP               PIC S9(8) COMP.	0	0	1
44000063	44	          05 WS-CICS-RESP2              PIC S9(8) COMP.	0	0	1
44000066	44	       01 WS-DELAY-AMT                  PIC S9(8) COMP	0	0	1
44000067	44	                                                   VALUE 0.	0	0	1
44000069	44	       01 WS-CONTAINER-NAME             PIC X(16)  VALUE SPACES.	0	0	1
44000070	44	       01 WS-CHANNEL-NAME               PIC X(16)  VALUE SPACES.	0	0	1
44000072	44	       01 WS-CONTAINER-LEN              PIC S9(8) COMP	0	0	1
44000073	44	                                                   VALUE 0.	0	0	1
44000074	44	       01 WS-NEW-CREDSCORE              PIC 999    VALUE 0.	0	0	1
44000075	44	       01 WS-SEED                       PIC S9(15) COMP.	0	0	1
44000079	44	       01 WS-U-TIME                     PIC S9(15) COMP-3.	0	0	1
44000080	44	       01 WS-ORIG-DATE                  PIC X(10).	0	0	1
44000081	44	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
44000082	44	          03 WS-ORIG-DATE-DD            PIC 99.	0	0	1
44000083	44	          03 FILLER                     PIC X.	0	0	1
44000084	44	          03 WS-ORIG-DATE-MM            PIC 99.	0	0	1
44000085	44	          03 FILLER                     PIC X.	0	0	1
44000086	44	          03 WS-ORIG-DATE-YYYY          PIC 9999.	0	0	1
44000088	44	       01 WS-ORIG-DATE-GRP-X.	0	0	1
44000089	44	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
44000090	44	          03 FILLER                     PIC X      VALUE '.'.	0	0	1
44000091	44	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
44000092	44	          03 FILLER                     PIC X      VALUE '.'.	0	0	1
44000093	44	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
44000096	44	       01 WS-TIME-DATA.	0	0	1
44000097	44	          03 WS-TIME-NOW                PIC 9(6).	0	0	1
44000098	44	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
44000099	44	             05 WS-TIME-NOW-GRP-HH      PIC 99.	0	0	1
44000100	44	             05 WS-TIME-NOW-GRP-MM      PIC 99.	0	0	1
44000101	44	             05 WS-TIME-NOW-GRP-SS      PIC 99.	0	0	1
44000103	44	       01 WS-ABEND-PGM                  PIC X(8)   VALUE 'ABNDPROC'.	0	0	1
44000105	44	       01 ABNDINFO-REC.	0	0	1
44000106	44	           COPY ABNDINFO.	0	0	1
44000108	44	       LINKAGE SECTION.	0	0	1
44000111	44	       PROCEDURE DIVISION.	0	0	1
44000112	44	       PREMIERE SECTION.	0	0	1
44000113	44	       A010.	0	0	1
44000114	44	      *	1	0	0
44000115	44	      *    Generate a random  number of seconds between 0 & 3.	1	0	1
44000116	44	      *    This is the delay amount in seconds.	1	0	1
44000117	44	      *	1	0	1
44000119	44	           MOVE 'CIPC            ' TO WS-CONTAINER-NAME.	0	0	0
44000120	44	           MOVE 'CIPCREDCHANN    ' TO WS-CHANNEL-NAME.	0	0	1
44000121	44	           MOVE EIBTASKN           TO WS-SEED.	0	0	1
44000123	44	           COMPUTE WS-DELAY-AMT = ((3 - 1)	0	0	1
44000124	44	                            * FUNCTION RANDOM(WS-SEED)) + 1.	0	0	1
44000126	44	           EXEC CICS DELAY	0	0	1
44000127	44	                FOR SECONDS(WS-DELAY-AMT)	0	0	1
44000128	44	                RESP(WS-CICS-RESP)	0	0	1
44000129	44	                RESP2(WS-CICS-RESP2)	0	0	1
44000130	44	           END-EXEC.	0	0	1
44000132	44	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
44000133	44	      *	1	0	0
44000134	44	      *       Preserve the RESP and RESP2, then set up the	1	0	1
44000135	44	      *       standard ABEND info before getting the applid,	1	0	1
44000136	44	      *       date/time etc. and linking to the Abend Handler	1	0	1
44000137	44	      *       program.	1	0	1
44000138	44	      *	1	0	1
44000139	44	              INITIALIZE ABNDINFO-REC	0	0	0
44000140	44	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
44000141	44	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
44000142	44	      *	1	0	0
44000143	44	      *       Get supplemental information	1	0	1
44000144	44	      *	1	0	1
44000145	44	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
44000146	44	              END-EXEC	0	0	1
44000148	44	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
44000149	44	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
44000151	44	              PERFORM POPULATE-TIME-DATE	0	0	1
44000153	44	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
44000154	44	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
44000155	44	                      ':' DELIMITED BY SIZE,	0	0	1
44000156	44	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
44000157	44	                       ':' DELIMITED BY SIZE,	0	0	1
44000158	44	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
44000159	44	                       INTO ABND-TIME	0	0	1
44000160	44	              END-STRING	0	0	1
44000162	44	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
44000163	44	              MOVE 'PLOP'      TO ABND-CODE	0	0	1
44000165	44	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
44000166	44	              END-EXEC	0	0	1
44000168	44	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
44000170	44	              STRING 'A010  - *** The delay messed up! ***'	0	0	1
44000171	44	                      DELIMITED BY SIZE,	0	0	1
44000172	44	                      ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
44000173	44	                      ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
44000174	44	                      ' RESP2=' DELIMITED BY SIZE,	0	0	1
44000175	44	                      ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
44000176	44	                      INTO ABND-FREEFORM	0	0	1
44000177	44	              END-STRING	0	0	1
44000179	44	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
44000180	44	                          COMMAREA(ABNDINFO-REC)	0	0	1
44000181	44	              END-EXEC	0	0	1
44000183	44	              DISPLAY '*** The delay messed up ! ***'	0	0	1
44000184	44	              EXEC CICS ABEND	0	0	1
44000185	44	                 ABCODE('PLOP')	0	0	1
44000186	44	              END-EXEC	0	0	1
44000187	44	           END-IF.	0	0	1
44000189	44	           COMPUTE WS-CONTAINER-LEN = LENGTH OF WS-CONT-IN.	0	0	1
44000191	44	           EXEC CICS GET CONTAINER(WS-CONTAINER-NAME)	0	0	1
44000192	44	                     CHANNEL(WS-CHANNEL-NAME)	0	0	1
44000193	44	                     INTO(WS-CONT-IN)	0	0	1
44000194	44	                     FLENGTH(WS-CONTAINER-LEN)	0	0	1
44000195	44	                     RESP(WS-CICS-RESP)	0	0	1
44000196	44	                     RESP2(WS-CICS-RESP2)	0	0	1
44000197	44	           END-EXEC.	0	0	1
44000199	44	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
44000200	44	              DISPLAY 'CRDTAGY3- UNABLE TO GET CONTAINER. RESP='	0	0	1
44000201	44	                 WS-CICS-RESP ', RESP2=' WS-CICS-RESP2	0	0	1
44000202	44	              DISPLAY 'CONTAINER=' WS-CONTAINER-NAME ' CHANNEL='	0	0	1
44000203	44	                       WS-CHANNEL-NAME ' FLENGTH='	0	0	1
44000204	44	                       WS-CONTAINER-LEN	0	0	1
44000205	44	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
44000206	44	           END-IF.	0	0	1
44000208	44	      *	1	0	0
44000209	44	      *    Now generate a credit score between 1 and 999. Because we	1	0	1
44000210	44	      *    used a SEED on the first RANDOM (above) we don't need to	1	0	1
44000211	44	      *    use a SEED again when using RANDOM for a subsequent time	1	0	1
44000212	44	      *	1	0	1
44000213	44	           COMPUTE WS-NEW-CREDSCORE = ((999 - 1)	0	0	0
44000214	44	                            * FUNCTION RANDOM) + 1.	0	0	1
44000217	44	           MOVE WS-NEW-CREDSCORE TO WS-CONT-IN-CREDIT-SCORE.	0	0	1
44000219	44	      *	1	0	0
44000220	44	      *    Now PUT the data back into a container	1	0	1
44000221	44	      *	1	0	1
44000222	44	           COMPUTE WS-CONTAINER-LEN = LENGTH OF WS-CONT-IN.	0	0	0
44000224	44	           EXEC CICS PUT CONTAINER(WS-CONTAINER-NAME)	0	0	1
44000225	44	                         FROM(WS-CONT-IN)	0	0	1
44000226	44	                         FLENGTH(WS-CONTAINER-LEN)	0	0	1
44000227	44	                         CHANNEL(WS-CHANNEL-NAME)	0	0	1
44000228	44	                         RESP(WS-CICS-RESP)	0	0	1
44000229	44	                         RESP2(WS-CICS-RESP2)	0	0	1
44000230	44	           END-EXEC.	0	0	1
44000232	44	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
44000233	44	              DISPLAY 'CRDTAGY3- UNABLE TO PUT CONTAINER. RESP='	0	0	1
44000234	44	                 WS-CICS-RESP ', RESP2=' WS-CICS-RESP2	0	0	1
44000235	44	              DISPLAY  'CONTAINER='  WS-CONTAINER-NAME	0	0	1
44000236	44	              ' CHANNEL=' WS-CHANNEL-NAME ' FLENGTH='	0	0	1
44000237	44	                    WS-CONTAINER-LEN	0	0	1
44000238	44	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
44000239	44	           END-IF.	0	0	1
44000241	44	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
44000243	44	       A999.	0	0	1
44000244	44	           EXIT.	0	0	1
44000247	44	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
44000248	44	       GMOFH010.	0	0	1
44000250	44	           EXEC CICS RETURN	0	0	1
44000251	44	           END-EXEC.	0	0	1
44000253	44	       GMOFH999.	0	0	1
44000254	44	           EXIT.	0	0	1
44000257	44	       POPULATE-TIME-DATE SECTION.	0	0	1
44000258	44	       PTD010.	0	0	1
44000260	44	           EXEC CICS ASKTIME	0	0	1
44000261	44	              ABSTIME(WS-U-TIME)	0	0	1
44000262	44	           END-EXEC.	0	0	1
44000264	44	           EXEC CICS FORMATTIME	0	0	1
44000265	44	                     ABSTIME(WS-U-TIME)	0	0	1
44000266	44	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
44000267	44	                     TIME(WS-TIME-NOW)	0	0	1
44000268	44	                     DATESEP	0	0	1
44000269	44	           END-EXEC.	0	0	1
44000271	44	       PTD999.	0	0	1
44000272	44	           EXIT.	0	0	1
45000001	45	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	1
45000002	45	       CBL CICS('SP,EDF')	0	0	1
45000003	45	      ******************************************************************	1	0	0
45000004	45	      *                                                                *	1	0	1
45000005	45	      *  Copyright IBM Corp. 2023                                      *	1	0	1
45000006	45	      *                                                                *	1	0	1
45000007	45	      ******************************************************************	1	0	1
45000010	45	      ******************************************************************	1	0	1
45000011	45	      * This is the Credit/Debit program in the BANKING application	1	0	1
45000012	45	      * BMS suite.	1	0	1
45000013	45	      *	1	0	1
45000014	45	      ******************************************************************	1	0	1
45000015	45	       IDENTIFICATION DIVISION.	0	0	0
45000016	45	       PROGRAM-ID. BNK1CRA.	0	0	1
45000017	45	       AUTHOR. Jon Collett.	0	0	1
45000019	45	       ENVIRONMENT DIVISION.	0	0	1
45000020	45	       CONFIGURATION SECTION.	0	0	1
45000021	45	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
45000022	45	       SOURCE-COMPUTER.  IBM-370.	0	0	0
45000023	45	       OBJECT-COMPUTER.  IBM-370.	0	0	1
45000025	45	       INPUT-OUTPUT SECTION.	0	0	1
45000027	45	       DATA DIVISION.	0	0	1
45000028	45	       WORKING-STORAGE SECTION.	0	0	1
45000030	45	       01 WS-CICS-WORK-AREA.	0	0	1
45000031	45	          03 WS-CICS-RESP              PIC S9(8) COMP	0	0	1
45000032	45	                                                     VALUE 0.	0	0	1
45000033	45	          03 WS-CICS-RESP2             PIC S9(8) COMP	0	0	1
45000034	45	                                                     VALUE 0.	0	0	1
45000035	45	       01 WS-FAIL-INFO.	0	0	1
45000036	45	          03 FILLER                    PIC X(9)      VALUE 'BNK1CRA  '.	0	0	1
45000037	45	          03 WS-CICS-FAIL-MSG          PIC X(70)     VALUE ' '.	0	0	1
45000038	45	          03 FILLER                    PIC X(6)      VALUE ' RESP='.	0	0	1
45000039	45	          03 WS-CICS-RESP-DISP         PIC 9(10)     VALUE 0.	0	0	1
45000040	45	          03 FILLER                    PIC X(7)      VALUE ' RESP2='.	0	0	1
45000041	45	          03 WS-CICS-RESP2-DISP        PIC 9(10)     VALUE 0.	0	0	1
45000042	45	          03 FILLER                    PIC X(15)     VALUE	0	0	1
45000043	45	                                                      ' ABENDING TASK.'.	0	0	1
45000044	45	       01 SWITCHES.	0	0	1
45000045	45	          03 VALID-DATA-SW             PIC X         VALUE 'Y'.	0	0	1
45000046	45	             88 VALID-DATA                           VALUE 'Y'.	0	0	1
45000048	45	       01 FLAGS.	0	0	1
45000049	45	          03 SEND-FLAG                 PIC X.	0	0	1
45000050	45	             88 SEND-ERASE                           VALUE '1'.	0	0	1
45000051	45	             88 SEND-DATAONLY                        VALUE '2'.	0	0	1
45000052	45	             88 SEND-DATAONLY-ALARM                  VALUE '3'.	0	0	1
45000054	45	       01 ACTION-ALPHA.	0	0	1
45000055	45	          03 ACTION-NUM                PIC 9.	0	0	1
45000057	45	      *	1	0	0
45000058	45	      * The end of session message	1	0	1
45000059	45	      *	1	0	1
45000060	45	       01 END-OF-SESSION-MESSAGE       PIC X(13)     VALUE	0	0	0
45000061	45	                                                        'Session Ended'.	0	0	1
45000062	45	       01 RESPONSE-CODE                PIC S9(8) COMP.	0	0	1
45000064	45	       01 COMMUNICATION-AREA           PIC X.	0	0	1
45000066	45	       COPY BNK1CDM.	0	0	1
45000068	45	       COPY DFHAID.	0	0	1
45000070	45	       01 AMTI9                        PIC 9(12).	0	0	1
45000072	45	       01 WS-AMOUNT-AS-FLOAT COMP-2.	0	0	1
45000073	45	       01 WS-NUM-COUNT-TOTAL           PIC S9(8) BINARY.	0	0	1
45000074	45	       01 WS-NUM-COUNT-POINT           PIC S9(8) BINARY.	0	0	1
45000075	45	       01 WS-NUM-COUNT-SPACE           PIC S9(8) BINARY.	0	0	1
45000077	45	       01 WS-AMOUNT-UNSTR              PIC X(13).	0	0	1
45000078	45	       01 WS-AMOUNT-UNSTR-L            PIC S9(8) BINARY.	0	0	1
45000079	45	       01 WS-AMOUNT-UNSTR-REVERSE      PIC X(13).	0	0	1
45000081	45	       01 WS-STUFF1.	0	0	1
45000082	45	          03 WS-COMM-ACT-BAL-UNSIGN    PIC 9(12).	0	0	1
45000083	45	       01 WS-STUFF2 REDEFINES WS-STUFF1.	0	0	1
45000084	45	          03 WS-COMM-ACT-BAL-X         PIC X(12).	0	0	1
45000086	45	       01 WS-STUFF3.	0	0	1
45000087	45	          03 WS-COMM-AMT-UNSIGN        PIC 9(12).	0	0	1
45000088	45	       01 WS-STUFF4 REDEFINES WS-STUFF3.	0	0	1
45000089	45	          03 WS-COMM-AMT-X             PIC X(12).	0	0	1
45000091	45	       01 WS-STUFF5.	0	0	1
45000092	45	          03 WS-COMM-AV-BAL-UNSIGN     PIC 9(12).	0	0	1
45000093	45	       01 WS-STUFF6 REDEFINES WS-STUFF5.	0	0	1
45000094	45	          03 WS-COMM-AV-BAL-X          PIC X(12).	0	0	1
45000096	45	       01 WS-COMM-AREA.	0	0	1
45000097	45	          03 WS-COMM-ACCNO             PIC X(8).	0	0	1
45000098	45	          03 WS-COMM-SIGN              PIC X.	0	0	1
45000099	45	          03 WS-COMM-AMT               PIC 9(12).	0	0	1
45000101	45	       01 WS-CONVERSIONA.	0	0	1
45000102	45	          03 WS-CONVERT-PIC1           PIC X(13).	0	0	1
45000103	45	          03 WS-CONVERT-PIC1SP REDEFINES WS-CONVERT-PIC1.	0	0	1
45000104	45	             05 WS-CONVERT-PIC1-1ST    PIC X(10).	0	0	1
45000105	45	             05 WS-CONVERT-PIC1-POINT  PIC X.	0	0	1
45000106	45	             05 WS-CONVERT-PIC1-2ND    PIC XX.	0	0	1
45000108	45	       01 WS-CONVERSIONB.	0	0	1
45000109	45	          03 WS-CONVERT-PICX           PIC X(13).	0	0	1
45000110	45	          03 WS-CONVERT-SPLIT REDEFINES WS-CONVERT-PICX.	0	0	1
45000111	45	             05 WS-CONVERT-DEC         PIC 9(10).	0	0	1
45000112	45	             05 WS-CONVERT-POINT       PIC X.	0	0	1
45000113	45	             05 WS-CONVERT-REMAIN      PIC 99.	0	0	1
45000115	45	       01 WS-CONVERTED-VAL1            PIC S9(10)V99 VALUE 0.	0	0	1
45000116	45	       01 WS-CONVERTED-VAL2            PIC S9(10)V99 VALUE 0.	0	0	1
45000117	45	       01 WS-CONVERTED-VAL3            PIC S9(10)V99 VALUE 0.	0	0	1
45000118	45	       01 WS-CONVERTED-VAL4            PIC S9(10)V99 VALUE 0.	0	0	1
45000120	45	       01 SUBPGM-PARMS.	0	0	1
45000121	45	          03 SUBPGM-ACCNO              PIC X(8).	0	0	1
45000122	45	          03 SUBPGM-AMT                PIC S9(10)V99.	0	0	1
45000123	45	          03 SUBPGM-SORTC              PIC 9(6).	0	0	1
45000124	45	          03 SUBPGM-AV-BAL             PIC S9(10)V99.	0	0	1
45000125	45	          03 SUBPGM-ACT-BAL            PIC S9(10)V99.	0	0	1
45000126	45	          03 SUBPGM-ORIGIN.	0	0	1
45000127	45	               05 SUBPGM-APPLID           PIC X(8).	0	0	1
45000128	45	               05 SUBPGM-USERID           PIC X(8).	0	0	1
45000129	45	               05 SUBPGM-FACILITY-NAME    PIC X(8).	0	0	1
45000130	45	               05 SUBPGM-NETWRK-ID        PIC X(8).	0	0	1
45000131	45	               05 SUBPGM-FACILTYPE        PIC S9(8) COMP.	0	0	1
45000132	45	               05 FILLER                  PIC X(4) VALUE SPACES.	0	0	1
45000133	45	          03 SUBPGM-SUCCESS            PIC X.	0	0	1
45000134	45	          03 SUBPGM-FAIL-CODE          PIC X.	0	0	1
45000136	45	       01 COMPANY-NAME-FULL            PIC X(32).	0	0	1
45000138	45	       01 AVAILABLE-BALANCE-DISPLAY    PIC +9(10).99.	0	0	1
45000139	45	       01 ACTUAL-BALANCE-DISPLAY       PIC +9(10).99.	0	0	1
45000141	45	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
45000142	45	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
45000143	45	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
45000144	45	          03 WS-ORIG-DATE-DD           PIC 99.	0	0	1
45000145	45	          03 FILLER                    PIC X.	0	0	1
45000146	45	          03 WS-ORIG-DATE-MM           PIC 99.	0	0	1
45000147	45	          03 FILLER                    PIC X.	0	0	1
45000148	45	          03 WS-ORIG-DATE-YYYY         PIC 9999.	0	0	1
45000150	45	       01 WS-ORIG-DATE-GRP-X.	0	0	1
45000151	45	          03 WS-ORIG-DATE-DD-X         PIC XX.	0	0	1
45000152	45	          03 FILLER                    PIC X         VALUE '.'.	0	0	1
45000153	45	          03 WS-ORIG-DATE-MM-X         PIC XX.	0	0	1
45000154	45	          03 FILLER                    PIC X         VALUE '.'.	0	0	1
45000155	45	          03 WS-ORIG-DATE-YYYY-X       PIC X(4).	0	0	1
45000157	45	       01 WS-TIME-DATA.	0	0	1
45000158	45	          03 WS-TIME-NOW               PIC 9(6).	0	0	1
45000159	45	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
45000160	45	             05 WS-TIME-NOW-GRP-HH     PIC 99.	0	0	1
45000161	45	             05 WS-TIME-NOW-GRP-MM     PIC 99.	0	0	1
45000162	45	             05 WS-TIME-NOW-GRP-SS     PIC 99.	0	0	1
45000164	45	       01 WS-ABEND-PGM                 PIC X(8)      VALUE 'ABNDPROC'.	0	0	1
45000166	45	       01 ABNDINFO-REC.	0	0	1
45000167	45	           COPY ABNDINFO.	0	0	1
45000169	45	       LINKAGE SECTION.	0	0	1
45000170	45	       01 DFHCOMMAREA.	0	0	1
45000171	45	          03 COMM-ACCNO                PIC X(8).	0	0	1
45000172	45	          03 COMM-SIGN                 PIC X.	0	0	1
45000173	45	          03 COMM-AMT                  PIC 9(12).	0	0	1
45000176	45	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
45000177	45	       PREMIERE SECTION.	0	0	1
45000178	45	       A010.	0	0	1
45000180	45	           EVALUATE TRUE	0	0	1
45000181	45	      *	1	0	0
45000182	45	      *       Is it the first time through? If so, send the map	1	0	1
45000183	45	      *       with erased (empty) data fields.	1	0	1
45000184	45	      *	1	0	1
45000185	45	              WHEN EIBCALEN = ZERO	0	0	0
45000186	45	                 MOVE LOW-VALUE TO BNK1CDO	0	0	1
45000187	45	                 MOVE -1 TO ACCNOL	0	0	1
45000188	45	                 SET SEND-ERASE TO TRUE	0	0	1
45000189	45	                 PERFORM SEND-MAP	0	0	1
45000191	45	      *	1	0	0
45000192	45	      *       If a PA key is pressed, just carry on	1	0	1
45000193	45	      *	1	0	1
45000194	45	              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3	0	0	0
45000195	45	                 CONTINUE	0	0	1
45000197	45	      *	1	0	0
45000198	45	      *       When Pf3 is pressed, return to the main menu	1	0	1
45000199	45	      *	1	0	1
45000200	45	              WHEN EIBAID = DFHPF3	0	0	0
45000201	45	                 EXEC CICS RETURN	0	0	1
45000202	45	                    TRANSID('OMEN')	0	0	1
45000203	45	                    IMMEDIATE	0	0	1
45000204	45	                    RESP(WS-CICS-RESP)	0	0	1
45000205	45	                    RESP2(WS-CICS-RESP2)	0	0	1
45000206	45	                 END-EXEC	0	0	1
45000208	45	      *	1	0	0
45000209	45	      *       If the aid or Pf12 is pressed, then send a termination	1	0	1
45000210	45	      *       message.	1	0	1
45000211	45	      *	1	0	1
45000212	45	              WHEN EIBAID = DFHAID OR DFHPF12	0	0	0
45000213	45	                 PERFORM SEND-TERMINATION-MSG	0	0	1
45000215	45	                 EXEC CICS	0	0	1
45000216	45	                    RETURN	0	0	1
45000217	45	                 END-EXEC	0	0	1
45000219	45	      *	1	0	0
45000220	45	      *       When CLEAR is pressed	1	0	1
45000221	45	      *	1	0	1
45000222	45	              WHEN EIBAID = DFHCLEAR	0	0	0
45000223	45	                EXEC CICS SEND CONTROL	0	0	1
45000224	45	                          ERASE	0	0	1
45000225	45	                          FREEKB	0	0	1
45000226	45	                END-EXEC	0	0	1
45000228	45	                EXEC CICS RETURN	0	0	1
45000229	45	                END-EXEC	0	0	1
45000231	45	      *	1	0	0
45000232	45	      *       When enter is pressed then process the content	1	0	1
45000233	45	      *	1	0	1
45000234	45	              WHEN EIBAID = DFHENTER	0	0	0
45000235	45	                 PERFORM PROCESS-MAP	0	0	1
45000237	45	      *	1	0	0
45000238	45	      *       When anything else happens, send the invalid key message	1	0	1
45000239	45	      *	1	0	1
45000240	45	              WHEN OTHER	0	0	0
45000241	45	                 MOVE LOW-VALUES TO BNK1CDO	0	0	1
45000242	45	                 MOVE 'Invalid key pressed.' TO MESSAGEO	0	0	1
45000243	45	                 MOVE 8 TO ACCNOL	0	0	1
45000244	45	                 SET SEND-DATAONLY-ALARM TO TRUE	0	0	1
45000245	45	                 PERFORM SEND-MAP	0	0	1
45000247	45	           END-EVALUATE.	0	0	1
45000249	45	      *	1	0	0
45000250	45	      *    Provided that we have been around this way before	1	0	1
45000251	45	      *    (i.e. it is NOT the first time through, put the data	1	0	1
45000252	45	      *    returned from the sub program into the area that we use	1	0	1
45000253	45	      *    as the COMMAREA on the RETURN.	1	0	1
45000254	45	      *	1	0	1
45000255	45	           IF EIBCALEN NOT = ZERO	0	0	0
45000257	45	              MOVE COMM-ACCNO  TO WS-COMM-ACCNO	0	0	1
45000258	45	              MOVE COMM-SIGN   TO  WS-COMM-SIGN	0	0	1
45000259	45	              MOVE COMM-AMT    TO WS-COMM-AMT	0	0	1
45000261	45	           END-IF.	0	0	1
45000263	45	           EXEC CICS	0	0	1
45000264	45	              RETURN TRANSID('OCRA')	0	0	1
45000265	45	              COMMAREA(WS-COMM-AREA)	0	0	1
45000266	45	              LENGTH(21)	0	0	1
45000267	45	              RESP(WS-CICS-RESP)	0	0	1
45000268	45	              RESP2(WS-CICS-RESP2)	0	0	1
45000269	45	           END-EXEC.	0	0	1
45000271	45	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
45000272	45	      *	1	0	0
45000273	45	      *       Preserve the RESP and RESP2, then set up the	1	0	1
45000274	45	      *       standard ABEND info before getting the applid,	1	0	1
45000275	45	      *       date/time etc. and linking to the Abend Handler	1	0	1
45000276	45	      *       program.	1	0	1
45000277	45	      *	1	0	1
45000278	45	              INITIALIZE ABNDINFO-REC	0	0	0
45000279	45	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
45000280	45	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
45000281	45	      *	1	0	0
45000282	45	      *       Get supplemental information	1	0	1
45000283	45	      *	1	0	1
45000284	45	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
45000285	45	              END-EXEC	0	0	1
45000287	45	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
45000288	45	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
45000290	45	              PERFORM POPULATE-TIME-DATE	0	0	1
45000292	45	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
45000293	45	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
45000294	45	                    ':' DELIMITED BY SIZE,	0	0	1
45000295	45	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
45000296	45	                     ':' DELIMITED BY SIZE,	0	0	1
45000297	45	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
45000298	45	                     INTO ABND-TIME	0	0	1
45000299	45	              END-STRING	0	0	1
45000301	45	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
45000302	45	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
45000304	45	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
45000305	45	              END-EXEC	0	0	1
45000307	45	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
45000309	45	              STRING 'A010 - RETURN TRANSID(OCRA) FAIL.'	0	0	1
45000310	45	                    DELIMITED BY SIZE,	0	0	1
45000311	45	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
45000312	45	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
45000313	45	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
45000314	45	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
45000315	45	                    INTO ABND-FREEFORM	0	0	1
45000316	45	              END-STRING	0	0	1
45000318	45	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
45000319	45	                        COMMAREA(ABNDINFO-REC)	0	0	1
45000320	45	              END-EXEC	0	0	1
45000322	45	              INITIALIZE WS-FAIL-INFO	0	0	1
45000323	45	              MOVE 'BNK1CRA - A010 - RETURN TRANSID(OCRA) FAIL' TO	0	0	1
45000324	45	                 WS-CICS-FAIL-MSG	0	0	1
45000325	45	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
45000326	45	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
45000327	45	              PERFORM ABEND-THIS-TASK	0	0	1
45000328	45	           END-IF.	0	0	1
45000330	45	       A999.	0	0	1
45000331	45	           EXIT.	0	0	1
45000334	45	       PROCESS-MAP SECTION.	0	0	1
45000335	45	       PM010.	0	0	1
45000336	45	      *	1	0	0
45000337	45	      *    Retrieve the data from the map	1	0	1
45000338	45	      *	1	0	1
45000339	45	           PERFORM RECEIVE-MAP.	0	0	0
45000341	45	      *	1	0	0
45000342	45	      *    Validate the received data	1	0	1
45000343	45	      *	1	0	1
45000344	45	           PERFORM EDIT-DATA.	0	0	0
45000346	45	      *	1	0	0
45000347	45	      *    If the data passes validation go on to apply the debit or	1	0	1
45000348	45	      *    credit.	1	0	1
45000349	45	      *	1	0	1
45000350	45	           IF VALID-DATA	0	0	0
45000351	45	              PERFORM UPD-CRED-DATA	0	0	1
45000352	45	           END-IF.	0	0	1
45000354	45	           SET SEND-DATAONLY-ALARM TO TRUE.	0	0	1
45000356	45	      *	1	0	0
45000357	45	      *    Output the data to the screen	1	0	1
45000358	45	      *	1	0	1
45000359	45	           PERFORM SEND-MAP.	0	0	0
45000361	45	       PM999.	0	0	1
45000362	45	           EXIT.	0	0	1
45000365	45	       RECEIVE-MAP SECTION.	0	0	1
45000366	45	       RM010.	0	0	1
45000367	45	      *	1	0	0
45000368	45	      *    Retrieve the data	1	0	1
45000369	45	      *	1	0	1
45000370	45	           EXEC CICS	0	0	0
45000371	45	              RECEIVE MAP('BNK1CD')	0	0	1
45000372	45	              MAPSET('BNK1CDM')	0	0	1
45000373	45	              INTO(BNK1CDI)	0	0	1
45000374	45	              RESP(WS-CICS-RESP)	0	0	1
45000375	45	              RESP2(WS-CICS-RESP2)	0	0	1
45000376	45	           END-EXEC.	0	0	1
45000378	45	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
45000379	45	      *	1	0	0
45000380	45	      *       Preserve the RESP and RESP2, then set up the	1	0	1
45000381	45	      *       standard ABEND info before getting the applid,	1	0	1
45000382	45	      *       date/time etc. and linking to the Abend Handler	1	0	1
45000383	45	      *       program.	1	0	1
45000384	45	      *	1	0	1
45000385	45	              INITIALIZE ABNDINFO-REC	0	0	0
45000386	45	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
45000387	45	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
45000388	45	      *	1	0	0
45000389	45	      *       Get supplemental information	1	0	1
45000390	45	      *	1	0	1
45000391	45	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
45000392	45	              END-EXEC	0	0	1
45000394	45	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
45000395	45	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
45000397	45	              PERFORM POPULATE-TIME-DATE	0	0	1
45000399	45	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
45000400	45	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
45000401	45	                    ':' DELIMITED BY SIZE,	0	0	1
45000402	45	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
45000403	45	                     ':' DELIMITED BY SIZE,	0	0	1
45000404	45	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
45000405	45	                     INTO ABND-TIME	0	0	1
45000406	45	              END-STRING	0	0	1
45000408	45	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
45000409	45	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
45000411	45	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
45000412	45	              END-EXEC	0	0	1
45000414	45	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
45000416	45	              STRING 'RM010 - RECEIVE MAP FAIL.'	0	0	1
45000417	45	                    DELIMITED BY SIZE,	0	0	1
45000418	45	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
45000419	45	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
45000420	45	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
45000421	45	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
45000422	45	                    INTO ABND-FREEFORM	0	0	1
45000423	45	              END-STRING	0	0	1
45000425	45	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
45000426	45	                        COMMAREA(ABNDINFO-REC)	0	0	1
45000427	45	              END-EXEC	0	0	1
45000429	45	              INITIALIZE WS-FAIL-INFO	0	0	1
45000430	45	              MOVE 'BNKMENU - RM010 - RECEIVE MAP FAIL ' TO	0	0	1
45000431	45	                 WS-CICS-FAIL-MSG	0	0	1
45000432	45	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
45000433	45	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
45000434	45	              PERFORM ABEND-THIS-TASK	0	0	1
45000435	45	           END-IF.	0	0	1
45000437	45	       RM999.	0	0	1
45000438	45	           EXIT.	0	0	1
45000441	45	       EDIT-DATA SECTION.	0	0	1
45000442	45	       ED010.	0	0	1
45000443	45	      *	1	0	0
45000444	45	      *    Perform validation on the incoming fields	1	0	1
45000445	45	      *	1	0	1
45000446	45	           EXEC CICS BIF	0	0	0
45000447	45	              DEEDIT FIELD(ACCNOI)	0	0	1
45000448	45	           END-EXEC.	0	0	1
45000450	45	           IF ACCNOI NOT NUMERIC	0	0	1
45000451	45	              MOVE 'Please enter an account number.  ' TO	0	0	1
45000452	45	                 MESSAGEO	0	0	1
45000453	45	              MOVE 'N' TO VALID-DATA-SW	0	0	1
45000454	45	              GO TO ED999	0	0	1
45000455	45	           END-IF.	0	0	1
45000457	45	           IF ACCNOI = ZERO	0	0	1
45000458	45	              MOVE 'Please enter a non zero account number.   ' TO	0	0	1
45000459	45	                 MESSAGEO	0	0	1
45000460	45	              MOVE 'N' TO VALID-DATA-SW	0	0	1
45000461	45	              GO TO ED999	0	0	1
45000462	45	           END-IF.	0	0	1
45000464	45	           IF SIGNI NOT = '+' AND SIGNI NOT = '-' AND SIGNL = 1	0	0	1
45000465	45	              MOVE 'Please enter + or - preceding the amount ' TO	0	0	1
45000466	45	                 MESSAGEO	0	0	1
45000467	45	              MOVE 'N' TO VALID-DATA-SW	0	0	1
45000468	45	              GO TO ED999	0	0	1
45000469	45	           END-IF.	0	0	1
45000471	45	      *	1	0	0
45000472	45	      *    Validate the Amount entered	1	0	1
45000473	45	      *	1	0	1
45000474	45	           PERFORM VALIDATE-AMOUNT.	0	0	0
45000476	45	       ED999.	0	0	1
45000477	45	           EXIT.	0	0	1
45000480	45	       UPD-CRED-DATA SECTION.	0	0	1
45000481	45	       UCD010.	0	0	1
45000482	45	      *	1	0	0
45000483	45	      *    Set up the COMMAREA fields required by DBCRFUN and then	1	0	1
45000484	45	      *    link to it.	1	0	1
45000485	45	      *	1	0	1
45000486	45	           INITIALIZE SUBPGM-PARMS.	0	0	0
45000488	45	           MOVE ACCNOI TO SUBPGM-ACCNO.	0	0	1
45000489	45	           MOVE 0 TO SUBPGM-AMT.	0	0	1
45000491	45	      *	1	0	0
45000492	45	      *    Provide the correct Amount	1	0	1
45000493	45	      *	1	0	1
45000494	45	           IF SIGNI = '-'	0	0	0
45000495	45	              COMPUTE WS-AMOUNT-AS-FLOAT = WS-AMOUNT-AS-FLOAT * -1	0	0	1
45000496	45	           END-IF.	0	0	1
45000498	45	           MOVE WS-AMOUNT-AS-FLOAT TO SUBPGM-AMT.	0	0	1
45000500	45	      *	1	0	0
45000501	45	      *    Get the ORIGIN data	1	0	1
45000502	45	      *	1	0	1
45000503	45	           EXEC CICS INQUIRE ASSOCIATION(EIBTASKN)	0	0	0
45000504	45	               ODAPPLID(SUBPGM-APPLID)	0	0	1
45000505	45	               ODUSERID(SUBPGM-USERID)	0	0	1
45000506	45	               ODFACILNAME(SUBPGM-FACILITY-NAME)	0	0	1
45000507	45	               ODNETWORKID(SUBPGM-NETWRK-ID)	0	0	1
45000508	45	               ODFACILTYPE(SUBPGM-FACILTYPE)	0	0	1
45000509	45	           END-EXEC.	0	0	1
45000511	45	           EXEC CICS LINK	0	0	1
45000512	45	              PROGRAM('DBCRFUN')	0	0	1
45000513	45	              COMMAREA(SUBPGM-PARMS)	0	0	1
45000514	45	              RESP(WS-CICS-RESP)	0	0	1
45000515	45	              RESP2(WS-CICS-RESP2)	0	0	1
45000516	45	              SYNCONRETURN	0	0	1
45000517	45	           END-EXEC.	0	0	1
45000519	45	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
45000520	45	      *	1	0	0
45000521	45	      *       Preserve the RESP and RESP2, then set up the	1	0	1
45000522	45	      *       standard ABEND info before getting the applid,	1	0	1
45000523	45	      *       date/time etc. and linking to the Abend Handler	1	0	1
45000524	45	      *       program.	1	0	1
45000525	45	      *	1	0	1
45000526	45	              INITIALIZE ABNDINFO-REC	0	0	0
45000527	45	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
45000528	45	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
45000529	45	      *	1	0	0
45000530	45	      *       Get supplemental information	1	0	1
45000531	45	      *	1	0	1
45000532	45	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
45000533	45	              END-EXEC	0	0	1
45000535	45	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
45000536	45	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
45000538	45	              PERFORM POPULATE-TIME-DATE	0	0	1
45000540	45	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
45000541	45	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
45000542	45	                    ':' DELIMITED BY SIZE,	0	0	1
45000543	45	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
45000544	45	                     ':' DELIMITED BY SIZE,	0	0	1
45000545	45	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
45000546	45	                     INTO ABND-TIME	0	0	1
45000547	45	              END-STRING	0	0	1
45000549	45	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
45000550	45	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
45000552	45	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
45000553	45	              END-EXEC	0	0	1
45000555	45	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
45000557	45	              STRING 'UCD010 - LINK DBCRFUN FAIL.'	0	0	1
45000558	45	                    DELIMITED BY SIZE,	0	0	1
45000559	45	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
45000560	45	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
45000561	45	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
45000562	45	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
45000563	45	                    INTO ABND-FREEFORM	0	0	1
45000564	45	              END-STRING	0	0	1
45000566	45	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
45000567	45	                        COMMAREA(ABNDINFO-REC)	0	0	1
45000568	45	              END-EXEC	0	0	1
45000570	45	              INITIALIZE WS-FAIL-INFO	0	0	1
45000571	45	              MOVE 'BNK1CRA - UCD010 - LINK DBCRFUN  FAIL      '	0	0	1
45000572	45	                 TO WS-CICS-FAIL-MSG	0	0	1
45000573	45	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
45000574	45	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
45000575	45	              PERFORM ABEND-THIS-TASK	0	0	1
45000576	45	           END-IF.	0	0	1
45000578	45	      *	1	0	0
45000579	45	      *    Check to see if the debit or credit was successful	1	0	1
45000580	45	      *	1	0	1
45000581	45	           IF SUBPGM-SUCCESS = 'N'	0	0	0
45000583	45	              MOVE 'N' TO VALID-DATA-SW	0	0	1
45000585	45	              EVALUATE SUBPGM-FAIL-CODE	0	0	1
45000586	45	                 WHEN '1'	0	0	1
45000587	45	                    MOVE SPACES TO MESSAGEO	0	0	1
45000588	45	                    STRING 'Sorry but the ACCOUNT no was not found'	0	0	1
45000589	45	                           ' for SORTCODE '	0	0	1
45000590	45	                           SUBPGM-SORTC	0	0	1
45000591	45	                           ' . Amount not applied. '	0	0	1
45000592	45	                           DELIMITED BY SIZE	0	0	1
45000593	45	                           INTO MESSAGEO	0	0	1
45000594	45	                    GO TO UCD999	0	0	1
45000596	45	                 WHEN '2'	0	0	1
45000597	45	                    MOVE SPACES TO MESSAGEO	0	0	1
45000598	45	                    STRING 'Sorry but the AMOUNT could not be applied'	0	0	1
45000599	45	                           ' due to an unexpected error.'	0	0	1
45000600	45	                           DELIMITED BY SIZE	0	0	1
45000601	45	                           INTO MESSAGEO	0	0	1
45000602	45	                    GO TO UCD999	0	0	1
45000604	45	                 WHEN '3'	0	0	1
45000605	45	                    MOVE SPACES TO MESSAGEO	0	0	1
45000606	45	                    STRING 'Sorry insufficient funds available to pro'	0	0	1
45000607	45	                           'cess the request.           '	0	0	1
45000608	45	                           DELIMITED BY SIZE	0	0	1
45000609	45	                           INTO MESSAGEO	0	0	1
45000610	45	                    GO TO UCD999	0	0	1
45000612	45	                 WHEN OTHER	0	0	1
45000613	45	                    MOVE SPACES TO MESSAGEO	0	0	1
45000614	45	                    STRING 'Sorry but the AMOUNT could not be applied'	0	0	1
45000615	45	                           ' due to an unexpected error. '	0	0	1
45000616	45	                           SUBPGM-FAIL-CODE	0	0	1
45000617	45	                           DELIMITED BY SIZE	0	0	1
45000618	45	                           INTO MESSAGEO	0	0	1
45000619	45	                    GO TO UCD999	0	0	1
45000620	45	              END-EVALUATE	0	0	1
45000622	45	           ELSE	0	0	1
45000623	45	              MOVE SPACES TO MESSAGEO	0	0	1
45000624	45	              MOVE 'Amount successfully applied to the account.' TO	0	0	1
45000625	45	                 MESSAGEO	0	0	1
45000626	45	           END-IF.	0	0	1
45000628	45	      *	1	0	0
45000629	45	      *    Set up the values on the map	1	0	1
45000630	45	      *	1	0	1
45000631	45	           MOVE SUBPGM-ACCNO       TO ACCNOO.	0	0	0
45000632	45	           MOVE SUBPGM-SORTC       TO SORTCO.	0	0	1
45000634	45	           MOVE SUBPGM-ACT-BAL    TO ACTUAL-BALANCE-DISPLAY.	0	0	1
45000635	45	           MOVE SUBPGM-AV-BAL     TO AVAILABLE-BALANCE-DISPLAY.	0	0	1
45000636	45	           MOVE ACTUAL-BALANCE-DISPLAY      TO ACTBALO.	0	0	1
45000637	45	           MOVE AVAILABLE-BALANCE-DISPLAY   TO AVBALO.	0	0	1
45000639	45	       UCD999.	0	0	1
45000640	45	           EXIT.	0	0	1
45000643	45	       SEND-MAP SECTION.	0	0	1
45000644	45	       SM010.	0	0	1
45000645	45	      *	1	0	0
45000646	45	      *    If the map needs to have its data erased	1	0	1
45000647	45	      *	1	0	1
45000648	45	           IF SEND-ERASE	0	0	0
45000649	45	              EXEC CICS SEND MAP('BNK1CD')	0	0	1
45000650	45	                 MAPSET('BNK1CDM')	0	0	1
45000651	45	                 FROM(BNK1CDO)	0	0	1
45000652	45	                 ERASE	0	0	1
45000653	45	                 RESP(WS-CICS-RESP)	0	0	1
45000654	45	                 RESP2(WS-CICS-RESP2)	0	0	1
45000655	45	              END-EXEC	0	0	1
45000657	45	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
45000658	45	      *	1	0	0
45000659	45	      *          Preserve the RESP and RESP2, then set up the	1	0	1
45000660	45	      *          standard ABEND info before getting the applid,	1	0	1
45000661	45	      *          date/time etc. and linking to the Abend Handler	1	0	1
45000662	45	      *          program.	1	0	1
45000663	45	      *	1	0	1
45000664	45	                 INITIALIZE ABNDINFO-REC	0	0	0
45000665	45	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
45000666	45	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
45000667	45	      *	1	0	0
45000668	45	      *          Get supplemental information	1	0	1
45000669	45	      *	1	0	1
45000670	45	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
45000671	45	                 END-EXEC	0	0	1
45000673	45	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
45000674	45	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
45000676	45	                 PERFORM POPULATE-TIME-DATE	0	0	1
45000678	45	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
45000679	45	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
45000680	45	                       ':' DELIMITED BY SIZE,	0	0	1
45000681	45	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
45000682	45	                        ':' DELIMITED BY SIZE,	0	0	1
45000683	45	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
45000684	45	                        INTO ABND-TIME	0	0	1
45000685	45	                 END-STRING	0	0	1
45000687	45	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
45000688	45	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
45000690	45	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
45000691	45	                 END-EXEC	0	0	1
45000693	45	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
45000695	45	                 STRING 'SM010 - SEND MAP ERASE FAIL.'	0	0	1
45000696	45	                       DELIMITED BY SIZE,	0	0	1
45000697	45	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
45000698	45	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
45000699	45	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
45000700	45	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
45000701	45	                       INTO ABND-FREEFORM	0	0	1
45000702	45	                 END-STRING	0	0	1
45000704	45	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
45000705	45	                           COMMAREA(ABNDINFO-REC)	0	0	1
45000706	45	                 END-EXEC	0	0	1
45000708	45	                 INITIALIZE WS-FAIL-INFO	0	0	1
45000709	45	                 MOVE 'BNK1CRA - SM010 - SEND MAP ERASE FAIL '	0	0	1
45000710	45	                    TO WS-CICS-FAIL-MSG	0	0	1
45000711	45	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
45000712	45	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
45000713	45	                 PERFORM ABEND-THIS-TASK	0	0	1
45000714	45	              END-IF	0	0	1
45000716	45	              GO TO SM999	0	0	1
45000717	45	           END-IF.	0	0	1
45000719	45	      *	1	0	0
45000720	45	      *    If the map just needs a resend of only the data	1	0	1
45000721	45	      *	1	0	1
45000722	45	           IF SEND-DATAONLY	0	0	0
45000723	45	              EXEC CICS SEND MAP('BNK1CD')	0	0	1
45000724	45	                 MAPSET('BNK1CDM')	0	0	1
45000725	45	                 FROM(BNK1CDO)	0	0	1
45000726	45	                 DATAONLY	0	0	1
45000727	45	                 RESP(WS-CICS-RESP)	0	0	1
45000728	45	                 RESP2(WS-CICS-RESP2)	0	0	1
45000729	45	              END-EXEC	0	0	1
45000731	45	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
45000732	45	      *	1	0	0
45000733	45	      *          Preserve the RESP and RESP2, then set up the	1	0	1
45000734	45	      *          standard ABEND info before getting the applid,	1	0	1
45000735	45	      *          date/time etc. and linking to the Abend Handler	1	0	1
45000736	45	      *          program.	1	0	1
45000737	45	      *	1	0	1
45000738	45	                 INITIALIZE ABNDINFO-REC	0	0	0
45000739	45	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
45000740	45	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
45000741	45	      *	1	0	0
45000742	45	      *          Get supplemental information	1	0	1
45000743	45	      *	1	0	1
45000744	45	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
45000745	45	                 END-EXEC	0	0	1
45000747	45	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
45000748	45	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
45000750	45	                 PERFORM POPULATE-TIME-DATE	0	0	1
45000752	45	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
45000753	45	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
45000754	45	                       ':' DELIMITED BY SIZE,	0	0	1
45000755	45	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
45000756	45	                        ':' DELIMITED BY SIZE,	0	0	1
45000757	45	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
45000758	45	                        INTO ABND-TIME	0	0	1
45000759	45	                 END-STRING	0	0	1
45000761	45	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
45000762	45	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
45000764	45	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
45000765	45	                 END-EXEC	0	0	1
45000767	45	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
45000769	45	                 STRING 'SM010 - SEND MAP DATAONLY FAIL.'	0	0	1
45000770	45	                       DELIMITED BY SIZE,	0	0	1
45000771	45	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
45000772	45	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
45000773	45	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
45000774	45	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
45000775	45	                       INTO ABND-FREEFORM	0	0	1
45000776	45	                 END-STRING	0	0	1
45000778	45	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
45000779	45	                           COMMAREA(ABNDINFO-REC)	0	0	1
45000780	45	                 END-EXEC	0	0	1
45000782	45	                 INITIALIZE WS-FAIL-INFO	0	0	1
45000783	45	                 MOVE 'BNK1CRA - SM010 - SEND MAP DATAONLY FAIL '	0	0	1
45000784	45	                    TO WS-CICS-FAIL-MSG	0	0	1
45000785	45	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
45000786	45	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
45000787	45	                 PERFORM ABEND-THIS-TASK	0	0	1
45000788	45	              END-IF	0	0	1
45000790	45	              GO TO SM999	0	0	1
45000791	45	           END-IF.	0	0	1
45000793	45	      *	1	0	0
45000794	45	      *    If we have elected to send the map and a beep	1	0	1
45000795	45	      *	1	0	1
45000796	45	           IF SEND-DATAONLY-ALARM	0	0	0
45000797	45	              EXEC CICS SEND MAP('BNK1CD')	0	0	1
45000798	45	                 MAPSET('BNK1CDM')	0	0	1
45000799	45	                 FROM(BNK1CDO)	0	0	1
45000800	45	                 DATAONLY	0	0	1
45000801	45	                 ALARM	0	0	1
45000802	45	                 RESP(WS-CICS-RESP)	0	0	1
45000803	45	                 RESP2(WS-CICS-RESP2)	0	0	1
45000804	45	              END-EXEC	0	0	1
45000806	45	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
45000807	45	      *	1	0	0
45000808	45	      *          Preserve the RESP and RESP2, then set up the	1	0	1
45000809	45	      *          standard ABEND info before getting the applid,	1	0	1
45000810	45	      *          date/time etc. and linking to the Abend Handler	1	0	1
45000811	45	      *          program.	1	0	1
45000812	45	      *	1	0	1
45000813	45	                 INITIALIZE ABNDINFO-REC	0	0	0
45000814	45	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
45000815	45	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
45000816	45	      *	1	0	0
45000817	45	      *          Get supplemental information	1	0	1
45000818	45	      *	1	0	1
45000819	45	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
45000820	45	                 END-EXEC	0	0	1
45000822	45	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
45000823	45	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
45000825	45	                 PERFORM POPULATE-TIME-DATE	0	0	1
45000827	45	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
45000828	45	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
45000829	45	                       ':' DELIMITED BY SIZE,	0	0	1
45000830	45	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
45000831	45	                        ':' DELIMITED BY SIZE,	0	0	1
45000832	45	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
45000833	45	                        INTO ABND-TIME	0	0	1
45000834	45	                 END-STRING	0	0	1
45000836	45	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
45000837	45	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
45000839	45	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
45000840	45	                 END-EXEC	0	0	1
45000842	45	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
45000844	45	                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL.'	0	0	1
45000845	45	                       DELIMITED BY SIZE,	0	0	1
45000846	45	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
45000847	45	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
45000848	45	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
45000849	45	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
45000850	45	                       INTO ABND-FREEFORM	0	0	1
45000851	45	                 END-STRING	0	0	1
45000853	45	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
45000854	45	                           COMMAREA(ABNDINFO-REC)	0	0	1
45000855	45	                 END-EXEC	0	0	1
45000857	45	                 INITIALIZE WS-FAIL-INFO	0	0	1
45000858	45	                 MOVE 'BNK1CRA - SM010 - SEND MAP DATAONLY ALARM FAIL '	0	0	1
45000859	45	                    TO WS-CICS-FAIL-MSG	0	0	1
45000860	45	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
45000861	45	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
45000862	45	                 PERFORM ABEND-THIS-TASK	0	0	1
45000863	45	              END-IF	0	0	1
45000865	45	           END-IF.	0	0	1
45000867	45	       SM999.	0	0	1
45000868	45	           EXIT.	0	0	1
45000871	45	       SEND-TERMINATION-MSG SECTION.	0	0	1
45000872	45	       STM010.	0	0	1
45000873	45	      *	1	0	0
45000874	45	      *    Send the termination message	1	0	1
45000875	45	      *	1	0	1
45000876	45	           EXEC CICS SEND TEXT	0	0	0
45000877	45	              FROM(END-OF-SESSION-MESSAGE)	0	0	1
45000878	45	              ERASE	0	0	1
45000879	45	              FREEKB	0	0	1
45000880	45	              RESP(WS-CICS-RESP)	0	0	1
45000881	45	              RESP2(WS-CICS-RESP2)	0	0	1
45000882	45	           END-EXEC.	0	0	1
45000884	45	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
45000885	45	      *	1	0	0
45000886	45	      *       Preserve the RESP and RESP2, then set up the	1	0	1
45000887	45	      *       standard ABEND info before getting the applid,	1	0	1
45000888	45	      *       date/time etc. and linking to the Abend Handler	1	0	1
45000889	45	      *       program.	1	0	1
45000890	45	      *	1	0	1
45000891	45	              INITIALIZE ABNDINFO-REC	0	0	0
45000892	45	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
45000893	45	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
45000894	45	      *	1	0	0
45000895	45	      *       Get supplemental information	1	0	1
45000896	45	      *	1	0	1
45000897	45	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
45000898	45	              END-EXEC	0	0	1
45000900	45	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
45000901	45	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
45000903	45	              PERFORM POPULATE-TIME-DATE	0	0	1
45000905	45	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
45000906	45	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
45000907	45	                    ':' DELIMITED BY SIZE,	0	0	1
45000908	45	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
45000909	45	                     ':' DELIMITED BY SIZE,	0	0	1
45000910	45	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
45000911	45	                     INTO ABND-TIME	0	0	1
45000912	45	              END-STRING	0	0	1
45000914	45	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
45000915	45	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
45000917	45	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
45000918	45	              END-EXEC	0	0	1
45000920	45	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
45000922	45	              STRING 'STM010 - SEND TEXT FAIL.'	0	0	1
45000923	45	                    DELIMITED BY SIZE,	0	0	1
45000924	45	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
45000925	45	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
45000926	45	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
45000927	45	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
45000928	45	                    INTO ABND-FREEFORM	0	0	1
45000929	45	              END-STRING	0	0	1
45000931	45	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
45000932	45	                        COMMAREA(ABNDINFO-REC)	0	0	1
45000933	45	              END-EXEC	0	0	1
45000935	45	              INITIALIZE WS-FAIL-INFO	0	0	1
45000936	45	              MOVE 'BNK1CRA - STM010 - SEND TEXT FAIL'	0	0	1
45000937	45	                 TO WS-CICS-FAIL-MSG	0	0	1
45000938	45	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
45000939	45	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
45000940	45	              PERFORM ABEND-THIS-TASK	0	0	1
45000941	45	           END-IF.	0	0	1
45000943	45	       STM999.	0	0	1
45000944	45	           EXIT.	0	0	1
45000947	45	       ABEND-THIS-TASK SECTION.	0	0	1
45000948	45	       ATT010.	0	0	1
45000949	45	           DISPLAY WS-FAIL-INFO.	0	0	1
45000950	45	           EXEC CICS ABEND	0	0	1
45000951	45	              ABCODE('HBNK')	0	0	1
45000952	45	              NODUMP	0	0	1
45000953	45	           END-EXEC.	0	0	1
45000955	45	       ATT999.	0	0	1
45000956	45	           EXIT.	0	0	1
45000959	45	       VALIDATE-AMOUNT SECTION.	0	0	1
45000960	45	       VA010.	0	0	1
45000962	45	           MOVE 0 TO WS-AMOUNT-AS-FLOAT.	0	0	1
45000964	45	           IF AMTL = ZERO	0	0	1
45000965	45	              MOVE 'The Amount entered must be numeric.' TO	0	0	1
45000966	45	                 MESSAGEO	0	0	1
45000967	45	              MOVE 'N' TO VALID-DATA-SW	0	0	1
45000968	45	              MOVE -1 TO AMTL	0	0	1
45000969	45	              GO TO VA999	0	0	1
45000970	45	           END-IF.	0	0	1
45000973	45	           IF AMTI(1:AMTL) IS NUMERIC	0	0	1
45000974	45	              COMPUTE WS-AMOUNT-AS-FLOAT =	0	0	1
45000975	45	                 FUNCTION NUMVAL(AMTI(1:AMTL))	0	0	1
45000977	45	              MOVE 'Y' TO VALID-DATA-SW	0	0	1
45000978	45	              GO TO VA999	0	0	1
45000979	45	           END-IF.	0	0	1
45000981	45	           MOVE ZERO TO WS-NUM-COUNT-TOTAL.	0	0	1
45000982	45	           INSPECT AMTI(1:AMTL) TALLYING WS-NUM-COUNT-TOTAL	0	0	1
45000983	45	              FOR LEADING SPACES.	0	0	1
45000985	45	      *	1	0	0
45000986	45	      *    It is entirely spaces	1	0	1
45000987	45	      *	1	0	1
45000988	45	           IF WS-NUM-COUNT-TOTAL = AMTL	0	0	0
45000989	45	              MOVE 'The Amount entered must be numeric.' TO	0	0	1
45000990	45	                 MESSAGEO	0	0	1
45000991	45	              MOVE 'N' TO VALID-DATA-SW	0	0	1
45000992	45	              MOVE -1 TO AMTL	0	0	1
45000993	45	              GO TO VA999	0	0	1
45000994	45	           END-IF.	0	0	1
45000996	45	           COMPUTE WS-AMOUNT-UNSTR-L = AMTL - WS-NUM-COUNT-TOTAL.	0	0	1
45000998	45	           IF WS-NUM-COUNT-TOTAL = ZERO	0	0	1
45000999	45	              MOVE SPACES TO WS-AMOUNT-UNSTR	0	0	1
45001000	45	              UNSTRING AMTI(1:AMTL)	0	0	1
45001001	45	                 INTO WS-AMOUNT-UNSTR	0	0	1
45001002	45	           ELSE	0	0	1
45001003	45	              MOVE SPACES TO WS-AMOUNT-UNSTR	0	0	1
45001004	45	              ADD 1 TO WS-NUM-COUNT-TOTAL GIVING WS-NUM-COUNT-TOTAL	0	0	1
45001005	45	              UNSTRING AMTI(WS-NUM-COUNT-TOTAL:AMTL)	0	0	1
45001006	45	                 INTO WS-AMOUNT-UNSTR	0	0	1
45001007	45	           END-IF.	0	0	1
45001009	45	           MOVE ZERO TO WS-NUM-COUNT-TOTAL.	0	0	1
45001011	45	           MOVE FUNCTION REVERSE(WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L))	0	0	1
45001012	45	              TO WS-AMOUNT-UNSTR-REVERSE	0	0	1
45001014	45	           INSPECT WS-AMOUNT-UNSTR-REVERSE	0	0	1
45001015	45	              TALLYING WS-NUM-COUNT-TOTAL	0	0	1
45001016	45	              FOR LEADING SPACES.	0	0	1
45001018	45	           SUBTRACT WS-NUM-COUNT-TOTAL FROM WS-AMOUNT-UNSTR-L	0	0	1
45001019	45	              GIVING WS-AMOUNT-UNSTR-L.	0	0	1
45001021	45	           MOVE ZERO TO WS-NUM-COUNT-TOTAL WS-NUM-COUNT-SPACE.	0	0	1
45001022	45	           INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)	0	0	1
45001023	45	              TALLYING	0	0	1
45001024	45	              WS-NUM-COUNT-TOTAL FOR ALL '0'	0	0	1
45001025	45	              WS-NUM-COUNT-TOTAL FOR ALL '1'	0	0	1
45001026	45	              WS-NUM-COUNT-TOTAL FOR ALL '2'	0	0	1
45001027	45	              WS-NUM-COUNT-TOTAL FOR ALL '3'	0	0	1
45001028	45	              WS-NUM-COUNT-TOTAL FOR ALL '4'	0	0	1
45001029	45	              WS-NUM-COUNT-TOTAL FOR ALL '5'	0	0	1
45001030	45	              WS-NUM-COUNT-TOTAL FOR ALL '6'	0	0	1
45001031	45	              WS-NUM-COUNT-TOTAL FOR ALL '7'	0	0	1
45001032	45	              WS-NUM-COUNT-TOTAL FOR ALL '8'	0	0	1
45001033	45	              WS-NUM-COUNT-TOTAL FOR ALL '9'	0	0	1
45001034	45	              WS-NUM-COUNT-TOTAL FOR ALL '.'	0	0	1
45001035	45	              WS-NUM-COUNT-SPACE FOR ALL ' '.	0	0	1
45001037	45	      *	1	0	0
45001038	45	      *       If there is a decimal point, the field is not numeric.	1	0	1
45001039	45	      *       But if it is 1.1 then it is valid. So first of all	1	0	1
45001040	45	      *       we check to see that only the above chars are	1	0	1
45001041	45	      *       valid.	1	0	1
45001042	45	      *       We DO NOT tolerate embedded spaces too	1	0	1
45001043	45	      *	1	0	1
45001044	45	           IF WS-NUM-COUNT-SPACE > 0	0	0	0
45001045	45	              MOVE SPACES TO MESSAGEO	0	0	1
45001046	45	              STRING	0	0	1
45001047	45	                 'Please supply a numeric amount without embedded'	0	0	1
45001048	45	                  DELIMITED BY SIZE,	0	0	1
45001049	45	                  ' spaces.' DELIMITED BY SPACES	0	0	1
45001050	45	              INTO MESSAGEO	0	0	1
45001051	45	              MOVE 'N' TO VALID-DATA-SW	0	0	1
45001052	45	              MOVE -1 TO AMTL	0	0	1
45001053	45	              GO TO VA999	0	0	1
45001054	45	           END-IF.	0	0	1
45001056	45	           IF WS-NUM-COUNT-TOTAL < WS-AMOUNT-UNSTR-L	0	0	1
45001057	45	              MOVE SPACES TO MESSAGEO	0	0	1
45001058	45	              STRING 'Please supply a numeric amount.'	0	0	1
45001059	45	                 DELIMITED BY SIZE,	0	0	1
45001060	45	                 INTO MESSAGEO	0	0	1
45001061	45	              MOVE 'N' TO VALID-DATA-SW	0	0	1
45001062	45	              MOVE -1 TO AMTL	0	0	1
45001063	45	              GO TO VA999	0	0	1
45001064	45	           END-IF.	0	0	1
45001066	45	      *	1	0	0
45001067	45	      *    Check that we have no or just one decimal point	1	0	1
45001068	45	      *	1	0	1
45001069	45	           MOVE ZERO TO WS-NUM-COUNT-POINT	0	0	0
45001070	45	           INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)	0	0	1
45001071	45	             TALLYING	0	0	1
45001072	45	             WS-NUM-COUNT-POINT FOR ALL '.'.	0	0	1
45001074	45	           IF WS-NUM-COUNT-POINT > 1	0	0	1
45001075	45	              MOVE SPACES TO MESSAGEO	0	0	1
45001076	45	              STRING 'Use one decimal point for amount only.'	0	0	1
45001077	45	                 DELIMITED BY SIZE,	0	0	1
45001078	45	              INTO MESSAGEO	0	0	1
45001080	45	              MOVE 'N' TO VALID-DATA-SW	0	0	1
45001081	45	              MOVE -1 TO AMTL	0	0	1
45001082	45	              GO TO VA999	0	0	1
45001083	45	           END-IF.	0	0	1
45001085	45	      *	1	0	0
45001086	45	      *    Have we got too many decimals?	1	0	1
45001087	45	      *	1	0	1
45001088	45	           IF WS-NUM-COUNT-POINT = 1	0	0	0
45001089	45	              MOVE ZERO TO WS-NUM-COUNT-TOTAL	0	0	1
45001090	45	              INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)	0	0	1
45001091	45	                 TALLYING WS-NUM-COUNT-TOTAL FOR CHARACTERS AFTER '.'	0	0	1
45001093	45	              IF WS-NUM-COUNT-TOTAL > 2	0	0	1
45001094	45	                 MOVE ZERO TO WS-NUM-COUNT-TOTAL WS-NUM-COUNT-POINT	0	0	1
45001095	45	                 INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)	0	0	1
45001096	45	                 TALLYING	0	0	1
45001097	45	                    WS-NUM-COUNT-POINT FOR CHARACTERS BEFORE '.'	0	0	1
45001098	45	                 ADD 2 TO WS-NUM-COUNT-POINT GIVING WS-NUM-COUNT-POINT	0	0	1
45001100	45	                 INSPECT	0	0	1
45001101	45	                 WS-AMOUNT-UNSTR(WS-NUM-COUNT-POINT:WS-AMOUNT-UNSTR-L)	0	0	1
45001102	45	                    TALLYING WS-NUM-COUNT-TOTAL FOR ALL '0'	0	0	1
45001103	45	                    WS-NUM-COUNT-TOTAL FOR ALL '1'	0	0	1
45001104	45	                    WS-NUM-COUNT-TOTAL FOR ALL '2'	0	0	1
45001105	45	                    WS-NUM-COUNT-TOTAL FOR ALL '3'	0	0	1
45001106	45	                    WS-NUM-COUNT-TOTAL FOR ALL '4'	0	0	1
45001107	45	                    WS-NUM-COUNT-TOTAL FOR ALL '5'	0	0	1
45001108	45	                    WS-NUM-COUNT-TOTAL FOR ALL '6'	0	0	1
45001109	45	                    WS-NUM-COUNT-TOTAL FOR ALL '7'	0	0	1
45001110	45	                    WS-NUM-COUNT-TOTAL FOR ALL '8'	0	0	1
45001111	45	                    WS-NUM-COUNT-TOTAL FOR ALL '9'	0	0	1
45001112	45	                    AFTER '.'	0	0	1
45001114	45	                 IF WS-NUM-COUNT-TOTAL > 2	0	0	1
45001115	45	      *	1	0	0
45001116	45	      *             There are two numerics	1	0	1
45001117	45	      *	1	0	1
45001118	45	                    MOVE SPACES TO MESSAGEO	0	0	0
45001119	45	                    STRING	0	0	1
45001120	45	                       'Only up to two decimal places are supported.'	0	0	1
45001121	45	                       DELIMITED BY SIZE,	0	0	1
45001122	45	                    INTO MESSAGEO	0	0	1
45001123	45	                    MOVE 'N' TO VALID-DATA-SW	0	0	1
45001124	45	                    MOVE -1 TO AMTL	0	0	1
45001125	45	                    GO TO VA999	0	0	1
45001126	45	                 END-IF	0	0	1
45001127	45	              END-IF	0	0	1
45001128	45	           END-IF.	0	0	1
45001130	45	           COMPUTE WS-AMOUNT-AS-FLOAT =	0	0	1
45001131	45	              FUNCTION NUMVAL(WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)).	0	0	1
45001133	45	           IF WS-AMOUNT-AS-FLOAT = ZERO	0	0	1
45001134	45	              MOVE SPACES TO MESSAGEO	0	0	1
45001135	45	              STRING	0	0	1
45001136	45	                 'Please supply a non-zero amount.'	0	0	1
45001137	45	                 DELIMITED BY SIZE,	0	0	1
45001138	45	              INTO MESSAGEO	0	0	1
45001139	45	              MOVE 'N' TO VALID-DATA-SW	0	0	1
45001140	45	              MOVE -1 TO AMTL	0	0	1
45001141	45	              GO TO VA999	0	0	1
45001142	45	           END-IF.	0	0	1
45001144	45	           MOVE SPACES TO MESSAGEO.	0	0	1
45001145	45	           MOVE 'Y' TO VALID-DATA-SW.	0	0	1
45001147	45	       VA999.	0	0	1
45001148	45	           EXIT.	0	0	1
45001151	45	       POPULATE-TIME-DATE SECTION.	0	0	1
45001152	45	       PTD010.	0	0	1
45001154	45	           EXEC CICS ASKTIME	0	0	1
45001155	45	              ABSTIME(WS-U-TIME)	0	0	1
45001156	45	           END-EXEC.	0	0	1
45001158	45	           EXEC CICS FORMATTIME	0	0	1
45001159	45	                     ABSTIME(WS-U-TIME)	0	0	1
45001160	45	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
45001161	45	                     TIME(WS-TIME-NOW)	0	0	1
45001162	45	                     DATESEP	0	0	1
45001163	45	           END-EXEC.	0	0	1
45001165	45	       PTD999.	0	0	1
45001166	45	           EXIT.	0	0	1
46000000	46	<<<< file not found >>>>	0	0	0
46000001	46	<<<< file not found >>>>	0	0	0
47000001	47	       CBL CICS('SP,EDF')	0	0	1
47000002	47	      ******************************************************************	1	0	0
47000003	47	      *                                                                *	1	0	1
47000004	47	      *  Copyright IBM Corp. 2023                                      *	1	0	1
47000005	47	      *                                                                *	1	0	1
47000006	47	      ******************************************************************	1	0	1
47000007	47	      ******************************************************************	1	0	1
47000008	47	      * This program is the dummy credit agency, used for credit	1	0	1
47000009	47	      * scoring. Data is passed to the program via a channel and	1	0	1
47000010	47	      * container and the role of this program is to delay for a	1	0	1
47000011	47	      * random amount of time (between 0 and 3 seconds) and to	1	0	1
47000012	47	      * create a random credit score (between 1 and 999), then finish.	1	0	1
47000013	47	      *	1	0	1
47000014	47	      * The purpose of the initial delay is to emulate data being	1	0	1
47000015	47	      * returned to the parent program (this program is driven using	1	0	1
47000016	47	      * the Async API). There is a delay of 3 seconds in the parent	1	0	1
47000017	47	      * so what this means is there a 1 in 4 chance that data will be	1	0	1
47000018	47	      * returned withing the overall 3 second delay - this emulates	1	0	1
47000019	47	      * not always being able to get a timely reply back to the parent.	1	0	1
47000020	47	      *	1	0	1
47000021	47	      *	1	0	1
47000022	47	      ******************************************************************	1	0	1
47000024	47	       IDENTIFICATION DIVISION.	0	0	0
47000025	47	       PROGRAM-ID. CRDTAGY5.	0	0	1
47000026	47	       AUTHOR. Jon Collett.	0	0	1
47000028	47	       ENVIRONMENT DIVISION.	0	0	1
47000029	47	       CONFIGURATION SECTION.	0	0	1
47000030	47	      * SOURCE-COMPUTER.  IBM-370 WITH DEBUGGING MODE.	1	0	0
47000031	47	       SOURCE-COMPUTER.  IBM-370.	0	0	0
47000032	47	       OBJECT-COMPUTER.  IBM-370.	0	0	1
47000034	47	       INPUT-OUTPUT SECTION.	0	0	1
47000036	47	       DATA DIVISION.	0	0	1
47000037	47	       FILE SECTION.	0	0	1
47000039	47	       WORKING-STORAGE SECTION.	0	0	1
47000041	47	       COPY SORTCODE.	0	0	1
47000044	47	       01 WS-CONT-IN.	0	0	1
47000045	47	          03 WS-CONT-IN-EYECATCHER      PIC X(4).	0	0	1
47000046	47	          03 WS-CONT-IN-KEY.	0	0	1
47000047	47	             05 WS-CONT-IN-SORTCODE     PIC 9(6) DISPLAY.	0	0	1
47000048	47	             05 WS-CONT-IN-NUMBER       PIC 9(10) DISPLAY.	0	0	1
47000049	47	          03 WS-CONT-IN-NAME            PIC X(60).	0	0	1
47000050	47	          03 WS-CONT-IN-ADDRESS         PIC X(160).	0	0	1
47000051	47	          03 WS-CONT-IN-DATE-OF-BIRTH   PIC 9(8).	0	0	1
47000052	47	          03 WS-CONT-IN-DOB-GROUP REDEFINES WS-CONT-IN-DATE-OF-BIRTH.	0	0	1
47000053	47	             05 WS-CONT-IN-BIRTH-DAY    PIC 99.	0	0	1
47000054	47	             05 WS-CONT-IN-BIRTH-MONTH  PIC 99.	0	0	1
47000055	47	             05 WS-CONT-IN-BIRTH-YEAR   PIC 9999.	0	0	1
47000056	47	          03 WS-CONT-IN-CREDIT-SCORE    PIC 999.	0	0	1
47000057	47	          03 WS-CONT-IN-CS-REVIEW-DATE  PIC 9(8).	0	0	1
47000058	47	          03 WS-CONT-IN-SUCCESS         PIC X.	0	0	1
47000059	47	          03 WS-CONT-IN-FAIL-CODE       PIC X.	0	0	1
47000061	47	       01 WS-CICS-WORK-AREA.	0	0	1
47000062	47	          05 WS-CICS-RESP               PIC S9(8) COMP.	0	0	1
47000063	47	          05 WS-CICS-RESP2              PIC S9(8) COMP.	0	0	1
47000066	47	       01 WS-DELAY-AMT                  PIC S9(8) COMP	0	0	1
47000067	47	                                                   VALUE 0.	0	0	1
47000069	47	       01 WS-CONTAINER-NAME             PIC X(16)  VALUE SPACES.	0	0	1
47000070	47	       01 WS-CHANNEL-NAME               PIC X(16)  VALUE SPACES.	0	0	1
47000072	47	       01 WS-CONTAINER-LEN              PIC S9(8) COMP	0	0	1
47000073	47	                                                   VALUE 0.	0	0	1
47000074	47	       01 WS-NEW-CREDSCORE              PIC 999    VALUE 0.	0	0	1
47000075	47	       01 WS-SEED                       PIC S9(15) COMP.	0	0	1
47000078	47	       01 WS-U-TIME                     PIC S9(15) COMP-3.	0	0	1
47000079	47	       01 WS-ORIG-DATE                  PIC X(10).	0	0	1
47000080	47	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
47000081	47	          03 WS-ORIG-DATE-DD            PIC 99.	0	0	1
47000082	47	          03 FILLER                     PIC X.	0	0	1
47000083	47	          03 WS-ORIG-DATE-MM            PIC 99.	0	0	1
47000084	47	          03 FILLER                     PIC X.	0	0	1
47000085	47	          03 WS-ORIG-DATE-YYYY          PIC 9999.	0	0	1
47000087	47	       01 WS-ORIG-DATE-GRP-X.	0	0	1
47000088	47	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
47000089	47	          03 FILLER                     PIC X      VALUE '.'.	0	0	1
47000090	47	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
47000091	47	          03 FILLER                     PIC X      VALUE '.'.	0	0	1
47000092	47	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
47000095	47	       01 WS-TIME-DATA.	0	0	1
47000096	47	          03 WS-TIME-NOW                PIC 9(6).	0	0	1
47000097	47	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
47000098	47	             05 WS-TIME-NOW-GRP-HH      PIC 99.	0	0	1
47000099	47	             05 WS-TIME-NOW-GRP-MM      PIC 99.	0	0	1
47000100	47	             05 WS-TIME-NOW-GRP-SS      PIC 99.	0	0	1
47000102	47	       01 WS-ABEND-PGM                  PIC X(8)   VALUE 'ABNDPROC'.	0	0	1
47000104	47	       01 ABNDINFO-REC.	0	0	1
47000105	47	           COPY ABNDINFO.	0	0	1
47000107	47	       LINKAGE SECTION.	0	0	1
47000110	47	       PROCEDURE DIVISION.	0	0	1
47000111	47	       PREMIERE SECTION.	0	0	1
47000112	47	       A010.	0	0	1
47000113	47	      *	1	0	0
47000114	47	      *    Generate a random  number of seconds between 0 & 3.	1	0	1
47000115	47	      *    This is the delay amount in seconds.	1	0	1
47000116	47	      *	1	0	1
47000119	47	           MOVE 'CIPE            ' TO WS-CONTAINER-NAME.	0	0	0
47000120	47	           MOVE 'CIPCREDCHANN    ' TO WS-CHANNEL-NAME.	0	0	1
47000121	47	           MOVE EIBTASKN           TO WS-SEED.	0	0	1
47000123	47	           COMPUTE WS-DELAY-AMT = ((3 - 1)	0	0	1
47000124	47	                            * FUNCTION RANDOM(WS-SEED)) + 1.	0	0	1
47000126	47	           EXEC CICS DELAY	0	0	1
47000127	47	                FOR SECONDS(WS-DELAY-AMT)	0	0	1
47000128	47	                RESP(WS-CICS-RESP)	0	0	1
47000129	47	                RESP2(WS-CICS-RESP2)	0	0	1
47000130	47	           END-EXEC.	0	0	1
47000132	47	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
47000133	47	      *	1	0	0
47000134	47	      *       Preserve the RESP and RESP2, then set up the	1	0	1
47000135	47	      *       standard ABEND info before getting the applid,	1	0	1
47000136	47	      *       date/time etc. and linking to the Abend Handler	1	0	1
47000137	47	      *       program.	1	0	1
47000138	47	      *	1	0	1
47000139	47	              INITIALIZE ABNDINFO-REC	0	0	0
47000140	47	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
47000141	47	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
47000142	47	      *	1	0	0
47000143	47	      *       Get supplemental information	1	0	1
47000144	47	      *	1	0	1
47000145	47	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
47000146	47	              END-EXEC	0	0	1
47000148	47	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
47000149	47	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
47000151	47	              PERFORM POPULATE-TIME-DATE	0	0	1
47000153	47	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
47000154	47	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
47000155	47	                      ':' DELIMITED BY SIZE,	0	0	1
47000156	47	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
47000157	47	                       ':' DELIMITED BY SIZE,	0	0	1
47000158	47	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
47000159	47	                       INTO ABND-TIME	0	0	1
47000160	47	              END-STRING	0	0	1
47000162	47	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
47000163	47	              MOVE 'PLOP'      TO ABND-CODE	0	0	1
47000165	47	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
47000166	47	              END-EXEC	0	0	1
47000168	47	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
47000170	47	              STRING 'A010  - *** The delay messed up! ***'	0	0	1
47000171	47	                      DELIMITED BY SIZE,	0	0	1
47000172	47	                      ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
47000173	47	                      ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
47000174	47	                      ' RESP2=' DELIMITED BY SIZE,	0	0	1
47000175	47	                      ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
47000176	47	                      INTO ABND-FREEFORM	0	0	1
47000177	47	              END-STRING	0	0	1
47000179	47	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
47000180	47	                          COMMAREA(ABNDINFO-REC)	0	0	1
47000181	47	              END-EXEC	0	0	1
47000184	47	              DISPLAY '*** The delay messed up ! ***'	0	0	1
47000185	47	              EXEC CICS ABEND	0	0	1
47000186	47	                 ABCODE('PLOP')	0	0	1
47000187	47	              END-EXEC	0	0	1
47000188	47	           END-IF.	0	0	1
47000190	47	           COMPUTE WS-CONTAINER-LEN = LENGTH OF WS-CONT-IN.	0	0	1
47000192	47	           EXEC CICS GET CONTAINER(WS-CONTAINER-NAME)	0	0	1
47000193	47	                     CHANNEL(WS-CHANNEL-NAME)	0	0	1
47000194	47	                     INTO(WS-CONT-IN)	0	0	1
47000195	47	                     FLENGTH(WS-CONTAINER-LEN)	0	0	1
47000196	47	                     RESP(WS-CICS-RESP)	0	0	1
47000197	47	                     RESP2(WS-CICS-RESP2)	0	0	1
47000198	47	           END-EXEC.	0	0	1
47000200	47	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
47000201	47	              DISPLAY 'CRDTAGY5 - UNABLE TO GET CONTAINER. RESP='	0	0	1
47000202	47	                 WS-CICS-RESP ', RESP2=' WS-CICS-RESP2	0	0	1
47000203	47	              DISPLAY 'CONTAINER=' WS-CONTAINER-NAME ' CHANNEL='	0	0	1
47000204	47	                       WS-CHANNEL-NAME ' FLENGTH='	0	0	1
47000205	47	                       WS-CONTAINER-LEN	0	0	1
47000206	47	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
47000207	47	           END-IF.	0	0	1
47000210	47	      *	1	0	0
47000211	47	      *    Now generate a credit score between 1 and 999. Because we	1	0	1
47000212	47	      *    used a SEED on the first RANDOM (above) we don't need to	1	0	1
47000213	47	      *    use a SEED again when using RANDOM for a subsequent time	1	0	1
47000214	47	      *	1	0	1
47000216	47	           COMPUTE WS-NEW-CREDSCORE = ((999 - 1)	0	0	0
47000217	47	                            * FUNCTION RANDOM) + 1.	0	0	1
47000219	47	           MOVE WS-NEW-CREDSCORE TO WS-CONT-IN-CREDIT-SCORE.	0	0	1
47000222	47	      *	1	0	0
47000223	47	      *    Now PUT the data back into a container	1	0	1
47000224	47	      *	1	0	1
47000225	47	           COMPUTE WS-CONTAINER-LEN = LENGTH OF WS-CONT-IN.	0	0	0
47000227	47	           EXEC CICS PUT CONTAINER(WS-CONTAINER-NAME)	0	0	1
47000228	47	                         FROM(WS-CONT-IN)	0	0	1
47000229	47	                         FLENGTH(WS-CONTAINER-LEN)	0	0	1
47000230	47	                         CHANNEL(WS-CHANNEL-NAME)	0	0	1
47000231	47	                         RESP(WS-CICS-RESP)	0	0	1
47000232	47	                         RESP2(WS-CICS-RESP2)	0	0	1
47000233	47	           END-EXEC.	0	0	1
47000235	47	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
47000236	47	              DISPLAY 'CRDTAGY5- UNABLE TO PUT CONTAINER. RESP='	0	0	1
47000237	47	                 WS-CICS-RESP ', RESP2=' WS-CICS-RESP2	0	0	1
47000238	47	              DISPLAY  'CONTAINER='  WS-CONTAINER-NAME	0	0	1
47000239	47	              ' CHANNEL=' WS-CHANNEL-NAME ' FLENGTH='	0	0	1
47000240	47	                    WS-CONTAINER-LEN	0	0	1
47000241	47	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
47000242	47	           END-IF.	0	0	1
47000244	47	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
47000246	47	       A999.	0	0	1
47000247	47	           EXIT.	0	0	1
47000250	47	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
47000251	47	       GMOFH010.	0	0	1
47000253	47	           EXEC CICS RETURN	0	0	1
47000254	47	           END-EXEC.	0	0	1
47000256	47	       GMOFH999.	0	0	1
47000257	47	           EXIT.	0	0	1
47000260	47	       POPULATE-TIME-DATE SECTION.	0	0	1
47000261	47	       PTD010.	0	0	1
47000263	47	           EXEC CICS ASKTIME	0	0	1
47000264	47	              ABSTIME(WS-U-TIME)	0	0	1
47000265	47	           END-EXEC.	0	0	1
47000267	47	           EXEC CICS FORMATTIME	0	0	1
47000268	47	                     ABSTIME(WS-U-TIME)	0	0	1
47000269	47	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
47000270	47	                     TIME(WS-TIME-NOW)	0	0	1
47000271	47	                     DATESEP	0	0	1
47000272	47	           END-EXEC.	0	0	1
47000274	47	       PTD999.	0	0	1
47000275	47	           EXIT.	0	0	1
48000001	48	       CBL CICS('SP,EDF')	0	0	1
48000002	48	      ******************************************************************	1	0	0
48000003	48	      *                                                                *	1	0	1
48000004	48	      *  Copyright IBM Corp. 2023                                      *	1	0	1
48000005	48	      *                                                                *	1	0	1
48000006	48	      ******************************************************************	1	0	1
48000008	48	      ******************************************************************	1	0	1
48000009	48	      * This program takes customer number as input	1	0	1
48000010	48	      * and returns to the calling program a commarea containing all of	1	0	1
48000011	48	      * the customer information for that record.	1	0	1
48000012	48	      *	1	0	1
48000013	48	      * What gets returned is the CUSTOMER data if the CUSTOMER is	1	0	1
48000014	48	      * found or a CUSTOMER record set to low values if a matching	1	0	1
48000015	48	      * CUSTOMER record could not be found.	1	0	1
48000016	48	      *	1	0	1
48000017	48	      * If there is any kind of problem then an appropriate abend is	1	0	1
48000018	48	      * issued.	1	0	1
48000019	48	      *	1	0	1
48000020	48	      ******************************************************************	1	0	1
48000022	48	       IDENTIFICATION DIVISION.	0	0	0
48000023	48	       PROGRAM-ID. INQCUST.	0	0	1
48000024	48	       AUTHOR. Jon Collett.	0	0	1
48000026	48	       ENVIRONMENT DIVISION.	0	0	1
48000027	48	       CONFIGURATION SECTION.	0	0	1
48000028	48	      *SOURCE-COMPUTER.  IBM-370 WITH DEBUGGING MODE.	1	0	0
48000029	48	       SOURCE-COMPUTER.  IBM-370.	0	0	0
48000030	48	       OBJECT-COMPUTER.  IBM-370.	0	0	1
48000031	48	       INPUT-OUTPUT SECTION.	0	0	1
48000033	48	       DATA DIVISION.	0	0	1
48000034	48	       FILE SECTION.	0	0	1
48000036	48	       WORKING-STORAGE SECTION.	0	0	1
48000038	48	       77 SYSIDERR-RETRY               PIC 999.	0	0	1
48000039	48	       77 INQCUST-RETRY                PIC 9999.	0	0	1
48000041	48	       01 WS-CICS-WORK-AREA.	0	0	1
48000042	48	          03 WS-CICS-RESP              PIC S9(8) COMP.	0	0	1
48000043	48	          03 WS-CICS-RESP2             PIC S9(8) COMP.	0	0	1
48000045	48	       LOCAL-STORAGE SECTION.	0	0	1
48000046	48	       COPY SORTCODE.	0	0	1
48000050	48	       01 OUTPUT-DATA.	0	0	1
48000051	48	           COPY CUSTOMER.	0	0	1
48000053	48	       01 CUSTOMER-KY.	0	0	1
48000054	48	          03 REQUIRED-SORT-CODE        PIC 9(6) VALUE 0.	0	0	1
48000055	48	          03 REQUIRED-CUST-NUMBER      PIC 9(10) VALUE 0.	0	0	1
48000057	48	       01 CUSTOMER-KY2.	0	0	1
48000058	48	          03 REQUIRED-SORT-CODE2       PIC 9(6) VALUE 0.	0	0	1
48000059	48	          03 REQUIRED-CUST-NUMBER2     PIC 9(10) VALUE 0.	0	0	1
48000061	48	       01 RANDOM-CUSTOMER              PIC 9(10) VALUE 0.	0	0	1
48000062	48	       01 HIGHEST-CUST-NUMBER          PIC 9(10) VALUE 0.	0	0	1
48000064	48	       01 EXIT-VSAM-READ               PIC X VALUE 'N'.	0	0	1
48000065	48	       01 EXIT-DB2-READ                PIC X VALUE 'N'.	0	0	1
48000066	48	       01 EXIT-IMS-READ                PIC X VALUE 'N'.	0	0	1
48000069	48	       01 WS-V-RETRIED                 PIC X VALUE 'N'.	0	0	1
48000070	48	       01 WS-D-RETRIED                 PIC X VALUE 'N'.	0	0	1
48000072	48	       01 WS-PROGRAM                   PIC X(8) VALUE SPACES.	0	0	1
48000075	48	      *	1	0	0
48000076	48	      * CUSTOMER NCS definitions	1	0	1
48000077	48	      *	1	0	1
48000078	48	       01 NCS-CUST-NO-STUFF.	0	0	0
48000079	48	          03 NCS-CUST-NO-NAME.	0	0	1
48000080	48	             05 NCS-CUST-NO-ACT-NAME   PIC X(8) VALUE 'HBNKCUST'.	0	0	1
48000081	48	             05 NCS-CUST-NO-TEST-SORT  PIC X(6) VALUE '      '.	0	0	1
48000082	48	             05 NCS-CUST-NO-FILL       PIC XX VALUE '  '.	0	0	1
48000084	48	          03 NCS-CUST-NO-INC           PIC 9(16) COMP VALUE 0.	0	0	1
48000085	48	          03 NCS-CUST-NO-VALUE         PIC 9(16) COMP VALUE 0.	0	0	1
48000087	48	          03 NCS-CUST-NO-RESP          PIC XX VALUE '00'.	0	0	1
48000090	48	       01 WS-PASSED-DATA.	0	0	1
48000091	48	          02 WS-TEST-KEY               PIC X(4).	0	0	1
48000092	48	          02 WS-SORT-CODE              PIC 9(6).	0	0	1
48000093	48	          02 WS-CUSTOMER-RANGE.	0	0	1
48000094	48	             07 WS-CUSTOMER-RANGE-TOP             PIC X.	0	0	1
48000095	48	             07 WS-CUSTOMER-RANGE-MIDDLE          PIC X.	0	0	1
48000096	48	             07 WS-CUSTOMER-RANGE-BOTTOM          PIC X.	0	0	1
48000098	48	       01 WS-SORT-DIV.	0	0	1
48000099	48	          03 WS-SORT-DIV1              PIC XX.	0	0	1
48000100	48	          03 WS-SORT-DIV2              PIC XX.	0	0	1
48000101	48	          03 WS-SORT-DIV3              PIC XX.	0	0	1
48000103	48	       01 WS-DISP-CUST-NO-VAL          PIC S9(18) DISPLAY.	0	0	1
48000105	48	       01 VAR-REMIX.	0	0	1
48000106	48	          03 REMIX-SCODE               PIC X(6).	0	0	1
48000107	48	          03 REMIX-NUM REDEFINES REMIX-SCODE.	0	0	1
48000108	48	             05 REMIX-SCODE-NUM        PIC 9(6).	0	0	1
48000110	48	       01 VAR-REMIX2.	0	0	1
48000111	48	          03 REMIX2-CREDIT-SCR         PIC X(3).	0	0	1
48000112	48	          03 REMIX2-NUM REDEFINES REMIX2-CREDIT-SCR.	0	0	1
48000113	48	             05 REMIX2-CREDIT-SCR-NUM  PIC 9(3).	0	0	1
48000115	48	       01 MY-ABEND-CODE                PIC XXXX.	0	0	1
48000117	48	       01 WS-STORM-DRAIN               PIC X VALUE 'N'.	0	0	1
48000118	48	       01 STORM-DRAIN-CONDITION        PIC X(20).	0	0	1
48000120	48	       01 SQLCODE-DISPLAY              PIC S9(8) DISPLAY	0	0	1
48000121	48	           SIGN LEADING SEPARATE.	0	0	1
48000123	48	        01 WS-INVOKING-PROGRAM         PIC X(8).	0	0	1
48000125	48	       01 WS-POINTER USAGE POINTER.	0	0	1
48000126	48	       01 WS-POINTER-BYTES   REDEFINES WS-POINTER PIC X(8).	0	0	1
48000127	48	       01 WS-POINTER-NUMBER  REDEFINES WS-POINTER PIC 9(8) BINARY.	0	0	1
48000129	48	       01 WS-POINTER-NUMBER-DISPLAY    PIC 9(8) DISPLAY.	0	0	1
48000131	48	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
48000132	48	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
48000133	48	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
48000134	48	          03 WS-ORIG-DATE-DD           PIC 99.	0	0	1
48000135	48	          03 FILLER                    PIC X.	0	0	1
48000136	48	          03 WS-ORIG-DATE-MM           PIC 99.	0	0	1
48000137	48	          03 FILLER                    PIC X.	0	0	1
48000138	48	          03 WS-ORIG-DATE-YYYY         PIC 9999.	0	0	1
48000140	48	       01 WS-ORIG-DATE-GRP-X.	0	0	1
48000141	48	          03 WS-ORIG-DATE-DD-X         PIC XX.	0	0	1
48000142	48	          03 FILLER                    PIC X VALUE '.'.	0	0	1
48000143	48	          03 WS-ORIG-DATE-MM-X         PIC XX.	0	0	1
48000144	48	          03 FILLER                    PIC X VALUE '.'.	0	0	1
48000145	48	          03 WS-ORIG-DATE-YYYY-X       PIC X(4).	0	0	1
48000147	48	       01 WS-TIME-DATA.	0	0	1
48000148	48	           03 WS-TIME-NOW              PIC 9(6).	0	0	1
48000149	48	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
48000150	48	              05 WS-TIME-NOW-GRP-HH    PIC 99.	0	0	1
48000151	48	              05 WS-TIME-NOW-GRP-MM    PIC 99.	0	0	1
48000152	48	              05 WS-TIME-NOW-GRP-SS    PIC 99.	0	0	1
48000154	48	       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.	0	0	1
48000156	48	       01 ABNDINFO-REC.	0	0	1
48000157	48	           COPY ABNDINFO.	0	0	1
48000160	48	       LINKAGE SECTION.	0	0	1
48000161	48	       01 DFHCOMMAREA.	0	0	1
48000162	48	           COPY INQCUST.	0	0	1
48000165	48	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
48000166	48	       PREMIERE SECTION.	0	0	1
48000167	48	       P010.	0	0	1
48000168	48	      *	1	0	0
48000169	48	      *    Set up abend handling	1	0	1
48000170	48	      *	1	0	1
48000171	48	           EXEC CICS HANDLE ABEND	0	0	0
48000172	48	              LABEL(ABEND-HANDLING)	0	0	1
48000173	48	           END-EXEC.	0	0	1
48000175	48	           MOVE 'N' TO INQCUST-INQ-SUCCESS	0	0	1
48000176	48	           MOVE '0' TO INQCUST-INQ-FAIL-CD	0	0	1
48000178	48	           MOVE SORTCODE TO REQUIRED-SORT-CODE.	0	0	1
48000179	48	           MOVE INQCUST-CUSTNO TO REQUIRED-CUST-NUMBER.	0	0	1
48000180	48	      *	1	0	0
48000181	48	      *    Is the incoming CUSTOMER number set to 0's, 9's or	1	0	1
48000182	48	      *    an actual value?	1	0	1
48000183	48	      *	1	0	1
48000184	48	      *    If the incoming CUSTOMER number is 0's (random	1	0	1
48000185	48	      *    customer) or the incoming CUSTOMER number is 9's	1	0	1
48000186	48	      *    (the last valid CUSTOMER in use) then access the	1	0	1
48000187	48	      *    named counter server to get the last	1	0	1
48000188	48	      *    CUSTOMER-NUMBER in use.	1	0	1
48000189	48	      *	1	0	1
48000190	48	           IF INQCUST-CUSTNO = 0000000000 OR INQCUST-CUSTNO = 9999999999	0	0	0
48000191	48	              PERFORM READ-CUSTOMER-NCS	0	0	1
48000192	48	      D       DISPLAY 'CUST NO RETURNED FROM NCS=' NCS-CUST-NO-VALUE	0	0	1
48000193	48	              IF INQCUST-INQ-SUCCESS = 'Y'	0	0	1
48000194	48	                MOVE NCS-CUST-NO-VALUE TO REQUIRED-CUST-NUMBER	0	0	1
48000195	48	              ELSE	0	0	1
48000196	48	                PERFORM GET-ME-OUT-OF-HERE	0	0	1
48000197	48	              END-IF	0	0	1
48000198	48	           END-IF.	0	0	1
48000199	48	      *	1	0	0
48000200	48	      * For a random customer generate a CUSTOMER number	1	0	1
48000201	48	      * randomly which is less than the highest CUSTOMER	1	0	1
48000202	48	      * number that is currently in use.	1	0	1
48000203	48	      *	1	0	1
48000204	48	           IF INQCUST-CUSTNO = 0000000000	0	0	0
48000205	48	              PERFORM GENERATE-RANDOM-CUSTOMER	0	0	1
48000206	48	              MOVE RANDOM-CUSTOMER TO REQUIRED-CUST-NUMBER	0	0	1
48000207	48	           END-IF.	0	0	1
48000208	48	           MOVE 'N' TO EXIT-VSAM-READ.	0	0	1
48000209	48	           MOVE 'N' TO EXIT-DB2-READ.	0	0	1
48000210	48	           MOVE 'N' TO WS-D-RETRIED.	0	0	1
48000211	48	           MOVE 'N' TO WS-V-RETRIED.	0	0	1
48000212	48	      *	1	0	0
48000213	48	      *          Get the customer information	1	0	1
48000214	48	      *	1	0	1
48000215	48	           PERFORM READ-CUSTOMER-VSAM	0	0	0
48000216	48	             UNTIL EXIT-VSAM-READ = 'Y'.	0	0	1
48000217	48	      *	1	0	0
48000218	48	      * Return the CUSTOMER data in the commarea.	1	0	1
48000219	48	      *	1	0	1
48000220	48	           IF INQCUST-INQ-SUCCESS = 'Y'	0	0	0
48000221	48	             MOVE '0' TO INQCUST-INQ-FAIL-CD	0	0	1
48000222	48	             MOVE CUSTOMER-EYECATCHER OF OUTPUT-DATA	0	0	1
48000223	48	                TO INQCUST-EYE	0	0	1
48000224	48	             MOVE CUSTOMER-SORTCODE OF OUTPUT-DATA	0	0	1
48000225	48	                TO INQCUST-SCODE	0	0	1
48000226	48	             MOVE CUSTOMER-NUMBER OF OUTPUT-DATA	0	0	1
48000227	48	                TO INQCUST-CUSTNO	0	0	1
48000228	48	             MOVE CUSTOMER-NAME OF OUTPUT-DATA	0	0	1
48000229	48	                TO INQCUST-NAME	0	0	1
48000230	48	             MOVE CUSTOMER-ADDRESS OF OUTPUT-DATA	0	0	1
48000231	48	                TO INQCUST-ADDR	0	0	1
48000232	48	             MOVE CUSTOMER-DATE-OF-BIRTH OF OUTPUT-DATA	0	0	1
48000233	48	                TO INQCUST-DOB	0	0	1
48000234	48	             MOVE CUSTOMER-CREDIT-SCORE OF OUTPUT-DATA	0	0	1
48000235	48	                TO INQCUST-CREDIT-SCORE	0	0	1
48000236	48	             MOVE CUSTOMER-CS-REVIEW-DATE OF OUTPUT-DATA	0	0	1
48000237	48	                TO INQCUST-CS-REVIEW-DT	0	0	1
48000238	48	           END-IF.	0	0	1
48000240	48	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
48000242	48	       P999.	0	0	1
48000243	48	           EXIT.	0	0	1
48000246	48	       READ-CUSTOMER-NCS SECTION.	0	0	1
48000247	48	       RCN010.	0	0	1
48000248	48	      *	1	0	0
48000249	48	      *    Retrieve the last CUSTOMER number in use	1	0	1
48000250	48	      *	1	0	1
48000251	48	           PERFORM GET-LAST-CUSTOMER-VSAM	0	0	0
48000252	48	           IF INQCUST-INQ-SUCCESS = 'Y'	0	0	1
48000253	48	             MOVE REQUIRED-CUST-NUMBER2 TO NCS-CUST-NO-VALUE	0	0	1
48000254	48	           END-IF.	0	0	1
48000255	48	       RCN999.	0	0	1
48000256	48	           EXIT.	0	0	1
48000258	48	       READ-CUSTOMER-VSAM SECTION.	0	0	1
48000259	48	       RCV010.	0	0	1
48000260	48	      *	1	0	0
48000261	48	      *    Read the VSAM CUSTOMER file	1	0	1
48000262	48	      *	1	0	1
48000263	48	           INITIALIZE OUTPUT-DATA.	0	0	0
48000265	48	           EXEC CICS READ FILE('CUSTOMER')	0	0	1
48000266	48	                RIDFLD(CUSTOMER-KY)	0	0	1
48000267	48	                INTO(OUTPUT-DATA)	0	0	1
48000268	48	                RESP(WS-CICS-RESP)	0	0	1
48000269	48	                RESP2(WS-CICS-RESP2)	0	0	1
48000270	48	           END-EXEC.	0	0	1
48000272	48	      *	1	0	0
48000273	48	      *    Check that the READ was successful. If it was	1	0	1
48000274	48	      *    exit this loop	1	0	1
48000275	48	      *	1	0	1
48000276	48	           IF WS-CICS-RESP = DFHRESP(NORMAL)	0	0	0
48000277	48	              MOVE 'Y' TO EXIT-VSAM-READ	0	0	1
48000278	48	              MOVE 'Y' TO INQCUST-INQ-SUCCESS	0	0	1
48000279	48	              GO TO RCV999	0	0	1
48000280	48	           END-IF.	0	0	1
48000282	48	           IF WS-CICS-RESP = DFHRESP(SYSIDERR)	0	0	1
48000283	48	              PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1	0	0	1
48000284	48	              UNTIL SYSIDERR-RETRY > 100	0	0	1
48000285	48	              OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)	0	0	1
48000287	48	                 EXEC CICS DELAY FOR SECONDS(3)	0	0	1
48000288	48	                 END-EXEC	0	0	1
48000290	48	                 EXEC CICS READ FILE('CUSTOMER')	0	0	1
48000291	48	                    RIDFLD(CUSTOMER-KY)	0	0	1
48000292	48	                    INTO(OUTPUT-DATA)	0	0	1
48000293	48	                    RESP(WS-CICS-RESP)	0	0	1
48000294	48	                    RESP2(WS-CICS-RESP2)	0	0	1
48000295	48	                  END-EXEC	0	0	1
48000297	48	                  IF WS-CICS-RESP = DFHRESP(NORMAL)	0	0	1
48000298	48	                     MOVE 'Y' TO EXIT-VSAM-READ	0	0	1
48000299	48	                     MOVE 'Y' TO INQCUST-INQ-SUCCESS	0	0	1
48000300	48	                     GO TO RCV999	0	0	1
48000301	48	                  END-IF	0	0	1
48000302	48	              END-PERFORM	0	0	1
48000303	48	           END-IF.	0	0	1
48000305	48	      * If the customer record was NOT found and the incoming	1	0	0
48000306	48	      * customer was 0000000000 (i.e. generate a random	1	0	1
48000307	48	      * customer number) then have another go at generating a	1	0	1
48000308	48	      * different random customer number and try reading that.	1	0	1
48000309	48	      *	1	0	1
48000310	48	           IF WS-CICS-RESP = DFHRESP(NOTFND) AND	0	0	0
48000311	48	              INQCUST-CUSTNO = 0000000000	0	0	1
48000312	48	            IF INQCUST-RETRY < 1000	0	0	1
48000313	48	                PERFORM GENERATE-RANDOM-CUSTOMER-AGAIN	0	0	1
48000314	48	                MOVE RANDOM-CUSTOMER TO REQUIRED-CUST-NUMBER	0	0	1
48000315	48	                GO TO RCV999	0	0	1
48000316	48	              ELSE	0	0	1
48000317	48	                MOVE 'Y' TO EXIT-VSAM-READ	0	0	1
48000318	48	                MOVE 'N' TO INQCUST-INQ-SUCCESS	0	0	1
48000319	48	                MOVE '1' TO INQCUST-INQ-FAIL-CD	0	0	1
48000320	48	                GO TO RCV999	0	0	1
48000321	48	              END-IF	0	0	1
48000322	48	           END-IF.	0	0	1
48000323	48	           IF WS-CICS-RESP = DFHRESP(NOTFND) AND	0	0	1
48000324	48	           INQCUST-CUSTNO = 9999999999 AND	0	0	1
48000325	48	           WS-V-RETRIED = 'N'	0	0	1
48000326	48	              PERFORM GET-LAST-CUSTOMER-VSAM	0	0	1
48000327	48	      D       DISPLAY 'CUSTOMER NUMBER RETURNED FROM NCS IS='	0	0	1
48000328	48	      D           NCS-CUST-NO-VALUE	0	0	1
48000329	48	              MOVE NCS-CUST-NO-VALUE TO REQUIRED-CUST-NUMBER	0	0	1
48000330	48	              MOVE 'Y' TO WS-V-RETRIED	0	0	1
48000331	48	              GO TO RCV999	0	0	1
48000332	48	           END-IF.	0	0	1
48000333	48	      *	1	0	0
48000334	48	      *    If the customer record was NOT found	1	0	1
48000335	48	      *    we must return the customer number with an initialised	1	0	1
48000336	48	      *    output record (this will indicate that the supplied	1	0	1
48000337	48	      *    customer number was a dud.	1	0	1
48000338	48	      *	1	0	1
48000339	48	           IF (WS-CICS-RESP = DFHRESP(NOTFND)	0	0	0
48000340	48	                AND INQCUST-CUSTNO NOT = 9999999999)	0	0	1
48000341	48	                AND (WS-CICS-RESP = DFHRESP(NOTFND)	0	0	1
48000342	48	                AND INQCUST-CUSTNO NOT = 0000000000)	0	0	1
48000343	48	              MOVE REQUIRED-CUST-NUMBER TO CUSTOMER-NUMBER	0	0	1
48000344	48	                                           OF OUTPUT-DATA	0	0	1
48000345	48	              MOVE 'Y' TO EXIT-VSAM-READ	0	0	1
48000346	48	              MOVE 'N' TO INQCUST-INQ-SUCCESS	0	0	1
48000347	48	              MOVE '1' TO INQCUST-INQ-FAIL-CD	0	0	1
48000348	48	              MOVE SPACES TO INQCUST-ADDR	0	0	1
48000349	48	              MOVE SPACES TO INQCUST-NAME	0	0	1
48000350	48	              GO TO RCV999	0	0	1
48000351	48	           END-IF.	0	0	1
48000353	48	      *	1	0	0
48000354	48	      *    If something else went wrong all we can do is report it	1	0	1
48000355	48	      *    and abend	1	0	1
48000356	48	      *	1	0	1
48000357	48	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	0
48000358	48	      *	1	0	0
48000359	48	      *       Preserve the RESP and RESP2, then set up the	1	0	1
48000360	48	      *       standard ABEND info before getting the applid,	1	0	1
48000361	48	      *       date/time etc. and linking to the Abend Handler	1	0	1
48000362	48	      *       program.	1	0	1
48000363	48	      *	1	0	1
48000364	48	              INITIALIZE ABNDINFO-REC	0	0	0
48000365	48	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
48000366	48	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
48000367	48	      *	1	0	0
48000368	48	      *       Get supplemental information	1	0	1
48000369	48	      *	1	0	1
48000370	48	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
48000371	48	              END-EXEC	0	0	1
48000373	48	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
48000374	48	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
48000376	48	              PERFORM POPULATE-TIME-DATE	0	0	1
48000378	48	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
48000379	48	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
48000380	48	                    ':' DELIMITED BY SIZE,	0	0	1
48000381	48	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
48000382	48	                     ':' DELIMITED BY SIZE,	0	0	1
48000383	48	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
48000384	48	                     INTO ABND-TIME	0	0	1
48000385	48	              END-STRING	0	0	1
48000387	48	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
48000388	48	              MOVE 'CVR1'      TO ABND-CODE	0	0	1
48000390	48	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
48000391	48	              END-EXEC	0	0	1
48000393	48	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
48000395	48	              STRING 'RCV010 - CUSTOMER VSAM RECORD KEY='	0	0	1
48000396	48	                    DELIMITED BY SIZE,	0	0	1
48000397	48	                    CUSTOMER-KY DELIMITED SIZE,	0	0	1
48000398	48	                    ' GAVE VSAM RC=' DELIMITED BY SIZE,	0	0	1
48000399	48	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
48000400	48	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
48000401	48	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
48000402	48	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
48000403	48	                    INTO ABND-FREEFORM	0	0	1
48000404	48	              END-STRING	0	0	1
48000406	48	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
48000407	48	                        COMMAREA(ABNDINFO-REC)	0	0	1
48000408	48	              END-EXEC	0	0	1
48000410	48	              DISPLAY 'CUSTOMER VSAM RECORD KEY='	0	0	1
48000411	48	                  CUSTOMER-KY ' GAVE VSAM RC='	0	0	1
48000412	48	                  WS-CICS-RESP	0	0	1
48000414	48	              IF WS-V-RETRIED = 'Y'	0	0	1
48000415	48	                 DISPLAY 'ON A RETRY'	0	0	1
48000416	48	              END-IF	0	0	1
48000418	48	              EXEC CICS ABEND ABCODE('CVR1')	0	0	1
48000419	48	                 CANCEL	0	0	1
48000420	48	              END-EXEC	0	0	1
48000422	48	           END-IF.	0	0	1
48000424	48	       RCV999.	0	0	1
48000425	48	           EXIT.	0	0	1
48000428	48	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
48000429	48	       GMOFH010.	0	0	1
48000430	48	      *	1	0	0
48000431	48	      *    Finish	1	0	1
48000432	48	      *	1	0	1
48000433	48	           EXEC CICS RETURN	0	0	0
48000434	48	           END-EXEC.	0	0	1
48000436	48	       GMOFH999.	0	0	1
48000437	48	           EXIT.	0	0	1
48000440	48	       ABEND-HANDLING SECTION.	0	0	1
48000441	48	       AH010.	0	0	1
48000442	48	      *	1	0	0
48000443	48	      * How ABENDs are dealt with	1	0	1
48000444	48	      *	1	0	1
48000445	48	           EXEC CICS ASSIGN	0	0	0
48000446	48	              ABCODE(MY-ABEND-CODE)	0	0	1
48000447	48	           END-EXEC.	0	0	1
48000449	48	      *    Evaluate the Abend code that is returned	1	0	0
48000450	48	      *    for DB2 AD2Z ... provide some diagnostics,	1	0	1
48000451	48	      *    for VSAM RLS abends: AFCR, AFCS and AFCT record the	1	0	1
48000452	48	      *    abend as happening but do not abend ... leave this to	1	0	1
48000453	48	      *    CPSM WLM "Storm drain" (Abend probability) to handle.	1	0	1
48000454	48	      *    If not a "storm drain" ... take the abend afterwards	1	0	1
48000455	48	      *	1	0	1
48000456	48	           EVALUATE MY-ABEND-CODE	0	0	0
48000459	48	      *	1	0	0
48000460	48	      *      VSAM RLS abends, subject to CPSM WLM Storm Drain check	1	0	1
48000461	48	      *      if handled (as here) and Workload Abend Thresholds are	1	0	1
48000462	48	      *      set.	1	0	1
48000463	48	      *	1	0	1
48000464	48	             WHEN 'AFCR'	0	0	0
48000465	48	             WHEN 'AFCS'	0	0	1
48000466	48	             WHEN 'AFCT'	0	0	1
48000467	48	               MOVE 'Y' TO WS-STORM-DRAIN	0	0	1
48000468	48	               DISPLAY 'INQCUST: Check-For-Storm-Drain-VSAM: Storm '	0	0	1
48000469	48	                       'Drain condition (Abend ' MY-ABEND-CODE ') '	0	0	1
48000470	48	                       'has been met.'	0	0	1
48000472	48	               EXEC CICS SYNCPOINT ROLLBACK	0	0	1
48000473	48	                   RESP(WS-CICS-RESP)	0	0	1
48000474	48	                   RESP2(WS-CICS-RESP2)	0	0	1
48000475	48	               END-EXEC	0	0	1
48000477	48	               IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
48000479	48	      *	1	0	0
48000480	48	      *          Preserve the RESP and RESP2, then set up the	1	0	1
48000481	48	      *          standard ABEND info before getting the applid,	1	0	1
48000482	48	      *          date/time etc. and linking to the Abend Handler	1	0	1
48000483	48	      *          program.	1	0	1
48000484	48	      *	1	0	1
48000485	48	                 INITIALIZE ABNDINFO-REC	0	0	0
48000486	48	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
48000487	48	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
48000488	48	      *	1	0	0
48000489	48	      *          Get supplemental information	1	0	1
48000490	48	      *	1	0	1
48000491	48	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
48000492	48	                 END-EXEC	0	0	1
48000494	48	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
48000495	48	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
48000497	48	                 PERFORM POPULATE-TIME-DATE	0	0	1
48000499	48	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
48000500	48	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
48000501	48	                       ':' DELIMITED BY SIZE,	0	0	1
48000502	48	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
48000503	48	                        ':' DELIMITED BY SIZE,	0	0	1
48000504	48	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
48000505	48	                        INTO ABND-TIME	0	0	1
48000506	48	                 END-STRING	0	0	1
48000508	48	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
48000509	48	                 MOVE 'HROL'      TO ABND-CODE	0	0	1
48000511	48	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
48000512	48	                 END-EXEC	0	0	1
48000514	48	                 MOVE 0 TO ABND-SQLCODE	0	0	1
48000516	48	                 STRING 'AH010 -Unable to perform SYNCPOINT ROLLBACK.'	0	0	1
48000517	48	                       DELIMITED BY SIZE,	0	0	1
48000518	48	                       ' Possible integrity issue following VSAM RLS '	0	0	1
48000519	48	                       DELIMITED BY SIZE,	0	0	1
48000520	48	                       ' abend.' DELIMITED BY SIZE,	0	0	1
48000521	48	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
48000522	48	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
48000523	48	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
48000524	48	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
48000525	48	                       INTO ABND-FREEFORM	0	0	1
48000526	48	                 END-STRING	0	0	1
48000528	48	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
48000529	48	                           COMMAREA(ABNDINFO-REC)	0	0	1
48000530	48	                 END-EXEC	0	0	1
48000533	48	                 DISPLAY 'INQCUST: Unable to perform Synpoint Rollback.'	0	0	1
48000534	48	                 ' Possible Integrity issue following VSAM RLS abend'	0	0	1
48000535	48	                 ' RESP CODE=' WS-CICS-RESP ' RESP2 CODE=' WS-CICS-RESP2	0	0	1
48000537	48	                  EXEC CICS ABEND	0	0	1
48000538	48	                     ABCODE ('HROL')	0	0	1
48000539	48	                     CANCEL	0	0	1
48000540	48	                  END-EXEC	0	0	1
48000542	48	               END-IF	0	0	1
48000544	48	               MOVE 'N' TO INQCUST-INQ-SUCCESS	0	0	1
48000545	48	               MOVE '2' TO INQCUST-INQ-FAIL-CD	0	0	1
48000547	48	               EXEC CICS RETURN	0	0	1
48000548	48	               END-EXEC	0	0	1
48000550	48	           END-EVALUATE.	0	0	1
48000552	48	           IF WS-STORM-DRAIN = 'N'	0	0	1
48000554	48	              EXEC CICS ABEND ABCODE( MY-ABEND-CODE)	0	0	1
48000555	48	              NODUMP	0	0	1
48000556	48	              END-EXEC	0	0	1
48000558	48	           END-IF.	0	0	1
48000560	48	       AH999.	0	0	1
48000561	48	           EXIT.	0	0	1
48000564	48	       GET-LAST-CUSTOMER-VSAM SECTION.	0	0	1
48000565	48	       GLCV010.	0	0	1
48000566	48	      *	1	0	0
48000567	48	      *    Retrieves the last customer number in use on the	1	0	1
48000568	48	      *    CUSTOMER file	1	0	1
48000569	48	      *	1	0	1
48000570	48	           INITIALIZE OUTPUT-DATA.	0	0	0
48000572	48	           MOVE HIGH-VALUES TO CUSTOMER-KY2.	0	0	1
48000574	48	           EXEC CICS STARTBR FILE('CUSTOMER')	0	0	1
48000575	48	                RIDFLD(CUSTOMER-KY2)	0	0	1
48000576	48	                RESP(WS-CICS-RESP)	0	0	1
48000577	48	                RESP2(WS-CICS-RESP2)	0	0	1
48000578	48	           END-EXEC.	0	0	1
48000580	48	           IF WS-CICS-RESP = DFHRESP(SYSIDERR)	0	0	1
48000581	48	              PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1	0	0	1
48000582	48	              UNTIL SYSIDERR-RETRY > 100	0	0	1
48000583	48	              OR WS-CICS-RESP = DFHRESP(NORMAL)	0	0	1
48000584	48	              OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)	0	0	1
48000586	48	                 EXEC CICS DELAY FOR SECONDS(3)	0	0	1
48000587	48	                 END-EXEC	0	0	1
48000589	48	                 EXEC CICS STARTBR FILE('CUSTOMER')	0	0	1
48000590	48	                    RIDFLD(CUSTOMER-KY2)	0	0	1
48000591	48	                    RESP(WS-CICS-RESP)	0	0	1
48000592	48	                    RESP2(WS-CICS-RESP2)	0	0	1
48000593	48	                 END-EXEC	0	0	1
48000595	48	              END-PERFORM	0	0	1
48000597	48	           END-IF.	0	0	1
48000599	48	      *    At this point we have either done a successful	1	0	0
48000600	48	      *    STARTBR, or we have a non-SYSIDERR RESP, or we've retried	1	0	1
48000601	48	      *    more than 100 times.	1	0	1
48000603	48	           IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	0
48000604	48	               MOVE 'N' TO INQCUST-INQ-SUCCESS	0	0	1
48000605	48	               MOVE '9' TO INQCUST-INQ-FAIL-CD	0	0	1
48000606	48	               GO TO GLCVE999	0	0	1
48000607	48	           END-IF.	0	0	1
48000609	48	           EXEC CICS READPREV FILE('CUSTOMER')	0	0	1
48000610	48	                RIDFLD(CUSTOMER-KY2)	0	0	1
48000611	48	                INTO(OUTPUT-DATA)	0	0	1
48000612	48	                RESP(WS-CICS-RESP)	0	0	1
48000613	48	                RESP2(WS-CICS-RESP2)	0	0	1
48000614	48	           END-EXEC.	0	0	1
48000616	48	           IF WS-CICS-RESP = DFHRESP(SYSIDERR)	0	0	1
48000617	48	              PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1	0	0	1
48000618	48	              UNTIL SYSIDERR-RETRY > 100	0	0	1
48000619	48	              OR WS-CICS-RESP = DFHRESP(NORMAL)	0	0	1
48000620	48	              OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)	0	0	1
48000622	48	                 EXEC CICS DELAY FOR SECONDS(3)	0	0	1
48000623	48	                 END-EXEC	0	0	1
48000625	48	                 EXEC CICS READPREV FILE('CUSTOMER')	0	0	1
48000626	48	                      RIDFLD(CUSTOMER-KY2)	0	0	1
48000627	48	                      INTO(OUTPUT-DATA)	0	0	1
48000628	48	                      RESP(WS-CICS-RESP)	0	0	1
48000629	48	                      RESP2(WS-CICS-RESP2)	0	0	1
48000630	48	                 END-EXEC	0	0	1
48000632	48	              END-PERFORM	0	0	1
48000634	48	           END-IF.	0	0	1
48000636	48	           IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	1
48000637	48	              MOVE 'N' TO INQCUST-INQ-SUCCESS	0	0	1
48000638	48	              MOVE '9' TO INQCUST-INQ-FAIL-CD	0	0	1
48000639	48	              GO TO GLCVE999	0	0	1
48000640	48	           END-IF.	0	0	1
48000642	48	           EXEC CICS ENDBR FILE('CUSTOMER')	0	0	1
48000643	48	                RESP(WS-CICS-RESP)	0	0	1
48000644	48	                RESP2(WS-CICS-RESP2)	0	0	1
48000645	48	           END-EXEC.	0	0	1
48000647	48	           IF WS-CICS-RESP = DFHRESP(SYSIDERR)	0	0	1
48000648	48	              PERFORM VARYING SYSIDERR-RETRY FROM 1 BY 1	0	0	1
48000649	48	              UNTIL SYSIDERR-RETRY > 100	0	0	1
48000650	48	              OR WS-CICS-RESP = DFHRESP(NORMAL)	0	0	1
48000651	48	              OR WS-CICS-RESP IS NOT EQUAL TO DFHRESP(SYSIDERR)	0	0	1
48000653	48	                 EXEC CICS DELAY FOR SECONDS(3)	0	0	1
48000654	48	                 END-EXEC	0	0	1
48000656	48	                 EXEC CICS ENDBR FILE('CUSTOMER')	0	0	1
48000657	48	                      RESP(WS-CICS-RESP)	0	0	1
48000658	48	                      RESP2(WS-CICS-RESP2)	0	0	1
48000659	48	                 END-EXEC	0	0	1
48000661	48	              END-PERFORM	0	0	1
48000663	48	           IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	1
48000664	48	              MOVE 'N' TO INQCUST-INQ-SUCCESS	0	0	1
48000665	48	              MOVE '9' TO INQCUST-INQ-FAIL-CD	0	0	1
48000666	48	              GO TO GLCVE999	0	0	1
48000667	48	           END-IF.	0	0	1
48000669	48	           MOVE 'Y' TO INQCUST-INQ-SUCCESS.	0	0	1
48000671	48	       GLCVE999.	0	0	1
48000672	48	           EXIT.	0	0	1
48000675	48	       POPULATE-TIME-DATE SECTION.	0	0	1
48000676	48	       PTD010.	0	0	1
48000678	48	           EXEC CICS ASKTIME	0	0	1
48000679	48	              ABSTIME(WS-U-TIME)	0	0	1
48000680	48	           END-EXEC.	0	0	1
48000682	48	           EXEC CICS FORMATTIME	0	0	1
48000683	48	                     ABSTIME(WS-U-TIME)	0	0	1
48000684	48	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
48000685	48	                     TIME(WS-TIME-NOW)	0	0	1
48000686	48	                     DATESEP	0	0	1
48000687	48	           END-EXEC.	0	0	1
48000689	48	       PTD999.	0	0	1
48000690	48	           EXIT.	0	0	1
48000692	48	      *	1	0	0
48000693	48	      * Generate a random customer number	1	0	1
48000694	48	      *	1	0	1
48000695	48	       GENERATE-RANDOM-CUSTOMER SECTION.	0	0	0
48000696	48	       GRC010.	0	0	1
48000697	48	           MOVE ZERO TO INQCUST-RETRY.	0	0	1
48000698	48	           COMPUTE RANDOM-CUSTOMER = ((NCS-CUST-NO-VALUE - 1)	0	0	1
48000699	48	                                     * FUNCTION RANDOM(EIBTASKN)) + 1.	0	0	1
48000700	48	       GRC999.	0	0	1
48000701	48	           EXIT.	0	0	1
48000702	48	      *	1	0	0
48000703	48	      * Generate a random customer number	1	0	1
48000704	48	      *	1	0	1
48000705	48	       GENERATE-RANDOM-CUSTOMER-AGAIN SECTION.	0	0	0
48000706	48	       GRCA10.	0	0	1
48000707	48	           ADD 1 TO INQCUST-RETRY GIVING INQCUST-RETRY.	0	0	1
48000708	48	           COMPUTE RANDOM-CUSTOMER = ((NCS-CUST-NO-VALUE - 1)	0	0	1
48000709	48	                                                * FUNCTION RANDOM) + 1.	0	0	1
48000710	48	        GRCA99.	0	0	1
48000711	48	            EXIT.	0	0	1
49000001	49	       CBL CICS('SP,EDF')	0	0	1
49000002	49	       CBL SQL	0	0	1
49000003	49	      ******************************************************************	1	0	0
49000004	49	      *                                                                *	1	0	1
49000005	49	      *  Copyright IBM Corp. 2023                                      *	1	0	1
49000006	49	      *                                                                *	1	0	1
49000007	49	      ******************************************************************	1	0	1
49000009	49	       IDENTIFICATION DIVISION.	0	0	0
49000010	49	       PROGRAM-ID. CUSTCTRL.	0	0	1
49000011	49	       AUTHOR. OGRADYJ.	0	0	1
49000013	49	       ENVIRONMENT DIVISION.	0	0	1
49000014	49	       CONFIGURATION SECTION.	0	0	1
49000015	49	      * SOURCE-COMPUTER.  IBM-370 WITH DEBUGGING MODE.	1	0	0
49000016	49	       SOURCE-COMPUTER.  IBM-370.	0	0	0
49000017	49	       OBJECT-COMPUTER.  IBM-370.	0	0	1
49000019	49	       INPUT-OUTPUT SECTION.	0	0	1
49000023	49	       DATA DIVISION.	0	0	1
49000024	49	       FILE SECTION.	0	0	1
49000027	49	       WORKING-STORAGE SECTION.	0	0	1
49000029	49	       01 SYSIDERR-RETRY PIC 999.	0	0	1
49000031	49	       LOCAL-STORAGE SECTION.	0	0	1
49000032	49	       COPY SORTCODE.	0	0	1
49000033	49	       01 CUSTOMER-KY.	0	0	1
49000034	49	          03 REQUIRED-SORT-CODE   PIC 9(6) VALUE 0.	0	0	1
49000035	49	          03 REQUIRED-CUST-NUMBER PIC 9(10) VALUE 0.	0	0	1
49000038	49	       01 EXIT-VSAM-READ       PIC X VALUE 'N'.	0	0	1
49000039	49	       01 EXIT-DB2-READ        PIC X VALUE 'N'.	0	0	1
49000041	49	       01 WS-V-RETRIED         PIC X VALUE 'N'.	0	0	1
49000042	49	       01 WS-D-RETRIED         PIC X VALUE 'N'.	0	0	1
49000044	49	       01 SQLCODE-DISPLAY                 PIC S9(8) DISPLAY	0	0	1
49000045	49	           SIGN LEADING SEPARATE.	0	0	1
49000050	49	       01 WS-PASSED-DATA.	0	0	1
49000051	49	          02 WS-TEST-KEY                             PIC X(4).	0	0	1
49000052	49	          02 WS-SORT-CODE                            PIC 9(6).	0	0	1
49000053	49	          02 WS-CUSTOMER-RANGE.	0	0	1
49000054	49	             07 WS-CUSTOMER-RANGE-TOP                PIC X.	0	0	1
49000055	49	             07 WS-CUSTOMER-RANGE-MIDDLE             PIC X.	0	0	1
49000056	49	             07 WS-CUSTOMER-RANGE-BOTTOM             PIC X.	0	0	1
49000058	49	       01 WS-SORT-DIV.	0	0	1
49000059	49	          03 WS-SORT-DIV1                    PIC XX.	0	0	1
49000060	49	          03 WS-SORT-DIV2                    PIC XX.	0	0	1
49000061	49	          03 WS-SORT-DIV3                    PIC XX.	0	0	1
49000063	49	       01 WS-DISP-CUST-NO-VAL                PIC S9(18) DISPLAY.	0	0	1
49000065	49	       01 WS-CUST-REC-LEN                    PIC S9(4) COMP VALUE 0.	0	0	1
49000067	49	       01 NCS-UPDATED                        PIC X VALUE 'N'.	0	0	1
49000069	49	       01 WS-EIBTASKN12                  PIC 9(12) VALUE 0.	0	0	1
49000070	49	       77 PROCTRAN-RETRY PIC 999.	0	0	1
49000072	49	       01 CUSTOMER-KY2.	0	0	1
49000073	49	          03 REQUIRED-SORT-CODE2   PIC 9(6) VALUE 0.	0	0	1
49000074	49	          03 REQUIRED-CUST-NUMBER2 PIC 9(10) VALUE 0.	0	0	1
49000076	49	       01 CUSTOMER-KY2-BYTES REDEFINES CUSTOMER-KY2 PIC X(16).	0	0	1
49000078	49	       01 HIGHEST-CUST-NUMBER  PIC 9(10) VALUE 0.	0	0	1
49000080	49	       01 WS-CICS-RESP PIC S9(8) BINARY.	0	0	1
49000081	49	       01 WS-CICS-RESP2 PIC S9(8) BINARY.	0	0	1
49000083	49	      * Pull in the SQL COMMAREA	1	0	0
49000084	49	       EXEC SQL	0	0	0
49000085	49	          INCLUDE SQLCA	0	0	1
49000086	49	       END-EXEC.	0	0	1
49000088	49	       01 HV-NUMBER-OF-CUSTOMERS PIC S9(8) BINARY.	0	0	1
49000089	49	       01 HV-CUSTOMER-SORTCODE PIC X(6).	0	0	1
49000094	49	       01 WS-U-TIME                      PIC S9(15) COMP-3.	0	0	1
49000095	49	       01 WS-ORIG-DATE                   PIC X(10).	0	0	1
49000096	49	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
49000097	49	          03 WS-ORIG-DATE-DD             PIC 99.	0	0	1
49000098	49	          03 FILLER                      PIC X.	0	0	1
49000099	49	          03 WS-ORIG-DATE-MM             PIC 99.	0	0	1
49000100	49	          03 FILLER                      PIC X.	0	0	1
49000101	49	          03 WS-ORIG-DATE-YYYY           PIC 9999.	0	0	1
49000103	49	       01 WS-ORIG-DATE-GRP-X.	0	0	1
49000104	49	          03 WS-ORIG-DATE-DD-X           PIC XX.	0	0	1
49000105	49	          03 FILLER                      PIC X VALUE '.'.	0	0	1
49000106	49	          03 WS-ORIG-DATE-MM-X           PIC XX.	0	0	1
49000107	49	          03 FILLER                      PIC X VALUE '.'.	0	0	1
49000108	49	          03 WS-ORIG-DATE-YYYY-X         PIC X(4).	0	0	1
49000111	49	       01 WS-TIME-DATA.	0	0	1
49000112	49	           03 WS-TIME-NOW                  PIC 9(6).	0	0	1
49000113	49	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
49000114	49	              05 WS-TIME-NOW-GRP-HH     PIC 99.	0	0	1
49000115	49	              05 WS-TIME-NOW-GRP-MM     PIC 99.	0	0	1
49000116	49	              05 WS-TIME-NOW-GRP-SS     PIC 99.	0	0	1
49000118	49	       01 WS-ABEND-PGM                  PIC X(8) VALUE 'ABNDPROC'.	0	0	1
49000120	49	       01 ABNDINFO-REC.	0	0	1
49000121	49	           COPY ABNDINFO.	0	0	1
49000126	49	       LINKAGE SECTION.	0	0	1
49000127	49	       01 DFHCOMMAREA.	0	0	1
49000128	49	           COPY CUSTCTRL.	0	0	1
49000131	49	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
49000132	49	       PREMIERE SECTION.	0	0	1
49000133	49	       P010.	0	0	1
49000134	49	           MOVE SORTCODE TO	0	0	1
49000135	49	              REQUIRED-SORT-CODE.	0	0	1
49000137	49	           PERFORM GET-NUMBER-OF-CUSTOMERS-VSAM	0	0	1
49000140	49	      D    DISPLAY 'OUTPUT DATA IS='	0	0	1
49000141	49	      D       DFHCOMMAREA.	0	0	1
49000144	49	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
49000146	49	       P999.	0	0	1
49000147	49	           EXIT.	0	0	1
49000152	49	       GET-NUMBER-OF-CUSTOMERS-VSAM SECTION.	0	0	1
49000153	49	       WCV010.	0	0	1
49000155	49	           INITIALIZE DFHCOMMAREA.	0	0	1
49000158	49	           MOVE ZERO TO CUSTOMER-CONTROL-SORTCODE	0	0	1
49000159	49	           MOVE ALL '9' TO CUSTOMER-CONTROL-NUMBER	0	0	1
49000162	49	           EXEC CICS READ	0	0	1
49000163	49	                FILE('CUSTOMER')	0	0	1
49000164	49	                INTO(DFHCOMMAREA)	0	0	1
49000165	49	                RIDFLD(CUSTOMER-CONTROL-KEY)	0	0	1
49000166	49	                KEYLENGTH(16)	0	0	1
49000167	49	                RESP(WS-CICS-RESP)	0	0	1
49000168	49	                RESP2(WS-CICS-RESP2)	0	0	1
49000169	49	           END-EXEC.	0	0	1
49000171	49	           if ws-cics-resp = dfhresp(sysiderr)	0	0	1
49000172	49	             perform varying SYSIDERR-RETRY from 1 by 1	0	0	1
49000173	49	             until SYSIDERR-RETRY > 100	0	0	1
49000174	49	             or ws-cics-resp = dfhresp(normal)	0	0	1
49000175	49	             or ws-cics-resp is not equal to dfhresp(sysiderr)	0	0	1
49000176	49	               exec cics delay for seconds(3)	0	0	1
49000177	49	               end-exec	0	0	1
49000178	49	                EXEC CICS READ	0	0	1
49000179	49	                  FILE('CUSTOMER')	0	0	1
49000180	49	                  INTO(DFHCOMMAREA)	0	0	1
49000181	49	                  RIDFLD(CUSTOMER-CONTROL-KEY)	0	0	1
49000182	49	                  KEYLENGTH(16)	0	0	1
49000183	49	                  RESP(WS-CICS-RESP)	0	0	1
49000184	49	                  RESP2(WS-CICS-RESP2)	0	0	1
49000185	49	               END-EXEC	0	0	1
49000186	49	             end-perform	0	0	1
49000187	49	           end-if	0	0	1
49000189	49	      *	1	0	0
49000190	49	      * Check if the READ was unsuccessful and take action.	1	0	1
49000191	49	      *	1	0	1
49000192	49	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	0
49000193	49	              MOVE 'N' TO CUSTOMER-CONTROL-SUCCESS-FLAG	0	0	1
49000194	49	              MOVE '1' TO CUSTOMER-CONTROL-FAIL-CODE	0	0	1
49000195	49	           END-IF.	0	0	1
49000197	49	       WCV999.	0	0	1
49000198	49	           EXIT.	0	0	1
49000203	49	      *	1	0	0
49000204	49	      * Finish	1	0	1
49000205	49	      *	1	0	1
49000206	49	       GET-ME-OUT-OF-HERE SECTION.	0	0	0
49000207	49	       GMOFH010.	0	0	1
49000209	49	           EXEC CICS RETURN	0	0	1
49000210	49	           END-EXEC.	0	0	1
49000212	49	       GMOFH999.	0	0	1
49000213	49	           EXIT.	0	0	1
49000215	49	      /	1	0	0
49000216	49	       POPULATE-TIME-DATE SECTION.	0	0	0
49000217	49	       PTD010.	0	0	1
49000218	49	      D    DISPLAY 'POPULATE-TIME-DATE SECTION'.	0	0	1
49000220	49	           EXEC CICS ASKTIME	0	0	1
49000221	49	              ABSTIME(WS-U-TIME)	0	0	1
49000222	49	           END-EXEC.	0	0	1
49000224	49	           EXEC CICS FORMATTIME	0	0	1
49000225	49	                     ABSTIME(WS-U-TIME)	0	0	1
49000226	49	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
49000227	49	                     TIME(WS-TIME-NOW)	0	0	1
49000228	49	                     DATESEP	0	0	1
49000229	49	           END-EXEC.	0	0	1
49000231	49	       PTD999.	0	0	1
49000232	49	           EXIT.	0	0	1
50000001	50	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	1
50000002	50	       CBL CICS('SP,EDF,DLI')	0	0	1
50000003	50	      ******************************************************************	1	0	0
50000004	50	      *                                                                *	1	0	1
50000005	50	      *  Copyright IBM Corp. 2023                                      *	1	0	1
50000006	50	      *                                                                *	1	0	1
50000007	50	      ******************************************************************	1	0	1
50000010	50	      ******************************************************************	1	0	1
50000011	50	      * This program processes application abends and writes them to	1	0	1
50000012	50	      * a centralised CF (KSDS) datastore - this is so that they can be	1	0	1
50000013	50	      * viewed from one place, without having to go hunting for them.	1	0	1
50000014	50	      ******************************************************************	1	0	1
50000016	50	       IDENTIFICATION DIVISION.	0	0	0
50000017	50	       PROGRAM-ID. ABNDPROC.	0	0	1
50000018	50	       AUTHOR. JONCOLLETT.	0	0	1
50000020	50	       ENVIRONMENT DIVISION.	0	0	1
50000021	50	       CONFIGURATION SECTION.	0	0	1
50000022	50	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
50000023	50	       SOURCE-COMPUTER.  IBM-370.	0	0	0
50000024	50	       OBJECT-COMPUTER.  IBM-370.	0	0	1
50000026	50	       INPUT-OUTPUT SECTION.	0	0	1
50000029	50	       DATA DIVISION.	0	0	1
50000030	50	       WORKING-STORAGE SECTION.	0	0	1
50000032	50	       01 WS-CICS-WORK-AREA.	0	0	1
50000033	50	          05 WS-CICS-RESP      PIC S9(8) COMP.	0	0	1
50000034	50	          05 WS-CICS-RESP2     PIC S9(8) COMP.	0	0	1
50000037	50	       01 WS-ABND-AREA.	0	0	1
50000038	50	           COPY ABNDINFO.	0	0	1
50000040	50	       01 WS-ABND-KEY-LEN      PIC S9(8) COMP VALUE +12.	0	0	1
50000042	50	       LOCAL-STORAGE SECTION.	0	0	1
50000045	50	       01 DB2-DATE-REFORMAT.	0	0	1
50000046	50	          03 DB2-DATE-REF-YR           PIC 9(4).	0	0	1
50000047	50	          03 FILLER                    PIC X.	0	0	1
50000048	50	          03 DB2-DATE-REF-MNTH         PIC 99.	0	0	1
50000049	50	          03 FILLER                    PIC X.	0	0	1
50000050	50	          03 DB2-DATE-REF-DAY          PIC 99.	0	0	1
50000052	50	       01 DATA-STORE-TYPE      PIC X.	0	0	1
50000053	50	          88 DATASTORE-TYPE-DLI     VALUE '1'.	0	0	1
50000054	50	          88 DATASTORE-TYPE-DB2     VALUE '2'.	0	0	1
50000055	50	          88 DATASTORE-TYPE-VSAM    VALUE 'V'.	0	0	1
50000057	50	       01 WS-EIBTASKN12                PIC 9(12) VALUE 0.	0	0	1
50000058	50	       01 WS-SQLCODE-DISP              PIC 9(9) VALUE 0.	0	0	1
50000060	50	      * **************************************************************	1	0	0
50000061	50	      * Pull in the input and output data structures	1	0	1
50000062	50	      * **************************************************************	1	0	1
50000065	50	       01 WS-U-TIME                      PIC S9(15) COMP-3.	0	0	0
50000066	50	       01 WS-ORIG-DATE                   PIC X(10).	0	0	1
50000067	50	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
50000068	50	          03 WS-ORIG-DATE-DD             PIC 99.	0	0	1
50000069	50	          03 FILLER                      PIC X.	0	0	1
50000070	50	          03 WS-ORIG-DATE-MM             PIC 99.	0	0	1
50000071	50	          03 FILLER                      PIC X.	0	0	1
50000072	50	          03 WS-ORIG-DATE-YYYY           PIC 9999.	0	0	1
50000074	50	       01 WS-ORIG-DATE-GRP-X.	0	0	1
50000075	50	          03 WS-ORIG-DATE-DD-X           PIC XX.	0	0	1
50000076	50	          03 FILLER                      PIC X VALUE '.'.	0	0	1
50000077	50	          03 WS-ORIG-DATE-MM-X           PIC XX.	0	0	1
50000078	50	          03 FILLER                      PIC X VALUE '.'.	0	0	1
50000079	50	          03 WS-ORIG-DATE-YYYY-X         PIC X(4).	0	0	1
50000082	50	       01 WS-PASSED-DATA.	0	0	1
50000083	50	          02 WS-TEST-KEY                             PIC X(4).	0	0	1
50000084	50	          02 WS-SORT-CODE                            PIC 9(6).	0	0	1
50000085	50	          02 WS-CUSTOMER-RANGE.	0	0	1
50000086	50	             07 WS-CUSTOMER-RANGE-TOP                PIC X.	0	0	1
50000087	50	             07 WS-CUSTOMER-RANGE-MIDDLE             PIC X.	0	0	1
50000088	50	             07 WS-CUSTOMER-RANGE-BOTTOM             PIC X.	0	0	1
50000090	50	       01 WS-SORT-DIV.	0	0	1
50000091	50	          03 WS-SORT-DIV1                         PIC XX.	0	0	1
50000092	50	          03 WS-SORT-DIV2                         PIC XX.	0	0	1
50000093	50	          03 WS-SORT-DIV3                         PIC XX.	0	0	1
50000095	50	       01 CUSTOMER-KY.	0	0	1
50000096	50	          03 REQUIRED-SORT-CODE       PIC 9(6)  VALUE 0.	0	0	1
50000097	50	          03 REQUIRED-ACC-NUM         PIC 9(8)  VALUE 0.	0	0	1
50000099	50	       01 PROCTRAN-RIDFLD             PIC S9(8) COMP.	0	0	1
50000101	50	       01 SQLCODE-DISPLAY             PIC S9(8) DISPLAY	0	0	1
50000102	50	           SIGN LEADING SEPARATE.	0	0	1
50000104	50	       01 MY-ABEND-CODE               PIC XXXX.	0	0	1
50000108	50	       LINKAGE SECTION.	0	0	1
50000110	50	       01 DFHCOMMAREA.	0	0	1
50000111	50	           03 COMM-VSAM-KEY.	0	0	1
50000112	50	              05 COMM-UTIME-KEY                  PIC S9(15) COMP-3.	0	0	1
50000113	50	              05 COMM-TASKNO-KEY                 PIC 9(4).	0	0	1
50000114	50	           03 COMM-APPLID                        PIC X(8).	0	0	1
50000115	50	           03 COMM-TRANID                        PIC X(4).	0	0	1
50000116	50	           03 COMM-DATE                          PIC X(10).	0	0	1
50000117	50	           03 COMM-TIME                          PIC X(8).	0	0	1
50000118	50	           03 COMM-CODE                          PIC X(4).	0	0	1
50000119	50	           03 COMM-PROGRAM                       PIC X(8).	0	0	1
50000120	50	           03 COMM-RESPCODE                      PIC S9(8) DISPLAY	0	0	1
50000121	50	              SIGN LEADING SEPARATE.	0	0	1
50000122	50	           03 COMM-RESP2CODE                     PIC S9(8) DISPLAY	0	0	1
50000123	50	              SIGN LEADING SEPARATE.	0	0	1
50000124	50	           03 COMM-SQLCODE                       PIC S9(8) DISPLAY	0	0	1
50000125	50	              SIGN LEADING SEPARATE.	0	0	1
50000126	50	           03 COMM-FREEFORM                      PIC X(600).	0	0	1
50000130	50	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
50000131	50	       PREMIERE SECTION.	0	0	1
50000132	50	       A010.	0	0	1
50000135	50	      D    DISPLAY 'Started ABNDPROC:'.	0	0	1
50000136	50	      D    DISPLAY 'COMMAREA passed=' DFHCOMMAREA.	0	0	1
50000139	50	           MOVE DFHCOMMAREA TO WS-ABND-AREA.	0	0	1
50000141	50	           EXEC CICS WRITE	0	0	1
50000142	50	              FILE('ABNDFILE')	0	0	1
50000143	50	              FROM(WS-ABND-AREA)	0	0	1
50000144	50	              RIDFLD(ABND-VSAM-KEY)	0	0	1
50000145	50	              RESP(WS-CICS-RESP)	0	0	1
50000146	50	              RESP2(WS-CICS-RESP2)	0	0	1
50000147	50	           END-EXEC.	0	0	1
50000149	50	           IF WS-CICS-RESP NOT= DFHRESP(NORMAL)	0	0	1
50000150	50	              DISPLAY '*********************************************'	0	0	1
50000151	50	              DISPLAY '**** Unable to write to the file ABNDFILE !!!'	0	0	1
50000152	50	              DISPLAY 'RESP=' WS-CICS-RESP ' RESP2=' WS-CICS-RESP2	0	0	1
50000153	50	              DISPLAY '*********************************************'	0	0	1
50000155	50	              EXEC CICS RETURN	0	0	1
50000156	50	              END-EXEC	0	0	1
50000158	50	           END-IF.	0	0	1
50000160	50	      D    DISPLAY 'ABEND record successfully written to ABNDFILE'.	0	0	1
50000161	50	      D    DISPLAY WS-ABND-AREA.	0	0	1
50000163	50	           PERFORM GET-ME-OUT-OF-HERE.	0	0	1
50000165	50	       A999.	0	0	1
50000166	50	           EXIT.	0	0	1
50000168	50	      /	1	0	0
50000169	50	       GET-ME-OUT-OF-HERE SECTION.	0	0	0
50000170	50	       GMOOH010.	0	0	1
50000171	50	           EXEC CICS RETURN	0	0	1
50000172	50	           END-EXEC.	0	0	1
50000173	50	           GOBACK.	0	0	1
50000175	50	       GMOOH999.	0	0	1
50000176	50	           EXIT.	0	0	1
51000001	51	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	1
51000002	51	       CBL CICS('SP,EDF')	0	0	1
51000003	51	       CBL SQL	0	0	1
51000004	51	      ******************************************************************	1	0	0
51000005	51	      *                                                                *	1	0	1
51000006	51	      *  Copyright IBM Corp. 2023                                      *	1	0	1
51000007	51	      *                                                                *	1	0	1
51000008	51	      ******************************************************************	1	0	1
51000010	51	      ******************************************************************	1	0	1
51000011	51	      * This program gets called when someone initiates a transfer	1	0	1
51000012	51	      * of funds (perhaps) over the counter or via a web application.	1	0	1
51000013	51	      *	1	0	1
51000014	51	      * This program takes an incoming sortcode/account number (key)	1	0	1
51000015	51	      * from the account where the money is transfered from and a	1	0	1
51000016	51	      * sortcode/acount number (key) combination for the account where	1	0	1
51000017	51	      * the money is being transferred to. Additionally, there will	1	0	1
51000018	51	      * also be an incoming amount.	1	0	1
51000019	51	      *	1	0	1
51000020	51	      * This program needs to be able to cope with the data in any	1	0	1
51000021	51	      * format. No checking is made on overdraft limits.	1	0	1
51000022	51	      *	1	0	1
51000023	51	      * If the transfer can be made successfully after looking up	1	0	1
51000024	51	      * the account information then the account information will be	1	0	1
51000025	51	      * updated and the PROCTRAN (Processed Transaction) datastore	1	0	1
51000026	51	      * will be updated to record the successful transaction.	1	0	1
51000027	51	      *	1	0	1
51000028	51	      * If the transaction is a success, then the available balance	1	0	1
51000029	51	      * and the actual balance for the account being debited and the	1	0	1
51000030	51	      * account being credited will be returned.	1	0	1
51000031	51	      *	1	0	1
51000032	51	      * If the update to either the ACCOUNT or PROCTRAN datastore is	1	0	1
51000033	51	      * unsuccessful, then the transaction is deemed to have failed.	1	0	1
51000034	51	      *	1	0	1
51000035	51	      * Should there be some kind of datastore failure or other	1	0	1
51000036	51	      * unpredictable failure we should report it, back out any	1	0	1
51000037	51	      * updates already made and abend the transaction.	1	0	1
51000038	51	      *	1	0	1
51000039	51	      *****************************************************************	1	0	1
51000040	51	       IDENTIFICATION DIVISION.	0	0	0
51000041	51	       PROGRAM-ID. XFRFUN.	0	0	1
51000042	51	       AUTHOR. Jon Collett.	0	0	1
51000044	51	       ENVIRONMENT DIVISION.	0	0	1
51000045	51	       CONFIGURATION SECTION.	0	0	1
51000046	51	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
51000047	51	       SOURCE-COMPUTER.  IBM-370.	0	0	0
51000048	51	       OBJECT-COMPUTER.  IBM-370.	0	0	1
51000050	51	       INPUT-OUTPUT SECTION.	0	0	1
51000052	51	       DATA DIVISION.	0	0	1
51000053	51	       WORKING-STORAGE SECTION.	0	0	1
51000056	51	       COPY SORTCODE.	0	0	1
51000059	51	      * Get the ACCOUNT DB2 copybook	1	0	0
51000060	51	           EXEC SQL	0	0	0
51000061	51	             INCLUDE ACCDB2	0	0	1
51000062	51	           END-EXEC.	0	0	1
51000064	51	      * ACCOUNT Host variables for DB2	1	0	0
51000065	51	       01 HOST-ACCOUNT-ROW.	0	0	0
51000066	51	          03 HV-ACCOUNT-EYECATCHER      PIC X(4).	0	0	1
51000067	51	          03 HV-ACCOUNT-CUST-NO         PIC X(10).	0	0	1
51000068	51	          03 HV-ACCOUNT-KEY.	0	0	1
51000069	51	             05 HV-ACCOUNT-SORTCODE     PIC X(6).	0	0	1
51000070	51	             05 HV-ACCOUNT-ACC-NO       PIC X(8).	0	0	1
51000071	51	          03 HV-ACCOUNT-ACC-TYPE        PIC X(8).	0	0	1
51000072	51	          03 HV-ACCOUNT-INT-RATE        PIC S9(4)V99 COMP-3.	0	0	1
51000073	51	          03 HV-ACCOUNT-OPENED          PIC X(10).	0	0	1
51000074	51	          03 HV-ACCOUNT-OVERDRAFT-LIM   PIC S9(9) COMP.	0	0	1
51000075	51	          03 HV-ACCOUNT-LAST-STMT       PIC X(10).	0	0	1
51000076	51	          03 HV-ACCOUNT-NEXT-STMT       PIC X(10).	0	0	1
51000077	51	          03 HV-ACCOUNT-AVAIL-BAL       PIC S9(10)V99 COMP-3.	0	0	1
51000078	51	          03 HV-ACCOUNT-ACTUAL-BAL      PIC S9(10)V99 COMP-3.	0	0	1
51000080	51	      * PROCTRAN DB2 copybook	1	0	0
51000081	51	          EXEC SQL	0	0	0
51000082	51	             INCLUDE PROCDB2	0	0	1
51000083	51	          END-EXEC.	0	0	1
51000085	51	      * PROCTRAN host variables for DB2	1	0	0
51000086	51	       01 HOST-PROCTRAN-ROW.	0	0	0
51000087	51	          03 HV-PROCTRAN-EYECATCHER     PIC X(4).	0	0	1
51000088	51	          03 HV-PROCTRAN-SORT-CODE      PIC X(6).	0	0	1
51000089	51	          03 HV-PROCTRAN-ACC-NUMBER     PIC X(8).	0	0	1
51000090	51	          03 HV-PROCTRAN-DATE           PIC X(10).	0	0	1
51000091	51	          03 HV-PROCTRAN-TIME           PIC X(6).	0	0	1
51000092	51	          03 HV-PROCTRAN-REF            PIC X(12).	0	0	1
51000093	51	          03 HV-PROCTRAN-TYPE           PIC X(3).	0	0	1
51000094	51	          03 HV-PROCTRAN-DESC           PIC X(40).	0	0	1
51000095	51	          03 HV-PROCTRAN-AMOUNT         PIC S9(10)V99 COMP-3.	0	0	1
51000097	51	      * Pull in the SQL COMMAREA	1	0	0
51000098	51	        EXEC SQL	0	0	0
51000099	51	          INCLUDE SQLCA	0	0	1
51000100	51	        END-EXEC.	0	0	1
51000102	51	       01 WS-CICS-WORK-AREA.	0	0	1
51000103	51	          05 WS-CICS-RESP               PIC S9(8) COMP.	0	0	1
51000104	51	          05 WS-CICS-RESP2              PIC S9(8) COMP.	0	0	1
51000107	51	       LOCAL-STORAGE SECTION.	0	0	1
51000108	51	       01 SYSIDERR-RETRY                PIC 999.	0	0	1
51000109	51	       01 FILE-RETRY                    PIC 999.	0	0	1
51000110	51	       01 WS-EXIT-RETRY-LOOP            PIC X         VALUE ' '.	0	0	1
51000111	51	       01 DB2-DEADLOCK-RETRY            PIC 999.	0	0	1
51000113	51	       01 DB2-DATE-REFORMAT.	0	0	1
51000114	51	          03 DB2-DATE-REF-YR            PIC 9(4).	0	0	1
51000115	51	          03 FILLER                     PIC X.	0	0	1
51000116	51	          03 DB2-DATE-REF-MNTH          PIC 99.	0	0	1
51000117	51	          03 FILLER                     PIC X.	0	0	1
51000118	51	          03 DB2-DATE-REF-DAY           PIC 99.	0	0	1
51000121	51	      *	1	0	0
51000122	51	      * Pull in the input and output data structures	1	0	1
51000123	51	      *	1	0	1
51000124	51	       01 WS-ACC-DATA.	0	0	0
51000125	51	          COPY ACCOUNT.	0	0	1
51000127	51	       01 WS-ACC-DATA2.	0	0	1
51000128	51	          COPY ACCOUNT REPLACING "ACCOUNT" BY "ACCOUNT2".	0	0	1
51000130	51	       01 WS-EIBTASKN12                 PIC 9(12)     VALUE 0.	0	0	1
51000131	51	       01 WS-SQLCODE-DISP               PIC 9(9)      VALUE 0.	0	0	1
51000133	51	      *	1	0	0
51000134	51	      * Pull in the input and output data structures	1	0	1
51000135	51	      *	1	0	1
51000137	51	       01 DESIRED-ACC-KEY.	0	0	0
51000138	51	          03 DESIRED-SORT-CODE          PIC 9(6).	0	0	1
51000139	51	          03 DESIRED-ACC-NO             PIC 9(8).	0	0	1
51000141	51	      * 01 DESIRED-ACC-KEY2.	1	0	0
51000142	51	      *    03 DESIRED-SORT-CODE2         PIC 9(6).	1	0	1
51000143	51	      *    03 DESIRED-ACC-NO2            PIC 9(8).	1	0	1
51000145	51	       01 NEW-ACCOUNT-AVAILABLE-BALANCE PIC S9(10)V99 VALUE 0.	0	0	0
51000146	51	       01 NEW-ACCOUNT-ACTUAL-BALANCE    PIC S9(10)V99 VALUE 0.	0	0	1
51000147	51	       01 WS-ACC-REC-LEN                PIC S9(4) COMP	0	0	1
51000148	51	                                                      VALUE 0.	0	0	1
51000150	51	       01 NEW-ACCOUNT-AVAILABLE-BALANCE2	0	0	1
51000151	51	                                        PIC S9(10)V99 VALUE 0.	0	0	1
51000152	51	       01 NEW-ACCOUNT-ACTUAL-BALANCE2   PIC S9(10)V99 VALUE 0.	0	0	1
51000153	51	       01 WS-ACC-REC-LEN2               PIC S9(4) COMP	0	0	1
51000154	51	                                                      VALUE 0.	0	0	1
51000156	51	       01 WS-U-TIME                     PIC S9(15) COMP-3.	0	0	1
51000157	51	       01 WS-ORIG-DATE                  PIC X(10).	0	0	1
51000158	51	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
51000159	51	          03 WS-ORIG-DATE-DD            PIC 99.	0	0	1
51000160	51	          03 FILLER                     PIC X.	0	0	1
51000161	51	          03 WS-ORIG-DATE-MM            PIC 99.	0	0	1
51000162	51	          03 FILLER                     PIC X.	0	0	1
51000163	51	          03 WS-ORIG-DATE-YYYY          PIC 9999.	0	0	1
51000165	51	       01 WS-ORIG-DATE-GRP-X.	0	0	1
51000166	51	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
51000167	51	          03 FILLER                     PIC X         VALUE '.'.	0	0	1
51000168	51	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
51000169	51	          03 FILLER                     PIC X         VALUE '.'.	0	0	1
51000170	51	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
51000172	51	       01 REJ-REASON                    PIC XX        VALUE SPACES.	0	0	1
51000174	51	       01 PROCTRAN-AREA.	0	0	1
51000175	51	          COPY PROCTRAN.	0	0	1
51000177	51	       01 REJTRAN-RIDFLD                PIC S9(8) COMP.	0	0	1
51000178	51	       01 PROCTRAN-RIDFLD               PIC S9(8) COMP.	0	0	1
51000180	51	       01 WS-REJ-REAS.	0	0	1
51000181	51	          03 WS-REASON-TEXT             PIC X(26)     VALUE SPACES.	0	0	1
51000182	51	          03 WS-TO-ACC                  PIC 9(14) DISPLAY	0	0	1
51000183	51	                                                      VALUE 0.	0	0	1
51000184	51	      * 01 WS-REJ-COMBINED.	1	0	0
51000185	51	      *    03 WS-REJ-COMBINED-SORT       PIC X(6).	1	0	1
51000186	51	      *    03 WS-REJ-COMBINED-ACC        PIC X(8).	1	0	1
51000187	51	      *	1	0	1
51000188	51	      * 01 WS-PROC-COMBINED.	1	0	1
51000189	51	      *    03 WS-PROC-COMBINED-SORT      PIC X(6).	1	0	1
51000190	51	      *    03 WS-PROC-COMBINED-ACC       PIC X(8).	1	0	1
51000192	51	       01 WS-PROC-REAS.	0	0	0
51000193	51	          03 WS-PROC-TEXT               PIC X(26)     VALUE SPACES.	0	0	1
51000194	51	          03 WS-PROC-TO                 PIC 9(14) DISPLAY	0	0	1
51000195	51	                                                      VALUE 0.	0	0	1
51000196	51	       01 WS-TESTING-DB-NAME.	0	0	1
51000197	51	          03 WS-TESTING-TYPE            PIC X(9)      VALUE 'STTESTER.'.	0	0	1
51000198	51	          03 WS-TESTING-TABLE-NAME      PIC X(4)      VALUE 'PLOP'.	0	0	1
51000200	51	       01 WS-SQLCODE1                   PIC 9(15).	0	0	1
51000202	51	       EXEC SQL INCLUDE SQLDA END-EXEC.	0	0	1
51000204	51	       01 STMTBUF.	0	0	1
51000205	51	          49 STMTLEN                    PIC S9(4) COMP	0	0	1
51000206	51	                                                      VALUE +78.	0	0	1
51000207	51	          49 STMTTXT                    PIC X(78).	0	0	1
51000209	51	       01 STMTBUF2.	0	0	1
51000210	51	          49 STMTLEN2                   PIC S9(4) COMP	0	0	1
51000211	51	                                                      VALUE +81.	0	0	1
51000212	51	          49 STMTTXT2                   PIC X(81).	0	0	1
51000214	51	       01 DISP-LOT.	0	0	1
51000215	51	          03 DISP-SIGN                  PIC X.	0	0	1
51000216	51	          03 DISP-SQLCD                 PIC 9999.	0	0	1
51000218	51	       01 WS-WANTED.	0	0	1
51000219	51	          03 VAR-LEN                    PIC S9(4) COMP	0	0	1
51000220	51	                                                      VALUE +78.	0	0	1
51000221	51	          03 VAR-TXT                    PIC X(78).	0	0	1
51000223	51	       01 WS-WANTED2.	0	0	1
51000224	51	          03 VAR-LEN2                   PIC S9(4) COMP	0	0	1
51000225	51	                                                      VALUE +81.	0	0	1
51000226	51	          03 VAR-TXT2                   PIC X(81).	0	0	1
51000228	51	       01 WS-INPUT-TAB-NAME             PIC X(4).	0	0	1
51000229	51	       01 WS-INPUT-TAB-NAME2            PIC X(7).	0	0	1
51000231	51	       01 WS-PASSED-DATA.	0	0	1
51000232	51	          02 WS-TEST-KEY                PIC X(4).	0	0	1
51000233	51	          02 WS-SORT-CODE               PIC 9(6).	0	0	1
51000234	51	          02 WS-CUSTOMER-RANGE.	0	0	1
51000235	51	             07 WS-CUSTOMER-RANGE-TOP   PIC X.	0	0	1
51000236	51	             07 WS-CUSTOMER-RANGE-MIDDLE	0	0	1
51000237	51	                                        PIC X.	0	0	1
51000238	51	             07 WS-CUSTOMER-RANGE-BOTTOM	0	0	1
51000239	51	                                        PIC X.	0	0	1
51000240	51	       01 MY-ABEND-CODE                 PIC XXXX.	0	0	1
51000242	51	       01 WS-STORM-DRAIN                PIC X         VALUE 'N'.	0	0	1
51000243	51	       01 STORM-DRAIN-CONDITION         PIC X(20).	0	0	1
51000245	51	       01 SQLCODE-DISPLAY               PIC S9(8) DISPLAY	0	0	1
51000246	51	             SIGN LEADING SEPARATE.	0	0	1
51000248	51	       01 NUMERIC-AMOUNT-DISPLAY        PIC +9(10).99.	0	0	1
51000250	51	       01 WS-TIME-DATA.	0	0	1
51000251	51	          03 WS-TIME-NOW                PIC 9(6).	0	0	1
51000252	51	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
51000253	51	             05 WS-TIME-NOW-GRP-HH      PIC 99.	0	0	1
51000254	51	             05 WS-TIME-NOW-GRP-MM      PIC 99.	0	0	1
51000255	51	             05 WS-TIME-NOW-GRP-SS      PIC 99.	0	0	1
51000257	51	       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.	0	0	1
51000259	51	       01 ABNDINFO-REC.	0	0	1
51000260	51	           COPY ABNDINFO.	0	0	1
51000262	51	       LINKAGE SECTION.	0	0	1
51000264	51	       01 DFHCOMMAREA.	0	0	1
51000265	51	           COPY XFRFUN.	0	0	1
51000268	51	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
51000269	51	       PREMIERE SECTION.	0	0	1
51000270	51	       A010.	0	0	1
51000272	51	           EXEC CICS HANDLE ABEND	0	0	1
51000273	51	              LABEL(ABEND-HANDLING)	0	0	1
51000274	51	           END-EXEC.	0	0	1
51000276	51	           MOVE '0' TO HV-ACCOUNT-EYECATCHER.	0	0	1
51000277	51	           MOVE '0' TO HV-ACCOUNT-SORTCODE.	0	0	1
51000278	51	           MOVE '0' TO HV-ACCOUNT-ACC-NO.	0	0	1
51000279	51	           MOVE  0  TO DB2-DEADLOCK-RETRY.	0	0	1
51000281	51	           MOVE SORTCODE TO COMM-FSCODE COMM-TSCODE.	0	0	1
51000283	51	           MOVE SORTCODE TO DESIRED-SORT-CODE.	0	0	1
51000285	51	      *	1	0	0
51000286	51	      *    If the amount being transferred is negative, then	1	0	1
51000287	51	      *    flag this as a failure and finish.	1	0	1
51000288	51	      *	1	0	1
51000289	51	           IF COMM-AMT <= ZERO	0	0	0
51000290	51	             MOVE 'N' TO COMM-SUCCESS	0	0	1
51000291	51	             MOVE '4' TO COMM-FAIL-CODE	0	0	1
51000292	51	             PERFORM GET-ME-OUT-OF-HERE	0	0	1
51000293	51	           END-IF.	0	0	1
51000295	51	      *	1	0	0
51000296	51	           PERFORM UPDATE-ACCOUNT-DB2	0	0	0
51000298	51	      *	1	0	0
51000299	51	      *    The COMMAREA values have now been set so all we need to do	1	0	1
51000300	51	      *    is finish	1	0	1
51000301	51	      *	1	0	1
51000302	51	           PERFORM GET-ME-OUT-OF-HERE.	0	0	0
51000304	51	       A999.	0	0	1
51000305	51	           EXIT.	0	0	1
51000308	51	       UPDATE-ACCOUNT-DB2 SECTION.	0	0	1
51000309	51	       UAD010.	0	0	1
51000311	51	           MOVE 'N' TO COMM-SUCCESS.	0	0	1
51000312	51	      *	1	0	0
51000313	51	      *    Are we trying to transfer from and to the same account?	1	0	1
51000314	51	      *    We don't allow that.	1	0	1
51000315	51	      *	1	0	1
51000316	51	           IF COMM-FACCNO = COMM-TACCNO	0	0	0
51000317	51	              AND COMM-FSCODE = COMM-TSCODE	0	0	1
51000318	51	      *	1	0	0
51000319	51	      *       Preserve the RESP and RESP2, then set up the	1	0	1
51000320	51	      *       standard ABEND info before getting the applid,	1	0	1
51000321	51	      *       date/time etc. and linking to the Abend Handler	1	0	1
51000322	51	      *       program.	1	0	1
51000323	51	      *	1	0	1
51000324	51	              INITIALIZE ABNDINFO-REC	0	0	0
51000325	51	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51000326	51	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51000327	51	      *	1	0	0
51000328	51	      *       Get supplemental information	1	0	1
51000329	51	      *	1	0	1
51000330	51	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51000331	51	              END-EXEC	0	0	1
51000333	51	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51000334	51	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51000336	51	              PERFORM POPULATE-TIME-DATE	0	0	1
51000338	51	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51000339	51	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51000340	51	                    ':' DELIMITED BY SIZE,	0	0	1
51000341	51	                    WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51000342	51	                    ':' DELIMITED BY SIZE,	0	0	1
51000343	51	                    WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51000344	51	                    INTO ABND-TIME	0	0	1
51000345	51	              END-STRING	0	0	1
51000347	51	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51000348	51	              MOVE 'SAME'      TO ABND-CODE	0	0	1
51000350	51	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51000351	51	              END-EXEC	0	0	1
51000353	51	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51000355	51	              STRING 'UAD010 - Cannot transfer to the same account '	0	0	1
51000356	51	                   DELIMITED BY SIZE,	0	0	1
51000357	51	                   ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51000358	51	                   ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51000359	51	                   ' RESP2=' DELIMITED BY SIZE,	0	0	1
51000360	51	                   ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51000361	51	                   INTO ABND-FREEFORM	0	0	1
51000362	51	              END-STRING	0	0	1
51000364	51	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51000365	51	                       COMMAREA(ABNDINFO-REC)	0	0	1
51000366	51	              END-EXEC	0	0	1
51000368	51	              DISPLAY 'Cannot transfer to the same account'	0	0	1
51000370	51	              EXEC CICS ABEND	0	0	1
51000371	51	                 ABCODE('SAME')	0	0	1
51000372	51	                 NODUMP	0	0	1
51000373	51	                 CANCEL	0	0	1
51000374	51	              END-EXEC	0	0	1
51000376	51	           END-IF.	0	0	1
51000378	51	           IF COMM-FACCNO < COMM-TACCNO	0	0	1
51000379	51	      *	1	0	0
51000380	51	      *       If the FROM account number is less than the TO	1	0	1
51000381	51	      *       account number	1	0	1
51000382	51	      *	1	0	1
51000383	51	              MOVE COMM-FACCNO TO DESIRED-ACC-NO	0	0	0
51000384	51	              MOVE COMM-FSCODE TO DESIRED-SORT-CODE	0	0	1
51000386	51	      *	1	0	0
51000387	51	      *       Update the FROM account	1	0	1
51000388	51	      *	1	0	1
51000389	51	              PERFORM UPDATE-ACCOUNT-DB2-FROM	0	0	0
51000391	51	      *	1	0	0
51000392	51	      *       If the update was successful, update the TO account	1	0	1
51000393	51	      *	1	0	1
51000394	51	              IF COMM-SUCCESS = 'Y'	0	0	0
51000395	51	                 MOVE COMM-TACCNO TO DESIRED-ACC-NO	0	0	1
51000396	51	                 MOVE COMM-TSCODE TO DESIRED-SORT-CODE	0	0	1
51000398	51	                 PERFORM UPDATE-ACCOUNT-DB2-TO	0	0	1
51000400	51	      *	1	0	0
51000401	51	      *          If the update to the TO account was unsuccessful then	1	0	1
51000402	51	      *          we need to flag it and roll it back	1	0	1
51000403	51	      *	1	0	1
51000404	51	                 IF COMM-SUCCESS = 'N'	0	0	0
51000406	51	                    IF COMM-FAIL-CODE = '2'	0	0	1
51000407	51	                       EXEC CICS SYNCPOINT	0	0	1
51000408	51	                          ROLLBACK	0	0	1
51000409	51	                          RESP(WS-CICS-RESP)	0	0	1
51000410	51	                          RESP2(WS-CICS-RESP2)	0	0	1
51000411	51	                       END-EXEC	0	0	1
51000413	51	                       IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	1
51000414	51	      *	1	0	0
51000415	51	      *                   Preserve the RESP and RESP2, then set up the	1	0	1
51000416	51	      *                   standard ABEND info before getting the applid,	1	0	1
51000417	51	      *                   date/time etc. and linking to the Abend	1	0	1
51000418	51	      *                   Handler program.	1	0	1
51000419	51	      *	1	0	1
51000420	51	                          INITIALIZE ABNDINFO-REC	0	0	0
51000421	51	                          MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51000422	51	                          MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51000423	51	      *	1	0	0
51000424	51	      *                   Get supplemental information	1	0	1
51000425	51	      *	1	0	1
51000426	51	                          EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51000427	51	                          END-EXEC	0	0	1
51000429	51	                          MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51000430	51	                          MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51000432	51	                          PERFORM POPULATE-TIME-DATE	0	0	1
51000434	51	                          MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51000435	51	                          STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51000436	51	                             ':' DELIMITED BY SIZE,	0	0	1
51000437	51	                             WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51000438	51	                             ':' DELIMITED BY SIZE,	0	0	1
51000439	51	                             WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51000440	51	                             INTO ABND-TIME	0	0	1
51000441	51	                          END-STRING	0	0	1
51000443	51	                          MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51000444	51	                          MOVE 'HROL'      TO ABND-CODE	0	0	1
51000446	51	                          EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51000447	51	                          END-EXEC	0	0	1
51000449	51	                          MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51000451	51	                          STRING 'UAD010(2) - Error on SYNCPOINT'	0	0	1
51000452	51	                             DELIMITED BY SIZE,	0	0	1
51000453	51	                             ' ROLLBACK' DELIMITED BY SIZE,	0	0	1
51000454	51	                             ' after UPDATING TO account '	0	0	1
51000455	51	                             DELIMITED BY SIZE,	0	0	1
51000456	51	                             ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51000457	51	                             ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51000458	51	                             ' RESP2=' DELIMITED BY SIZE,	0	0	1
51000459	51	                             ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51000460	51	                             INTO ABND-FREEFORM	0	0	1
51000461	51	                          END-STRING	0	0	1
51000463	51	                          EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51000464	51	                             COMMAREA(ABNDINFO-REC)	0	0	1
51000465	51	                          END-EXEC	0	0	1
51000467	51	                          DISPLAY 'XFRFUN error syncpoint rollback'	0	0	1
51000468	51	                             ' after updating TO account '	0	0	1
51000469	51	                             ',RESP=' WS-CICS-RESP	0	0	1
51000470	51	                             ',RESP2=' WS-CICS-RESP2	0	0	1
51000472	51	                          EXEC CICS ABEND	0	0	1
51000473	51	                             ABCODE('HROL')	0	0	1
51000474	51	                             NODUMP	0	0	1
51000475	51	                             CANCEL	0	0	1
51000476	51	                          END-EXEC	0	0	1
51000477	51	                       END-IF	0	0	1
51000479	51	                       GO TO UAD999	0	0	1
51000481	51	                    ELSE	0	0	1
51000482	51	      *	1	0	0
51000483	51	      *                If the COMM-FLAG is anything else other than	1	0	1
51000484	51	      *                2 then abend.	1	0	1
51000485	51	      *	1	0	1
51000486	51	                       DISPLAY 'Error updating TO account'	0	0	0
51000488	51	                       EXEC CICS ABEND	0	0	1
51000489	51	                          ABCODE('TO  ')	0	0	1
51000490	51	                          NODUMP	0	0	1
51000491	51	                       END-EXEC	0	0	1
51000492	51	                    END-IF	0	0	1
51000494	51	                 END-IF	0	0	1
51000496	51	              ELSE	0	0	1
51000497	51	      *	1	0	0
51000498	51	      *          If the update to the FROM account was not successful	1	0	1
51000499	51	      *          rollback.	1	0	1
51000500	51	      *	1	0	1
51000501	51	                 IF COMM-FAIL-CODE = '1'	0	0	0
51000503	51	                    EXEC CICS SYNCPOINT	0	0	1
51000504	51	                       ROLLBACK	0	0	1
51000505	51	                       RESP(WS-CICS-RESP)	0	0	1
51000506	51	                       RESP2(WS-CICS-RESP2)	0	0	1
51000507	51	                    END-EXEC	0	0	1
51000509	51	      *	1	0	0
51000510	51	      *             If the ROLLback failed	1	0	1
51000511	51	      *	1	0	1
51000512	51	                    IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	0
51000513	51	                       DISPLAY 'XFRFUN error syncpoint '	0	0	1
51000514	51	                          ' rollback after '	0	0	1
51000515	51	                          'updating FROM account '	0	0	1
51000516	51	                          ',RESP=' WS-CICS-RESP	0	0	1
51000517	51	                          ',RESP2=' WS-CICS-RESP2	0	0	1
51000519	51	                       EXEC CICS ABEND	0	0	1
51000520	51	                          ABCODE('HROL')	0	0	1
51000521	51	                          NODUMP	0	0	1
51000522	51	                       END-EXEC	0	0	1
51000523	51	                    END-IF	0	0	1
51000525	51	                    GO TO UAD999	0	0	1
51000526	51	                 ELSE	0	0	1
51000527	51	      *	1	0	0
51000528	51	      *             Preserve the RESP and RESP2, then set up the	1	0	1
51000529	51	      *             standard ABEND info before getting the applid,	1	0	1
51000530	51	      *             date/time etc. and linking to the Abend Handler	1	0	1
51000531	51	      *             program.	1	0	1
51000532	51	      *	1	0	1
51000533	51	                    INITIALIZE ABNDINFO-REC	0	0	0
51000534	51	                    MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51000535	51	                    MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51000536	51	      *	1	0	0
51000537	51	      *             Get supplemental information	1	0	1
51000538	51	      *	1	0	1
51000539	51	                    EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51000540	51	                    END-EXEC	0	0	1
51000542	51	                    MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51000543	51	                    MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51000545	51	                    PERFORM POPULATE-TIME-DATE	0	0	1
51000547	51	                    MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51000548	51	                    STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51000549	51	                        ':' DELIMITED BY SIZE,	0	0	1
51000550	51	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51000551	51	                        ':' DELIMITED BY SIZE,	0	0	1
51000552	51	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51000553	51	                        INTO ABND-TIME	0	0	1
51000554	51	                    END-STRING	0	0	1
51000556	51	                    MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51000557	51	                    MOVE 'FROM'      TO ABND-CODE	0	0	1
51000559	51	                    EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51000560	51	                    END-EXEC	0	0	1
51000562	51	                    MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51000564	51	                    STRING 'UAD010(3) - Error updating FROM account '	0	0	1
51000565	51	                       DELIMITED BY SIZE,	0	0	1
51000566	51	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51000567	51	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51000568	51	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
51000569	51	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51000570	51	                       INTO ABND-FREEFORM	0	0	1
51000571	51	                    END-STRING	0	0	1
51000573	51	                    EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51000574	51	                           COMMAREA(ABNDINFO-REC)	0	0	1
51000575	51	                    END-EXEC	0	0	1
51000577	51	                    DISPLAY 'Error updating FROM account'	0	0	1
51000579	51	                    EXEC CICS ABEND	0	0	1
51000580	51	                       ABCODE('FROM')	0	0	1
51000581	51	                       NODUMP	0	0	1
51000582	51	                       CANCEL	0	0	1
51000583	51	                    END-EXEC	0	0	1
51000585	51	                 END-IF	0	0	1
51000587	51	              END-IF	0	0	1
51000589	51	           ELSE	0	0	1
51000590	51	      *	1	0	0
51000591	51	      *       The FROM account number is greater than the TO	1	0	1
51000592	51	      *       account number	1	0	1
51000593	51	      *	1	0	1
51000594	51	              MOVE COMM-TACCNO TO DESIRED-ACC-NO	0	0	0
51000595	51	              MOVE COMM-TSCODE TO DESIRED-SORT-CODE	0	0	1
51000597	51	      *	1	0	0
51000598	51	      *       Update the TO account number	1	0	1
51000599	51	      *	1	0	1
51000600	51	              PERFORM UPDATE-ACCOUNT-DB2-TO	0	0	0
51000602	51	      *	1	0	0
51000603	51	      *       If the update to the TO account was successful	1	0	1
51000604	51	      *       then update the FROM account	1	0	1
51000605	51	      *	1	0	1
51000606	51	              IF COMM-SUCCESS = 'Y'	0	0	0
51000607	51	                 MOVE COMM-FACCNO TO DESIRED-ACC-NO	0	0	1
51000608	51	                 MOVE COMM-FSCODE TO DESIRED-SORT-CODE	0	0	1
51000610	51	                 PERFORM UPDATE-ACCOUNT-DB2-FROM	0	0	1
51000612	51	      *	1	0	0
51000613	51	      *          Did the update to the FROM account work?	1	0	1
51000614	51	      *	1	0	1
51000615	51	                 IF COMM-SUCCESS = 'N'	0	0	0
51000617	51	                    IF COMM-FAIL-CODE NOT = '1'	0	0	1
51000618	51	      *	1	0	0
51000619	51	      *                Preserve the RESP and RESP2, then set up the	1	0	1
51000620	51	      *                standard ABEND info before getting the applid,	1	0	1
51000621	51	      *                date/time etc. and linking to the Abend Handler	1	0	1
51000622	51	      *                program.	1	0	1
51000623	51	      *	1	0	1
51000624	51	                       INITIALIZE ABNDINFO-REC	0	0	0
51000625	51	                       MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51000626	51	                       MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51000627	51	      *	1	0	0
51000628	51	      *                Get supplemental information	1	0	1
51000629	51	      *	1	0	1
51000630	51	                       EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51000631	51	                       END-EXEC	0	0	1
51000633	51	                       MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51000634	51	                       MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51000636	51	                       PERFORM POPULATE-TIME-DATE	0	0	1
51000638	51	                       MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51000639	51	                       STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51000640	51	                          ':' DELIMITED BY SIZE,	0	0	1
51000641	51	                          WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51000642	51	                          ':' DELIMITED BY SIZE,	0	0	1
51000643	51	                          WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51000644	51	                          INTO ABND-TIME	0	0	1
51000645	51	                       END-STRING	0	0	1
51000647	51	                       MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51000648	51	                       MOVE 'FROM'      TO ABND-CODE	0	0	1
51000650	51	                       EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51000651	51	                       END-EXEC	0	0	1
51000653	51	                       MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51000655	51	                       STRING 'UAD010(4) - Error updating FROM account '	0	0	1
51000656	51	                          DELIMITED BY SIZE,	0	0	1
51000657	51	                          ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51000658	51	                          ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51000659	51	                          ' RESP2=' DELIMITED BY SIZE,	0	0	1
51000660	51	                          ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51000661	51	                          INTO ABND-FREEFORM	0	0	1
51000662	51	                       END-STRING	0	0	1
51000664	51	                       EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51000665	51	                             COMMAREA(ABNDINFO-REC)	0	0	1
51000666	51	                       END-EXEC	0	0	1
51000668	51	                       DISPLAY 'Error updating FROM account'	0	0	1
51000669	51	                       EXEC CICS ABEND	0	0	1
51000670	51	                           ABCODE('FROM')	0	0	1
51000671	51	                           NODUMP	0	0	1
51000672	51	                           CANCEL	0	0	1
51000673	51	                       END-EXEC	0	0	1
51000675	51	                    ELSE	0	0	1
51000676	51	      *	1	0	0
51000677	51	      *                If the FAIL code is something else	1	0	1
51000678	51	      *	1	0	1
51000679	51	                       EXEC CICS SYNCPOINT	0	0	0
51000680	51	                          ROLLBACK	0	0	1
51000681	51	                          RESP(WS-CICS-RESP)	0	0	1
51000682	51	                          RESP2(WS-CICS-RESP2)	0	0	1
51000683	51	                       END-EXEC	0	0	1
51000684	51	      *	1	0	0
51000685	51	      *                If that rollback didn't work	1	0	1
51000686	51	      *	1	0	1
51000687	51	                       IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	0
51000688	51	      *	1	0	0
51000689	51	      *                   Preserve the RESP and RESP2, then set up the	1	0	1
51000690	51	      *                   standard ABEND info before getting the	1	0	1
51000691	51	      *                   applid, date/time etc. and linking to the	1	0	1
51000692	51	      *                   Abend Handler program.	1	0	1
51000693	51	      *	1	0	1
51000694	51	                          INITIALIZE ABNDINFO-REC	0	0	0
51000695	51	                          MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51000696	51	                          MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51000697	51	      *	1	0	0
51000698	51	      *                   Get supplemental information	1	0	1
51000699	51	      *	1	0	1
51000700	51	                          EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51000701	51	                          END-EXEC	0	0	1
51000703	51	                          MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51000704	51	                          MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51000706	51	                          PERFORM POPULATE-TIME-DATE	0	0	1
51000708	51	                          MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51000709	51	                          STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51000710	51	                             ':' DELIMITED BY SIZE,	0	0	1
51000711	51	                              WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51000712	51	                              ':' DELIMITED BY SIZE,	0	0	1
51000713	51	                              WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51000714	51	                              INTO ABND-TIME	0	0	1
51000715	51	                          END-STRING	0	0	1
51000717	51	                          MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51000718	51	                          MOVE 'HROL'      TO ABND-CODE	0	0	1
51000720	51	                          EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51000721	51	                          END-EXEC	0	0	1
51000723	51	                          MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51000725	51	                          STRING 'UAD010(5) - Error on SYNCPOINT '	0	0	1
51000726	51	                             DELIMITED BY SIZE,	0	0	1
51000727	51	                             ' ROLLBACK ' DELIMITED BY SIZE,	0	0	1
51000728	51	                             ' after UPDATING the FROM account'	0	0	1
51000729	51	                             DELIMITED BY SIZE,	0	0	1
51000730	51	                             ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51000731	51	                             ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51000732	51	                             ' RESP2=' DELIMITED BY SIZE,	0	0	1
51000733	51	                             ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51000734	51	                             INTO ABND-FREEFORM	0	0	1
51000735	51	                          END-STRING	0	0	1
51000737	51	                          EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51000738	51	                             COMMAREA(ABNDINFO-REC)	0	0	1
51000739	51	                          END-EXEC	0	0	1
51000741	51	                          DISPLAY 'XFRFUN error syncpoint '	0	0	1
51000742	51	                             ' rollback after '	0	0	1
51000743	51	                             'updating FROM account '	0	0	1
51000744	51	                             ',RESP=' WS-CICS-RESP	0	0	1
51000745	51	                             ',RESP2=' WS-CICS-RESP2	0	0	1
51000747	51	                          EXEC CICS ABEND	0	0	1
51000748	51	                              ABCODE('HROL')	0	0	1
51000749	51	                              NODUMP	0	0	1
51000750	51	                              CANCEL	0	0	1
51000751	51	                          END-EXEC	0	0	1
51000753	51	                       END-IF	0	0	1
51000755	51	                       GO TO UAD999	0	0	1
51000756	51	                    END-IF	0	0	1
51000758	51	                 END-IF	0	0	1
51000760	51	              ELSE	0	0	1
51000762	51	      *	1	0	0
51000763	51	      *          If the update to the TO account was NOT successful	1	0	1
51000764	51	      *          & the fail code isn't = '2'	1	0	1
51000765	51	      *	1	0	1
51000766	51	                 IF COMM-FAIL-CODE NOT = '2'	0	0	0
51000767	51	      *	1	0	0
51000768	51	      *             Preserve the RESP and RESP2, then set up the	1	0	1
51000769	51	      *             standard ABEND info before getting the applid,	1	0	1
51000770	51	      *             date/time etc. and linking to the Abend Handler	1	0	1
51000771	51	      *             program.	1	0	1
51000772	51	      *	1	0	1
51000773	51	                    INITIALIZE ABNDINFO-REC	0	0	0
51000774	51	                    MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51000775	51	                    MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51000776	51	      *	1	0	0
51000777	51	      *             Get supplemental information	1	0	1
51000778	51	      *	1	0	1
51000779	51	                    EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51000780	51	                    END-EXEC	0	0	1
51000782	51	                    MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51000783	51	                    MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51000785	51	                    PERFORM POPULATE-TIME-DATE	0	0	1
51000787	51	                    MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51000788	51	                    STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51000789	51	                       ':' DELIMITED BY SIZE,	0	0	1
51000790	51	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51000791	51	                       ':' DELIMITED BY SIZE,	0	0	1
51000792	51	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51000793	51	                       INTO ABND-TIME	0	0	1
51000794	51	                    END-STRING	0	0	1
51000796	51	                    MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51000797	51	                    MOVE 'TO  '      TO ABND-CODE	0	0	1
51000799	51	                    EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51000800	51	                    END-EXEC	0	0	1
51000802	51	                    MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51000804	51	                    STRING 'UAD010(6) - Error updating TO account '	0	0	1
51000805	51	                       DELIMITED BY SIZE,	0	0	1
51000806	51	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51000807	51	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51000808	51	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
51000809	51	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51000810	51	                       INTO ABND-FREEFORM	0	0	1
51000811	51	                    END-STRING	0	0	1
51000813	51	                    EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51000814	51	                           COMMAREA(ABNDINFO-REC)	0	0	1
51000815	51	                    END-EXEC	0	0	1
51000817	51	                    DISPLAY 'Error updating TO account'	0	0	1
51000819	51	                    EXEC CICS ABEND	0	0	1
51000820	51	                       ABCODE('TO  ')	0	0	1
51000821	51	                       CANCEL	0	0	1
51000822	51	                       NODUMP	0	0	1
51000823	51	                    END-EXEC	0	0	1
51000824	51	                 ELSE	0	0	1
51000826	51	                    EXEC CICS SYNCPOINT	0	0	1
51000827	51	                       ROLLBACK	0	0	1
51000828	51	                       RESP(WS-CICS-RESP)	0	0	1
51000829	51	                       RESP2(WS-CICS-RESP2)	0	0	1
51000830	51	                    END-EXEC	0	0	1
51000832	51	                    IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	1
51000833	51	      *	1	0	0
51000834	51	      *                Preserve the RESP and RESP2, then set up the	1	0	1
51000835	51	      *                standard ABEND info before getting the applid,	1	0	1
51000836	51	      *                date/time etc. and linking to the Abend Handler	1	0	1
51000837	51	      *                program.	1	0	1
51000838	51	      *	1	0	1
51000839	51	                       INITIALIZE ABNDINFO-REC	0	0	0
51000840	51	                       MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51000841	51	                       MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51000842	51	      *	1	0	0
51000843	51	      *                Get supplemental information	1	0	1
51000844	51	      *	1	0	1
51000845	51	                       EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51000846	51	                       END-EXEC	0	0	1
51000848	51	                       MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51000849	51	                       MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51000851	51	                       PERFORM POPULATE-TIME-DATE	0	0	1
51000853	51	                       MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51000854	51	                       STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51000855	51	                          ':' DELIMITED BY SIZE,	0	0	1
51000856	51	                          WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51000857	51	                          ':' DELIMITED BY SIZE,	0	0	1
51000858	51	                          WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51000859	51	                          INTO ABND-TIME	0	0	1
51000860	51	                       END-STRING	0	0	1
51000862	51	                       MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51000863	51	                       MOVE 'HROL'      TO ABND-CODE	0	0	1
51000865	51	                       EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51000866	51	                       END-EXEC	0	0	1
51000868	51	                       MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51000870	51	                       STRING 'UAD010(7) - Error on SYNCPOINT ROLLBACK'	0	0	1
51000871	51	                          DELIMITED BY SIZE,	0	0	1
51000872	51	                          ' after UPDATING the TO account'	0	0	1
51000873	51	                          DELIMITED BY SIZE,	0	0	1
51000874	51	                          ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51000875	51	                          ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51000876	51	                          ' RESP2=' DELIMITED BY SIZE,	0	0	1
51000877	51	                          ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51000878	51	                          INTO ABND-FREEFORM	0	0	1
51000879	51	                       END-STRING	0	0	1
51000881	51	                       EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51000882	51	                             COMMAREA(ABNDINFO-REC)	0	0	1
51000883	51	                       END-EXEC	0	0	1
51000885	51	                       DISPLAY 'XFRFUN error syncpoint rollback after '	0	0	1
51000886	51	                           'updating TO account '	0	0	1
51000887	51	                           ',RESP=' WS-CICS-RESP	0	0	1
51000888	51	                           ',RESP2=' WS-CICS-RESP2	0	0	1
51000890	51	                       EXEC CICS ABEND	0	0	1
51000891	51	                          ABCODE('HROL')	0	0	1
51000892	51	                          NODUMP	0	0	1
51000893	51	                          CANCEL	0	0	1
51000894	51	                       END-EXEC	0	0	1
51000896	51	                    END-IF	0	0	1
51000898	51	                    GO TO UAD999	0	0	1
51000900	51	                 END-IF	0	0	1
51000902	51	              END-IF	0	0	1
51000904	51	           END-IF.	0	0	1
51000906	51	      *	1	0	0
51000907	51	      *    If the updates to the TO and FROM accounts were successful	1	0	1
51000908	51	      *    then we need to write to PROCTRAN (processed transaction)	1	0	1
51000909	51	      *    to record the successful transfer.	1	0	1
51000910	51	      *	1	0	1
51000911	51	           PERFORM WRITE-TO-PROCTRAN.	0	0	0
51000913	51	           MOVE 'Y' TO COMM-SUCCESS.	0	0	1
51000915	51	       UAD999.	0	0	1
51000916	51	           EXIT.	0	0	1
51000919	51	       UPDATE-ACCOUNT-DB2-FROM SECTION.	0	0	1
51000920	51	       UADF010.	0	0	1
51000921	51	      *	1	0	0
51000922	51	      *    Position ourself at the matching FROM account record	1	0	1
51000923	51	      *	1	0	1
51000924	51	           MOVE COMM-FACCNO TO DESIRED-ACC-NO.	0	0	0
51000925	51	           MOVE COMM-FSCODE TO DESIRED-SORT-CODE.	0	0	1
51000927	51	           MOVE DESIRED-SORT-CODE TO HV-ACCOUNT-SORTCODE.	0	0	1
51000928	51	           MOVE DESIRED-ACC-NO TO HV-ACCOUNT-ACC-NO.	0	0	1
51000930	51	           EXEC SQL	0	0	1
51000931	51	              SELECT ACCOUNT_EYECATCHER,	0	0	1
51000932	51	                ACCOUNT_CUSTOMER_NUMBER,	0	0	1
51000933	51	                ACCOUNT_SORTCODE,	0	0	1
51000934	51	                ACCOUNT_NUMBER,	0	0	1
51000935	51	                ACCOUNT_TYPE,	0	0	1
51000936	51	                ACCOUNT_INTEREST_RATE,	0	0	1
51000937	51	                ACCOUNT_OPENED,	0	0	1
51000938	51	                ACCOUNT_OVERDRAFT_LIMIT,	0	0	1
51000939	51	                ACCOUNT_LAST_STATEMENT,	0	0	1
51000940	51	                ACCOUNT_NEXT_STATEMENT,	0	0	1
51000941	51	                ACCOUNT_AVAILABLE_BALANCE,	0	0	1
51000942	51	                ACCOUNT_ACTUAL_BALANCE	0	0	1
51000943	51	              INTO  :HV-ACCOUNT-EYECATCHER,	0	0	1
51000944	51	                :HV-ACCOUNT-CUST-NO,	0	0	1
51000945	51	                :HV-ACCOUNT-SORTCODE,	0	0	1
51000946	51	                :HV-ACCOUNT-ACC-NO,	0	0	1
51000947	51	                :HV-ACCOUNT-ACC-TYPE,	0	0	1
51000948	51	                :HV-ACCOUNT-INT-RATE,	0	0	1
51000949	51	                :HV-ACCOUNT-OPENED,	0	0	1
51000950	51	                :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
51000951	51	                :HV-ACCOUNT-LAST-STMT,	0	0	1
51000952	51	                :HV-ACCOUNT-NEXT-STMT,	0	0	1
51000953	51	                :HV-ACCOUNT-AVAIL-BAL,	0	0	1
51000954	51	                :HV-ACCOUNT-ACTUAL-BAL	0	0	1
51000955	51	              FROM ACCOUNT	0	0	1
51000956	51	              WHERE  (ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND	0	0	1
51000957	51	                ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO)	0	0	1
51000958	51	           END-EXEC.	0	0	1
51000960	51	      *	1	0	0
51000961	51	      *    Check that select was successful. If it wasn't then set the	1	0	1
51000962	51	      *    COMMAREA return flags accordingly.	1	0	1
51000963	51	      *	1	0	1
51000964	51	           IF SQLCODE NOT = 0	0	0	0
51000965	51	              MOVE 'N' TO COMM-SUCCESS	0	0	1
51000967	51	              IF SQLCODE = +100	0	0	1
51000968	51	                 MOVE '1' TO COMM-FAIL-CODE	0	0	1
51000969	51	              ELSE	0	0	1
51000970	51	                 MOVE '3' TO COMM-FAIL-CODE	0	0	1
51000971	51	              END-IF	0	0	1
51000972	51	      *	1	0	0
51000973	51	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
51000974	51	      *       is applicable in a workload if activated	1	0	1
51000975	51	      *	1	0	1
51000976	51	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
51000978	51	              GO TO UADF999	0	0	1
51000980	51	           END-IF.	0	0	1
51000982	51	      *	1	0	0
51000983	51	      *    If the SQLCODE is OK then update the row on ACCOUNT for	1	0	1
51000984	51	      *    the FROM account.	1	0	1
51000985	51	      *	1	0	1
51000986	51	           COMPUTE HV-ACCOUNT-AVAIL-BAL =	0	0	0
51000987	51	           HV-ACCOUNT-AVAIL-BAL - COMM-AMT.	0	0	1
51000989	51	           COMPUTE HV-ACCOUNT-ACTUAL-BAL =	0	0	1
51000990	51	           HV-ACCOUNT-ACTUAL-BAL - COMM-AMT.	0	0	1
51000992	51	           EXEC SQL	0	0	1
51000993	51	              UPDATE ACCOUNT	0	0	1
51000994	51	              SET ACCOUNT_EYECATCHER        = :HV-ACCOUNT-EYECATCHER,	0	0	1
51000995	51	              ACCOUNT_CUSTOMER_NUMBER   = :HV-ACCOUNT-CUST-NO,	0	0	1
51000996	51	              ACCOUNT_SORTCODE          = :HV-ACCOUNT-SORTCODE,	0	0	1
51000997	51	              ACCOUNT_NUMBER            = :HV-ACCOUNT-ACC-NO,	0	0	1
51000998	51	              ACCOUNT_TYPE              = :HV-ACCOUNT-ACC-TYPE,	0	0	1
51000999	51	              ACCOUNT_INTEREST_RATE     = :HV-ACCOUNT-INT-RATE,	0	0	1
51001000	51	              ACCOUNT_OPENED            = :HV-ACCOUNT-OPENED,	0	0	1
51001001	51	              ACCOUNT_OVERDRAFT_LIMIT   = :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
51001002	51	              ACCOUNT_LAST_STATEMENT    = :HV-ACCOUNT-LAST-STMT,	0	0	1
51001003	51	              ACCOUNT_NEXT_STATEMENT    = :HV-ACCOUNT-NEXT-STMT,	0	0	1
51001004	51	              ACCOUNT_AVAILABLE_BALANCE = :HV-ACCOUNT-AVAIL-BAL,	0	0	1
51001005	51	              ACCOUNT_ACTUAL_BALANCE    = :HV-ACCOUNT-ACTUAL-BAL	0	0	1
51001006	51	              WHERE (ACCOUNT_SORTCODE       = :HV-ACCOUNT-SORTCODE AND	0	0	1
51001007	51	              ACCOUNT_NUMBER         = :HV-ACCOUNT-ACC-NO)	0	0	1
51001008	51	           END-EXEC.	0	0	1
51001010	51	      *	1	0	0
51001011	51	      *    If the RESP CODE was NOT OK then we need to indicate a	1	0	1
51001012	51	      *    failure	1	0	1
51001013	51	      *	1	0	1
51001014	51	           IF SQLCODE NOT = 0	0	0	0
51001016	51	              MOVE 'N' TO COMM-SUCCESS	0	0	1
51001017	51	              MOVE '3' TO COMM-FAIL-CODE	0	0	1
51001019	51	      *	1	0	0
51001020	51	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
51001021	51	      *       is applicable in a workload if activated	1	0	1
51001022	51	      *	1	0	1
51001023	51	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
51001025	51	              GO TO UADF999	0	0	1
51001027	51	           END-IF.	0	0	1
51001029	51	      *	1	0	0
51001030	51	      *    If the update to the FROM account was OK store the	1	0	1
51001031	51	      *    updated balances away.	1	0	1
51001032	51	      *	1	0	1
51001033	51	           MOVE HV-ACCOUNT-AVAIL-BAL TO COMM-FAVBAL.	0	0	0
51001034	51	           MOVE HV-ACCOUNT-ACTUAL-BAL TO COMM-FACTBAL.	0	0	1
51001035	51	           MOVE 'Y' TO COMM-SUCCESS.	0	0	1
51001037	51	       UADF999.	0	0	1
51001038	51	           EXIT.	0	0	1
51001041	51	       UPDATE-ACCOUNT-DB2-TO SECTION.	0	0	1
51001042	51	       UADT010.	0	0	1
51001044	51	           MOVE 'N' TO COMM-SUCCESS.	0	0	1
51001045	51	      *	1	0	0
51001046	51	      *    Position ourself at the matching account record	1	0	1
51001047	51	      *    for the TO account	1	0	1
51001048	51	      *	1	0	1
51001049	51	           INITIALIZE HOST-ACCOUNT-ROW.	0	0	0
51001051	51	           MOVE COMM-TACCNO TO DESIRED-ACC-NO.	0	0	1
51001052	51	           MOVE COMM-TSCODE TO DESIRED-SORT-CODE.	0	0	1
51001054	51	           MOVE DESIRED-SORT-CODE TO HV-ACCOUNT-SORTCODE.	0	0	1
51001055	51	           MOVE DESIRED-ACC-NO TO HV-ACCOUNT-ACC-NO.	0	0	1
51001057	51	           EXEC SQL	0	0	1
51001058	51	                SELECT ACCOUNT_EYECATCHER,	0	0	1
51001059	51	                ACCOUNT_CUSTOMER_NUMBER,	0	0	1
51001060	51	                ACCOUNT_SORTCODE,	0	0	1
51001061	51	                ACCOUNT_NUMBER,	0	0	1
51001062	51	                ACCOUNT_TYPE,	0	0	1
51001063	51	                ACCOUNT_INTEREST_RATE,	0	0	1
51001064	51	                ACCOUNT_OPENED,	0	0	1
51001065	51	                ACCOUNT_OVERDRAFT_LIMIT,	0	0	1
51001066	51	                ACCOUNT_LAST_STATEMENT,	0	0	1
51001067	51	                ACCOUNT_NEXT_STATEMENT,	0	0	1
51001068	51	                ACCOUNT_AVAILABLE_BALANCE,	0	0	1
51001069	51	                ACCOUNT_ACTUAL_BALANCE	0	0	1
51001070	51	                INTO  :HV-ACCOUNT-EYECATCHER,	0	0	1
51001071	51	                :HV-ACCOUNT-CUST-NO,	0	0	1
51001072	51	                :HV-ACCOUNT-SORTCODE,	0	0	1
51001073	51	                :HV-ACCOUNT-ACC-NO,	0	0	1
51001074	51	                :HV-ACCOUNT-ACC-TYPE,	0	0	1
51001075	51	                :HV-ACCOUNT-INT-RATE,	0	0	1
51001076	51	                :HV-ACCOUNT-OPENED,	0	0	1
51001077	51	                :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
51001078	51	                :HV-ACCOUNT-LAST-STMT,	0	0	1
51001079	51	                :HV-ACCOUNT-NEXT-STMT,	0	0	1
51001080	51	                :HV-ACCOUNT-AVAIL-BAL,	0	0	1
51001081	51	                :HV-ACCOUNT-ACTUAL-BAL	0	0	1
51001082	51	                FROM ACCOUNT	0	0	1
51001083	51	                WHERE  (ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND	0	0	1
51001084	51	                ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO)	0	0	1
51001085	51	           END-EXEC.	0	0	1
51001087	51	      *	1	0	0
51001088	51	      *    Check that SELECT was successful. If it wasn't then set the	1	0	1
51001089	51	      *    return flags accordingly.	1	0	1
51001090	51	      *	1	0	1
51001091	51	           IF SQLCODE NOT = 0	0	0	0
51001092	51	              MOVE 'N' TO COMM-SUCCESS	0	0	1
51001093	51	      *	1	0	0
51001094	51	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
51001095	51	      *       is applicable in a workload if activated	1	0	1
51001096	51	      *	1	0	1
51001097	51	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
51001099	51	      *	1	0	0
51001100	51	      *       If the TO account was not found	1	0	1
51001101	51	      *	1	0	1
51001102	51	              IF SQLCODE = +100	0	0	0
51001103	51	                 MOVE '2' TO COMM-FAIL-CODE	0	0	1
51001104	51	                 MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
51001106	51	                 DISPLAY 'UPDATE UNABLE TO READ TO ACC'	0	0	1
51001107	51	                    HV-ACCOUNT-SORTCODE '/' HV-ACCOUNT-ACC-NO	0	0	1
51001108	51	                    ' ROLLBACK TO AVOID DATA INCONSISTENCY.'	0	0	1
51001109	51	                    'SQLCODE=' SQLCODE-DISPLAY	0	0	1
51001111	51	                 EXEC CICS SYNCPOINT ROLLBACK	0	0	1
51001112	51	                   RESP(WS-CICS-RESP)	0	0	1
51001113	51	                   RESP2(WS-CICS-RESP2)	0	0	1
51001114	51	                 END-EXEC	0	0	1
51001116	51	                 IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	1
51001117	51	      *	1	0	0
51001118	51	      *             Preserve the RESP and RESP2, then set up the	1	0	1
51001119	51	      *             standard ABEND info before getting the applid,	1	0	1
51001120	51	      *             date/time etc. and linking to the Abend Handler	1	0	1
51001121	51	      *             program.	1	0	1
51001122	51	      *	1	0	1
51001123	51	                    INITIALIZE ABNDINFO-REC	0	0	0
51001124	51	                    MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51001125	51	                    MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51001126	51	      *	1	0	0
51001127	51	      *             Get supplemental information	1	0	1
51001128	51	      *	1	0	1
51001129	51	                    EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51001130	51	                    END-EXEC	0	0	1
51001132	51	                    MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51001133	51	                    MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51001135	51	                    PERFORM POPULATE-TIME-DATE	0	0	1
51001137	51	                    MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51001138	51	                    STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51001139	51	                          ':' DELIMITED BY SIZE,	0	0	1
51001140	51	                          WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51001141	51	                          ':' DELIMITED BY SIZE,	0	0	1
51001142	51	                          WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51001143	51	                          INTO ABND-TIME	0	0	1
51001144	51	                    END-STRING	0	0	1
51001146	51	                    MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51001147	51	                    MOVE 'HROL'      TO ABND-CODE	0	0	1
51001149	51	                    EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51001150	51	                    END-EXEC	0	0	1
51001152	51	                    MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51001154	51	                    STRING 'UAD010-TO - Error on SYNCPOINT ROLLBACK '	0	0	1
51001155	51	                         DELIMITED BY SIZE,	0	0	1
51001156	51	                         'after failing to read TO account'	0	0	1
51001157	51	                         DELIMITED BY SIZE,	0	0	1
51001158	51	                         ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51001159	51	                         ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51001160	51	                         ' RESP2=' DELIMITED BY SIZE,	0	0	1
51001161	51	                         ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51001162	51	                         INTO ABND-FREEFORM	0	0	1
51001163	51	                    END-STRING	0	0	1
51001165	51	                    EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51001166	51	                             COMMAREA(ABNDINFO-REC)	0	0	1
51001167	51	                    END-EXEC	0	0	1
51001169	51	                    DISPLAY 'XFRFUN error syncpoint rollback after '	0	0	1
51001170	51	                           'failing to read TO account '	0	0	1
51001171	51	                           ',RESP=' WS-CICS-RESP	0	0	1
51001172	51	                           ',RESP2=' WS-CICS-RESP2	0	0	1
51001174	51	                    EXEC CICS ABEND	0	0	1
51001175	51	                       ABCODE('HROL')	0	0	1
51001176	51	                       NODUMP	0	0	1
51001177	51	                       CANCEL	0	0	1
51001178	51	                    END-EXEC	0	0	1
51001179	51	                 END-IF	0	0	1
51001181	51	                 GO TO UADT999	0	0	1
51001183	51	              ELSE	0	0	1
51001184	51	      *	1	0	0
51001185	51	      *          If the failure isn't down to the row NOT being	1	0	1
51001186	51	      *          found (it failed for some other reason)	1	0	1
51001187	51	      *	1	0	1
51001188	51	                 MOVE '3' TO COMM-FAIL-CODE	0	0	0
51001189	51	                 MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
51001191	51	                 DISPLAY 'UPDATE UNABLE TO READ TO ACC'	0	0	1
51001192	51	                    HV-ACCOUNT-SORTCODE HV-ACCOUNT-ACC-NO	0	0	1
51001193	51	                    ' ABENDING TO AVOID DATA INCONSISTENCY. SQLCODE='	0	0	1
51001194	51	                    SQLCODE-DISPLAY	0	0	1
51001195	51	                    ' SQLERRD(3) IS ' SQLERRD(3)	0	0	1
51001197	51	                 IF SQLCODE = -911	0	0	1
51001199	51	                    IF SQLERRD(3) = 13172872	0	0	1
51001200	51	                       DISPLAY 'DEADLOCK DETECTED!'	0	0	1
51001201	51	                       ADD 1 TO DB2-DEADLOCK-RETRY	0	0	1
51001203	51	                       IF DB2-DEADLOCK-RETRY < 6	0	0	1
51001204	51	                          EXEC CICS SYNCPOINT	0	0	1
51001205	51	                             ROLLBACK	0	0	1
51001206	51	                             RESP(WS-CICS-RESP)	0	0	1
51001207	51	                             RESP2(WS-CICS-RESP2)	0	0	1
51001208	51	                          END-EXEC	0	0	1
51001210	51	                          IF WS-CICS-RESP IS NOT EQUAL TO	0	0	1
51001211	51	                          DFHRESP(NORMAL)	0	0	1
51001213	51	      *	1	0	0
51001214	51	      *                      Preserve the RESP and RESP2, then set up	1	0	1
51001215	51	      *                      the standard ABEND info before getting	1	0	1
51001216	51	      *                      the applid, date/time etc. and link	1	0	1
51001217	51	      *                      to the Abend Handler program.	1	0	1
51001218	51	      *	1	0	1
51001219	51	                             INITIALIZE ABNDINFO-REC	0	0	0
51001220	51	                             MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51001221	51	                             MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51001222	51	      *	1	0	0
51001223	51	      *                      Get supplemental information	1	0	1
51001224	51	      *	1	0	1
51001225	51	                             EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51001226	51	                             END-EXEC	0	0	1
51001228	51	                             MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51001229	51	                             MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51001231	51	                             PERFORM POPULATE-TIME-DATE	0	0	1
51001233	51	                             MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51001234	51	                             STRING WS-TIME-NOW-GRP-HH	0	0	1
51001235	51	                                DELIMITED BY SIZE,	0	0	1
51001236	51	                                ':' DELIMITED BY SIZE,	0	0	1
51001237	51	                                WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51001238	51	                                ':' DELIMITED BY SIZE,	0	0	1
51001239	51	                                WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51001240	51	                                INTO ABND-TIME	0	0	1
51001241	51	                             END-STRING	0	0	1
51001243	51	                             MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51001244	51	                             MOVE 'HROL'      TO ABND-CODE	0	0	1
51001246	51	                             EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51001247	51	                             END-EXEC	0	0	1
51001249	51	                             MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51001251	51	                             STRING 'UAD010-TO(2) - Error on SYNCPOINT'	0	0	1
51001252	51	                                DELIMITED BY SIZE,	0	0	1
51001253	51	                                ' ROLLBACK after updating TO account'	0	0	1
51001254	51	                                DELIMITED BY SIZE,	0	0	1
51001255	51	                                ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51001256	51	                                ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51001257	51	                                ' RESP2=' DELIMITED BY SIZE,	0	0	1
51001258	51	                                ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51001259	51	                                INTO ABND-FREEFORM	0	0	1
51001260	51	                             END-STRING	0	0	1
51001262	51	                             EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51001263	51	                                   COMMAREA(ABNDINFO-REC)	0	0	1
51001264	51	                             END-EXEC	0	0	1
51001266	51	                             DISPLAY 'XFRFUN error syncpoint rollback'	0	0	1
51001267	51	                                ' after updating TO account '	0	0	1
51001268	51	                                ',RESP=' WS-CICS-RESP	0	0	1
51001269	51	                                ',RESP2=' WS-CICS-RESP2	0	0	1
51001271	51	                             EXEC CICS ABEND	0	0	1
51001272	51	                                ABCODE('HROL')	0	0	1
51001273	51	                                NODUMP	0	0	1
51001274	51	                                CANCEL	0	0	1
51001275	51	                             END-EXEC	0	0	1
51001277	51	                          END-IF	0	0	1
51001279	51	                          EXEC CICS DELAY FOR SECONDS(1)	0	0	1
51001280	51	                          END-EXEC	0	0	1
51001282	51	                          GO TO UPDATE-ACCOUNT-DB2	0	0	1
51001284	51	                       END-IF	0	0	1
51001286	51	                    END-IF	0	0	1
51001288	51	                    IF SQLERRD(3) = 13172894	0	0	1
51001289	51	                       DISPLAY 'TIMEOUT DETECTED!'	0	0	1
51001290	51	                    END-IF	0	0	1
51001292	51	      *	1	0	0
51001293	51	      *             Preserve the RESP and RESP2, then set up the	1	0	1
51001294	51	      *             standard ABEND info before getting the applid,	1	0	1
51001295	51	      *             date/time etc. and linking to the Abend Handler	1	0	1
51001296	51	      *             program.	1	0	1
51001297	51	      *	1	0	1
51001298	51	                    INITIALIZE ABNDINFO-REC	0	0	0
51001299	51	                    MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51001300	51	                    MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51001301	51	      *	1	0	0
51001302	51	      *             Get supplemental information	1	0	1
51001303	51	      *	1	0	1
51001304	51	                    EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51001305	51	                    END-EXEC	0	0	1
51001307	51	                    MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51001308	51	                    MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51001310	51	                    PERFORM POPULATE-TIME-DATE	0	0	1
51001312	51	                    MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51001313	51	                    STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51001314	51	                        ':' DELIMITED BY SIZE,	0	0	1
51001315	51	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51001316	51	                        ':' DELIMITED BY SIZE,	0	0	1
51001317	51	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51001318	51	                        INTO ABND-TIME	0	0	1
51001319	51	                    END-STRING	0	0	1
51001321	51	                    MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51001322	51	                    MOVE 'RUF2'      TO ABND-CODE	0	0	1
51001324	51	                    EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51001325	51	                    END-EXEC	0	0	1
51001327	51	                    MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51001329	51	                    IF SQLERRD(3) = 13172894	0	0	1
51001330	51	                       STRING 'UAD010-TO(3) - timeout detected '	0	0	1
51001331	51	                          DELIMITED BY SIZE,	0	0	1
51001332	51	                          ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51001333	51	                          ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51001334	51	                          'RESP2=' DELIMITED BY SIZE,	0	0	1
51001335	51	                          ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51001336	51	                          INTO ABND-FREEFORM	0	0	1
51001337	51	                       END-STRING	0	0	1
51001339	51	                    END-IF	0	0	1
51001341	51	                    EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51001342	51	                           COMMAREA(ABNDINFO-REC)	0	0	1
51001343	51	                    END-EXEC	0	0	1
51001345	51	                    EXEC CICS ABEND	0	0	1
51001346	51	                       ABCODE('RUF2')	0	0	1
51001347	51	                    END-EXEC	0	0	1
51001348	51	              END-IF	0	0	1
51001350	51	           END-IF.	0	0	1
51001353	51	      *	1	0	0
51001354	51	      *    If the SELECT was successful, then amend the account balances	1	0	1
51001355	51	      *    and UPDATE the row back onto the ACCOUNT table.	1	0	1
51001356	51	      *	1	0	1
51001357	51	           COMPUTE HV-ACCOUNT-AVAIL-BAL = HV-ACCOUNT-AVAIL-BAL +	0	0	0
51001358	51	                   COMM-AMT.	0	0	1
51001359	51	           COMPUTE HV-ACCOUNT-ACTUAL-BAL = HV-ACCOUNT-ACTUAL-BAL +	0	0	1
51001360	51	                   COMM-AMT.	0	0	1
51001362	51	           EXEC SQL	0	0	1
51001363	51	                UPDATE ACCOUNT	0	0	1
51001364	51	                SET ACCOUNT_EYECATCHER        = :HV-ACCOUNT-EYECATCHER,	0	0	1
51001365	51	                ACCOUNT_CUSTOMER_NUMBER   = :HV-ACCOUNT-CUST-NO,	0	0	1
51001366	51	                ACCOUNT_SORTCODE          = :HV-ACCOUNT-SORTCODE,	0	0	1
51001367	51	                ACCOUNT_NUMBER            = :HV-ACCOUNT-ACC-NO,	0	0	1
51001368	51	                ACCOUNT_TYPE              = :HV-ACCOUNT-ACC-TYPE,	0	0	1
51001369	51	                ACCOUNT_INTEREST_RATE     = :HV-ACCOUNT-INT-RATE,	0	0	1
51001370	51	                ACCOUNT_OPENED            = :HV-ACCOUNT-OPENED,	0	0	1
51001371	51	                ACCOUNT_OVERDRAFT_LIMIT   = :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
51001372	51	                ACCOUNT_LAST_STATEMENT    = :HV-ACCOUNT-LAST-STMT,	0	0	1
51001373	51	                ACCOUNT_NEXT_STATEMENT    = :HV-ACCOUNT-NEXT-STMT,	0	0	1
51001374	51	                ACCOUNT_AVAILABLE_BALANCE = :HV-ACCOUNT-AVAIL-BAL,	0	0	1
51001375	51	                ACCOUNT_ACTUAL_BALANCE    = :HV-ACCOUNT-ACTUAL-BAL	0	0	1
51001376	51	                WHERE (ACCOUNT_SORTCODE   = :HV-ACCOUNT-SORTCODE AND	0	0	1
51001377	51	                ACCOUNT_NUMBER         = :HV-ACCOUNT-ACC-NO)	0	0	1
51001378	51	           END-EXEC.	0	0	1
51001381	51	      *	1	0	0
51001382	51	      *    If the RESP CODE was NOT OK then we need to abend	1	0	1
51001383	51	      *	1	0	1
51001384	51	           IF SQLCODE NOT = 0	0	0	0
51001385	51	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
51001386	51	              DISPLAY 'UNABLE TO UPDATE TO ACCOUNT.'	0	0	1
51001387	51	                 HV-ACCOUNT-SORTCODE HV-ACCOUNT-ACC-NO	0	0	1
51001388	51	                 'THE SQLCODE=' SQLCODE-DISPLAY	0	0	1
51001389	51	                 ' SQLERRD(3) ' SQLERRD(3)	0	0	1
51001391	51	      *	1	0	0
51001392	51	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
51001393	51	      *       is applicable in a workload if activated	1	0	1
51001394	51	      *	1	0	1
51001395	51	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
51001397	51	              IF SQLCODE = -911	0	0	1
51001398	51	                 IF SQLERRD(3) = 13172872	0	0	1
51001399	51	                    DISPLAY 'DEADLOCK DETECTED!'	0	0	1
51001400	51	                    ADD 1 TO DB2-DEADLOCK-RETRY	0	0	1
51001402	51	                    IF DB2-DEADLOCK-RETRY < 6	0	0	1
51001403	51	                       EXEC CICS SYNCPOINT	0	0	1
51001404	51	                          ROLLBACK	0	0	1
51001405	51	                          RESP(WS-CICS-RESP)	0	0	1
51001406	51	                          RESP2(WS-CICS-RESP2)	0	0	1
51001407	51	                       END-EXEC	0	0	1
51001409	51	                       IF WS-CICS-RESP IS NOT EQUAL TO DFHRESP(NORMAL)	0	0	1
51001411	51	      *	1	0	0
51001412	51	      *                   Preserve the RESP and RESP2, then set up the	1	0	1
51001413	51	      *                   standard ABEND info before getting the applid,	1	0	1
51001414	51	      *                   date/time etc. and linking to the Abend	1	0	1
51001415	51	      *                   Handler program.	1	0	1
51001416	51	      *	1	0	1
51001417	51	                          INITIALIZE ABNDINFO-REC	0	0	0
51001418	51	                          MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51001419	51	                          MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51001420	51	      *	1	0	0
51001421	51	      *                   Get supplemental information	1	0	1
51001422	51	      *	1	0	1
51001423	51	                          EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51001424	51	                          END-EXEC	0	0	1
51001426	51	                          MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51001427	51	                          MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51001429	51	                          PERFORM POPULATE-TIME-DATE	0	0	1
51001431	51	                          MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51001432	51	                          STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51001433	51	                             ':' DELIMITED BY SIZE,	0	0	1
51001434	51	                             WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51001435	51	                             ':' DELIMITED BY SIZE,	0	0	1
51001436	51	                             WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51001437	51	                             INTO ABND-TIME	0	0	1
51001438	51	                          END-STRING	0	0	1
51001440	51	                          MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51001441	51	                          MOVE 'HROL'      TO ABND-CODE	0	0	1
51001443	51	                          EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51001444	51	                          END-EXEC	0	0	1
51001446	51	                          MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51001448	51	                          STRING 'UAD010-TO(4) - Error on SYNCPOINT '	0	0	1
51001449	51	                             DELIMITED BY SIZE,	0	0	1
51001450	51	                             'ROLLBACK after Updating TO account'	0	0	1
51001451	51	                             DELIMITED BY SIZE,	0	0	1
51001452	51	                             ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51001453	51	                             ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51001454	51	                             ' RESP2=' DELIMITED BY SIZE,	0	0	1
51001455	51	                             ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51001456	51	                             INTO ABND-FREEFORM	0	0	1
51001457	51	                          END-STRING	0	0	1
51001459	51	                          EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51001460	51	                               COMMAREA(ABNDINFO-REC)	0	0	1
51001461	51	                          END-EXEC	0	0	1
51001463	51	                          DISPLAY 'XFRFUN error syncpoint rollback '	0	0	1
51001464	51	                             ' after updating TO account '	0	0	1
51001465	51	                             ',RESP=' WS-CICS-RESP	0	0	1
51001466	51	                             ',RESP2=' WS-CICS-RESP2	0	0	1
51001468	51	                          EXEC CICS ABEND	0	0	1
51001469	51	                             ABCODE('HROL')	0	0	1
51001470	51	                             NODUMP	0	0	1
51001471	51	                             CANCEL	0	0	1
51001472	51	                          END-EXEC	0	0	1
51001474	51	                       END-IF	0	0	1
51001476	51	                       EXEC CICS DELAY FOR SECONDS(1)	0	0	1
51001477	51	                       END-EXEC	0	0	1
51001479	51	                       GO TO UPDATE-ACCOUNT-DB2	0	0	1
51001481	51	                    END-IF	0	0	1
51001483	51	                 END-IF	0	0	1
51001485	51	                 IF SQLERRD(3) = 13172872	0	0	1
51001486	51	                    DISPLAY 'TIMEOUT DETECTED!'	0	0	1
51001488	51	                 END-IF	0	0	1
51001490	51	              END-IF	0	0	1
51001492	51	      *	1	0	0
51001493	51	      *       Preserve the RESP and RESP2, then set up the	1	0	1
51001494	51	      *       standard ABEND info before getting the applid,	1	0	1
51001495	51	      *       date/time etc. and linking to the Abend Handler	1	0	1
51001496	51	      *       program.	1	0	1
51001497	51	      *	1	0	1
51001498	51	              INITIALIZE ABNDINFO-REC	0	0	0
51001499	51	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51001500	51	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51001501	51	      *	1	0	0
51001502	51	      *       Get supplemental information	1	0	1
51001503	51	      *	1	0	1
51001504	51	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51001505	51	              END-EXEC	0	0	1
51001507	51	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51001508	51	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51001510	51	              PERFORM POPULATE-TIME-DATE	0	0	1
51001512	51	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51001513	51	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51001514	51	                        ':' DELIMITED BY SIZE,	0	0	1
51001515	51	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51001516	51	                        ':' DELIMITED BY SIZE,	0	0	1
51001517	51	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51001518	51	                        INTO ABND-TIME	0	0	1
51001519	51	              END-STRING	0	0	1
51001521	51	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51001522	51	              MOVE 'RUF2'      TO ABND-CODE	0	0	1
51001524	51	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51001525	51	              END-EXEC	0	0	1
51001527	51	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51001529	51	              IF SQLERRD(3) = 13172872	0	0	1
51001530	51	                 STRING 'UAD010-TO(5) - timeout detected '	0	0	1
51001531	51	                       DELIMITED BY SIZE,	0	0	1
51001532	51	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51001533	51	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51001534	51	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
51001535	51	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51001536	51	                       INTO ABND-FREEFORM	0	0	1
51001537	51	                 END-STRING	0	0	1
51001539	51	              END-IF	0	0	1
51001541	51	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51001542	51	                           COMMAREA(ABNDINFO-REC)	0	0	1
51001543	51	              END-EXEC	0	0	1
51001545	51	              EXEC CICS	0	0	1
51001546	51	                 ABEND ABCODE ('RUF3')	0	0	1
51001547	51	              END-EXEC	0	0	1
51001549	51	           END-IF.	0	0	1
51001551	51	      *	1	0	0
51001552	51	      *    Store the data away	1	0	1
51001553	51	      *	1	0	1
51001554	51	           MOVE HV-ACCOUNT-AVAIL-BAL  TO COMM-TAVBAL.	0	0	0
51001555	51	           MOVE HV-ACCOUNT-ACTUAL-BAL TO COMM-TACTBAL.	0	0	1
51001557	51	           MOVE 'Y' TO COMM-SUCCESS.	0	0	1
51001559	51	       UADT999.	0	0	1
51001560	51	           EXIT.	0	0	1
51001563	51	       WRITE-TO-PROCTRAN SECTION.	0	0	1
51001564	51	       WTP010.	0	0	1
51001566	51	           PERFORM WRITE-TO-PROCTRAN-DB2.	0	0	1
51001567	51	       WTP999.	0	0	1
51001568	51	           EXIT.	0	0	1
51001571	51	       WRITE-TO-PROCTRAN-DB2 SECTION.	0	0	1
51001572	51	       WTPD010.	0	0	1
51001573	51	      *	1	0	0
51001574	51	      *    Writes details of the successful transfer to the	1	0	1
51001575	51	      *    PROCTRAN (Processed Transaction) datastore.	1	0	1
51001576	51	      *	1	0	1
51001577	51	           INITIALIZE HOST-PROCTRAN-ROW.	0	0	0
51001578	51	           INITIALIZE WS-EIBTASKN12.	0	0	1
51001580	51	           MOVE 'PRTR' TO HV-PROCTRAN-EYECATCHER.	0	0	1
51001581	51	           MOVE COMM-FSCODE TO HV-PROCTRAN-SORT-CODE.	0	0	1
51001582	51	           MOVE COMM-FACCNO TO HV-PROCTRAN-ACC-NUMBER.	0	0	1
51001583	51	           MOVE EIBTASKN TO WS-EIBTASKN12.	0	0	1
51001584	51	           MOVE WS-EIBTASKN12 TO HV-PROCTRAN-REF.	0	0	1
51001586	51	      *	1	0	0
51001587	51	      *    Populate the time and date	1	0	1
51001588	51	      *	1	0	1
51001589	51	           EXEC CICS ASKTIME	0	0	0
51001590	51	                ABSTIME(WS-U-TIME)	0	0	1
51001591	51	           END-EXEC.	0	0	1
51001593	51	           EXEC CICS FORMATTIME	0	0	1
51001594	51	                ABSTIME(WS-U-TIME)	0	0	1
51001595	51	                DDMMYYYY(WS-ORIG-DATE)	0	0	1
51001596	51	                TIME(HV-PROCTRAN-TIME)	0	0	1
51001597	51	                DATESEP('.')	0	0	1
51001598	51	           END-EXEC.	0	0	1
51001600	51	           MOVE WS-ORIG-DATE TO WS-ORIG-DATE-GRP-X.	0	0	1
51001601	51	           MOVE WS-ORIG-DATE-GRP-X TO HV-PROCTRAN-DATE.	0	0	1
51001603	51	           SET PROC-TY-TRANSFER IN PROCTRAN-AREA TO TRUE	0	0	1
51001605	51	           MOVE PROC-TRAN-TYPE IN PROCTRAN-AREA TO HV-PROCTRAN-TYPE.	0	0	1
51001607	51	           MOVE COMM-AMT TO HV-PROCTRAN-AMOUNT.	0	0	1
51001609	51	           SET PROC-TRAN-DESC-XFR-FLAG IN PROCTRAN-AREA TO TRUE.	0	0	1
51001610	51	           MOVE COMM-TSCODE	0	0	1
51001611	51	             TO PROC-TRAN-DESC-XFR-SORTCODE IN PROCTRAN-AREA.	0	0	1
51001612	51	           MOVE COMM-TACCNO	0	0	1
51001613	51	             TO PROC-TRAN-DESC-XFR-ACCOUNT IN PROCTRAN-AREA.	0	0	1
51001614	51	           MOVE PROC-TRAN-DESC IN PROCTRAN-AREA TO HV-PROCTRAN-DESC.	0	0	1
51001616	51	           EXEC SQL	0	0	1
51001617	51	                INSERT INTO PROCTRAN	0	0	1
51001618	51	                (	0	0	1
51001619	51	                PROCTRAN_EYECATCHER,	0	0	1
51001620	51	                PROCTRAN_SORTCODE,	0	0	1
51001621	51	                PROCTRAN_NUMBER,	0	0	1
51001622	51	                PROCTRAN_DATE,	0	0	1
51001623	51	                PROCTRAN_TIME,	0	0	1
51001624	51	                PROCTRAN_REF,	0	0	1
51001625	51	                PROCTRAN_TYPE,	0	0	1
51001626	51	                PROCTRAN_DESC,	0	0	1
51001627	51	                PROCTRAN_AMOUNT	0	0	1
51001628	51	                )	0	0	1
51001629	51	                VALUES	0	0	1
51001630	51	                (	0	0	1
51001631	51	                :HV-PROCTRAN-EYECATCHER,	0	0	1
51001632	51	                :HV-PROCTRAN-SORT-CODE,	0	0	1
51001633	51	                :HV-PROCTRAN-ACC-NUMBER,	0	0	1
51001634	51	                :HV-PROCTRAN-DATE,	0	0	1
51001635	51	                :HV-PROCTRAN-TIME,	0	0	1
51001636	51	                :HV-PROCTRAN-REF,	0	0	1
51001637	51	                :HV-PROCTRAN-TYPE,	0	0	1
51001638	51	                :HV-PROCTRAN-DESC,	0	0	1
51001639	51	                :HV-PROCTRAN-AMOUNT	0	0	1
51001640	51	                )	0	0	1
51001641	51	           END-EXEC.	0	0	1
51001643	51	      *	1	0	0
51001644	51	      *    Check the SQLCODE	1	0	1
51001645	51	      *	1	0	1
51001646	51	           IF SQLCODE NOT = 0	0	0	0
51001648	51	              MOVE SQLCODE TO WS-SQLCODE-DISP	0	0	1
51001649	51	      *	1	0	0
51001650	51	      *       Preserve the RESP and RESP2, then set up the	1	0	1
51001651	51	      *       standard ABEND info before getting the applid,	1	0	1
51001652	51	      *       date/time etc. and linking to the Abend Handler	1	0	1
51001653	51	      *       program.	1	0	1
51001654	51	      *	1	0	1
51001655	51	              INITIALIZE ABNDINFO-REC	0	0	0
51001656	51	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51001657	51	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51001658	51	      *	1	0	0
51001659	51	      *       Get supplemental information	1	0	1
51001660	51	      *	1	0	1
51001661	51	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51001662	51	              END-EXEC	0	0	1
51001664	51	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51001665	51	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51001667	51	              PERFORM POPULATE-TIME-DATE	0	0	1
51001669	51	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51001670	51	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51001671	51	                     ':' DELIMITED BY SIZE,	0	0	1
51001672	51	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51001673	51	                     ':' DELIMITED BY SIZE,	0	0	1
51001674	51	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51001675	51	                     INTO ABND-TIME	0	0	1
51001676	51	              END-STRING	0	0	1
51001678	51	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51001679	51	              MOVE 'WPCD'      TO ABND-CODE	0	0	1
51001681	51	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51001682	51	              END-EXEC	0	0	1
51001684	51	              MOVE WS-SQLCODE-DISP TO ABND-SQLCODE	0	0	1
51001686	51	              STRING 'WTPD010 - Unable to WRITE to PROCTRAN DB2 '	0	0	1
51001687	51	                    DELIMITED BY SIZE,	0	0	1
51001688	51	                    'datastore. Data='	0	0	1
51001689	51	                    DELIMITED BY SIZE,	0	0	1
51001690	51	                    HOST-PROCTRAN-ROW	0	0	1
51001691	51	                    DELIMITED BY SIZE,	0	0	1
51001692	51	                    '.Data inconsistency, data UPDATED on ACCOUNT file'	0	0	1
51001693	51	                    DELIMITED BY SIZE,	0	0	1
51001694	51	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51001695	51	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51001696	51	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
51001697	51	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51001698	51	                    INTO ABND-FREEFORM	0	0	1
51001699	51	              END-STRING	0	0	1
51001701	51	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51001702	51	                        COMMAREA(ABNDINFO-REC)	0	0	1
51001703	51	              END-EXEC	0	0	1
51001705	51	              DISPLAY 'UNABLE TO WRITE TO PROCTRAN DB2 DATASTORE'	0	0	1
51001706	51	              ' SQLCODE=' SQLCODE	0	0	1
51001707	51	              'WITH THE FOLLOWING DATA:' HOST-PROCTRAN-ROW	0	0	1
51001708	51	              DISPLAY 'DATA INCONSISTENCY, DATA UPDATED ON ACCOUNT'	0	0	1
51001710	51	      *	1	0	0
51001711	51	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
51001712	51	      *       is applicable in a workload if activated	1	0	1
51001713	51	      *	1	0	1
51001714	51	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
51001716	51	              EXEC CICS ABEND	0	0	1
51001717	51	                 ABCODE('WPCD')	0	0	1
51001718	51	              END-EXEC	0	0	1
51001720	51	           END-IF.	0	0	1
51001722	51	       WTPD999.	0	0	1
51001723	51	           EXIT.	0	0	1
51001726	51	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
51001727	51	       GMOOH010.	0	0	1
51001728	51	           EXEC CICS RETURN	0	0	1
51001729	51	           END-EXEC.	0	0	1
51001731	51	           GOBACK.	0	0	1
51001733	51	       GMOOH999.	0	0	1
51001734	51	           EXIT.	0	0	1
51001737	51	       CHECK-FOR-STORM-DRAIN-DB2 SECTION.	0	0	1
51001738	51	       CFSDD010.	0	0	1
51001740	51	      *	1	0	0
51001741	51	      *    Check if the Sqlcode that is returned one that will	1	0	1
51001742	51	      *    trigger Storm Drain is active in Workload	1	0	1
51001743	51	      *	1	0	1
51001744	51	           EVALUATE SQLCODE	0	0	0
51001746	51	              WHEN 923	0	0	1
51001747	51	                 MOVE 'DB2 Connection lost ' TO STORM-DRAIN-CONDITION	0	0	1
51001749	51	              WHEN OTHER	0	0	1
51001750	51	                 MOVE 'Not Storm Drain     ' TO STORM-DRAIN-CONDITION	0	0	1
51001752	51	           END-EVALUATE.	0	0	1
51001754	51	           IF STORM-DRAIN-CONDITION NOT EQUAL 'Not Storm Drain     '	0	0	1
51001756	51	              DISPLAY 'XFRFUN: Check-For-Storm-Drain-DB2: Storm '	0	0	1
51001757	51	                      'Drain condition (' STORM-DRAIN-CONDITION ') '	0	0	1
51001758	51	                      'has been met (' SQLCODE-DISPLAY ').'	0	0	1
51001759	51	           ELSE	0	0	1
51001761	51	              CONTINUE	0	0	1
51001763	51	           END-IF.	0	0	1
51001765	51	       CFSDD999.	0	0	1
51001766	51	           EXIT.	0	0	1
51001769	51	       ABEND-HANDLING SECTION.	0	0	1
51001770	51	       AH010.	0	0	1
51001771	51	      *	1	0	0
51001772	51	      *    Deal with any abends	1	0	1
51001773	51	      *	1	0	1
51001774	51	           EXEC CICS ASSIGN	0	0	0
51001775	51	              ABCODE(MY-ABEND-CODE)	0	0	1
51001776	51	           END-EXEC.	0	0	1
51001778	51	      *	1	0	0
51001779	51	      *    Evaluate the Abend code that is returned	1	0	1
51001780	51	      *     - For DB2 AD2Z ... provide some diagnostics	1	0	1
51001781	51	      *     - For VSAM RLS abends: AFCR, AFCS and AFCT record the	1	0	1
51001782	51	      *    Abend as happening but do not abend ... leave this to	1	0	1
51001783	51	      *    CPSM WLM "Storm drain" (Abend probability) to handle	1	0	1
51001784	51	      *    If not a "storm drain" ... take the abend afterwards	1	0	1
51001785	51	      *	1	0	1
51001786	51	           EVALUATE MY-ABEND-CODE	0	0	0
51001788	51	      *	1	0	0
51001789	51	      *       DB2 AD2Z abend	1	0	1
51001790	51	      *	1	0	1
51001791	51	              WHEN 'AD2Z'	0	0	0
51001793	51	                 MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
51001794	51	                 DISPLAY 'DB2 DEADLOCK DETECTED IN XFRFUN, SQLCODE='	0	0	1
51001795	51	                    SQLCODE-DISPLAY	0	0	1
51001796	51	                 DISPLAY 'DB2 DEADLOCK FOR ACCOUNT '	0	0	1
51001797	51	                    HV-ACCOUNT-ACC-NO	0	0	1
51001798	51	                 DISPLAY  'SQLSTATE=' SQLSTATE	0	0	1
51001799	51	                        ',SQLERRMC=' SQLERRMC(1:SQLERRML)	0	0	1
51001800	51	                        ',SQLERRD(1)=' SQLERRD(1)	0	0	1
51001801	51	                        ',SQLERRD(2)=' SQLERRD(2)	0	0	1
51001802	51	                        ',SQLERRD(3)=' SQLERRD(3)	0	0	1
51001803	51	                        ',SQLERRD(4)=' SQLERRD(4)	0	0	1
51001804	51	                        ',SQLERRD(5)=' SQLERRD(5)	0	0	1
51001805	51	                        ',SQLERRD(6)=' SQLERRD(6)	0	0	1
51001807	51	              WHEN 'AFCR'	0	0	1
51001808	51	              WHEN 'AFCS'	0	0	1
51001809	51	              WHEN 'AFCT'	0	0	1
51001810	51	                 MOVE 'Y' TO WS-STORM-DRAIN	0	0	1
51001811	51	                 DISPLAY 'XFRFUN: Check-For-Storm-Drain-VSAM: Storm '	0	0	1
51001812	51	                       'Drain condition (Abend ' MY-ABEND-CODE ') '	0	0	1
51001813	51	                       'has been met.'	0	0	1
51001815	51	                 EXEC CICS SYNCPOINT	0	0	1
51001816	51	                    ROLLBACK	0	0	1
51001817	51	                    RESP(WS-CICS-RESP)	0	0	1
51001818	51	                    RESP2(WS-CICS-RESP2)	0	0	1
51001819	51	                 END-EXEC	0	0	1
51001821	51	                 IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
51001822	51	      *	1	0	0
51001823	51	      *             Preserve the RESP and RESP2, then set up the	1	0	1
51001824	51	      *             standard ABEND info before getting the applid,	1	0	1
51001825	51	      *             date/time etc. and linking to the Abend Handler	1	0	1
51001826	51	      *             program.	1	0	1
51001827	51	      *	1	0	1
51001828	51	                    INITIALIZE ABNDINFO-REC	0	0	0
51001829	51	                    MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
51001830	51	                    MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
51001831	51	      *	1	0	0
51001832	51	      *             Get supplemental information	1	0	1
51001833	51	      *	1	0	1
51001834	51	                    EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
51001835	51	                    END-EXEC	0	0	1
51001837	51	                    MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
51001838	51	                    MOVE EIBTRNID   TO ABND-TRANID	0	0	1
51001840	51	                    PERFORM POPULATE-TIME-DATE	0	0	1
51001842	51	                    MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
51001843	51	                    STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
51001844	51	                       ':' DELIMITED BY SIZE,	0	0	1
51001845	51	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
51001846	51	                        ':' DELIMITED BY SIZE,	0	0	1
51001847	51	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
51001848	51	                        INTO ABND-TIME	0	0	1
51001849	51	                    END-STRING	0	0	1
51001851	51	                    MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
51001852	51	                    MOVE 'HROL'      TO ABND-CODE	0	0	1
51001854	51	                    EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
51001855	51	                    END-EXEC	0	0	1
51001857	51	                    MOVE ZEROS      TO ABND-SQLCODE	0	0	1
51001859	51	                    STRING 'AH010 - Unable to perform SYNCPOINT '	0	0	1
51001860	51	                       DELIMITED BY SIZE,	0	0	1
51001861	51	                       'ROLLBACK.' DELIMITED BY SIZE,	0	0	1
51001862	51	                       ' Possible integrity issue following VSAM RLS '	0	0	1
51001863	51	                       DELIMITED BY SIZE,	0	0	1
51001864	51	                       'abend.'	0	0	1
51001865	51	                       DELIMITED BY SIZE,	0	0	1
51001866	51	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
51001867	51	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
51001868	51	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
51001869	51	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
51001870	51	                       INTO ABND-FREEFORM	0	0	1
51001871	51	                    END-STRING	0	0	1
51001873	51	                    EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
51001874	51	                           COMMAREA(ABNDINFO-REC)	0	0	1
51001875	51	                    END-EXEC	0	0	1
51001877	51	                    DISPLAY 'XFRFUN: Unable to perform Syncpoint '	0	0	1
51001878	51	                       'Rollback. Possible Integrity issue following '	0	0	1
51001879	51	                       ' VSAM RLS abend RESP CODE='	0	0	1
51001880	51	                       WS-CICS-RESP ' RESP2 CODE=' WS-CICS-RESP2	0	0	1
51001882	51	                    EXEC CICS	0	0	1
51001883	51	                       ABEND	0	0	1
51001884	51	                       ABCODE ('HROL')	0	0	1
51001885	51	                    END-EXEC	0	0	1
51001887	51	                 END-IF	0	0	1
51001889	51	                 MOVE 'N' TO COMM-SUCCESS	0	0	1
51001890	51	                 MOVE '2' TO COMM-FAIL-CODE	0	0	1
51001892	51	                 EXEC CICS RETURN	0	0	1
51001893	51	                 END-EXEC	0	0	1
51001895	51	           END-EVALUATE.	0	0	1
51001897	51	           IF WS-STORM-DRAIN = 'N'	0	0	1
51001899	51	              EXEC CICS ABEND ABCODE( MY-ABEND-CODE)	0	0	1
51001900	51	              NODUMP	0	0	1
51001901	51	              END-EXEC	0	0	1
51001903	51	           END-IF.	0	0	1
51001905	51	       AH999.	0	0	1
51001906	51	           EXIT.	0	0	1
51001909	51	       POPULATE-TIME-DATE SECTION.	0	0	1
51001910	51	       PTD010.	0	0	1
51001912	51	           EXEC CICS ASKTIME	0	0	1
51001913	51	              ABSTIME(WS-U-TIME)	0	0	1
51001914	51	           END-EXEC.	0	0	1
51001916	51	           EXEC CICS FORMATTIME	0	0	1
51001917	51	                     ABSTIME(WS-U-TIME)	0	0	1
51001918	51	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
51001919	51	                     TIME(WS-TIME-NOW)	0	0	1
51001920	51	                     DATESEP	0	0	1
51001921	51	           END-EXEC.	0	0	1
51001923	51	       PTD999.	0	0	1
51001924	51	           EXIT.	0	0	1
52000000	52	<<<< included file >>>>	0	0	0
52000001	52	        01 SQLDA.	0	0	1
52000002	52	            05 SQLDAID PIC X(8).	0	0	0
52000003	52	            05 SQLDABC PIC S9(9)BINARY.	0	0	0
52000004	52	            05 SQLN PIC S9(4)BINARY.	0	0	0
52000005	52	            05 SQLD PIC S9(4)BINARY.	0	0	0
52000006	52	            05 SQLVAR OCCURS 0 TO 750 TIMES DEPENDING ON SQLN.	0	0	0
52000007	52	                10 SQLVAR1.	0	0	0
52000008	52	                    15 SQLTYPE PIC S9(4) BINARY.	0	0	0
52000009	52	                    15 SQLLEN PIC S9(4) BINARY.	0	0	0
52000010	52	                    15 FILLER REDEFINES SQLLEN.	0	0	0
52000011	52	                        20 SQLPRECISION PIC X.	0	0	0
52000012	52	                        20 SQLSCALE PIC X.	0	0	0
52000013	52	                    15 SQLDATA POINTER.	0	0	0
52000014	52	                    15 SQLIND POINTER.	0	0	0
52000015	52	                    15 SQLNAME.	0	0	0
52000016	52	                        49 SQLNAMEL PIC S9(4) BINARY.	0	0	0
52000017	52	                        49 SQLNAMEC PIC X(30).	0	0	0
52000018	52	                10 SQLVAR2 REDEFINES SQLVAR1.	0	0	0
52000019	52	                    15 SQLVAR2-RESERVED-1 PIC S9(9) BINARY.	0	0	0
52000020	52	                    15 SQLLONGLEN REDEFINES SQLVAR2-RESERVED-1	0	0	0
52000021	52	                                PIC S9(9) BINARY.	0	0	0
52000022	52	                    15 SQLVAR2-RESERVED-2 PIC S9(9) BINARY.	0	0	0
52000023	52	                    15 SQLDATALEN POINTER.	0	0	0
52000024	52	                    15 SQLDATATYPE-NAME.	0	0	0
52000025	52	                        20 SQLDATATYPE-NAMEL PIC S9(4) BINARY.	0	0	0
52000026	52	                        20 SQLDATATYPE-NAMEC PIC X(30).	0	0	0
53000000	53	<<<< file not found >>>>	0	0	0
53000001	53	<<<< file not found >>>>	0	0	0
54000001	54	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	0
54000002	54	       CBL CICS('SP,EDF')	0	0	1
54000003	54	      ******************************************************************	1	0	0
54000004	54	      *                                                                *	1	0	1
54000005	54	      *  Copyright IBM Corp. 2023                                      *	1	0	1
54000006	54	      *                                                                *	1	0	1
54000007	54	      ******************************************************************	1	0	1
54000009	54	      ******************************************************************	1	0	1
54000010	54	      * This is the Create Account program. It verifies the input	1	0	1
54000011	54	      * and assuming it passes verification, it links to the CREACC	1	0	1
54000012	54	      * program to add it to the Account datastore.	1	0	1
54000013	54	      *	1	0	1
54000014	54	      ******************************************************************	1	0	1
54000015	54	       IDENTIFICATION DIVISION.	0	0	0
54000016	54	       PROGRAM-ID. BNK1CAC.	0	0	1
54000017	54	       AUTHOR. Jon Collett.	0	0	1
54000019	54	       ENVIRONMENT DIVISION.	0	0	1
54000020	54	       CONFIGURATION SECTION.	0	0	1
54000021	54	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
54000022	54	       SOURCE-COMPUTER.  IBM-370.	0	0	0
54000023	54	       OBJECT-COMPUTER.  IBM-370.	0	0	1
54000025	54	       INPUT-OUTPUT SECTION.	0	0	1
54000027	54	       DATA DIVISION.	0	0	1
54000028	54	       WORKING-STORAGE SECTION.	0	0	1
54000029	54	       01 WS-CICS-WORK-AREA.	0	0	1
54000030	54	          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.	0	0	1
54000031	54	          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.	0	0	1
54000033	54	       01 WS-FAIL-INFO.	0	0	1
54000034	54	          03 FILLER                    PIC X(9)  VALUE 'BNK1CAC  '.	0	0	1
54000035	54	          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.	0	0	1
54000036	54	          03 FILLER                    PIC X(6)  VALUE ' RESP='.	0	0	1
54000037	54	          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.	0	0	1
54000038	54	          03 FILLER                    PIC X(7)  VALUE ' RESP2='.	0	0	1
54000039	54	          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.	0	0	1
54000040	54	          03 FILLER                    PIC X(15)	0	0	1
54000041	54	                                          VALUE ' ABENDING TASK.'.	0	0	1
54000043	54	       01 SWITCHES.	0	0	1
54000044	54	           03 VALID-DATA-SW            PIC X VALUE 'Y'.	0	0	1
54000045	54	              88 VALID-DATA               VALUE 'Y'.	0	0	1
54000047	54	       01 FLAGS.	0	0	1
54000048	54	           03 SEND-FLAG                PIC X.	0	0	1
54000049	54	              88 SEND-ERASE               VALUE '1'.	0	0	1
54000050	54	              88 SEND-DATAONLY            VALUE '2'.	0	0	1
54000051	54	              88 SEND-DATAONLY-ALARM      VALUE '3'.	0	0	1
54000053	54	       01 ACTION-ALPHA.	0	0	1
54000054	54	           03 ACTION-NUM               PIC 9.	0	0	1
54000056	54	      *	1	0	0
54000057	54	      * The end of session message	1	0	1
54000058	54	      *	1	0	1
54000059	54	       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.	0	0	0
54000061	54	       01 RESPONSE-CODE                PIC S9(8) COMP.	0	0	1
54000063	54	       01 COMMUNICATION-AREA           PIC X.	0	0	1
54000065	54	       COPY BNK1CAM.	0	0	1
54000067	54	       COPY DFHAID.	0	0	1
54000069	54	       01 COMM-DOB-SPLIT.	0	0	1
54000070	54	          03 COMM-DOB-SPLIT-DD         PIC 99.	0	0	1
54000071	54	          03 COMM-DOB-SPLIT-MM         PIC 99.	0	0	1
54000072	54	          03 COMM-DOB-SPLIT-YYYY       PIC 9999.	0	0	1
54000074	54	       01 WS-COMM-AREA.	0	0	1
54000075	54	          03 WS-COMM-CUSTNO            PIC 9(10).	0	0	1
54000076	54	          03 WS-COMM-ACCTYPE           PIC X(8).	0	0	1
54000077	54	          03 WS-COMM-INTRT             PIC 9(4)V99.	0	0	1
54000078	54	          03 WS-COMM-OVERDR            PIC 9(8).	0	0	1
54000080	54	       01 DATE-REFORMED.	0	0	1
54000081	54	          03 NSTMTDD-CHAR             PIC XX.	0	0	1
54000082	54	          03 NSTMTDD-REFORM REDEFINES NSTMTDD-CHAR.	0	0	1
54000083	54	             05 NSTMTDD-NUM              PIC 99.	0	0	1
54000084	54	          03 NSTMTMMI-CHAR               PIC XX.	0	0	1
54000085	54	          03 NSTMTMMI-REFORM REDEFINES NSTMTMMI-CHAR.	0	0	1
54000086	54	             05 NSTMTMMI-NUM             PIC 99.	0	0	1
54000087	54	          03 NSTMTYYI-CHAR               PIC XX.	0	0	1
54000088	54	          03 NSTMTYYI-REFORM REDEFINES NSTMTYYI-CHAR.	0	0	1
54000089	54	             05 NSTMTYYI-NUM             PIC 99.	0	0	1
54000091	54	       01 MORE-STRING-CONVS.	0	0	1
54000092	54	          03 NST-CHAR                  PIC X(8).	0	0	1
54000093	54	          03 NST-DATE-GRP REDEFINES NST-CHAR.	0	0	1
54000094	54	             05 NST-NUM                PIC 9(8).	0	0	1
54000096	54	       01 INTRTI-COMP-1 USAGE COMP-1.	0	0	1
54000097	54	       01 INTRT-PIC9                   PIC 9999.99.	0	0	1
54000098	54	       01 WS-NUM-COUNT-POINT           PIC S9(8) BINARY.	0	0	1
54000099	54	       01 WS-NUM-COUNT-TOTAL           PIC S9(8) BINARY.	0	0	1
54000100	54	       01 WS-REVERSE                   PIC X(8).	0	0	1
54000102	54	       01 SUBPGM-PARMS.	0	0	1
54000103	54	          03 SUBPGM-EYECATCHER         PIC X(4).	0	0	1
54000104	54	          03 SUBPGM-CUSTNO             PIC 9(10).	0	0	1
54000105	54	          03 SUBPGM-KEY.	0	0	1
54000106	54	             05 SUBPGM-SORTCODE        PIC 9(6) DISPLAY.	0	0	1
54000107	54	             05 SUBPGM-NUMBER          PIC 9(8) DISPLAY.	0	0	1
54000108	54	          03 SUBPGM-ACC-TYPE           PIC X(8).	0	0	1
54000109	54	          03 SUBPGM-INT-RT             PIC 9(4)V99.	0	0	1
54000110	54	          03 SUBPGM-OPENED             PIC 9(8).	0	0	1
54000111	54	          03 SUBPGM-OVERDR-LIM         PIC 9(8).	0	0	1
54000112	54	          03 SUBPGM-LAST-STMT-DT       PIC 9(8).	0	0	1
54000113	54	          03 SUBPGM-NEXT-STMT-DT       PIC 9(8).	0	0	1
54000114	54	          03 SUBPGM-AVAIL-BAL          PIC S9(10)V99.	0	0	1
54000115	54	          03 SUBPGM-ACT-BAL            PIC S9(10)V99.	0	0	1
54000116	54	          03 SUBPGM-SUCCESS            PIC X.	0	0	1
54000117	54	          03 SUBPGM-FAIL-CODE          PIC X.	0	0	1
54000119	54	       01 COMPANY-NAME-FULL            PIC X(32).	0	0	1
54000121	54	       01 AVAILABLE-BALANCE-DISPLAY    PIC +9(10).99.	0	0	1
54000122	54	       01 ACTUAL-BALANCE-DISPLAY       PIC +9(10).99.	0	0	1
54000124	54	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
54000125	54	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
54000126	54	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
54000127	54	          03 WS-ORIG-DATE-DD           PIC 99.	0	0	1
54000128	54	          03 FILLER                    PIC X.	0	0	1
54000129	54	          03 WS-ORIG-DATE-MM           PIC 99.	0	0	1
54000130	54	          03 FILLER                    PIC X.	0	0	1
54000131	54	          03 WS-ORIG-DATE-YYYY         PIC 9999.	0	0	1
54000133	54	       01 WS-ORIG-DATE-GRP-X.	0	0	1
54000134	54	          03 WS-ORIG-DATE-DD-X         PIC XX.	0	0	1
54000135	54	          03 FILLER                    PIC X VALUE '.'.	0	0	1
54000136	54	          03 WS-ORIG-DATE-MM-X         PIC XX.	0	0	1
54000137	54	          03 FILLER                    PIC X VALUE '.'.	0	0	1
54000138	54	          03 WS-ORIG-DATE-YYYY-X       PIC X(4).	0	0	1
54000140	54	       01 WS-TIME-DATA.	0	0	1
54000141	54	           03 WS-TIME-NOW              PIC 9(6).	0	0	1
54000142	54	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
54000143	54	              05 WS-TIME-NOW-GRP-HH       PIC 99.	0	0	1
54000144	54	              05 WS-TIME-NOW-GRP-MM       PIC 99.	0	0	1
54000145	54	              05 WS-TIME-NOW-GRP-SS       PIC 99.	0	0	1
54000147	54	       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.	0	0	1
54000149	54	       01 ABNDINFO-REC.	0	0	1
54000150	54	           COPY ABNDINFO.	0	0	1
54000152	54	       LINKAGE SECTION.	0	0	1
54000153	54	       01 DFHCOMMAREA.	0	0	1
54000154	54	          03 COMM-CUSTNO            PIC 9(10).	0	0	1
54000155	54	          03 COMM-ACCTYPE           PIC X(8).	0	0	1
54000156	54	          03 COMM-INTRT             PIC 9(4)V99.	0	0	1
54000157	54	          03 COMM-OVERDR            PIC 9(8).	0	0	1
54000159	54	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
54000160	54	       PREMIERE SECTION.	0	0	1
54000161	54	       A010.	0	0	1
54000163	54	           EVALUATE TRUE	0	0	1
54000165	54	      *	1	0	0
54000166	54	      *       Is it the first time through? If so, send the map	1	0	1
54000167	54	      *       with erased (empty) data fields.	1	0	1
54000168	54	      *	1	0	1
54000169	54	              WHEN EIBCALEN = ZERO	0	0	0
54000170	54	                 MOVE LOW-VALUE TO BNK1CAO	0	0	1
54000171	54	                 MOVE -1 TO CUSTNOL	0	0	1
54000172	54	                 SET SEND-ERASE TO TRUE	0	0	1
54000173	54	                 MOVE SPACES TO MESSAGEO	0	0	1
54000174	54	                 PERFORM SEND-MAP	0	0	1
54000176	54	      *	1	0	0
54000177	54	      *       If a PA key is pressed, just carry on	1	0	1
54000178	54	      *	1	0	1
54000179	54	              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3	0	0	0
54000180	54	                 CONTINUE	0	0	1
54000182	54	      *	1	0	0
54000183	54	      *       When Pf3 is pressed, return to the main menu	1	0	1
54000184	54	      *	1	0	1
54000185	54	              WHEN EIBAID = DFHPF3	0	0	0
54000186	54	                 EXEC CICS RETURN	0	0	1
54000187	54	                    TRANSID('OMEN')	0	0	1
54000188	54	                    IMMEDIATE	0	0	1
54000189	54	                    RESP(WS-CICS-RESP)	0	0	1
54000190	54	                    RESP2(WS-CICS-RESP2)	0	0	1
54000191	54	                 END-EXEC	0	0	1
54000193	54	      *	1	0	0
54000194	54	      *       If the aid or Pf12 is pressed, then send a termination	1	0	1
54000195	54	      *       message.	1	0	1
54000196	54	      *	1	0	1
54000197	54	              WHEN EIBAID = DFHAID OR DFHPF12	0	0	0
54000198	54	                 PERFORM SEND-TERMINATION-MSG	0	0	1
54000199	54	                 EXEC CICS	0	0	1
54000200	54	                    RETURN	0	0	1
54000201	54	                 END-EXEC	0	0	1
54000203	54	      *	1	0	0
54000204	54	      *       When CLEAR is pressed	1	0	1
54000205	54	      *	1	0	1
54000206	54	              WHEN EIBAID = DFHCLEAR	0	0	0
54000207	54	                 EXEC CICS SEND CONTROL	0	0	1
54000208	54	                          ERASE	0	0	1
54000209	54	                          FREEKB	0	0	1
54000210	54	                 END-EXEC	0	0	1
54000212	54	                 EXEC CICS RETURN	0	0	1
54000213	54	                 END-EXEC	0	0	1
54000215	54	      *	1	0	0
54000216	54	      *       When enter is pressed then process the content	1	0	1
54000217	54	      *	1	0	1
54000218	54	              WHEN EIBAID = DFHENTER	0	0	0
54000219	54	                 PERFORM PROCESS-MAP	0	0	1
54000221	54	      *	1	0	0
54000222	54	      *       When anything else happens, send the invalid key message	1	0	1
54000223	54	      *	1	0	1
54000224	54	              WHEN OTHER	0	0	0
54000225	54	                 MOVE LOW-VALUES TO BNK1CAO	0	0	1
54000226	54	                 MOVE SPACES TO MESSAGEO	0	0	1
54000227	54	                 MOVE 'Invalid key pressed.' TO MESSAGEO	0	0	1
54000228	54	                 SET SEND-DATAONLY-ALARM TO TRUE	0	0	1
54000229	54	                 PERFORM SEND-MAP	0	0	1
54000231	54	           END-EVALUATE.	0	0	1
54000233	54	      *	1	0	0
54000234	54	      *     Having processed the input or processed the error check	1	0	1
54000235	54	      *     to see if it is the first time through. If it is then	1	0	1
54000236	54	      *     initialise the returned information. If it is not, set	1	0	1
54000237	54	      *     the return information accordingly.	1	0	1
54000238	54	      *	1	0	1
54000239	54	            IF EIBCALEN NOT = 0	0	0	0
54000240	54	               MOVE SUBPGM-CUSTNO     TO WS-COMM-CUSTNO	0	0	1
54000241	54	               MOVE SUBPGM-ACC-TYPE   TO WS-COMM-ACCTYPE	0	0	1
54000242	54	               MOVE SUBPGM-INT-RT     TO WS-COMM-INTRT	0	0	1
54000243	54	               MOVE SUBPGM-OVERDR-LIM TO WS-COMM-OVERDR	0	0	1
54000244	54	            ELSE	0	0	1
54000245	54	               INITIALIZE WS-COMM-AREA	0	0	1
54000246	54	            END-IF.	0	0	1
54000248	54	            EXEC CICS	0	0	1
54000249	54	               RETURN TRANSID('OCAC')	0	0	1
54000250	54	               COMMAREA(WS-COMM-AREA)	0	0	1
54000251	54	               LENGTH(32)	0	0	1
54000252	54	               RESP(WS-CICS-RESP)	0	0	1
54000253	54	               RESP2(WS-CICS-RESP2)	0	0	1
54000254	54	            END-EXEC.	0	0	1
54000256	54	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
54000257	54	              INITIALIZE WS-FAIL-INFO	0	0	1
54000258	54	              MOVE 'BNK1CAC - A010 - RETURN TRANSID(OCAC) FAIL' TO	0	0	1
54000259	54	                 WS-CICS-FAIL-MSG	0	0	1
54000260	54	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
54000261	54	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
54000263	54	      *	1	0	0
54000264	54	      *         Preserve the RESP and RESP2, then set up the	1	0	1
54000265	54	      *         standard ABEND info before getting the applid,	1	0	1
54000266	54	      *         date/time etc. and linking to the Abend Handler	1	0	1
54000267	54	      *         program.	1	0	1
54000268	54	      *	1	0	1
54000269	54	                INITIALIZE ABNDINFO-REC	0	0	0
54000270	54	                MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
54000271	54	                MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
54000272	54	      *	1	0	0
54000273	54	      *         Get supplemental information	1	0	1
54000274	54	      *	1	0	1
54000275	54	                EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
54000276	54	                END-EXEC	0	0	1
54000278	54	                MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
54000279	54	                MOVE EIBTRNID   TO ABND-TRANID	0	0	1
54000281	54	                PERFORM POPULATE-TIME-DATE	0	0	1
54000284	54	                MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
54000285	54	                STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
54000286	54	                       ':' DELIMITED BY SIZE,	0	0	1
54000287	54	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
54000288	54	                       ':' DELIMITED BY SIZE,	0	0	1
54000289	54	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
54000290	54	                       INTO ABND-TIME	0	0	1
54000291	54	                END-STRING	0	0	1
54000293	54	                MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
54000294	54	                MOVE 'HBNK'      TO ABND-CODE	0	0	1
54000296	54	                EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
54000297	54	                END-EXEC	0	0	1
54000299	54	                MOVE ZEROS      TO ABND-SQLCODE	0	0	1
54000301	54	                STRING 'A010- RETURN TRANSID(OCAC) ' DELIMITED BY SIZE,	0	0	1
54000302	54	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
54000303	54	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
54000304	54	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
54000305	54	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
54000306	54	                       INTO ABND-FREEFORM	0	0	1
54000307	54	                END-STRING	0	0	1
54000309	54	                EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
54000310	54	                          COMMAREA(ABNDINFO-REC)	0	0	1
54000311	54	                END-EXEC	0	0	1
54000313	54	                PERFORM ABEND-THIS-TASK	0	0	1
54000314	54	           END-IF.	0	0	1
54000316	54	       A999.	0	0	1
54000317	54	           EXIT.	0	0	1
54000320	54	       PROCESS-MAP SECTION.	0	0	1
54000321	54	       PM010.	0	0	1
54000322	54	      *	1	0	0
54000323	54	      *    Retrieve the data from the map	1	0	1
54000324	54	      *	1	0	1
54000325	54	           PERFORM RECEIVE-MAP.	0	0	0
54000327	54	      *	1	0	0
54000328	54	      *    Validate the received data	1	0	1
54000329	54	      *	1	0	1
54000330	54	           PERFORM EDIT-DATA.	0	0	0
54000332	54	      *	1	0	0
54000333	54	      *    If the data passes validation go on to	1	0	1
54000334	54	      *    create an account	1	0	1
54000335	54	      *	1	0	1
54000336	54	           IF VALID-DATA	0	0	0
54000337	54	              PERFORM CRE-ACC-DATA	0	0	1
54000338	54	           END-IF.	0	0	1
54000340	54	           SET SEND-DATAONLY-ALARM TO TRUE.	0	0	1
54000342	54	      *	1	0	0
54000343	54	      *    Output the data to the screen	1	0	1
54000344	54	      *	1	0	1
54000345	54	           PERFORM SEND-MAP.	0	0	0
54000347	54	       PM999.	0	0	1
54000348	54	           EXIT.	0	0	1
54000351	54	       RECEIVE-MAP SECTION.	0	0	1
54000352	54	       RM010.	0	0	1
54000353	54	      *	1	0	0
54000354	54	      *    Retrieve the data	1	0	1
54000355	54	      *	1	0	1
54000356	54	           EXEC CICS	0	0	0
54000357	54	              RECEIVE MAP('BNK1CA')	0	0	1
54000358	54	              MAPSET('BNK1CAM')	0	0	1
54000359	54	              INTO(BNK1CAI)	0	0	1
54000360	54	              RESP(WS-CICS-RESP)	0	0	1
54000361	54	              RESP2(WS-CICS-RESP2)	0	0	1
54000362	54	           END-EXEC.	0	0	1
54000364	54	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
54000365	54	              INITIALIZE WS-FAIL-INFO	0	0	1
54000366	54	              MOVE 'BNK1CAC - RM010 - RECEIVE MAP FAIL ' TO	0	0	1
54000367	54	                 WS-CICS-FAIL-MSG	0	0	1
54000368	54	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
54000369	54	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
54000371	54	      *	1	0	0
54000372	54	      *       Preserve the RESP and RESP2, then set up the	1	0	1
54000373	54	      *       standard ABEND info before getting the applid,	1	0	1
54000374	54	      *       date/time etc. and linking to the Abend Handler	1	0	1
54000375	54	      *       program.	1	0	1
54000376	54	      *	1	0	1
54000377	54	              INITIALIZE ABNDINFO-REC	0	0	0
54000378	54	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
54000379	54	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
54000380	54	      *	1	0	0
54000381	54	      *       Get supplemental information	1	0	1
54000382	54	      *	1	0	1
54000383	54	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
54000384	54	              END-EXEC	0	0	1
54000386	54	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
54000387	54	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
54000389	54	              PERFORM POPULATE-TIME-DATE	0	0	1
54000391	54	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
54000392	54	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
54000393	54	                     ':' DELIMITED BY SIZE,	0	0	1
54000394	54	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
54000395	54	                     ':' DELIMITED BY SIZE,	0	0	1
54000396	54	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
54000397	54	                     INTO ABND-TIME	0	0	1
54000398	54	              END-STRING	0	0	1
54000400	54	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
54000401	54	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
54000403	54	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
54000404	54	              END-EXEC	0	0	1
54000406	54	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
54000408	54	              STRING 'RM010 - RECEIVE MAP FAIL ' DELIMITED BY SIZE,	0	0	1
54000409	54	                     ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
54000410	54	                     ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
54000411	54	                     ' RESP2=' DELIMITED BY SIZE,	0	0	1
54000412	54	                     ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
54000413	54	                     INTO ABND-FREEFORM	0	0	1
54000414	54	              END-STRING	0	0	1
54000416	54	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
54000417	54	                          COMMAREA(ABNDINFO-REC)	0	0	1
54000418	54	              END-EXEC	0	0	1
54000420	54	              PERFORM ABEND-THIS-TASK	0	0	1
54000422	54	           END-IF.	0	0	1
54000424	54	       RM999.	0	0	1
54000425	54	           EXIT.	0	0	1
54000428	54	       EDIT-DATA SECTION.	0	0	1
54000429	54	       ED010.	0	0	1
54000430	54	      *	1	0	0
54000431	54	      *    Perform validation on the incoming fields	1	0	1
54000432	54	      *	1	0	1
54000433	54	           EXEC CICS BIF DEEDIT	0	0	0
54000434	54	              FIELD(CUSTNOI)	0	0	1
54000435	54	           END-EXEC.	0	0	1
54000437	54	           IF CUSTNOL < 1 OR CUSTNOI = '__________'	0	0	1
54000438	54	              MOVE SPACES TO MESSAGEO	0	0	1
54000439	54	              STRING 'Please enter a 10 digit Customer Number '	0	0	1
54000440	54	                    DELIMITED BY SIZE,	0	0	1
54000441	54	                     ' ' DELIMITED BY SIZE	0	0	1
54000442	54	                 INTO MESSAGEO	0	0	1
54000443	54	              MOVE 'N' TO VALID-DATA-SW	0	0	1
54000444	54	              MOVE -1 TO CUSTNOL	0	0	1
54000445	54	              GO TO ED999	0	0	1
54000446	54	           END-IF.	0	0	1
54000448	54	           IF CUSTNOI NOT NUMERIC	0	0	1
54000449	54	              MOVE SPACES TO MESSAGEO	0	0	1
54000450	54	              STRING 'Please enter a numeric Customer number '	0	0	1
54000451	54	                    DELIMITED BY SIZE,	0	0	1
54000452	54	                     ' ' DELIMITED BY SIZE	0	0	1
54000453	54	                 INTO MESSAGEO	0	0	1
54000454	54	              MOVE 'N' TO VALID-DATA-SW	0	0	1
54000455	54	              MOVE -1 TO CUSTNOL	0	0	1
54000456	54	              GO TO ED999	0	0	1
54000457	54	           END-IF.	0	0	1
54000459	54	           IF ACCTYPI = '________' OR ACCTYPL < 1	0	0	1
54000460	54	              MOVE SPACES TO MESSAGEO	0	0	1
54000461	54	              STRING 'Account Type should be ISA,CURRENT,LOAN,'	0	0	1
54000462	54	                 DELIMITED BY SIZE,	0	0	1
54000463	54	                    'SAVING or MORTGAGE' DELIMITED BY SIZE	0	0	1
54000464	54	                 INTO MESSAGEO	0	0	1
54000465	54	              MOVE 'N' TO VALID-DATA-SW	0	0	1
54000466	54	              move -1 to acctypl	0	0	1
54000467	54	              GO TO ED999	0	0	1
54000468	54	           END-IF.	0	0	1
54000470	54	           MOVE SPACES TO MESSAGEO.	0	0	1
54000472	54	           IF ACCTYPL > 0	0	0	1
54000474	54	              EVALUATE ACCTYPI	0	0	1
54000475	54	                 WHEN 'ISA_____'	0	0	1
54000476	54	                    MOVE 'ISA     ' TO ACCTYPI	0	0	1
54000477	54	                    CONTINUE	0	0	1
54000478	54	                 WHEN 'isa_____'	0	0	1
54000479	54	                    MOVE 'ISA     ' TO ACCTYPI	0	0	1
54000480	54	                    CONTINUE	0	0	1
54000481	54	                 WHEN 'ISA     '	0	0	1
54000482	54	                    CONTINUE	0	0	1
54000483	54	                 WHEN 'isa     '	0	0	1
54000484	54	                    MOVE 'ISA     ' TO ACCTYPI	0	0	1
54000485	54	                    CONTINUE	0	0	1
54000486	54	                 WHEN 'CURRENT_'	0	0	1
54000487	54	                    MOVE 'CURRENT ' TO ACCTYPI	0	0	1
54000488	54	                    CONTINUE	0	0	1
54000489	54	                 WHEN 'current_'	0	0	1
54000490	54	                    MOVE 'CURRENT ' TO ACCTYPI	0	0	1
54000491	54	                    CONTINUE	0	0	1
54000492	54	                 WHEN 'CURRENT '	0	0	1
54000493	54	                    CONTINUE	0	0	1
54000494	54	                 WHEN 'current '	0	0	1
54000495	54	                    MOVE 'CURRENT ' TO ACCTYPI	0	0	1
54000496	54	                    CONTINUE	0	0	1
54000497	54	                 WHEN 'LOAN____'	0	0	1
54000498	54	                    MOVE 'LOAN    ' TO ACCTYPI	0	0	1
54000499	54	                    CONTINUE	0	0	1
54000500	54	                 WHEN 'loan____'	0	0	1
54000501	54	                    MOVE 'LOAN    ' TO ACCTYPI	0	0	1
54000502	54	                    CONTINUE	0	0	1
54000503	54	                 WHEN 'loan    '	0	0	1
54000504	54	                    MOVE 'LOAN    ' TO ACCTYPI	0	0	1
54000505	54	                    CONTINUE	0	0	1
54000506	54	                 WHEN 'LOAN    '	0	0	1
54000507	54	                    CONTINUE	0	0	1
54000508	54	                 WHEN 'SAVING__'	0	0	1
54000509	54	                    MOVE 'SAVING  ' TO ACCTYPI	0	0	1
54000510	54	                    CONTINUE	0	0	1
54000511	54	                 WHEN 'saving__'	0	0	1
54000512	54	                    MOVE 'SAVING  ' TO ACCTYPI	0	0	1
54000513	54	                    CONTINUE	0	0	1
54000514	54	                 WHEN 'saving  '	0	0	1
54000515	54	                    MOVE 'SAVING  ' TO ACCTYPI	0	0	1
54000516	54	                    CONTINUE	0	0	1
54000517	54	                 WHEN 'SAVING  '	0	0	1
54000518	54	                    CONTINUE	0	0	1
54000519	54	                 WHEN 'MORTGAGE'	0	0	1
54000520	54	                    CONTINUE	0	0	1
54000521	54	                 WHEN 'mortgage'	0	0	1
54000522	54	                    MOVE 'MORTGAGE' TO ACCTYPI	0	0	1
54000523	54	                    CONTINUE	0	0	1
54000524	54	                 WHEN OTHER	0	0	1
54000525	54	                    MOVE SPACES TO MESSAGEO	0	0	1
54000526	54	                    STRING 'Account Type should be ISA,CURRENT,LOAN,'	0	0	1
54000527	54	                       DELIMITED BY SIZE,	0	0	1
54000528	54	                       'SAVING or MORTGAGE' DELIMITED BY SIZE	0	0	1
54000529	54	                       INTO MESSAGEO	0	0	1
54000530	54	                    MOVE 'N' TO VALID-DATA-SW	0	0	1
54000531	54	                    MOVE -1 TO ACCTYPL	0	0	1
54000532	54	                    GO TO ED999	0	0	1
54000534	54	              END-EVALUATE	0	0	1
54000536	54	           END-IF.	0	0	1
54000538	54	           IF INTRTL = ZERO	0	0	1
54000539	54	              MOVE SPACES TO MESSAGEO	0	0	1
54000540	54	              STRING 'Please supply a numeric interest rate'	0	0	1
54000541	54	                    DELIMITED BY SIZE,	0	0	1
54000542	54	              INTO MESSAGEO	0	0	1
54000543	54	              MOVE 'N' TO VALID-DATA-SW	0	0	1
54000544	54	              MOVE -1 TO INTRTL	0	0	1
54000545	54	              GO TO ED999	0	0	1
54000546	54	           END-IF	0	0	1
54000548	54	           IF INTRTI(1:INTRTL) IS NOT NUMERIC	0	0	1
54000549	54	              MOVE ZERO TO WS-NUM-COUNT-TOTAL	0	0	1
54000550	54	              INSPECT INTRTI(1:INTRTL) TALLYING	0	0	1
54000551	54	                 WS-NUM-COUNT-TOTAL FOR ALL '0'	0	0	1
54000552	54	                 WS-NUM-COUNT-TOTAL FOR ALL '1'	0	0	1
54000553	54	                 WS-NUM-COUNT-TOTAL FOR ALL '2'	0	0	1
54000554	54	                 WS-NUM-COUNT-TOTAL FOR ALL '3'	0	0	1
54000555	54	                 WS-NUM-COUNT-TOTAL FOR ALL '4'	0	0	1
54000556	54	                 WS-NUM-COUNT-TOTAL FOR ALL '5'	0	0	1
54000557	54	                 WS-NUM-COUNT-TOTAL FOR ALL '6'	0	0	1
54000558	54	                 WS-NUM-COUNT-TOTAL FOR ALL '7'	0	0	1
54000559	54	                 WS-NUM-COUNT-TOTAL FOR ALL '8'	0	0	1
54000560	54	                 WS-NUM-COUNT-TOTAL FOR ALL '9'	0	0	1
54000561	54	                 WS-NUM-COUNT-TOTAL FOR ALL '.'	0	0	1
54000562	54	                 WS-NUM-COUNT-TOTAL FOR ALL '-'	0	0	1
54000563	54	                 WS-NUM-COUNT-TOTAL FOR ALL '+'	0	0	1
54000564	54	                 WS-NUM-COUNT-TOTAL FOR ALL ' '	0	0	1
54000565	54	      *	1	0	0
54000566	54	      *       So the idea here is that if there is a	1	0	1
54000567	54	      *       decimal point, the field is not numeric. But if it	1	0	1
54000568	54	      *       is 1.1 then it is valid. So first of all we check	1	0	1
54000569	54	      *       to see that only the above chars are OK. We also	1	0	1
54000570	54	      *       want to tolerate the minus and plus signs. We don't	1	0	1
54000571	54	      *       support negative interest though. We tolerate	1	0	1
54000572	54	      *       trailing spaces too.	1	0	1
54000573	54	      *	1	0	1
54000575	54	              IF WS-NUM-COUNT-TOTAL < INTRTL	0	0	0
54000576	54	                 MOVE SPACES TO MESSAGEO	0	0	1
54000577	54	                 STRING 'Please supply a numeric interest rate'	0	0	1
54000578	54	                      DELIMITED BY SIZE,	0	0	1
54000579	54	                 INTO MESSAGEO	0	0	1
54000580	54	                 MOVE 'N' TO VALID-DATA-SW	0	0	1
54000581	54	                 MOVE -1 TO INTRTL	0	0	1
54000582	54	                 GO TO ED999	0	0	1
54000583	54	              END-IF	0	0	1
54000584	54	      *	1	0	0
54000585	54	      *       And let's check to make sure we only have 0 to 1	1	0	1
54000586	54	      *       decimal points	1	0	1
54000587	54	      *	1	0	1
54000588	54	              MOVE ZERO TO WS-NUM-COUNT-POINT	0	0	0
54000590	54	              INSPECT INTRTI(1:INTRTL) TALLYING	0	0	1
54000591	54	                 WS-NUM-COUNT-POINT for ALL '.'	0	0	1
54000594	54	              IF WS-NUM-COUNT-POINT > 1	0	0	1
54000595	54	                 MOVE SPACES TO MESSAGEO	0	0	1
54000596	54	                 STRING 'Use one decimal point for interest rate only'	0	0	1
54000597	54	                      DELIMITED BY SIZE,	0	0	1
54000598	54	                 INTO MESSAGEO	0	0	1
54000599	54	                 MOVE 'N' TO VALID-DATA-SW	0	0	1
54000600	54	                 MOVE -1 TO INTRTL	0	0	1
54000601	54	                 GO TO ED999	0	0	1
54000602	54	              END-If	0	0	1
54000603	54	      *	1	0	0
54000604	54	      *       Now let's check to see if we have too many decimals!	1	0	1
54000605	54	      *	1	0	1
54000606	54	              IF WS-NUM-COUNT-POINT = 1	0	0	0
54000607	54	                 MOVE ZERO TO WS-NUM-COUNT-TOTAL	0	0	1
54000608	54	                 INSPECT INTRTI(1:INTRTL) TALLYING	0	0	1
54000609	54	                    WS-NUM-COUNT-TOTAL FOR CHARACTERS AFTER '.'	0	0	1
54000611	54	                 IF WS-NUM-COUNT-TOTAL > 2	0	0	1
54000612	54	      *	1	0	0
54000613	54	      *             There are more than 2 characters after the point	1	0	1
54000614	54	      *	1	0	1
54000615	54	                    MOVE ZERO TO WS-NUM-COUNT-TOTAL WS-NUM-COUNT-POINT	0	0	0
54000616	54	                    INSPECT INTRTI(1:INTRTL) TALLYING	0	0	1
54000617	54	                       WS-NUM-COUNT-POINT FOR CHARACTERS BEFORE '.'	0	0	1
54000619	54	                    ADD 2 TO WS-NUM-COUNT-POINT	0	0	1
54000620	54	                       GIVING WS-NUM-COUNT-POINT	0	0	1
54000622	54	                    INSPECT INTRTI(WS-NUM-COUNT-POINT:INTRTL) TALLYING	0	0	1
54000623	54	                       WS-NUM-COUNT-TOTAL FOR ALL '0'	0	0	1
54000624	54	                       WS-NUM-COUNT-TOTAL FOR ALL '1'	0	0	1
54000625	54	                       WS-NUM-COUNT-TOTAL FOR ALL '2'	0	0	1
54000626	54	                       WS-NUM-COUNT-TOTAL FOR ALL '3'	0	0	1
54000627	54	                       WS-NUM-COUNT-TOTAL FOR ALL '4'	0	0	1
54000628	54	                       WS-NUM-COUNT-TOTAL FOR ALL '5'	0	0	1
54000629	54	                       WS-NUM-COUNT-TOTAL FOR ALL '6'	0	0	1
54000630	54	                       WS-NUM-COUNT-TOTAL FOR ALL '7'	0	0	1
54000631	54	                       WS-NUM-COUNT-TOTAL FOR ALL '8'	0	0	1
54000632	54	                       WS-NUM-COUNT-TOTAL FOR ALL '9'	0	0	1
54000633	54	                       WS-NUM-COUNT-TOTAL FOR ALL '-'	0	0	1
54000634	54	                       WS-NUM-COUNT-TOTAL FOR ALL '+'	0	0	1
54000635	54	                       AFTER '.'	0	0	1
54000637	54	                    IF WS-NUM-COUNT-TOTAL > 2	0	0	1
54000638	54	      *	1	0	0
54000639	54	      *                More than two of them are numeric	1	0	1
54000640	54	      *	1	0	1
54000641	54	                       MOVE SPACES TO MESSAGEO	0	0	0
54000642	54	                       STRING	0	0	1
54000643	54	                         'Only up to two decimal places are supported'	0	0	1
54000644	54	                         DELIMITED BY SIZE,	0	0	1
54000645	54	                       INTO MESSAGEO	0	0	1
54000647	54	                       MOVE 'N' TO VALID-DATA-SW	0	0	1
54000648	54	                       MOVE -1 TO INTRTL	0	0	1
54000649	54	                       GO TO ED999	0	0	1
54000650	54	                    END-IF	0	0	1
54000652	54	                 END-IF	0	0	1
54000654	54	              END-IF	0	0	1
54000656	54	           END-IF	0	0	1
54000658	54	           COMPUTE INTRTI-COMP-1 = FUNCTION NUMVAL(INTRTI)	0	0	1
54000660	54	      *	1	0	0
54000661	54	      *    Validate the interest rate	1	0	1
54000662	54	      *	1	0	1
54000663	54	           IF INTRTI-COMP-1 < 0	0	0	0
54000664	54	              MOVE SPACES TO MESSAGEO	0	0	1
54000665	54	              STRING 'Please supply a zero or positive interest rate'	0	0	1
54000666	54	                    DELIMITED BY SIZE,	0	0	1
54000667	54	              INTO MESSAGEO	0	0	1
54000668	54	              MOVE 'N' TO VALID-DATA-SW	0	0	1
54000669	54	              MOVE -1 TO INTRTL	0	0	1
54000670	54	              GO TO ED999	0	0	1
54000671	54	           END-IF	0	0	1
54000673	54	           IF INTRTI-COMP-1 > 9999.99	0	0	1
54000674	54	              MOVE SPACES TO MESSAGEO	0	0	1
54000675	54	              STRING 'Please supply an interest rate less than 9999.99%'	0	0	1
54000676	54	                    DELIMITED BY SIZE,	0	0	1
54000677	54	              INTO MESSAGEO	0	0	1
54000678	54	              MOVE 'N' TO VALID-DATA-SW	0	0	1
54000679	54	              MOVE -1 TO INTRTL	0	0	1
54000680	54	              GO TO ED999	0	0	1
54000681	54	           END-IF	0	0	1
54000682	54	      * Remove trailing spaces from OVERDRAFT	1	0	0
54000683	54	           MOVE FUNCTION REVERSE(OVERDRI) TO WS-REVERSE	0	0	0
54000684	54	           MOVE ZERO TO WS-NUM-COUNT-TOTAL	0	0	1
54000685	54	           INSPECT WS-REVERSE TALLYING WS-NUM-COUNT-TOTAL	0	0	1
54000686	54	           FOR LEADING SPACES	0	0	1
54000687	54	           SUBTRACT WS-NUM-COUNT-TOTAL FROM OVERDRL	0	0	1
54000688	54	             GIVING OVERDRL	0	0	1
54000689	54	           MOVE ZERO TO WS-NUM-COUNT-TOTAL	0	0	1
54000690	54	           INSPECT OVERDRI(1:OVERDRL) TALLYING	0	0	1
54000691	54	              WS-NUM-COUNT-TOTAL FOR ALL '0'	0	0	1
54000692	54	              WS-NUM-COUNT-TOTAL FOR ALL '1'	0	0	1
54000693	54	              WS-NUM-COUNT-TOTAL FOR ALL '2'	0	0	1
54000694	54	              WS-NUM-COUNT-TOTAL FOR ALL '3'	0	0	1
54000695	54	              WS-NUM-COUNT-TOTAL FOR ALL '4'	0	0	1
54000696	54	              WS-NUM-COUNT-TOTAL FOR ALL '5'	0	0	1
54000697	54	              WS-NUM-COUNT-TOTAL FOR ALL '6'	0	0	1
54000698	54	              WS-NUM-COUNT-TOTAL FOR ALL '7'	0	0	1
54000699	54	              WS-NUM-COUNT-TOTAL FOR ALL '8'	0	0	1
54000700	54	              WS-NUM-COUNT-TOTAL FOR ALL '9'.	0	0	1
54000701	54	           IF WS-NUM-COUNT-TOTAL < OVERDRL	0	0	1
54000702	54	              MOVE SPACES TO MESSAGEO	0	0	1
54000703	54	              MOVE 'Overdraft Limit must be numeric positive int' TO	0	0	1
54000704	54	                 MESSAGEO	0	0	1
54000705	54	              MOVE 'N' TO VALID-DATA-SW	0	0	1
54000706	54	              MOVE -1 TO OVERDRL	0	0	1
54000707	54	              GO TO ED999	0	0	1
54000708	54	           END-IF.	0	0	1
54000710	54	           EXEC CICS BIF DEEDIT FIELD(OVERDRI)	0	0	1
54000711	54	           END-EXEC.	0	0	1
54000713	54	      *	1	0	0
54000714	54	      *    If the overdraft limit hasn't been supplied then make it	1	0	1
54000715	54	      *    zero	1	0	1
54000716	54	      *	1	0	1
54000717	54	           IF OVERDRL < 1 OR OVERDRI = '________' or overdri = spaces	0	0	0
54000718	54	              MOVE ZERO TO OVERDRI	0	0	1
54000719	54	           END-IF.	0	0	1
54000721	54	      *	1	0	0
54000722	54	      *    If the overdraft limit is supplied it must be numeric	1	0	1
54000723	54	      *	1	0	1
54000724	54	           IF OVERDRI NOT NUMERIC	0	0	0
54000725	54	              MOVE SPACES TO MESSAGEO	0	0	1
54000726	54	              MOVE 'The Overdraft Limit must be numeric ' TO	0	0	1
54000727	54	                 MESSAGEO	0	0	1
54000728	54	              MOVE 'N' TO VALID-DATA-SW	0	0	1
54000729	54	              MOVE -1 TO OVERDRL	0	0	1
54000730	54	              GO TO ED999	0	0	1
54000731	54	           END-IF.	0	0	1
54000733	54	      *	1	0	0
54000734	54	      *    Check to see if we have all the data we expected	1	0	1
54000735	54	      *	1	0	1
54000736	54	           IF CUSTNOL < 1 OR ACCTYPL < 1	0	0	0
54000737	54	              MOVE SPACES TO MESSAGEO	0	0	1
54000738	54	              MOVE 'Missing expected data.               ' TO	0	0	1
54000739	54	                 MESSAGEO	0	0	1
54000740	54	              MOVE 'N' TO VALID-DATA-SW	0	0	1
54000741	54	              GO TO ED999	0	0	1
54000742	54	           END-IF.	0	0	1
54000744	54	       ED999.	0	0	1
54000745	54	           EXIT.	0	0	1
54000748	54	       CRE-ACC-DATA SECTION.	0	0	1
54000749	54	       CAD010.	0	0	1
54000750	54	      *	1	0	0
54000751	54	      *    Set up the fields required by CREACC then link to it	1	0	1
54000752	54	      *	1	0	1
54000753	54	           INITIALIZE SUBPGM-PARMS.	0	0	0
54000754	54	           MOVE 'ACCT' TO SUBPGM-EYECATCHER.	0	0	1
54000755	54	           MOVE 'N' TO SUBPGM-SUCCESS.	0	0	1
54000757	54	           MOVE CUSTNOI      TO SUBPGM-CUSTNO.	0	0	1
54000758	54	           MOVE ZEROS        TO SUBPGM-SORTCODE.	0	0	1
54000759	54	           MOVE ZEROS        TO SUBPGM-NUMBER.	0	0	1
54000761	54	           MOVE ACCTYPI      TO SUBPGM-ACC-TYPE.	0	0	1
54000763	54	           COMPUTE INTRTI-COMP-1 = FUNCTION NUMVAL(INTRTI)	0	0	1
54000765	54	           MOVE INTRTI-COMP-1 TO SUBPGM-INT-RT.	0	0	1
54000767	54	           MOVE ZEROS        TO SUBPGM-OPENED.	0	0	1
54000768	54	           MOVE OVERDRI      TO SUBPGM-OVERDR-LIM.	0	0	1
54000769	54	           MOVE ZEROS        TO SUBPGM-LAST-STMT-DT.	0	0	1
54000770	54	           MOVE ZEROS        TO SUBPGM-NEXT-STMT-DT.	0	0	1
54000771	54	           MOVE ZEROS        TO SUBPGM-AVAIL-BAL.	0	0	1
54000772	54	           MOVE ZEROS        TO SUBPGM-ACT-BAL.	0	0	1
54000773	54	           MOVE ' '          TO SUBPGM-FAIL-CODE.	0	0	1
54000775	54	           EXEC CICS LINK	0	0	1
54000776	54	              PROGRAM('CREACC')	0	0	1
54000777	54	              COMMAREA(SUBPGM-PARMS)	0	0	1
54000778	54	              RESP(WS-CICS-RESP)	0	0	1
54000779	54	              RESP2(WS-CICS-RESP2)	0	0	1
54000780	54	              SYNCONRETURN	0	0	1
54000781	54	           END-EXEC.	0	0	1
54000783	54	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
54000784	54	              INITIALIZE WS-FAIL-INFO	0	0	1
54000785	54	              MOVE 'BNK1CAC - CAD010 - LINK CREACC FAILED    '	0	0	1
54000786	54	                 TO WS-CICS-FAIL-MSG	0	0	1
54000787	54	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
54000788	54	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
54000789	54	      *	1	0	0
54000790	54	      *       Preserve the RESP and RESP2, then set up the	1	0	1
54000791	54	      *       standard ABEND info before getting the applid,	1	0	1
54000792	54	      *       date/time etc. and linking to the Abend Handler	1	0	1
54000793	54	      *       program.	1	0	1
54000794	54	      *	1	0	1
54000795	54	              INITIALIZE ABNDINFO-REC	0	0	0
54000796	54	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
54000797	54	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
54000798	54	      *	1	0	0
54000799	54	      *       Get supplemental information	1	0	1
54000800	54	      *	1	0	1
54000801	54	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
54000802	54	              END-EXEC	0	0	1
54000804	54	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
54000805	54	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
54000807	54	              PERFORM POPULATE-TIME-DATE	0	0	1
54000809	54	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
54000810	54	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
54000811	54	                       ':' DELIMITED BY SIZE,	0	0	1
54000812	54	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
54000813	54	                       ':' DELIMITED BY SIZE,	0	0	1
54000814	54	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
54000815	54	                       INTO ABND-TIME	0	0	1
54000816	54	              END-STRING	0	0	1
54000818	54	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
54000819	54	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
54000821	54	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
54000822	54	              END-EXEC	0	0	1
54000824	54	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
54000826	54	              STRING 'CAD010 - LINK CREACC FAILED ' DELIMITED BY SIZE,	0	0	1
54000827	54	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
54000828	54	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
54000829	54	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
54000830	54	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
54000831	54	                       INTO ABND-FREEFORM	0	0	1
54000832	54	              END-STRING	0	0	1
54000834	54	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
54000835	54	                          COMMAREA(ABNDINFO-REC)	0	0	1
54000836	54	              END-EXEC	0	0	1
54000838	54	              PERFORM ABEND-THIS-TASK	0	0	1
54000840	54	           END-IF.	0	0	1
54000842	54	      *	1	0	0
54000843	54	      *    Check to see if the creation was successful or not	1	0	1
54000844	54	      *	1	0	1
54000845	54	           IF SUBPGM-SUCCESS = 'N'	0	0	0
54000846	54	              MOVE SPACES TO MESSAGEO	0	0	1
54000847	54	              MOVE 'N' TO VALID-DATA-SW	0	0	1
54000849	54	              EVALUATE SUBPGM-FAIL-CODE	0	0	1
54000851	54	                 WHEN '1'	0	0	1
54000852	54	                    MOVE 'The supplied customer number does not exist.'	0	0	1
54000853	54	                       TO  MESSAGEO	0	0	1
54000855	54	                 WHEN '2'	0	0	1
54000856	54	                    STRING 'The customer data cannot be accessed, '	0	0	1
54000857	54	                       DELIMITED BY SIZE,	0	0	1
54000858	54	                       ' unable to create account.'	0	0	1
54000859	54	                       DELIMITED BY SIZE	0	0	1
54000860	54	                    INTO MESSAGEO	0	0	1
54000862	54	                 WHEN '3'	0	0	1
54000863	54	                    STRING 'Account record creation failed.'	0	0	1
54000864	54	                       DELIMITED BY SIZE,	0	0	1
54000865	54	                       ' (unable to ENQ ACCOUNT NC).'	0	0	1
54000866	54	                       DELIMITED BY SIZE	0	0	1
54000867	54	                    INTO MESSAGEO	0	0	1
54000869	54	                 WHEN '4'	0	0	1
54000870	54	                    STRING 'Account record creation failed,'	0	0	1
54000871	54	                       DELIMITED BY SIZE,	0	0	1
54000872	54	                       ' (unable to increment ACCOUNT NC).'	0	0	1
54000873	54	                       DELIMITED BY SIZE	0	0	1
54000874	54	                    INTO MESSAGEO	0	0	1
54000876	54	                 WHEN '5'	0	0	1
54000877	54	                    STRING 'Account record creation failed,'	0	0	1
54000878	54	                       DELIMITED BY SIZE,	0	0	1
54000879	54	                       ' (unable to restore ACCOUNT NC).'	0	0	1
54000880	54	                       DELIMITED BY SIZE	0	0	1
54000881	54	                    INTO MESSAGEO	0	0	1
54000883	54	                 WHEN '6'	0	0	1
54000884	54	                    STRING 'Account record creation failed,'	0	0	1
54000885	54	                       DELIMITED BY SIZE,	0	0	1
54000886	54	                       ' (unable to WRITE to ACCOUNT file).'	0	0	1
54000887	54	                       DELIMITED BY SIZE	0	0	1
54000888	54	                    INTO MESSAGEO	0	0	1
54000890	54	                 WHEN '7'	0	0	1
54000891	54	                    STRING 'Account record creation failed,'	0	0	1
54000892	54	                       DELIMITED BY SIZE,	0	0	1
54000893	54	                       ' (unable to INSERT into ACCOUNT).'	0	0	1
54000894	54	                       DELIMITED BY SIZE	0	0	1
54000895	54	                    INTO MESSAGEO	0	0	1
54000897	54	                 WHEN '8'	0	0	1
54000898	54	                    STRING 'Account record creation failed,'	0	0	1
54000899	54	                       DELIMITED BY SIZE,	0	0	1
54000900	54	                       ' (too many accounts).'	0	0	1
54000901	54	                       DELIMITED BY SIZE	0	0	1
54000902	54	                    INTO MESSAGEO	0	0	1
54000904	54	                 WHEN '9'	0	0	1
54000905	54	                    STRING 'Account record creation failed, '	0	0	1
54000906	54	                       DELIMITED BY SIZE,	0	0	1
54000907	54	                       ' unable to count accounts.'	0	0	1
54000908	54	                       DELIMITED BY SIZE	0	0	1
54000909	54	                    INTO MESSAGEO	0	0	1
54000911	54	                 WHEN 'A'	0	0	1
54000912	54	                    STRING 'Account record creation failed, '	0	0	1
54000913	54	                       DELIMITED BY SIZE,	0	0	1
54000914	54	                       ' account type unsupported.'	0	0	1
54000915	54	                       DELIMITED BY SIZE	0	0	1
54000916	54	                    INTO MESSAGEO	0	0	1
54000918	54	                 WHEN OTHER	0	0	1
54000919	54	                    MOVE 'The account was not created.'	0	0	1
54000920	54	                       TO  MESSAGEO	0	0	1
54000922	54	              END-EVALUATE	0	0	1
54000923	54	           ELSE	0	0	1
54000924	54	      *	1	0	0
54000925	54	      *       If the account creation was successful then set	1	0	1
54000926	54	      *       the values on the map	1	0	1
54000927	54	      *	1	0	1
54000928	54	              MOVE SPACES TO MESSAGEO	0	0	0
54000929	54	              MOVE 'The Account has been successfully created' TO	0	0	1
54000930	54	                 MESSAGEO	0	0	1
54000932	54	              MOVE SUBPGM-SORTCODE          TO SRTCDO	0	0	1
54000933	54	              MOVE SUBPGM-NUMBER            TO ACCNOO	0	0	1
54000934	54	              MOVE SUBPGM-OPENED(1:2)       TO OPENDDO	0	0	1
54000935	54	              MOVE SUBPGM-OPENED(3:2)       TO OPENMMO	0	0	1
54000936	54	              MOVE SUBPGM-OPENED(5:4)       TO OPENYYO	0	0	1
54000937	54	              MOVE SUBPGM-NEXT-STMT-DT(1:2) TO NSTMTDDO	0	0	1
54000938	54	              MOVE SUBPGM-NEXT-STMT-DT(3:2) TO NSTMTMMO	0	0	1
54000939	54	              MOVE SUBPGM-NEXT-STMT-DT(5:4) TO NSTMTYYO	0	0	1
54000940	54	              MOVE SUBPGM-LAST-STMT-DT(1:2) TO LSTMDDO	0	0	1
54000941	54	              MOVE SUBPGM-LAST-STMT-DT(3:2) TO LSTMMMO	0	0	1
54000942	54	              MOVE SUBPGM-LAST-STMT-DT(5:4) TO LSTMYYO	0	0	1
54000943	54	              MOVE SUBPGM-AVAIL-BAL         TO AVAILABLE-BALANCE-DISPLAY	0	0	1
54000944	54	              MOVE SUBPGM-ACT-BAL           TO ACTUAL-BALANCE-DISPLAY	0	0	1
54000945	54	              MOVE AVAILABLE-BALANCE-DISPLAY TO AVAILO	0	0	1
54000946	54	              MOVE ACTUAL-BALANCE-DISPLAY   TO ACTBALO	0	0	1
54000947	54	           END-IF.	0	0	1
54000950	54	           MOVE SUBPGM-CUSTNO               TO CUSTNOO.	0	0	1
54000951	54	           MOVE SUBPGM-ACC-TYPE             TO ACCTYPO.	0	0	1
54000952	54	           MOVE SUBPGM-INT-RT               TO INTRT-PIC9.	0	0	1
54000953	54	           MOVE INTRT-PIC9                  TO INTRTO.	0	0	1
54000954	54	           MOVE SUBPGM-OVERDR-LIM           TO OVERDRO.	0	0	1
54000956	54	       CAD999.	0	0	1
54000957	54	           EXIT.	0	0	1
54000960	54	        SEND-MAP SECTION.	0	0	1
54000961	54	        SM010.	0	0	1
54000962	54	      *	1	0	0
54000963	54	      *    If the map needs to have its data erased	1	0	1
54000964	54	      *	1	0	1
54000965	54	           IF SEND-ERASE	0	0	0
54000966	54	              EXEC CICS SEND MAP('BNK1CA')	0	0	1
54000967	54	                 MAPSET('BNK1CAM')	0	0	1
54000968	54	                 FROM(BNK1CAO)	0	0	1
54000969	54	                 ERASE	0	0	1
54000970	54	                 CURSOR	0	0	1
54000971	54	                 RESP(WS-CICS-RESP)	0	0	1
54000972	54	                 RESP2(WS-CICS-RESP2)	0	0	1
54000973	54	              END-EXEC	0	0	1
54000975	54	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
54000976	54	                 INITIALIZE WS-FAIL-INFO	0	0	1
54000977	54	                 MOVE 'BNK1CAC - SM010 - SEND MAP ERASE FAIL '	0	0	1
54000978	54	                    TO WS-CICS-FAIL-MSG	0	0	1
54000979	54	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
54000980	54	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
54000981	54	      *	1	0	0
54000982	54	      *          Preserve the RESP and RESP2, then set up the	1	0	1
54000983	54	      *          standard ABEND info before getting the applid,	1	0	1
54000984	54	      *          date/time etc. and linking to the Abend Handler	1	0	1
54000985	54	      *          program.	1	0	1
54000986	54	      *	1	0	1
54000987	54	                 INITIALIZE ABNDINFO-REC	0	0	0
54000988	54	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
54000989	54	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
54000990	54	      *	1	0	0
54000991	54	      *          Get supplemental information	1	0	1
54000992	54	      *	1	0	1
54000993	54	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
54000994	54	                 END-EXEC	0	0	1
54000996	54	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
54000997	54	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
54000999	54	                 PERFORM POPULATE-TIME-DATE	0	0	1
54001001	54	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
54001002	54	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
54001003	54	                       ':' DELIMITED BY SIZE,	0	0	1
54001004	54	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
54001005	54	                        ':' DELIMITED BY SIZE,	0	0	1
54001006	54	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
54001007	54	                        INTO ABND-TIME	0	0	1
54001008	54	                 END-STRING	0	0	1
54001010	54	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
54001011	54	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
54001013	54	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
54001014	54	                 END-EXEC	0	0	1
54001016	54	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
54001018	54	                 STRING 'SM010 -SEND MAP ERASE FAIL' DELIMITED BY SIZE,	0	0	1
54001019	54	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
54001020	54	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
54001021	54	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
54001022	54	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
54001023	54	                       INTO ABND-FREEFORM	0	0	1
54001024	54	                 END-STRING	0	0	1
54001026	54	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
54001027	54	                           COMMAREA(ABNDINFO-REC)	0	0	1
54001028	54	                 END-EXEC	0	0	1
54001030	54	                 PERFORM ABEND-THIS-TASK	0	0	1
54001031	54	              END-IF	0	0	1
54001033	54	              GO TO SM999	0	0	1
54001034	54	           END-IF.	0	0	1
54001036	54	      *	1	0	0
54001037	54	      *    If the map just needs a resend of only the data	1	0	1
54001038	54	      *	1	0	1
54001039	54	           IF SEND-DATAONLY	0	0	0
54001040	54	              EXEC CICS SEND MAP('BNK1CA')	0	0	1
54001041	54	                 MAPSET('BNK1CAM')	0	0	1
54001042	54	                 FROM(BNK1CAO)	0	0	1
54001043	54	                 DATAONLY	0	0	1
54001044	54	                 CURSOR	0	0	1
54001045	54	                 RESP(WS-CICS-RESP)	0	0	1
54001046	54	                 RESP2(WS-CICS-RESP2)	0	0	1
54001047	54	              END-EXEC	0	0	1
54001049	54	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
54001050	54	                 INITIALIZE WS-FAIL-INFO	0	0	1
54001051	54	                 MOVE 'BNK1CAC - SM010 - SEND MAP DATAONLY FAIL '	0	0	1
54001052	54	                    TO WS-CICS-FAIL-MSG	0	0	1
54001053	54	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
54001054	54	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
54001056	54	      *	1	0	0
54001057	54	      *          Preserve the RESP and RESP2, then set up the	1	0	1
54001058	54	      *          standard ABEND info before getting the applid,	1	0	1
54001059	54	      *          date/time etc. and linking to the Abend Handler	1	0	1
54001060	54	      *          program.	1	0	1
54001061	54	      *	1	0	1
54001062	54	                 INITIALIZE ABNDINFO-REC	0	0	0
54001063	54	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
54001064	54	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
54001065	54	      *	1	0	0
54001066	54	      *          Get supplemental information	1	0	1
54001067	54	      *	1	0	1
54001068	54	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
54001069	54	                 END-EXEC	0	0	1
54001071	54	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
54001072	54	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
54001074	54	                 PERFORM POPULATE-TIME-DATE	0	0	1
54001076	54	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
54001077	54	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
54001078	54	                        ':' DELIMITED BY SIZE,	0	0	1
54001079	54	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
54001080	54	                        ':' DELIMITED BY SIZE,	0	0	1
54001081	54	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
54001082	54	                        INTO ABND-TIME	0	0	1
54001083	54	                 END-STRING	0	0	1
54001085	54	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
54001086	54	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
54001088	54	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
54001089	54	                 END-EXEC	0	0	1
54001091	54	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
54001093	54	                 STRING 'SM010 - SEND MAP DATAONLY Fail'	0	0	1
54001094	54	                      DELIMITED BY SIZE,	0	0	1
54001095	54	                      ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
54001096	54	                      ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
54001097	54	                      ' RESP2=' DELIMITED BY SIZE,	0	0	1
54001098	54	                      ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
54001099	54	                      INTO ABND-FREEFORM	0	0	1
54001100	54	                 END-STRING	0	0	1
54001102	54	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
54001103	54	                           COMMAREA(ABNDINFO-REC)	0	0	1
54001104	54	                 END-EXEC	0	0	1
54001106	54	                 PERFORM ABEND-THIS-TASK	0	0	1
54001107	54	              END-IF	0	0	1
54001109	54	              GO TO SM999	0	0	1
54001111	54	           END-IF.	0	0	1
54001113	54	      *	1	0	0
54001114	54	      *    If we have elected to send the map and a beep	1	0	1
54001115	54	      *	1	0	1
54001116	54	           IF SEND-DATAONLY-ALARM	0	0	0
54001117	54	              EXEC CICS SEND MAP('BNK1CA')	0	0	1
54001118	54	                 MAPSET('BNK1CAM')	0	0	1
54001119	54	                 FROM(BNK1CAO)	0	0	1
54001120	54	                 DATAONLY	0	0	1
54001121	54	                 ALARM	0	0	1
54001122	54	                 CURSOR	0	0	1
54001123	54	                 RESP(WS-CICS-RESP)	0	0	1
54001124	54	                 RESP2(WS-CICS-RESP2)	0	0	1
54001125	54	              END-EXEC	0	0	1
54001127	54	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
54001128	54	                 INITIALIZE WS-FAIL-INFO	0	0	1
54001129	54	                 MOVE 'BNK1CAC - SM010 - SEND MAP DATAONLY ALARM FAIL '	0	0	1
54001130	54	                    TO WS-CICS-FAIL-MSG	0	0	1
54001131	54	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
54001132	54	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
54001133	54	      *	1	0	0
54001134	54	      *          Preserve the RESP and RESP2, then set up the	1	0	1
54001135	54	      *          standard ABEND info before getting the applid,	1	0	1
54001136	54	      *          date/time etc. and linking to the Abend Handler	1	0	1
54001137	54	      *          program.	1	0	1
54001138	54	      *	1	0	1
54001139	54	                 INITIALIZE ABNDINFO-REC	0	0	0
54001140	54	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
54001141	54	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
54001142	54	      *	1	0	0
54001143	54	      *          Get supplemental information	1	0	1
54001144	54	      *	1	0	1
54001145	54	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
54001146	54	                 END-EXEC	0	0	1
54001148	54	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
54001149	54	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
54001151	54	                 PERFORM POPULATE-TIME-DATE	0	0	1
54001153	54	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
54001154	54	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
54001155	54	                        ':' DELIMITED BY SIZE,	0	0	1
54001156	54	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
54001157	54	                        ':' DELIMITED BY SIZE,	0	0	1
54001158	54	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
54001159	54	                        INTO ABND-TIME	0	0	1
54001160	54	                 END-STRING	0	0	1
54001162	54	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
54001163	54	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
54001165	54	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
54001166	54	                 END-EXEC	0	0	1
54001168	54	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
54001170	54	                 STRING 'SM010 - SEND MAP DATAONLY ALARM fail'	0	0	1
54001171	54	                      DELIMITED BY SIZE,	0	0	1
54001172	54	                      ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
54001173	54	                      ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
54001174	54	                      ' RESP2=' DELIMITED BY SIZE,	0	0	1
54001175	54	                      ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
54001176	54	                      INTO ABND-FREEFORM	0	0	1
54001177	54	                 END-STRING	0	0	1
54001179	54	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
54001180	54	                           COMMAREA(ABNDINFO-REC)	0	0	1
54001181	54	                 END-EXEC	0	0	1
54001183	54	                 PERFORM ABEND-THIS-TASK	0	0	1
54001184	54	              END-IF	0	0	1
54001186	54	           END-IF.	0	0	1
54001188	54	       SM999.	0	0	1
54001189	54	           EXIT.	0	0	1
54001192	54	       SEND-TERMINATION-MSG SECTION.	0	0	1
54001193	54	       STM010.	0	0	1
54001194	54	      *	1	0	0
54001195	54	      *    Send the termination message	1	0	1
54001196	54	      *	1	0	1
54001197	54	           EXEC CICS SEND TEXT	0	0	0
54001198	54	              FROM(END-OF-SESSION-MESSAGE)	0	0	1
54001199	54	              ERASE	0	0	1
54001200	54	              FREEKB	0	0	1
54001201	54	              RESP(WS-CICS-RESP)	0	0	1
54001202	54	              RESP2(WS-CICS-RESP2)	0	0	1
54001203	54	           END-EXEC.	0	0	1
54001205	54	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
54001206	54	              INITIALIZE WS-FAIL-INFO	0	0	1
54001207	54	              MOVE 'BNK1CAC - STM010 - SEND TEXT FAIL'	0	0	1
54001208	54	                 TO WS-CICS-FAIL-MSG	0	0	1
54001209	54	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
54001210	54	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
54001211	54	      *	1	0	0
54001212	54	      *       Preserve the RESP and RESP2, then set up the	1	0	1
54001213	54	      *       standard ABEND info before getting the applid,	1	0	1
54001214	54	      *       date/time etc. and linking to the Abend Handler	1	0	1
54001215	54	      *       program.	1	0	1
54001216	54	      *	1	0	1
54001217	54	              INITIALIZE ABNDINFO-REC	0	0	0
54001218	54	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
54001219	54	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
54001220	54	      *	1	0	0
54001221	54	      *       Get supplemental information	1	0	1
54001222	54	      *	1	0	1
54001223	54	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
54001224	54	              END-EXEC	0	0	1
54001226	54	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
54001227	54	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
54001229	54	              PERFORM POPULATE-TIME-DATE	0	0	1
54001231	54	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
54001232	54	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
54001233	54	                     ':' DELIMITED BY SIZE,	0	0	1
54001234	54	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
54001235	54	                     ':' DELIMITED BY SIZE,	0	0	1
54001236	54	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
54001237	54	                     INTO ABND-TIME	0	0	1
54001238	54	              END-STRING	0	0	1
54001240	54	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
54001241	54	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
54001243	54	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
54001244	54	              END-EXEC	0	0	1
54001246	54	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
54001248	54	              STRING 'STM010 - SEND TEXT FAIL'	0	0	1
54001249	54	                   DELIMITED BY SIZE,	0	0	1
54001250	54	                   ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
54001251	54	                   ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
54001252	54	                   ' RESP2=' DELIMITED BY SIZE,	0	0	1
54001253	54	                   ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
54001254	54	                   INTO ABND-FREEFORM	0	0	1
54001255	54	              END-STRING	0	0	1
54001257	54	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
54001258	54	                           COMMAREA(ABNDINFO-REC)	0	0	1
54001259	54	              END-EXEC	0	0	1
54001261	54	              PERFORM ABEND-THIS-TASK	0	0	1
54001263	54	           END-IF.	0	0	1
54001265	54	       STM999.	0	0	1
54001266	54	           EXIT.	0	0	1
54001269	54	       ABEND-THIS-TASK SECTION.	0	0	1
54001270	54	       ATT010.	0	0	1
54001272	54	           DISPLAY WS-FAIL-INFO.	0	0	1
54001274	54	           EXEC CICS ABEND	0	0	1
54001275	54	              ABCODE('HBNK')	0	0	1
54001276	54	              NODUMP	0	0	1
54001277	54	           END-EXEC.	0	0	1
54001279	54	       ATT999.	0	0	1
54001280	54	           EXIT.	0	0	1
54001283	54	       POPULATE-TIME-DATE SECTION.	0	0	1
54001284	54	       PTD010.	0	0	1
54001286	54	           EXEC CICS ASKTIME	0	0	1
54001287	54	              ABSTIME(WS-U-TIME)	0	0	1
54001288	54	           END-EXEC.	0	0	1
54001290	54	           EXEC CICS FORMATTIME	0	0	1
54001291	54	                     ABSTIME(WS-U-TIME)	0	0	1
54001292	54	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
54001293	54	                     TIME(WS-TIME-NOW)	0	0	1
54001294	54	                     DATESEP	0	0	1
54001295	54	           END-EXEC.	0	0	1
54001297	54	       PTD999.	0	0	1
54001298	54	           EXIT.	0	0	1
55000000	55	<<<< file not found >>>>	0	0	0
55000001	55	<<<< file not found >>>>	0	0	0
56000001	56	       CBL CICS('SP,EDF,DLI')	0	0	1
56000002	56	       CBL SQL	0	0	1
56000003	56	      ******************************************************************	1	0	0
56000004	56	      *                                                                *	1	0	1
56000005	56	      *  Copyright IBM Corp. 2023                                      *	1	0	1
56000006	56	      *                                                                *	1	0	1
56000007	56	      ******************************************************************	1	0	1
56000008	56	      ******************************************************************	1	0	1
56000009	56	      * This program takes an incoming customer number	1	0	1
56000010	56	      * and determines which accounts it is associated with	1	0	1
56000011	56	      * by accessing the datastore & retrieving	1	0	1
56000012	56	      * the associated account records matching on the customer number	1	0	1
56000013	56	      ******************************************************************	1	0	1
56000015	56	       IDENTIFICATION DIVISION.	0	0	0
56000016	56	       PROGRAM-ID. INQACCCU.	0	0	1
56000017	56	       AUTHOR. James O'Grady.	0	0	1
56000020	56	       ENVIRONMENT DIVISION.	0	0	1
56000021	56	       CONFIGURATION SECTION.	0	0	1
56000022	56	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
56000023	56	       SOURCE-COMPUTER.  IBM-370.	0	0	0
56000024	56	       OBJECT-COMPUTER.  IBM-370.	0	0	1
56000026	56	       INPUT-OUTPUT SECTION.	0	0	1
56000028	56	       DATA DIVISION.	0	0	1
56000029	56	       FILE SECTION.	0	0	1
56000031	56	       WORKING-STORAGE SECTION.	0	0	1
56000033	56	       COPY SORTCODE.	0	0	1
56000037	56	      *	1	0	0
56000038	56	      * Get the ACCOUNT DB2 copybook	1	0	1
56000039	56	      *	1	0	1
56000040	56	           EXEC SQL	0	0	0
56000041	56	              INCLUDE ACCDB2	0	0	1
56000042	56	           END-EXEC.	0	0	1
56000044	56	      * ACCOUNT Host variables for DB2	1	0	0
56000045	56	       01 HOST-ACCOUNT-ROW.	0	0	0
56000046	56	          03 HV-ACCOUNT-EYECATCHER        PIC X(4).	0	0	1
56000047	56	          03 HV-ACCOUNT-CUST-NO           PIC X(10).	0	0	1
56000048	56	          03 HV-ACCOUNT-SORTCODE          PIC X(6).	0	0	1
56000049	56	          03 HV-ACCOUNT-ACC-NO            PIC X(8).	0	0	1
56000050	56	          03 HV-ACCOUNT-ACC-TYPE          PIC X(8).	0	0	1
56000051	56	          03 HV-ACCOUNT-INT-RATE          PIC S9(4)V99 COMP-3.	0	0	1
56000052	56	          03 HV-ACCOUNT-OPENED            PIC X(10).	0	0	1
56000053	56	          03 HV-ACCOUNT-OVERDRAFT-LIM     PIC S9(9) COMP.	0	0	1
56000054	56	          03 HV-ACCOUNT-LAST-STMT         PIC X(10).	0	0	1
56000055	56	          03 HV-ACCOUNT-NEXT-STMT         PIC X(10).	0	0	1
56000056	56	          03 HV-ACCOUNT-AVAIL-BAL         PIC S9(10)V99 COMP-3.	0	0	1
56000057	56	          03 HV-ACCOUNT-ACTUAL-BAL        PIC S9(10)V99 COMP-3.	0	0	1
56000059	56	       01 EIBRCODE-NICE.	0	0	1
56000060	56	          03 EIBRCODE-FIRST               PIC X.	0	0	1
56000061	56	          03 EIBRCODE-SECOND              PIC X.	0	0	1
56000062	56	          03 EIBRCODE-THIRD               PIC X.	0	0	1
56000063	56	          03 EIBRCODE-FOURTH              PIC X.	0	0	1
56000064	56	          03 EIBRCODE-FIFTH               PIC X.	0	0	1
56000065	56	          03 EIBRCODE-SIXTH               PIC X.	0	0	1
56000067	56	      * Pull in the SQL COMMAREA	1	0	0
56000068	56	        EXEC SQL	0	0	0
56000069	56	          INCLUDE SQLCA	0	0	1
56000070	56	        END-EXEC.	0	0	1
56000073	56	      * Declare the CURSOR for ACCOUNT table	1	0	0
56000074	56	           EXEC SQL DECLARE ACC-CURSOR CURSOR FOR	0	0	0
56000075	56	              SELECT ACCOUNT_EYECATCHER,	0	0	1
56000076	56	                     ACCOUNT_CUSTOMER_NUMBER,	0	0	1
56000077	56	                     ACCOUNT_SORTCODE,	0	0	1
56000078	56	                     ACCOUNT_NUMBER,	0	0	1
56000079	56	                     ACCOUNT_TYPE,	0	0	1
56000080	56	                     ACCOUNT_INTEREST_RATE,	0	0	1
56000081	56	                     ACCOUNT_OPENED,	0	0	1
56000082	56	                     ACCOUNT_OVERDRAFT_LIMIT,	0	0	1
56000083	56	                     ACCOUNT_LAST_STATEMENT,	0	0	1
56000084	56	                     ACCOUNT_NEXT_STATEMENT,	0	0	1
56000085	56	                     ACCOUNT_AVAILABLE_BALANCE,	0	0	1
56000086	56	                     ACCOUNT_ACTUAL_BALANCE	0	0	1
56000087	56	                     FROM ACCOUNT	0	0	1
56000088	56	                     WHERE ACCOUNT_CUSTOMER_NUMBER =	0	0	1
56000089	56	                        :HV-ACCOUNT-CUST-NO	0	0	1
56000090	56	                      AND ACCOUNT_SORTCODE =	0	0	1
56000091	56	                      :HV-ACCOUNT-SORTCODE	0	0	1
56000092	56	                     FOR FETCH ONLY	0	0	1
56000093	56	           END-EXEC.	0	0	1
56000096	56	       01 WS-CICS-WORK-AREA.	0	0	1
56000097	56	          03 WS-CICS-RESP                 PIC S9(8) COMP.	0	0	1
56000098	56	          03 WS-CICS-RESP2                PIC S9(8) COMP.	0	0	1
56000099	56	          03 WS-CICS-RESP-DISPLAY         PIC +9(8) DISPLAY.	0	0	1
56000101	56	       01 EXIT-BROWSE-LOOP                PIC X VALUE 'N'.	0	0	1
56000103	56	       01 OUTPUT-DATA.	0	0	1
56000104	56	           COPY ACCOUNT.	0	0	1
56000106	56	       01 RETURNED-DATA.	0	0	1
56000107	56	           03 RETURNED-EYE-CATCHER        PIC X(4).	0	0	1
56000108	56	           03 RETURNED-CUST-NO            PIC 9(10).	0	0	1
56000109	56	           03 RETURNED-KEY.	0	0	1
56000110	56	              05 RETURNED-SORT-CODE       PIC 9(6).	0	0	1
56000111	56	              05 RETURNED-NUMBER          PIC 9(8).	0	0	1
56000112	56	           03 RETURNED-TYPE               PIC X(8).	0	0	1
56000113	56	           03 RETURNED-INTEREST-RATE      PIC 9(4)V99.	0	0	1
56000114	56	           03 RETURNED-OPENED             PIC 9(8).	0	0	1
56000115	56	           03 RETURNED-OVERDRAFT-LIMIT    PIC 9(8).	0	0	1
56000116	56	           03 RETURNED-LAST-STMT-DATE     PIC 9(8).	0	0	1
56000117	56	           03 RETURNED-NEXT-STMT-DATE     PIC 9(8).	0	0	1
56000118	56	           03 RETURNED-AVAILABLE-BALANCE  PIC S9(10)V99.	0	0	1
56000119	56	           03 RETURNED-ACTUAL-BALANCE     PIC S9(10)V99.	0	0	1
56000121	56	       01 DESIRED-KEY.	0	0	1
56000122	56	           03 DESIRED-KEY-CUSTOMER        PIC 9(10).	0	0	1
56000123	56	           03 DESIRED-KEY-SORTCODE        PIC 9(6).	0	0	1
56000125	56	       01 DB2-DATE-REFORMAT.	0	0	1
56000126	56	          03 DB2-DATE-REF-YR              PIC 9(4).	0	0	1
56000127	56	          03 FILLER                       PIC X.	0	0	1
56000128	56	          03 DB2-DATE-REF-MNTH            PIC 99.	0	0	1
56000129	56	          03 FILLER                       PIC X.	0	0	1
56000130	56	          03 DB2-DATE-REF-DAY             PIC 99.	0	0	1
56000132	56	       01 DATA-STORE-TYPE                 PIC X.	0	0	1
56000133	56	          88 DATASTORE-TYPE-DB2              VALUE '2'.	0	0	1
56000134	56	          88 DATASTORE-TYPE-VSAM             VALUE 'V'.	0	0	1
56000136	56	       01 DB2-EXIT-LOOP                   PIC X.	0	0	1
56000137	56	       01 FETCH-DATA-CNT                  PIC 9(4) COMP.	0	0	1
56000138	56	       01 WS-CUST-ALT-KEY-LEN             PIC S9(4) COMP VALUE +10.	0	0	1
56000141	56	       01 CUSTOMER-KY.	0	0	1
56000142	56	          03 REQUIRED-SORT-CODE           PIC 9(6)  VALUE 0.	0	0	1
56000143	56	          03 REQUIRED-ACC-NUM             PIC 9(8)  VALUE 0.	0	0	1
56000145	56	       01 SQLCODE-DISPLAY                 PIC S9(8) DISPLAY	0	0	1
56000146	56	                                          SIGN LEADING SEPARATE.	0	0	1
56000148	56	       01 MY-ABEND-CODE                   PIC XXXX.	0	0	1
56000150	56	       01 WS-STORM-DRAIN                  PIC X VALUE 'N'.	0	0	1
56000152	56	       01 STORM-DRAIN-CONDITION           PIC X(20).	0	0	1
56000154	56	       01 CUSTOMER-AREA.	0	0	1
56000155	56	       COPY CUSTOMER.	0	0	1
56000157	56	       01 INQCUST-COMMAREA.	0	0	1
56000158	56	          COPY INQCUST.	0	0	1
56000160	56	       01 WS-U-TIME                       PIC S9(15) COMP-3.	0	0	1
56000161	56	       01 WS-ORIG-DATE                    PIC X(10).	0	0	1
56000162	56	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
56000163	56	          03 WS-ORIG-DATE-DD                 PIC 99.	0	0	1
56000164	56	          03 FILLER                          PIC X.	0	0	1
56000165	56	          03 WS-ORIG-DATE-MM                 PIC 99.	0	0	1
56000166	56	          03 FILLER                          PIC X.	0	0	1
56000167	56	          03 WS-ORIG-DATE-YYYY               PIC 9999.	0	0	1
56000169	56	       01 WS-ORIG-DATE-GRP-X.	0	0	1
56000170	56	          03 WS-ORIG-DATE-DD-X            PIC XX.	0	0	1
56000171	56	          03 FILLER                       PIC X VALUE '.'.	0	0	1
56000172	56	          03 WS-ORIG-DATE-MM-X            PIC XX.	0	0	1
56000173	56	          03 FILLER                       PIC X VALUE '.'.	0	0	1
56000174	56	          03 WS-ORIG-DATE-YYYY-X          PIC X(4).	0	0	1
56000177	56	       01 WS-TIME-DATA.	0	0	1
56000178	56	           03 WS-TIME-NOW                 PIC 9(6).	0	0	1
56000179	56	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
56000180	56	              05 WS-TIME-NOW-GRP-HH          PIC 99.	0	0	1
56000181	56	              05 WS-TIME-NOW-GRP-MM          PIC 99.	0	0	1
56000182	56	              05 WS-TIME-NOW-GRP-SS          PIC 99.	0	0	1
56000184	56	       01 WS-ABEND-PGM                       PIC X(8) VALUE 'ABNDPROC'.	0	0	1
56000186	56	       01 ABNDINFO-REC.	0	0	1
56000187	56	           COPY ABNDINFO.	0	0	1
56000189	56	       LINKAGE SECTION.	0	0	1
56000190	56	       01 DFHCOMMAREA.	0	0	1
56000191	56	          COPY INQACCCU.	0	0	1
56000193	56	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
56000194	56	       PREMIERE SECTION.	0	0	1
56000195	56	       A010.	0	0	1
56000196	56	           MOVE 'N' TO COMM-SUCCESS	0	0	1
56000197	56	           MOVE '0' TO COMM-FAIL-CODE	0	0	1
56000199	56	           EXEC CICS HANDLE ABEND	0	0	1
56000200	56	              LABEL(ABEND-HANDLING)	0	0	1
56000201	56	           END-EXEC.	0	0	1
56000203	56	           MOVE SORTCODE TO REQUIRED-SORT-CODE OF CUSTOMER-KY.	0	0	1
56000205	56	      *	1	0	0
56000206	56	      *    CUSTOMER-CHECK LINKS to program INQCUST to retrieve the	1	0	1
56000207	56	      *    customer information.	1	0	1
56000208	56	      *	1	0	1
56000210	56	           PERFORM CUSTOMER-CHECK.	0	0	0
56000212	56	      *	1	0	0
56000213	56	      *    If a  matching customer was not returned then set fail flags	1	0	1
56000214	56	      *	1	0	1
56000215	56	           IF CUSTOMER-FOUND = 'N'	0	0	0
56000216	56	              MOVE 'N' TO COMM-SUCCESS	0	0	1
56000217	56	              MOVE '1' TO COMM-FAIL-CODE	0	0	1
56000218	56	              PERFORM GET-ME-OUT-OF-HERE	0	0	1
56000219	56	           END-IF	0	0	1
56000222	56	           PERFORM READ-ACCOUNT-DB2	0	0	1
56000223	56	      *	1	0	0
56000224	56	      * Return the ACCOUNT data to the COMMAREA	1	0	1
56000225	56	      *	1	0	1
56000227	56	           PERFORM GET-ME-OUT-OF-HERE.	0	0	0
56000229	56	       A999.	0	0	1
56000230	56	           EXIT.	0	0	1
56000233	56	       READ-ACCOUNT-DB2 SECTION.	0	0	1
56000234	56	       RAD010.	0	0	1
56000235	56	      *	1	0	0
56000236	56	      *    Get accounts from account datastore	1	0	1
56000237	56	      *	1	0	1
56000239	56	      *	1	0	1
56000240	56	      *    Open the DB2 CURSOR	1	0	1
56000241	56	      *	1	0	1
56000243	56	           MOVE CUSTOMER-NUMBER IN DFHCOMMAREA TO HV-ACCOUNT-CUST-NO.	0	0	0
56000244	56	           MOVE  SORTCODE TO HV-ACCOUNT-SORTCODE.	0	0	1
56000246	56	           EXEC SQL OPEN	0	0	1
56000247	56	              ACC-CURSOR	0	0	1
56000248	56	           END-EXEC.	0	0	1
56000250	56	           MOVE SQLCODE TO SQLCODE-DISPLAY.	0	0	1
56000252	56	           IF SQLCODE NOT = 0	0	0	1
56000253	56	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
56000255	56	      *	1	0	0
56000256	56	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
56000257	56	      *       is applicable in a workload if activated	1	0	1
56000258	56	      *	1	0	1
56000259	56	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
56000261	56	              MOVE 'N'  TO COMM-SUCCESS	0	0	1
56000262	56	              MOVE 'N'  TO CUSTOMER-FOUND	0	0	1
56000263	56	              MOVE '2'  TO COMM-FAIL-CODE	0	0	1
56000264	56	              MOVE ZERO TO NUMBER-OF-ACCOUNTS	0	0	1
56000266	56	              EXEC CICS SYNCPOINT ROLLBACK	0	0	1
56000267	56	                RESP(WS-CICS-RESP)	0	0	1
56000268	56	                RESP2(WS-CICS-RESP2)	0	0	1
56000269	56	              END-EXEC	0	0	1
56000271	56	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
56000272	56	      *	1	0	0
56000273	56	      *          Preserve the RESP and RESP2, then set up the	1	0	1
56000274	56	      *          standard ABEND info before getting the applid,	1	0	1
56000275	56	      *          date/time etc. and linking to the Abend Handler	1	0	1
56000276	56	      *          program.	1	0	1
56000277	56	      *	1	0	1
56000278	56	                 INITIALIZE ABNDINFO-REC	0	0	0
56000279	56	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
56000280	56	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
56000281	56	      *	1	0	0
56000282	56	      *          Get supplemental information	1	0	1
56000283	56	      *	1	0	1
56000284	56	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
56000285	56	                 END-EXEC	0	0	1
56000287	56	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
56000288	56	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
56000290	56	                 PERFORM POPULATE-TIME-DATE	0	0	1
56000292	56	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
56000293	56	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
56000294	56	                       ':' DELIMITED BY SIZE,	0	0	1
56000295	56	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
56000296	56	                        ':' DELIMITED BY SIZE,	0	0	1
56000297	56	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
56000298	56	                        INTO ABND-TIME	0	0	1
56000299	56	                 END-STRING	0	0	1
56000301	56	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
56000302	56	                 MOVE 'HROL'      TO ABND-CODE	0	0	1
56000304	56	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
56000305	56	                 END-EXEC	0	0	1
56000307	56	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
56000309	56	                 STRING 'RAD010 - Unable to perform Synpoint Rollback'	0	0	1
56000310	56	                       DELIMITED BY SIZE,	0	0	1
56000311	56	                       '. Possible Integrity issue following DB2 '	0	0	1
56000312	56	                       DELIMITED BY SIZE,	0	0	1
56000313	56	                       'CURSOR OPEN' DELIMITED BY SIZE,	0	0	1
56000314	56	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
56000315	56	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
56000316	56	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
56000317	56	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
56000318	56	                       INTO ABND-FREEFORM	0	0	1
56000319	56	                 END-STRING	0	0	1
56000321	56	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
56000322	56	                           COMMAREA(ABNDINFO-REC)	0	0	1
56000323	56	                 END-EXEC	0	0	1
56000326	56	                 DISPLAY 'INQACCCU: Unable to perform Synpoint Rollback'	0	0	1
56000327	56	                 '. Possible Integrity issue following DB2 CURSOR OPEN'	0	0	1
56000328	56	                 ' SQLCODE=' SQLCODE-DISPLAY	0	0	1
56000329	56	                 ',RESP=' WS-CICS-RESP	0	0	1
56000330	56	                 ',RESP2=' WS-CICS-RESP2	0	0	1
56000331	56	                 EXEC CICS ABEND	0	0	1
56000332	56	                    ABCODE ('HROL')	0	0	1
56000333	56	                    CANCEL	0	0	1
56000334	56	                 END-EXEC	0	0	1
56000336	56	              END-IF	0	0	1
56000337	56	              GO TO RAD999	0	0	1
56000338	56	           END-IF.	0	0	1
56000340	56	      *	1	0	0
56000341	56	      *    Retrieve each of the accounts associated with this customer	1	0	1
56000342	56	      *	1	0	1
56000343	56	           PERFORM FETCH-DATA.	0	0	0
56000345	56	      *	1	0	0
56000346	56	      *    Close the DB2 CURSOR	1	0	1
56000347	56	      *	1	0	1
56000348	56	           EXEC SQL CLOSE	0	0	0
56000349	56	                          ACC-CURSOR	0	0	1
56000350	56	           END-EXEC.	0	0	1
56000352	56	           IF SQLCODE NOT = 0	0	0	1
56000353	56	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
56000354	56	              DISPLAY 'Failure when attempting to close the DB2 CURSOR'	0	0	1
56000355	56	                  ' ACC-CURSOR. With SQL code='	0	0	1
56000356	56	                  SQLCODE-DISPLAY	0	0	1
56000358	56	      *	1	0	0
56000359	56	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
56000360	56	      *       is applicable in a workload if activated	1	0	1
56000361	56	      *	1	0	1
56000362	56	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
56000364	56	              MOVE 'N' TO COMM-SUCCESS	0	0	1
56000365	56	              MOVE 'N' TO CUSTOMER-FOUND	0	0	1
56000366	56	              MOVE '4' TO COMM-FAIL-CODE	0	0	1
56000368	56	              EXEC CICS SYNCPOINT	0	0	1
56000369	56	                 ROLLBACK	0	0	1
56000370	56	                 RESP(WS-CICS-RESP)	0	0	1
56000371	56	                 RESP2(WS-CICS-RESP2)	0	0	1
56000372	56	              END-EXEC	0	0	1
56000374	56	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
56000375	56	      *	1	0	0
56000376	56	      *          Preserve the RESP and RESP2, then set up the	1	0	1
56000377	56	      *          standard ABEND info before getting the applid,	1	0	1
56000378	56	      *          date/time etc. and linking to the Abend Handler	1	0	1
56000379	56	      *          program.	1	0	1
56000380	56	      *	1	0	1
56000381	56	                 INITIALIZE ABNDINFO-REC	0	0	0
56000382	56	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
56000383	56	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
56000384	56	      *	1	0	0
56000385	56	      *          Get supplemental information	1	0	1
56000386	56	      *	1	0	1
56000387	56	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
56000388	56	                 END-EXEC	0	0	1
56000390	56	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
56000391	56	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
56000393	56	                 PERFORM POPULATE-TIME-DATE	0	0	1
56000395	56	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
56000396	56	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
56000397	56	                       ':' DELIMITED BY SIZE,	0	0	1
56000398	56	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
56000399	56	                        ':' DELIMITED BY SIZE,	0	0	1
56000400	56	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
56000401	56	                        INTO ABND-TIME	0	0	1
56000402	56	                 END-STRING	0	0	1
56000404	56	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
56000405	56	                 MOVE 'HROL'      TO ABND-CODE	0	0	1
56000407	56	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
56000408	56	                 END-EXEC	0	0	1
56000410	56	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
56000412	56	                 STRING 'RAD010(2)- Unable to perform Syncpoint'	0	0	1
56000413	56	                       DELIMITED BY SIZE,	0	0	1
56000414	56	                       'Rollback. Possible Integrity issue following'	0	0	1
56000415	56	                       DELIMITED BY SIZE,	0	0	1
56000416	56	                       'CURSOR CLOSE' DELIMITED BY SIZE,	0	0	1
56000417	56	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
56000418	56	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
56000419	56	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
56000420	56	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
56000421	56	                       INTO ABND-FREEFORM	0	0	1
56000422	56	                 END-STRING	0	0	1
56000424	56	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
56000425	56	                           COMMAREA(ABNDINFO-REC)	0	0	1
56000426	56	                 END-EXEC	0	0	1
56000428	56	      *          '. Possible Integrity issue following DB2 CURSOR CLOSE'	1	0	0
56000429	56	      *          ' SQLCODE=' SQLCODE-DISPLAY	1	0	1
56000430	56	      *          ',RESP=' WS-CICS-RESP	1	0	1
56000431	56	      *          ',RESP2=' WS-CICS-RESP2	1	0	1
56000433	56	                 DISPLAY 'INQACCCU:Unable to perform Synpoint ROLLBACK'	0	0	0
56000434	56	                         '. Possible Integrity issue following '	0	0	1
56000435	56	                         'DB2 CURSOR OPEN SQLCODE=' SQLCODE-DISPLAY	0	0	1
56000436	56	                         ',RESP=' WS-CICS-RESP	0	0	1
56000437	56	                         ',RESP2=' WS-CICS-RESP2	0	0	1
56000439	56	                 EXEC CICS ABEND	0	0	1
56000440	56	                    ABCODE ('HROL')	0	0	1
56000441	56	                    CANCEL	0	0	1
56000442	56	                 END-EXEC	0	0	1
56000443	56	              END-IF	0	0	1
56000445	56	              GO TO RAD999	0	0	1
56000446	56	           END-IF.	0	0	1
56000448	56	           MOVE 'Y' TO COMM-SUCCESS.	0	0	1
56000450	56	       RAD999.	0	0	1
56000451	56	           EXIT.	0	0	1
56000454	56	       FETCH-DATA SECTION.	0	0	1
56000455	56	       FD010.	0	0	1
56000456	56	      *	1	0	0
56000457	56	      *    Fetch each account in turn, & store data until there are no	1	0	1
56000458	56	      *    more rows to process. (There is a maximum of 20 accounts per	1	0	1
56000459	56	      *    customer).	1	0	1
56000460	56	      *	1	0	1
56000461	56	           MOVE ZERO TO NUMBER-OF-ACCOUNTS.	0	0	0
56000463	56	           PERFORM UNTIL SQLCODE NOT = 0 OR	0	0	1
56000464	56	           NUMBER-OF-ACCOUNTS = 20	0	0	1
56000466	56	              EXEC SQL FETCH FROM ACC-CURSOR	0	0	1
56000467	56	              INTO :HV-ACCOUNT-EYECATCHER,	0	0	1
56000468	56	                   :HV-ACCOUNT-CUST-NO,	0	0	1
56000469	56	                   :HV-ACCOUNT-SORTCODE,	0	0	1
56000470	56	                   :HV-ACCOUNT-ACC-NO,	0	0	1
56000471	56	                   :HV-ACCOUNT-ACC-TYPE,	0	0	1
56000472	56	                   :HV-ACCOUNT-INT-RATE,	0	0	1
56000473	56	                   :HV-ACCOUNT-OPENED,	0	0	1
56000474	56	                   :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
56000475	56	                   :HV-ACCOUNT-LAST-STMT,	0	0	1
56000476	56	                   :HV-ACCOUNT-NEXT-STMT,	0	0	1
56000477	56	                   :HV-ACCOUNT-AVAIL-BAL,	0	0	1
56000478	56	                   :HV-ACCOUNT-ACTUAL-BAL	0	0	1
56000479	56	              END-EXEC	0	0	1
56000481	56	      *	1	0	0
56000482	56	      *       If there is no data found at all, then return a	1	0	1
56000483	56	      *       low value record	1	0	1
56000484	56	      *	1	0	1
56000485	56	              IF SQLCODE = +100	0	0	0
56000486	56	                  MOVE 'Y' TO COMM-SUCCESS	0	0	1
56000487	56	                  GO TO FD999	0	0	1
56000488	56	              END-IF	0	0	1
56000490	56	              IF SQLCODE NOT = 0	0	0	1
56000491	56	                 MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
56000493	56	                 DISPLAY 'Failure when attempting to FETCH from the'	0	0	1
56000494	56	                    ' DB2 CURSOR ACC-CURSOR. With SQL code='	0	0	1
56000495	56	                    SQLCODE-DISPLAY	0	0	1
56000496	56	      *	1	0	0
56000497	56	      *          Check if SQLCODE indicates that Storm Drain processing	1	0	1
56000498	56	      *          is applicable in a workload if activated	1	0	1
56000499	56	      *	1	0	1
56000500	56	                 PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
56000502	56	                 MOVE 'N'  TO COMM-SUCCESS	0	0	1
56000503	56	                 MOVE 'N'  TO CUSTOMER-FOUND	0	0	1
56000504	56	                 MOVE ZERO TO NUMBER-OF-ACCOUNTS	0	0	1
56000505	56	                 MOVE '3' TO COMM-FAIL-CODE	0	0	1
56000507	56	                 EXEC CICS SYNCPOINT	0	0	1
56000508	56	                    ROLLBACK	0	0	1
56000509	56	                    RESP(WS-CICS-RESP)	0	0	1
56000510	56	                    RESP2(WS-CICS-RESP2)	0	0	1
56000511	56	                 END-EXEC	0	0	1
56000513	56	                 IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
56000514	56	      *	1	0	0
56000515	56	      *             Preserve the RESP and RESP2, then set up the	1	0	1
56000516	56	      *             standard ABEND info before getting the applid,	1	0	1
56000517	56	      *             date/time etc. and linking to the Abend Handler	1	0	1
56000518	56	      *             program.	1	0	1
56000519	56	      *	1	0	1
56000520	56	                    INITIALIZE ABNDINFO-REC	0	0	0
56000521	56	                    MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
56000522	56	                    MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
56000523	56	      *	1	0	0
56000524	56	      *             Get supplemental information	1	0	1
56000525	56	      *	1	0	1
56000526	56	                    EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
56000527	56	                    END-EXEC	0	0	1
56000529	56	                    MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
56000530	56	                    MOVE EIBTRNID   TO ABND-TRANID	0	0	1
56000532	56	                    PERFORM POPULATE-TIME-DATE	0	0	1
56000534	56	                    MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
56000535	56	                    STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
56000536	56	                       ':' DELIMITED BY SIZE,	0	0	1
56000537	56	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
56000538	56	                       ':' DELIMITED BY SIZE,	0	0	1
56000539	56	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
56000540	56	                       INTO ABND-TIME	0	0	1
56000541	56	                    END-STRING	0	0	1
56000543	56	                    MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
56000544	56	                    MOVE 'HROL'      TO ABND-CODE	0	0	1
56000546	56	                    EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
56000547	56	                    END-EXEC	0	0	1
56000549	56	                    MOVE ZEROS      TO ABND-SQLCODE	0	0	1
56000551	56	                    STRING 'FD010 - Unable to perform Syncpoint'	0	0	1
56000552	56	                       DELIMITED BY SIZE,	0	0	1
56000553	56	                       'Rollback. Possible Integrity issue following'	0	0	1
56000554	56	                       DELIMITED BY SIZE,	0	0	1
56000555	56	                       'DB2 FETCH' DELIMITED BY SIZE,	0	0	1
56000556	56	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
56000557	56	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
56000558	56	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
56000559	56	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
56000560	56	                       INTO ABND-FREEFORM	0	0	1
56000561	56	                    END-STRING	0	0	1
56000563	56	                    EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
56000564	56	                           COMMAREA(ABNDINFO-REC)	0	0	1
56000565	56	                    END-EXEC	0	0	1
56000567	56	                    DISPLAY 'INQACCCU: Unable to perform Syncpoint '	0	0	1
56000568	56	                       'ROLLBACK. Possible Integrity issue following'	0	0	1
56000569	56	                       ' DB2 FETCH. SQLCODE=' SQLCODE-DISPLAY	0	0	1
56000570	56	                       ',RESP=' WS-CICS-RESP	0	0	1
56000571	56	                       ',RESP2=' WS-CICS-RESP2	0	0	1
56000573	56	                    EXEC CICS ABEND	0	0	1
56000574	56	                       ABCODE ('HROL')	0	0	1
56000575	56	                       CANCEL	0	0	1
56000576	56	                    END-EXEC	0	0	1
56000578	56	                 END-IF	0	0	1
56000579	56	                 GO TO FD999	0	0	1
56000581	56	              END-IF	0	0	1
56000583	56	              ADD 1 TO NUMBER-OF-ACCOUNTS GIVING NUMBER-OF-ACCOUNTS	0	0	1
56000584	56	      *	1	0	0
56000585	56	      *       If we find a matching customer	1	0	1
56000586	56	      *	1	0	1
56000587	56	              MOVE HV-ACCOUNT-EYECATCHER	0	0	0
56000588	56	                 TO COMM-EYE(NUMBER-OF-ACCOUNTS)	0	0	1
56000589	56	              MOVE HV-ACCOUNT-CUST-NO	0	0	1
56000590	56	                  TO COMM-CUSTNO(NUMBER-OF-ACCOUNTS)	0	0	1
56000591	56	              MOVE HV-ACCOUNT-SORTCODE	0	0	1
56000592	56	                  TO COMM-SCODE(NUMBER-OF-ACCOUNTS)	0	0	1
56000593	56	              MOVE HV-ACCOUNT-ACC-NO	0	0	1
56000594	56	                  TO COMM-ACCNO(NUMBER-OF-ACCOUNTS)	0	0	1
56000595	56	              MOVE HV-ACCOUNT-ACC-TYPE	0	0	1
56000596	56	                  TO COMM-ACC-TYPE(NUMBER-OF-ACCOUNTS)	0	0	1
56000597	56	              MOVE HV-ACCOUNT-INT-RATE	0	0	1
56000598	56	                  TO COMM-INT-RATE(NUMBER-OF-ACCOUNTS)	0	0	1
56000599	56	              MOVE HV-ACCOUNT-OPENED TO DB2-DATE-REFORMAT	0	0	1
56000601	56	              STRING DB2-DATE-REF-DAY	0	0	1
56000602	56	                DB2-DATE-REF-MNTH	0	0	1
56000603	56	                DB2-DATE-REF-YR	0	0	1
56000604	56	                DELIMITED BY SIZE	0	0	1
56000605	56	                INTO COMM-OPENED(NUMBER-OF-ACCOUNTS)	0	0	1
56000606	56	              END-STRING	0	0	1
56000608	56	              MOVE HV-ACCOUNT-OVERDRAFT-LIM	0	0	1
56000609	56	                 TO COMM-OVERDRAFT(NUMBER-OF-ACCOUNTS)	0	0	1
56000610	56	              MOVE HV-ACCOUNT-LAST-STMT TO DB2-DATE-REFORMAT	0	0	1
56000612	56	              STRING DB2-DATE-REF-DAY	0	0	1
56000613	56	                 DB2-DATE-REF-MNTH	0	0	1
56000614	56	                 DB2-DATE-REF-YR	0	0	1
56000615	56	                 DELIMITED BY SIZE	0	0	1
56000616	56	                 INTO COMM-LAST-STMT-DT(NUMBER-OF-ACCOUNTS)	0	0	1
56000617	56	              END-STRING	0	0	1
56000619	56	              MOVE HV-ACCOUNT-NEXT-STMT TO DB2-DATE-REFORMAT	0	0	1
56000621	56	              STRING DB2-DATE-REF-DAY	0	0	1
56000622	56	                 DB2-DATE-REF-MNTH	0	0	1
56000623	56	                 DB2-DATE-REF-YR	0	0	1
56000624	56	                 DELIMITED BY SIZE	0	0	1
56000625	56	                 INTO COMM-NEXT-STMT-DT(NUMBER-OF-ACCOUNTS)	0	0	1
56000626	56	              END-STRING	0	0	1
56000628	56	              MOVE HV-ACCOUNT-ACTUAL-BAL	0	0	1
56000629	56	                 TO COMM-ACTUAL-BAL(NUMBER-OF-ACCOUNTS)	0	0	1
56000630	56	              MOVE HV-ACCOUNT-AVAIL-BAL	0	0	1
56000631	56	                 TO COMM-AVAIL-BAL(NUMBER-OF-ACCOUNTS)	0	0	1
56000633	56	           END-PERFORM.	0	0	1
56000635	56	       FD999.	0	0	1
56000636	56	           EXIT.	0	0	1
56000638	56	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
56000639	56	       GMOFH010.	0	0	1
56000640	56	      *	1	0	0
56000641	56	      *    Return control back to CICS	1	0	1
56000642	56	      *	1	0	1
56000643	56	           EXEC CICS RETURN	0	0	0
56000644	56	           END-EXEC.	0	0	1
56000646	56	           GOBACK.	0	0	1
56000648	56	       GMOFH999.	0	0	1
56000649	56	           EXIT.	0	0	1
56000652	56	      *	1	0	0
56000653	56	      * Check for Storm Drain Condition (DB2)	1	0	1
56000654	56	      *	1	0	1
56000655	56	       CHECK-FOR-STORM-DRAIN-DB2 SECTION.	0	0	0
56000656	56	       CFSDD010.	0	0	1
56000658	56	      *	1	0	0
56000659	56	      *    Check if the Sqlcode is one that will	1	0	1
56000660	56	      *    trigger Storm Drain is active in Workload	1	0	1
56000661	56	      *	1	0	1
56000662	56	           EVALUATE SQLCODE	0	0	0
56000664	56	              WHEN 923	0	0	1
56000665	56	                 MOVE 'DB2 Connection lost ' TO STORM-DRAIN-CONDITION	0	0	1
56000667	56	              WHEN OTHER	0	0	1
56000668	56	                 MOVE 'Not Storm Drain     ' TO STORM-DRAIN-CONDITION	0	0	1
56000670	56	           END-EVALUATE.	0	0	1
56000672	56	           IF STORM-DRAIN-CONDITION NOT EQUAL 'Not Storm Drain     '	0	0	1
56000673	56	              DISPLAY 'INQACCCU: Check-For-Storm-Drain-DB2: Storm '	0	0	1
56000674	56	                      'Drain condition (' STORM-DRAIN-CONDITION ') '	0	0	1
56000675	56	                      'has been met (' SQLCODE-DISPLAY ').'	0	0	1
56000676	56	           ELSE	0	0	1
56000677	56	              CONTINUE	0	0	1
56000678	56	           END-IF.	0	0	1
56000681	56	       CFSDD999.	0	0	1
56000682	56	           EXIT.	0	0	1
56000685	56	      *	1	0	0
56000686	56	      * How ABENDs are dealt with	1	0	1
56000687	56	      *	1	0	1
56000688	56	       ABEND-HANDLING SECTION.	0	0	0
56000689	56	       AH010.	0	0	1
56000691	56	           EXEC CICS ASSIGN	0	0	1
56000692	56	              ABCODE(MY-ABEND-CODE)	0	0	1
56000693	56	           END-EXEC.	0	0	1
56000695	56	      *	1	0	0
56000696	56	      *    Evaluate the Abend code that is returned	1	0	1
56000697	56	      *     - For DB2 AD2Z ... provide some diagnostics.	1	0	1
56000698	56	      *     - For VSAM RLS abends: AFCR, AFCS and AFCT record the	1	0	1
56000699	56	      *       Abend as happening but do not abend ... leave this to	1	0	1
56000700	56	      *       CPSM WLM "Storm drain" (Abend probability) to handle	1	0	1
56000701	56	      *     If not a "storm drain" ... take the abend afterwards	1	0	1
56000702	56	      *	1	0	1
56000703	56	           EVALUATE MY-ABEND-CODE	0	0	0
56000705	56	      *	1	0	0
56000706	56	      *       DB2 AD2Z abend	1	0	1
56000707	56	      *	1	0	1
56000708	56	              WHEN 'AD2Z'	0	0	0
56000709	56	                 MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
56000710	56	                 DISPLAY 'DB2 DEADLOCK DETECTED IN INQACCCU, SQLCODE='	0	0	1
56000711	56	                    SQLCODE-DISPLAY	0	0	1
56000712	56	                 DISPLAY 'DB2 DEADLOCK FOR ACCOUNT '	0	0	1
56000713	56	                    HV-ACCOUNT-ACC-NO	0	0	1
56000714	56	                 DISPLAY  'SQLSTATE=' SQLSTATE	0	0	1
56000715	56	                          ',SQLERRMC=' sqlerrmc(1:sqlerrmL)	0	0	1
56000716	56	                          ',sqlerrd(1)=' sqlerrd(1)	0	0	1
56000717	56	                          ',sqlerrd(2)=' sqlerrd(2)	0	0	1
56000718	56	                          ',sqlerrd(3)=' sqlerrd(3)	0	0	1
56000719	56	                          ',sqlerrd(4)=' sqlerrd(4)	0	0	1
56000720	56	                          ',sqlerrd(5)=' sqlerrd(5)	0	0	1
56000721	56	                          ',sqlerrd(6)=' sqlerrd(6)	0	0	1
56000723	56	      *	1	0	0
56000724	56	      *          VSAM RLS abends, subject to CPSM WLM Storm Drain check	1	0	1
56000725	56	      *          if handled (as here) and Workload Abend Thresholds are	1	0	1
56000726	56	      *          Set.	1	0	1
56000727	56	      *	1	0	1
56000728	56	              WHEN 'AFCR'	0	0	0
56000730	56	              WHEN 'AFCS'	0	0	1
56000732	56	              WHEN 'AFCT'	0	0	1
56000733	56	                 MOVE 'Y' TO WS-STORM-DRAIN	0	0	1
56000734	56	                 DISPLAY 'INQACCCU: Check-For-Storm-Drain-VSAM: Storm '	0	0	1
56000735	56	                        'Drain condition (Abend ' MY-ABEND-CODE ') '	0	0	1
56000736	56	                        'has been met.'	0	0	1
56000738	56	                 EXEC CICS SYNCPOINT ROLLBACK	0	0	1
56000739	56	                    RESP(WS-CICS-RESP)	0	0	1
56000740	56	                    RESP2(WS-CICS-RESP2)	0	0	1
56000741	56	                 END-EXEC	0	0	1
56000743	56	                 IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
56000744	56	      *	1	0	0
56000745	56	      *             Preserve the RESP and RESP2, then set up the	1	0	1
56000746	56	      *             standard ABEND info before getting the applid,	1	0	1
56000747	56	      *             date/time etc. and linking to the Abend Handler	1	0	1
56000748	56	      *             program.	1	0	1
56000749	56	      *	1	0	1
56000750	56	                    INITIALIZE ABNDINFO-REC	0	0	0
56000751	56	                    MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
56000752	56	                    MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
56000753	56	      *	1	0	0
56000754	56	      *             Get supplemental information	1	0	1
56000755	56	      *	1	0	1
56000756	56	                    EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
56000757	56	                    END-EXEC	0	0	1
56000759	56	                    MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
56000760	56	                    MOVE EIBTRNID   TO ABND-TRANID	0	0	1
56000762	56	                    PERFORM POPULATE-TIME-DATE	0	0	1
56000764	56	                    MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
56000765	56	                    STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
56000766	56	                          ':' DELIMITED BY SIZE,	0	0	1
56000767	56	                           WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
56000768	56	                          ':' DELIMITED BY SIZE,	0	0	1
56000769	56	                          WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
56000770	56	                          INTO ABND-TIME	0	0	1
56000771	56	                    END-STRING	0	0	1
56000773	56	                    MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
56000774	56	                    MOVE 'HROL'      TO ABND-CODE	0	0	1
56000776	56	                    EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
56000777	56	                    END-EXEC	0	0	1
56000779	56	                    MOVE 0 TO ABND-SQLCODE	0	0	1
56000781	56	                    STRING 'AH010 -Unable to perform SYNCPOINT '	0	0	1
56000782	56	                       DELIMITED BY SIZE,	0	0	1
56000783	56	                       'ROLLBACK' DELIMITED BY SIZE,	0	0	1
56000784	56	                       ' Possible integrity issue following VSAM RLS '	0	0	1
56000785	56	                       DELIMITED BY SIZE,	0	0	1
56000786	56	                       ' abend.' DELIMITED BY SIZE,	0	0	1
56000787	56	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
56000788	56	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
56000789	56	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
56000790	56	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
56000791	56	                       INTO ABND-FREEFORM	0	0	1
56000792	56	                    END-STRING	0	0	1
56000794	56	                    EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
56000795	56	                           COMMAREA(ABNDINFO-REC)	0	0	1
56000796	56	                    END-EXEC	0	0	1
56000798	56	                    DISPLAY 'INQACCC: Unable to perform Syncpoint.'	0	0	1
56000799	56	                       ' Rollback. Possible Integrity issue following '	0	0	1
56000800	56	                       ' VSAM RLS abend RESP CODE=' WS-CICS-RESP	0	0	1
56000801	56	                       ' RESP2 CODE=' WS-CICS-RESP2	0	0	1
56000803	56	                    EXEC CICS ABEND	0	0	1
56000804	56	                       ABCODE ('HROL')	0	0	1
56000805	56	                       CANCEL	0	0	1
56000806	56	                    END-EXEC	0	0	1
56000808	56	                 END-IF	0	0	1
56000810	56	                 MOVE 'N' TO COMM-SUCCESS	0	0	1
56000812	56	                 EXEC CICS RETURN	0	0	1
56000813	56	                 END-EXEC	0	0	1
56000815	56	           END-EVALUATE.	0	0	1
56000817	56	           IF WS-STORM-DRAIN = 'N'	0	0	1
56000818	56	              EXEC CICS ABEND	0	0	1
56000819	56	                 ABCODE( MY-ABEND-CODE)	0	0	1
56000820	56	                 NODUMP	0	0	1
56000821	56	                 CANCEL	0	0	1
56000822	56	              END-EXEC	0	0	1
56000823	56	           END-IF.	0	0	1
56000825	56	       AH999.	0	0	1
56000826	56	           EXIT.	0	0	1
56000829	56	       CUSTOMER-CHECK SECTION.	0	0	1
56000830	56	       CC010.	0	0	1
56000831	56	      *	1	0	0
56000832	56	      *    Retrieve customer information by linking to INQCUST	1	0	1
56000833	56	      *	1	0	1
56000835	56	           IF CUSTOMER-NUMBER IN DFHCOMMAREA = ZERO	0	0	0
56000836	56	              MOVE 'N' TO CUSTOMER-FOUND	0	0	1
56000837	56	              MOVE ZERO TO NUMBER-OF-ACCOUNTS	0	0	1
56000838	56	              GO TO CC999	0	0	1
56000839	56	           END-IF.	0	0	1
56000841	56	           IF CUSTOMER-NUMBER IN DFHCOMMAREA = '9999999999'	0	0	1
56000842	56	              MOVE 'N' TO CUSTOMER-FOUND	0	0	1
56000843	56	              MOVE ZERO TO NUMBER-OF-ACCOUNTS	0	0	1
56000844	56	              GO TO CC999	0	0	1
56000845	56	           END-IF.	0	0	1
56000847	56	           INITIALIZE INQCUST-COMMAREA.	0	0	1
56000849	56	           MOVE CUSTOMER-NUMBER IN DFHCOMMAREA TO INQCUST-CUSTNO.	0	0	1
56000851	56	           EXEC CICS LINK PROGRAM('INQCUST ')	0	0	1
56000852	56	              COMMAREA(INQCUST-COMMAREA)	0	0	1
56000853	56	           END-EXEC.	0	0	1
56000855	56	           IF INQCUST-INQ-SUCCESS = 'Y'	0	0	1
56000856	56	              MOVE 'Y' TO CUSTOMER-FOUND	0	0	1
56000857	56	           ELSE	0	0	1
56000858	56	              MOVE 'N' TO CUSTOMER-FOUND	0	0	1
56000859	56	              MOVE ZERO TO NUMBER-OF-ACCOUNTS	0	0	1
56000860	56	           END-IF.	0	0	1
56000862	56	       CC999.	0	0	1
56000863	56	           EXIT.	0	0	1
56000866	56	       POPULATE-TIME-DATE SECTION.	0	0	1
56000867	56	       PTD010.	0	0	1
56000868	56	      D    DISPLAY 'POPULATE-TIME-DATE SECTION'.	0	0	1
56000870	56	           EXEC CICS ASKTIME	0	0	1
56000871	56	              ABSTIME(WS-U-TIME)	0	0	1
56000872	56	           END-EXEC.	0	0	1
56000874	56	           EXEC CICS FORMATTIME	0	0	1
56000875	56	                     ABSTIME(WS-U-TIME)	0	0	1
56000876	56	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
56000877	56	                     TIME(WS-TIME-NOW)	0	0	1
56000878	56	                     DATESEP	0	0	1
56000879	56	           END-EXEC.	0	0	1
56000881	56	       PTD999.	0	0	1
56000882	56	           EXIT.	0	0	1
57000001	57	       CBL SQL	0	0	1
57000002	57	      ******************************************************************	1	0	0
57000003	57	      *                                                                *	1	0	1
57000004	57	      *  Copyright IBM Corp. 2023                                      *	1	0	1
57000005	57	      *                                                                *	1	0	1
57000006	57	      ******************************************************************	1	0	1
57000008	57	      ******************************************************************	1	0	1
57000010	57	      ******************************************************************	1	0	1
57000011	57	      *                                                                *	1	0	1
57000012	57	      * Title: BANKDATA                                                *	1	0	1
57000013	57	      *                                                                *	1	0	1
57000014	57	      *                                                                *	1	0	1
57000015	57	      * Description: Batch program to initialise the data used in the  *	1	0	1
57000016	57	      *              bank application. Datastores populated by         *	1	0	1
57000017	57	      *              this program include CUSTOMER (VSAM) and ACCOUNT  *	1	0	1
57000018	57	      *              (DB2).                                            *	1	0	1
57000019	57	      *                                                                *	1	0	1
57000020	57	      *                                                                *	1	0	1
57000021	57	      * Input: parm='fffffff,ttttttt,ssssss,rrrrrr'                    *	1	0	1
57000022	57	      *        where fffffff is the key to start generating from       *	1	0	1
57000023	57	      *              ttttttt is the last key to generate               *	1	0	1
57000024	57	      *              sssssss is the step for generation                *	1	0	1
57000025	57	      *              rrrrrrr is the random event seed                  *	1	0	1
57000026	57	      *                                                                *	1	0	1
57000027	57	      * Output: The populated VSAM file CUSTOMER, the DB2 table        *	1	0	1
57000028	57	      *         ACCOUNT.                                               *	1	0	1
57000029	57	      *                                                                *	1	0	1
57000030	57	      *                                                                *	1	0	1
57000031	57	      *                                                                *	1	0	1
57000032	57	      ******************************************************************	1	0	1
57000033	57	       IDENTIFICATION DIVISION.	0	0	0
57000034	57	      *AUTHOR. JON COLLETT.	1	0	0
57000035	57	       PROGRAM-ID. BANKDATA.	0	0	0
57000037	57	       ENVIRONMENT DIVISION.	0	0	1
57000038	57	       CONFIGURATION SECTION.	0	0	1
57000039	57	      * SOURCE-COMPUTER. MAINFRAME WITH DEBUGGING MODE.	1	0	0
57000040	57	       SOURCE-COMPUTER. MAINFRAME.	0	0	0
57000041	57	      *****************************************************************	1	0	0
57000042	57	      *** File Control                                              ***	1	0	1
57000043	57	      *****************************************************************	1	0	1
57000044	57	       INPUT-OUTPUT SECTION.	0	0	0
57000045	57	       FILE-CONTROL.	0	0	1
57000046	57	           SELECT CUSTOMER-FILE	0	0	1
57000047	57	                  ASSIGN TO VSAM	0	0	1
57000048	57	                  ORGANIZATION IS INDEXED	0	0	1
57000049	57	                  ACCESS MODE  IS RANDOM	0	0	1
57000050	57	                  RECORD KEY   IS CUSTOMER-KEY	0	0	1
57000051	57	                  FILE STATUS  IS CUSTOMER-VSAM-STATUS.	0	0	1
57000053	57	       DATA DIVISION.	0	0	1
57000054	57	      *****************************************************************	1	0	0
57000055	57	      *** File Section                                              ***	1	0	1
57000056	57	      *****************************************************************	1	0	1
57000057	57	       FILE SECTION.	0	0	0
57000059	57	       FD  CUSTOMER-FILE.	0	0	1
57000060	57	       01  CUSTOMER-RECORD-STRUCTURE.	0	0	1
57000061	57	       COPY CUSTOMER.	0	0	1
57000065	57	      *****************************************************************	1	0	0
57000066	57	      *** Working storage                                           ***	1	0	1
57000067	57	      *****************************************************************	1	0	1
57000068	57	       WORKING-STORAGE SECTION.	0	0	0
57000072	57	      * Get the ACCOUNT DB2 copybook	1	0	0
57000073	57	           EXEC SQL	0	0	0
57000074	57	              INCLUDE ACCDB2	0	0	1
57000075	57	           END-EXEC.	0	0	1
57000077	57	       77  WS-ACCOUNT-OPENED-DAY PIC 99.	0	0	1
57000078	57	       77  WS-ACCOUNT-OPENED-MONTH PIC 99.	0	0	1
57000079	57	       77  WS-ACCOUNT-OPENED-YEAR PIC 9999.	0	0	1
57000081	57	      * ACCOUNT Host variables for DB2	1	0	0
57000082	57	       01 HOST-ACCOUNT-ROW.	0	0	0
57000083	57	           03 HV-ACCOUNT-DATA.	0	0	1
57000084	57	              05 HV-ACCOUNT-EYECATCHER         PIC X(4).	0	0	1
57000085	57	              05 HV-ACCOUNT-CUST-NO            PIC X(10).	0	0	1
57000086	57	              05 HV-ACCOUNT-KEY.	0	0	1
57000087	57	                 07 HV-ACCOUNT-SORT-CODE       PIC X(6).	0	0	1
57000088	57	                 07 HV-ACCOUNT-NUMBER          PIC X(8).	0	0	1
57000089	57	              05 HV-ACCOUNT-TYPE               PIC X(8).	0	0	1
57000090	57	              05 HV-ACCOUNT-INTEREST-RATE      PIC S9(4)V99 COMP-3.	0	0	1
57000091	57	              05 HV-ACCOUNT-OPENED             PIC X(10).	0	0	1
57000092	57	              05 HV-ACCOUNT-OPENED-GROUP REDEFINES HV-ACCOUNT-OPENED.	0	0	1
57000093	57	                 07 HV-ACCOUNT-OPENED-DAY      PIC XX.	0	0	1
57000094	57	                 07 HV-ACCOUNT-OPENED-DELIM1   PIC X.	0	0	1
57000095	57	                 07 HV-ACCOUNT-OPENED-MONTH    PIC XX.	0	0	1
57000096	57	                 07 HV-ACCOUNT-OPENED-DELIM2   PIC X.	0	0	1
57000097	57	                 07 HV-ACCOUNT-OPENED-YEAR     PIC X(4).	0	0	1
57000098	57	              05 HV-ACCOUNT-OVERDRAFT-LIMIT    PIC S9(9) COMP.	0	0	1
57000099	57	              05 HV-ACCOUNT-LAST-STMT-DATE     PIC X(10).	0	0	1
57000100	57	              05 HV-ACCOUNT-LAST-STMT-GROUP	0	0	1
57000101	57	                 REDEFINES HV-ACCOUNT-LAST-STMT-DATE.	0	0	1
57000102	57	                  07 HV-ACCOUNT-LAST-STMT-DAY   PIC XX.	0	0	1
57000103	57	                  07 HV-ACCOUNT-LAST-STMT-DELIM1 PIC X.	0	0	1
57000104	57	                  07 HV-ACCOUNT-LAST-STMT-MONTH  PIC XX.	0	0	1
57000105	57	                  07 HV-ACCOUNT-LAST-STMT-DELIM2 PIC X.	0	0	1
57000106	57	                  07 HV-ACCOUNT-LAST-STMT-YEAR   PIC X(4).	0	0	1
57000107	57	              05 HV-ACCOUNT-NEXT-STMT-DATE     PIC X(10).	0	0	1
57000108	57	              05 HV-ACCOUNT-NEXT-STMT-GROUP	0	0	1
57000109	57	                 REDEFINES HV-ACCOUNT-NEXT-STMT-DATE.	0	0	1
57000110	57	                 07 HV-ACCOUNT-NEXT-STMT-DAY    PIC XX.	0	0	1
57000111	57	                 07 HV-ACCOUNT-NEXT-STMT-DELIM1 PIC X.	0	0	1
57000112	57	                 07 HV-ACCOUNT-NEXT-STMT-MONTH  PIC XX.	0	0	1
57000113	57	                 07 HV-ACCOUNT-NEXT-STMT-DELIM2 PIC X.	0	0	1
57000114	57	                 07 HV-ACCOUNT-NEXT-STMT-YEAR   PIC X(4).	0	0	1
57000115	57	              05 HV-ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99 COMP-3.	0	0	1
57000116	57	              05 HV-ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99 COMP-3.	0	0	1
57000118	57	      * Pull in the SQL COMMAREA	1	0	0
57000119	57	       EXEC SQL	0	0	0
57000120	57	          INCLUDE SQLCA	0	0	1
57000121	57	       END-EXEC.	0	0	1
57000124	57	       01 DISP-LOT.	0	0	1
57000125	57	          03 DISP-SIGN      PIC X.	0	0	1
57000126	57	          03 DISP-SQLCD     PIC 9999.	0	0	1
57000128	57	       01 DISP-REASON-CODE             PIC X(18).	0	0	1
57000130	57	       01  START-KEY                   PIC 9(10) DISPLAY.	0	0	1
57000131	57	       01  END-KEY                     PIC 9(10) DISPLAY.	0	0	1
57000132	57	       01  STEP-KEY                    PIC 9(10) DISPLAY.	0	0	1
57000133	57	       01  TESTNM                      PIC 9(4)  DISPLAY.	0	0	1
57000135	57	       01  CUSTOMER-VSAM-STATUS.	0	0	1
57000136	57	           05 VSAM-STATUS1             PIC X.	0	0	1
57000137	57	           05 VSAM-STATUS2             PIC X.	0	0	1
57000139	57	       01  NEXT-KEY                    PIC 9(10) DISPLAY.	0	0	1
57000141	57	       01  FORENAMES.	0	0	1
57000142	57	           05 FORENAME                 PIC X(20)	0	0	1
57000143	57	                                       OCCURS 100 TIMES	0	0	1
57000144	57	                                       DEPENDING ON FORENAMES-CNT.	0	0	1
57000145	57	       01  FORENAMES-CNT               PIC 9(8) BINARY   VALUE 0.	0	0	1
57000146	57	       01  FORENAMES-PTR               PIC 9(8) BINARY   VALUE 0.	0	0	1
57000148	57	       01  STREET-NAME-TREES.	0	0	1
57000149	57	           05 STREET-NAME-TREE         PIC X(20)	0	0	1
57000150	57	                                       OCCURS 26 TIMES	0	0	1
57000151	57	                                       DEPENDING ON STREET-NAME-T-CNT.	0	0	1
57000152	57	       01  STREET-NAME-T-CNT           PIC 9(8) BINARY   VALUE 0.	0	0	1
57000153	57	       01  STREET-NAME-T-PTR           PIC 9(8) BINARY   VALUE 0.	0	0	1
57000155	57	       01  STREET-NAME-ROADS.	0	0	1
57000156	57	           05 STREET-NAME-ROAD         PIC X(20)	0	0	1
57000157	57	                                       OCCURS 19 TIMES	0	0	1
57000158	57	                                       DEPENDING ON STREET-NAME-R-CNT.	0	0	1
57000159	57	       01  STREET-NAME-R-CNT           PIC 9(8) BINARY   VALUE 0.	0	0	1
57000160	57	       01  STREET-NAME-R-PTR           PIC 9(8) BINARY   VALUE 0.	0	0	1
57000162	57	       01  TOWNS.	0	0	1
57000163	57	           05 TOWN                     PIC X(20)	0	0	1
57000164	57	                                       OCCURS 50 TIMES	0	0	1
57000165	57	                                       DEPENDING ON TOWN-COUNT.	0	0	1
57000166	57	       01  TOWN-COUNT                  PIC 9(8) BINARY   VALUE 0.	0	0	1
57000167	57	       01  TOWN-PTR                    PIC 9(8) BINARY   VALUE 0.	0	0	1
57000169	57	       01  INITIALS.	0	0	1
57000170	57	           05 INITIAL-CHARACTER                  PIC X	0	0	1
57000171	57	                                       OCCURS 30 TIMES.	0	0	1
57000172	57	       01  INITIALS-CNT                PIC 9(8) BINARY   VALUE 0.	0	0	1
57000173	57	       01  INITIALS-PTR                PIC 9(8) BINARY   VALUE 0.	0	0	1
57000175	57	       01 TITLE-WORDS.	0	0	1
57000176	57	           03 TITLE-WORD OCCURS 36 PIC X(9).	0	0	1
57000177	57	       01 TITLE-ALPHABET.	0	0	1
57000178	57	           03 FILLER PIC X(9) VALUE 'Mr'.	0	0	1
57000179	57	           03 FILLER PIC X(9) VALUE 'Mrs'.	0	0	1
57000180	57	           03 FILLER PIC X(9) VALUE 'Miss'.	0	0	1
57000181	57	           03 FILLER PIC X(9) VALUE 'Ms'.	0	0	1
57000182	57	           03 FILLER PIC X(9) VALUE 'Mr'.	0	0	1
57000183	57	           03 FILLER PIC X(9) VALUE 'Mrs'.	0	0	1
57000184	57	           03 FILLER PIC X(9) VALUE 'Miss'.	0	0	1
57000185	57	           03 FILLER PIC X(9) VALUE 'Ms'.	0	0	1
57000186	57	           03 FILLER PIC X(9) VALUE 'Mr'.	0	0	1
57000187	57	           03 FILLER PIC X(9) VALUE 'Mrs'.	0	0	1
57000188	57	           03 FILLER PIC X(9) VALUE 'Miss'.	0	0	1
57000189	57	           03 FILLER PIC X(9) VALUE 'Ms'.	0	0	1
57000190	57	           03 FILLER PIC X(9) VALUE 'Mr'.	0	0	1
57000191	57	           03 FILLER PIC X(9) VALUE 'Mrs'.	0	0	1
57000192	57	           03 FILLER PIC X(9) VALUE 'Miss'.	0	0	1
57000193	57	           03 FILLER PIC X(9) VALUE 'Ms'.	0	0	1
57000194	57	           03 FILLER PIC X(9) VALUE 'Mr'.	0	0	1
57000195	57	           03 FILLER PIC X(9) VALUE 'Mrs'.	0	0	1
57000196	57	           03 FILLER PIC X(9) VALUE 'Miss'.	0	0	1
57000197	57	           03 FILLER PIC X(9) VALUE 'Ms'.	0	0	1
57000198	57	           03 FILLER PIC X(9) VALUE 'Dr'.	0	0	1
57000199	57	           03 FILLER PIC X(9) VALUE 'Drs'.	0	0	1
57000200	57	           03 FILLER PIC X(9) VALUE 'Dr'.	0	0	1
57000201	57	           03 FILLER PIC X(9) VALUE 'Ms'.	0	0	1
57000202	57	           03 FILLER PIC X(9) VALUE 'Dr'.	0	0	1
57000203	57	           03 FILLER PIC X(9) VALUE 'Ms'.	0	0	1
57000204	57	           03 FILLER PIC X(9) VALUE 'Dr'.	0	0	1
57000205	57	           03 FILLER PIC X(9) VALUE 'Ms'.	0	0	1
57000206	57	           03 FILLER PIC X(9) VALUE 'Professor'.	0	0	1
57000207	57	           03 FILLER PIC X(9) VALUE 'Professor'.	0	0	1
57000208	57	           03 FILLER PIC X(9) VALUE 'Professor'.	0	0	1
57000209	57	           03 FILLER PIC X(9) VALUE 'Lord'.	0	0	1
57000210	57	           03 FILLER PIC X(9) VALUE 'Sir'.	0	0	1
57000211	57	           03 FILLER PIC X(9) VALUE 'Sir'.	0	0	1
57000212	57	           03 FILLER PIC X(9) VALUE 'Lady'.	0	0	1
57000213	57	           03 FILLER PIC X(9) VALUE 'Lady'.	0	0	1
57000216	57	       01 TITLE-NUMBER PIC S9(9) BINARY.	0	0	1
57000218	57	       01 HOUSE-NUMBER PIC 99.	0	0	1
57000220	57	       01  SURNAMES.	0	0	1
57000221	57	           05 SURNAME                  PIC X(20)	0	0	1
57000222	57	                                       OCCURS 100 TIMES	0	0	1
57000223	57	                                       DEPENDING ON SURNAMES-CNT.	0	0	1
57000224	57	       01  SURNAMES-CNT                PIC 9(8) BINARY   VALUE 0.	0	0	1
57000225	57	       01  SURNAMES-PTR                PIC 9(8) BINARY   VALUE 0.	0	0	1
57000227	57	       01  RDATE                       PIC X(21).	0	0	1
57000230	57	       01  RDATE-NUMERIC               REDEFINES RDATE	0	0	1
57000231	57	                                       PIC 9(16) USAGE DISPLAY.	0	0	1
57000234	57	       01  RANDOM-SEED                 PIC X(16).	0	0	1
57000235	57	       01  RANDOM-SEED-NUMERIC REDEFINES RANDOM-SEED PIC 9(16)	0	0	1
57000236	57	            USAGE DISPLAY.	0	0	1
57000239	57	       01 WS-CNT                       PIC 9    VALUE 0.	0	0	1
57000240	57	       COPY SORTCODE.	0	0	1
57000242	57	       01 WS-ACCOUNT-NUMBER            PIC 9(8) VALUE 1.	0	0	1
57000245	57	       01 WS-ACCOUNT-TYPES.	0	0	1
57000246	57	           05 WS-ACCOUNT-TYPE          PIC X(8)	0	0	1
57000247	57	                                       OCCURS 5 TIMES	0	0	1
57000248	57	                                       DEPENDING ON	0	0	1
57000249	57	                                       ACCOUNT-TYPES-COUNT.	0	0	1
57000250	57	       01 ACCOUNT-TYPES-COUNT          PIC 9(8) BINARY  VALUE 0.	0	0	1
57000251	57	       01 ACCOUNT-TYPES-PTR            PIC 9(8) BINARY   VALUE 0.	0	0	1
57000253	57	       01 WS-ACCOUNT-INT-RATES.	0	0	1
57000254	57	           05 WS-ACCOUNT-INT-RATE      PIC 9(4)V99	0	0	1
57000255	57	                                       OCCURS 5 TIMES	0	0	1
57000256	57	                                       DEPENDING ON	0	0	1
57000257	57	                                       ACCOUNT-INT-RATES-COUNT.	0	0	1
57000258	57	       01 ACCOUNT-INT-RATES-COUNT      PIC 9(8) BINARY  VALUE 0.	0	0	1
57000259	57	       01 ACCOUNT-INT-RATES-PTR        PIC 9(8) BINARY   VALUE 0.	0	0	1
57000262	57	       01 WS-ACCOUNT-OVERDRAFT-LIMS.	0	0	1
57000263	57	           05 WS-ACCOUNT-OVERDRAFT-LIM PIC 9(8)	0	0	1
57000264	57	                                       OCCURS 5 TIMES	0	0	1
57000265	57	                                       DEPENDING ON	0	0	1
57000266	57	                                       ACCOUNT-OVERDRAFT-COUNT.	0	0	1
57000267	57	       01 ACCOUNT-OVERDRAFT-COUNT      PIC 9(8) BINARY  VALUE 0.	0	0	1
57000268	57	       01 ACCOUNT-OVERDRAFT-PTR        PIC 9(8) BINARY   VALUE 0.	0	0	1
57000270	57	       01 NO-OF-ACCOUNTS               PIC 9(8) BINARY   VALUE 0.	0	0	1
57000272	57	       01 WS-OVERDRAFT-CONVERSION      PIC S9(9) COMP VALUE 0.	0	0	1
57000275	57	       01 WS-PGM-NAME                             PIC X(8) VALUE ' '.	0	0	1
57000278	57	       01 WS-SQLCODE-DISPLAY             PIC S9(8) DISPLAY	0	0	1
57000279	57	           SIGN LEADING SEPARATE.	0	0	1
57000281	57	       01 OPENED-DATE-ATTEMPTS           PIC S9(8) DISPLAY	0	0	1
57000282	57	           SIGN LEADING SEPARATE.	0	0	1
57000284	57	       01 OPENED-DATE-VALID              PIC X VALUE 'N'.	0	0	1
57000288	57	       01 COMMIT-COUNT PIC S9(8) BINARY.	0	0	1
57000290	57	       01 time-data.	0	0	1
57000291	57	           05 tod-clock                PIC X(20).	0	0	1
57000292	57	           05 period-start             PIC X(14).	0	0	1
57000293	57	           05 period-next              COMP-2.	0	0	1
57000294	57	           05 period-next-f            PIC 9(14).	0	0	1
57000295	57	           05 gmt-lilian               PIC S9(8) BINARY.	0	0	1
57000296	57	           05 gmt-seconds              COMP-2.	0	0	1
57000297	57	           05 delay-interval           PIC S9(9) BINARY VALUE 1.	0	0	1
57000298	57	           05 fc                       PIC X(12).	0	0	1
57000299	57	           05 datm-conv                PIC X(80).	0	0	1
57000300	57	           05 datm-picture.	0	0	1
57000301	57	              10 datm-length           PIC 9999 COMP.	0	0	1
57000302	57	              10 datm-format           PIC X(14).	0	0	1
57000304	57	       01 TIMESTAMP-FUNCTION PIC X(40).	0	0	1
57000307	57	       01 WS-CURRENT-DATE-DATA.	0	0	1
57000308	57	           03 WS-CURRENT-DATE.	0	0	1
57000309	57	              05 WS-CURRENT-YYYY         PIC 9(4).	0	0	1
57000310	57	              05 WS-CURRENT-MM           PIC 99.	0	0	1
57000311	57	              05 WS-CURRENT-DD           PIC 99.	0	0	1
57000312	57	           03 WS-CURRENT-TIME.	0	0	1
57000313	57	              05 WS-CURRENT-HOURS        PIC 99.	0	0	1
57000314	57	              05 WS-CURRENT-MINS         PIC 99.	0	0	1
57000315	57	              05 WS-CURRENT-SECS         PIC 99.	0	0	1
57000316	57	              05 WS-CURRENT-MILLI        PIC 99.	0	0	1
57000317	57	           03 WS-DIFFERENCE-FROM-GMT     PIC S9(4).	0	0	1
57000319	57	       01 WS-CURRENT-DATE-9              PIC 9(8) VALUE 0.	0	0	1
57000320	57	       01 WS-TODAY-INT                   PIC 9(8) VALUE 0.	0	0	1
57000321	57	       01 WS-REVIEW-DATE-ADD             PIC 99 VALUE 0.	0	0	1
57000322	57	       01 WS-NEW-REVIEW-DATE-INT         PIC 9(8) VALUE 0.	0	0	1
57000323	57	       01 WS-NEW-REVIEW-YYYYMMDD         PIC 9(8) VALUE 0.	0	0	1
57000325	57	       01 CUSTOMER-CONTROL.	0	0	1
57000326	57	       COPY CUSTCTRL.	0	0	1
57000328	57	       01 ACCOUNT-CONTROL.	0	0	1
57000329	57	       COPY ACCTCTRL.	0	0	1
57000331	57	      * Get the CONTROL table	1	0	0
57000332	57	           EXEC SQL	0	0	0
57000333	57	              INCLUDE CONTDB2	0	0	1
57000334	57	           END-EXEC.	0	0	1
57000336	57	      * CONTROL Host variables for DB2	1	0	0
57000337	57	       01 HOST-CONTROL-ROW.	0	0	0
57000338	57	           03 HV-CONTROL-NAME                  PIC X(32).	0	0	1
57000339	57	           03 HV-CONTROL-VALUE-NUM             PIC S9(9) COMP.	0	0	1
57000340	57	           03 HV-CONTROL-VALUE-STR             PIC X(40).	0	0	1
57000343	57	       01 WS-WEEKDAYS                    PIC X(63) VALUE ' '.	0	0	1
57000344	57	       01 WS-WEEKDAY-GROUP	0	0	1
57000345	57	           REDEFINES WS-WEEKDAYS.	0	0	1
57000346	57	           03 WS-WEEKDAY                 PIC X(9) OCCURS 7 TIMES.	0	0	1
57000347	57	       01 WS-DT                          PIC 9(8) VALUE 0.	0	0	1
57000348	57	       01 WS-DT-REM                      PIC S9(9) COMP VALUE 0.	0	0	1
57000349	57	       01 WS-DAY-OF-WEEK-VAL             PIC 9    VALUE 0.	0	0	1
57000350	57	       01 WS-DAY-TODAY                   PIC X(9) VALUE ' '.	0	0	1
57000352	57	       01 SQLCODE-DISPLAY                PIC S9(8) DISPLAY	0	0	1
57000353	57	           SIGN LEADING SEPARATE.	0	0	1
57000355	57	      *****************************************************************	1	0	0
57000356	57	      *** Linkage Storage                                           ***	1	0	1
57000357	57	      *****************************************************************	1	0	1
57000358	57	       LINKAGE SECTION.	0	0	0
57000360	57	       01 PARM-BUFFER.	0	0	1
57000361	57	           05 PARM-LENGTH              PIC 9(4) BINARY.	0	0	1
57000362	57	           05 PARM                     PIC X(256).	0	0	1
57000365	57	      *****************************************************************	1	0	0
57000366	57	      *** Main Processing                                           ***	1	0	1
57000367	57	      *****************************************************************	1	0	1
57000368	57	       PROCEDURE DIVISION USING PARM-BUFFER.	0	0	0
57000369	57	       PREMIERE SECTION.	0	0	1
57000370	57	       A010.	0	0	1
57000371	57	           MOVE 'Starting BANKDATA'	0	0	1
57000372	57	             to TIMESTAMP-FUNCTION	0	0	1
57000373	57	           perform TIMESTAMP	0	0	1
57000375	57	      *	1	0	0
57000376	57	      * Initialise the arrays	1	0	1
57000377	57	      *	1	0	1
57000378	57	      D    DISPLAY 'About to initialise arrays'.	0	0	0
57000379	57	           PERFORM INITIALISE-ARRAYS.	0	0	1
57000382	57	      *	1	0	0
57000383	57	      * Get the parameters	1	0	1
57000384	57	      *	1	0	1
57000385	57	           UNSTRING PARM(1:PARM-LENGTH)	0	0	0
57000386	57	                    DELIMITED BY SPACE OR ','	0	0	1
57000387	57	                    INTO START-KEY	0	0	1
57000388	57	                         END-KEY	0	0	1
57000389	57	                         STEP-KEY	0	0	1
57000390	57	                         RANDOM-SEED.	0	0	1
57000393	57	      D    DISPLAY 'INPUT PARMS ARE: START-KEY=' START-KEY	0	0	1
57000394	57	      D             ' END-KEY=' END-KEY ' STEP-KEY=' STEP-KEY	0	0	1
57000395	57	      D             ' RANDOM-SEED=' RANDOM-SEED '	0	0	1
57000397	57	           IF END-KEY < START-KEY	0	0	1
57000398	57	             MOVE 12 TO RETURN-CODE	0	0	1
57000399	57	             DISPLAY 'Final customer number cannot be smaller than '	0	0	1
57000400	57	               'first customer number'	0	0	1
57000401	57	             GOBACK	0	0	1
57000402	57	           END-IF	0	0	1
57000403	57	           IF step-key = zero	0	0	1
57000404	57	             MOVE 12 TO RETURN-CODE	0	0	1
57000405	57	             DISPLAY 'Gap between customers cannot be zero'	0	0	1
57000406	57	             GOBACK	0	0	1
57000407	57	           END-IF	0	0	1
57000409	57	      *	1	0	0
57000410	57	      * Get today's date and store it as an INTEGER	1	0	1
57000411	57	      *	1	0	1
57000412	57	           PERFORM GET-TODAYS-DATE.	0	0	0
57000414	57	      *	1	0	0
57000415	57	      * Delete the DB2 TABLE contents that match the SortCode	1	0	1
57000416	57	      *	1	0	1
57000417	57	      D    DISPLAY 'About to delete DB2 rows'.	0	0	0
57000419	57	           PERFORM DELETE-DB2-ROWS.	0	0	1
57000420	57	      D    DISPLAY 'Back from delete DB2 rows'.	0	0	1
57000421	57	      *	1	0	0
57000422	57	      * Initialise the random seed	1	0	1
57000423	57	      *	1	0	1
57000424	57	      *    MOVE FUNCTION CURRENT-DATE TO RDATE.	1	0	1
57000427	57	      D    DISPLAY 'RANDOM SEED IS ' RANDOM-SEED-NUMERIC	0	0	0
57000428	57	           COMPUTE FORENAMES-PTR = FORENAMES-CNT *	0	0	1
57000429	57	                                   FUNCTION RANDOM(RANDOM-SEED-NUMERIC).	0	0	1
57000430	57	      D    DISPLAY 'FORENAMES-PTR IS ' FORENAMES-PTR.	0	0	1
57000431	57	           COMPUTE INITIALS-PTR =  INITIALS-CNT *	0	0	1
57000432	57	                                   FUNCTION RANDOM.	0	0	1
57000433	57	      D    DISPLAY 'INITIALS-PTR IS ' INITIALS-PTR	0	0	1
57000434	57	           COMPUTE SURNAMES-PTR  =  SURNAMES-CNT *	0	0	1
57000435	57	                                   FUNCTION RANDOM.	0	0	1
57000436	57	           COMPUTE TOWN-PTR  =  TOWN-COUNT *	0	0	1
57000437	57	                                   FUNCTION RANDOM.	0	0	1
57000438	57	           COMPUTE STREET-NAME-R-PTR =  STREET-NAME-R-CNT *	0	0	1
57000439	57	                                   FUNCTION RANDOM.	0	0	1
57000440	57	           COMPUTE STREET-NAME-T-PTR =  STREET-NAME-T-CNT *	0	0	1
57000441	57	                                   FUNCTION RANDOM.	0	0	1
57000442	57	           COMPUTE ACCOUNT-TYPES-PTR = ACCOUNT-TYPES-COUNT *	0	0	1
57000443	57	                                   FUNCTION RANDOM.	0	0	1
57000445	57	      *	1	0	0
57000446	57	      * Open the files	1	0	1
57000447	57	      *	1	0	1
57000449	57	           OPEN OUTPUT CUSTOMER-FILE.	0	0	0
57000450	57	           IF CUSTOMER-VSAM-STATUS NOT EQUAL '00' THEN	0	0	1
57000451	57	               DISPLAY 'Error opening CUSTOMER file, status='	0	0	1
57000452	57	                       CUSTOMER-VSAM-STATUS	0	0	1
57000453	57	               MOVE 12 TO RETURN-CODE	0	0	1
57000454	57	               PERFORM PROGRAM-DONE	0	0	1
57000455	57	           END-IF.	0	0	1
57000458	57	      *	1	0	0
57000459	57	      * Populate the CUSTOMER file	1	0	1
57000460	57	      *	1	0	1
57000461	57	           MOVE 'Populating Customer + Account files'	0	0	0
57000462	57	             to TIMESTAMP-FUNCTION	0	0	1
57000463	57	           perform TIMESTAMP	0	0	1
57000464	57	           MOVE ZERO TO COMMIT-COUNT	0	0	1
57000465	57	           MOVE ZERO TO LAST-CUSTOMER-NUMBER NUMBER-OF-CUSTOMERS	0	0	1
57000466	57	           MOVE ZERO TO LAST-ACCOUNT-NUMBER NUMBER-OF-ACCOUNTS	0	0	1
57000467	57	           PERFORM TEST BEFORE	0	0	1
57000468	57	                   VARYING NEXT-KEY FROM START-KEY BY STEP-KEY	0	0	1
57000469	57	                     UNTIL NEXT-KEY > END-KEY	0	0	1
57000471	57	               INITIALIZE CUSTOMER-RECORD IN CUSTOMER-RECORD-STRUCTURE	0	0	1
57000473	57	               SET CUSTOMER-EYECATCHER-VALUE TO TRUE	0	0	1
57000475	57	               MOVE NEXT-KEY TO CUSTOMER-NUMBER	0	0	1
57000476	57	               MOVE NEXT-KEY TO LAST-CUSTOMER-NUMBER	0	0	1
57000477	57	               ADD 1 TO NUMBER-OF-CUSTOMERS GIVING NUMBER-OF-CUSTOMERS	0	0	1
57000479	57	      D        DISPLAY 'Generating data for customer ' customer-number	0	0	1
57000481	57	               COMPUTE TITLE-NUMBER = ((36 - 1)	0	0	1
57000482	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000483	57	               COMPUTE FORENAMES-PTR = ((FORENAMES-CNT - 1)	0	0	1
57000484	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000485	57	               COMPUTE INITIALS-PTR  = ((INITIALS-CNT - 1)	0	0	1
57000486	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000487	57	               COMPUTE SURNAMES-PTR  = ((SURNAMES-CNT - 1)	0	0	1
57000488	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000489	57	               COMPUTE HOUSE-NUMBER  = (99	0	0	1
57000490	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000491	57	               COMPUTE STREET-NAME-T-PTR  = ((STREET-NAME-T-CNT - 1)	0	0	1
57000492	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000493	57	               COMPUTE STREET-NAME-R-PTR  = ((STREET-NAME-R-CNT - 1)	0	0	1
57000494	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000495	57	               COMPUTE TOWN-PTR           = ((TOWN-COUNT - 1)	0	0	1
57000496	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000498	57	               MOVE SPACES TO CUSTOMER-NAME	0	0	1
57000500	57	               STRING TITLE-WORD(TITLE-NUMBER) DELIMITED BY SPACE	0	0	1
57000501	57	               ' '  DELIMITED BY SIZE	0	0	1
57000502	57	               FORENAME(FORENAMES-PTR) DELIMITED BY SPACE	0	0	1
57000503	57	               ' '  DELIMITED BY SIZE	0	0	1
57000504	57	               INITIAL-CHARACTER(INITIALS-PTR) DELIMITED BY SPACE	0	0	1
57000505	57	               ' '  DELIMITED BY SIZE	0	0	1
57000506	57	               SURNAME(SURNAMES-PTR) DELIMITED BY SIZE	0	0	1
57000507	57	               INTO CUSTOMER-NAME	0	0	1
57000509	57	               MOVE SPACES TO CUSTOMER-ADDRESS	0	0	1
57000510	57	               STRING	0	0	1
57000511	57	               HOUSE-NUMBER DELIMITED BY SIZE	0	0	1
57000512	57	               ' ' DELIMITED BY SIZE	0	0	1
57000513	57	               STREET-NAME-TREE(STREET-NAME-T-PTR)	0	0	1
57000514	57	               DELIMITED BY SPACE	0	0	1
57000515	57	               ' ' DELIMITED BY SIZE	0	0	1
57000516	57	               STREET-NAME-ROAD(STREET-NAME-R-PTR)	0	0	1
57000517	57	               DELIMITED BY SPACE	0	0	1
57000518	57	               ', ' DELIMITED BY SIZE	0	0	1
57000519	57	               TOWN(TOWN-PTR)	0	0	1
57000520	57	               DELIMITED BY SPACE	0	0	1
57000521	57	               INTO CUSTOMER-ADDRESS	0	0	1
57000523	57	               COMPUTE CUSTOMER-BIRTH-DAY =  ((28 - 1)	0	0	1
57000524	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000525	57	               COMPUTE CUSTOMER-BIRTH-MONTH =  ((12 - 1)	0	0	1
57000526	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000527	57	               COMPUTE CUSTOMER-BIRTH-YEAR =  ((2000 - 1900)	0	0	1
57000528	57	                                        * FUNCTION RANDOM) + 1900	0	0	1
57000530	57	               MOVE SORTCODE TO	0	0	1
57000531	57	                  CUSTOMER-SORTCODE	0	0	1
57000534	57	               COMPUTE CUSTOMER-CREDIT-SCORE = ((999 - 1)	0	0	1
57000535	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000537	57	      *	1	0	0
57000538	57	      *        Generate the random credit score review date. This	1	0	1
57000539	57	      *        should be a date between 1 and 21 days from today	1	0	1
57000540	57	      *	1	0	1
57000542	57	               COMPUTE WS-REVIEW-DATE-ADD = ((21 - 1)	0	0	0
57000543	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000545	57	               COMPUTE WS-NEW-REVIEW-DATE-INT =	0	0	1
57000546	57	                  WS-TODAY-INT + WS-REVIEW-DATE-ADD	0	0	1
57000548	57	      *	1	0	0
57000549	57	      *        Convert the integer date back to YYYYMMDD format	1	0	1
57000550	57	      *        and store on the CUSTOMER record	1	0	1
57000551	57	      *	1	0	1
57000552	57	               COMPUTE WS-NEW-REVIEW-YYYYMMDD = FUNCTION	0	0	0
57000553	57	                  DATE-OF-INTEGER (WS-NEW-REVIEW-DATE-INT)	0	0	1
57000555	57	               MOVE WS-NEW-REVIEW-YYYYMMDD(1:4) TO	0	0	1
57000556	57	                  CUSTOMER-CS-REVIEW-YEAR	0	0	1
57000557	57	               MOVE WS-NEW-REVIEW-YYYYMMDD(5:2) TO	0	0	1
57000558	57	                  CUSTOMER-CS-REVIEW-MONTH	0	0	1
57000559	57	               MOVE WS-NEW-REVIEW-YYYYMMDD(7:2) TO	0	0	1
57000560	57	                  CUSTOMER-CS-REVIEW-DAY	0	0	1
57000562	57	               WRITE CUSTOMER-RECORD-STRUCTURE	0	0	1
57000564	57	               IF CUSTOMER-VSAM-STATUS NOT EQUAL '00' THEN	0	0	1
57000565	57	                   DISPLAY 'Error writing to VSAM file, status='	0	0	1
57000566	57	                           CUSTOMER-VSAM-STATUS	0	0	1
57000567	57	                   MOVE 12 TO RETURN-CODE	0	0	1
57000568	57	                   PERFORM PROGRAM-DONE	0	0	1
57000569	57	               END-IF	0	0	1
57000570	57	      *	1	0	0
57000571	57	      * Having written out to the CUSTOMER datastore we now need to	1	0	1
57000572	57	      * use some of this information to populate related data on	1	0	1
57000573	57	      * on the ACCOUNT datastore.	1	0	1
57000574	57	      *	1	0	1
57000576	57	               PERFORM DEFINE-ACC	0	0	0
57000578	57	               ADD 1 TO COMMIT-COUNT GIVING COMMIT-COUNT	0	0	1
57000579	57	               IF COMMIT-COUNT > 1000	0	0	1
57000580	57	      D          DISPLAY 'Commit every 1,000 records or so'	0	0	1
57000581	57	                 EXEC SQL	0	0	1
57000582	57	                  COMMIT WORK	0	0	1
57000583	57	                 END-EXEC	0	0	1
57000584	57	                 MOVE ZERO TO COMMIT-COUNT	0	0	1
57000585	57	               END-IF	0	0	1
57000586	57	           END-PERFORM	0	0	1
57000588	57	           MOVE '000000' TO CUSTOMER-CONTROL-SORTCODE	0	0	1
57000589	57	           MOVE '9999999999' TO CUSTOMER-CONTROL-NUMBER	0	0	1
57000590	57	           SET CUSTOMER-CONTROL-EYECATCHER-V TO TRUE	0	0	1
57000591	57	      D    DISPLAY 'ABOUT TO WRITE CUSTOMER-CONTROL-RECORD'	0	0	1
57000592	57	           MOVE CUSTOMER-CONTROL-RECORD	0	0	1
57000593	57	             TO CUSTOMER-RECORD IN CUSTOMER-RECORD-STRUCTURE	0	0	1
57000594	57	           WRITE CUSTOMER-RECORD-STRUCTURE	0	0	1
57000595	57	           IF CUSTOMER-VSAM-STATUS NOT EQUAL '00' THEN	0	0	1
57000596	57	                   DISPLAY 'Error writing CUSTOMER-CONTROL-RECORD file'	0	0	1
57000597	57	                   ', status=' CUSTOMER-VSAM-STATUS	0	0	1
57000598	57	                   MOVE 12 TO RETURN-CODE	0	0	1
57000599	57	                   PERFORM PROGRAM-DONE	0	0	1
57000600	57	           END-IF.	0	0	1
57000601	57	      * We need to store 2 values in DB2	1	0	0
57000602	57	      * <<sortcode>>-ACCOUNT-LAST	1	0	1
57000603	57	      * <<sortcode>>-ACCOUNT-COUNT	1	0	1
57000606	57	           MOVE SPACES TO HV-CONTROL-NAME	0	0	0
57000607	57	           MOVE LAST-ACCOUNT-NUMBER TO HV-CONTROL-VALUE-NUM	0	0	1
57000608	57	           MOVE SPACES TO HV-CONTROL-VALUE-STR	0	0	1
57000609	57	           STRING SORTCODE DELIMITED BY SIZE	0	0	1
57000610	57	           '-' DELIMITED BY SIZE	0	0	1
57000611	57	           'ACCOUNT-LAST' DELIMITED BY SIZE	0	0	1
57000612	57	           INTO HV-CONTROL-NAME	0	0	1
57000613	57	           EXEC SQL	0	0	1
57000614	57	              INSERT INTO CONTROL	0	0	1
57000615	57	                      (CONTROL_NAME,	0	0	1
57000616	57	                       CONTROL_VALUE_NUM,	0	0	1
57000617	57	                       CONTROL_VALUE_STR	0	0	1
57000618	57	                      )	0	0	1
57000619	57	              VALUES (:HV-CONTROL-NAME,	0	0	1
57000620	57	                      :HV-CONTROL-VALUE-NUM,	0	0	1
57000621	57	                      :HV-CONTROL-VALUE-STR	0	0	1
57000622	57	                     )	0	0	1
57000623	57	           END-EXEC.	0	0	1
57000625	57	           IF SQLCODE IS NOT EQUAL TO ZERO	0	0	1
57000626	57	             MOVE SQLCODE TO WS-SQLCODE-DISPLAY	0	0	1
57000627	57	             DISPLAY 'Error inserting last account control record '	0	0	1
57000628	57	             ws-sqlcode-display	0	0	1
57000629	57	             '.'	0	0	1
57000630	57	             HV-CONTROL-NAME,	0	0	1
57000631	57	             ','	0	0	1
57000632	57	             HV-CONTROL-VALUE-NUM	0	0	1
57000633	57	           END-IF	0	0	1
57000635	57	           MOVE SPACES TO HV-CONTROL-NAME	0	0	1
57000636	57	           MOVE NUMBER-OF-ACCOUNTS TO HV-CONTROL-VALUE-NUM	0	0	1
57000637	57	           MOVE SPACES TO HV-CONTROL-VALUE-STR	0	0	1
57000638	57	           STRING SORTCODE DELIMITED BY SIZE	0	0	1
57000639	57	           '-' DELIMITED BY SIZE	0	0	1
57000640	57	           'ACCOUNT-COUNT' DELIMITED BY SIZE	0	0	1
57000641	57	           INTO HV-CONTROL-NAME	0	0	1
57000642	57	           EXEC SQL	0	0	1
57000643	57	              INSERT INTO CONTROL	0	0	1
57000644	57	                      (CONTROL_NAME,	0	0	1
57000645	57	                       CONTROL_VALUE_NUM,	0	0	1
57000646	57	                       CONTROL_VALUE_STR	0	0	1
57000647	57	                      )	0	0	1
57000648	57	              VALUES (:HV-CONTROL-NAME,	0	0	1
57000649	57	                      :HV-CONTROL-VALUE-NUM,	0	0	1
57000650	57	                      :HV-CONTROL-VALUE-STR	0	0	1
57000651	57	                     )	0	0	1
57000652	57	           END-EXEC.	0	0	1
57000654	57	           IF SQLCODE IS NOT EQUAL TO ZERO	0	0	1
57000655	57	             MOVE SQLCODE TO WS-SQLCODE-DISPLAY	0	0	1
57000656	57	             DISPLAY 'Error inserting account count control record '	0	0	1
57000657	57	             ws-sqlcode-display	0	0	1
57000658	57	             '.'	0	0	1
57000659	57	             HV-CONTROL-NAME,	0	0	1
57000660	57	             ','	0	0	1
57000661	57	             HV-CONTROL-VALUE-NUM	0	0	1
57000662	57	           END-IF	0	0	1
57000666	57	      *	1	0	0
57000667	57	      *** Close the files	1	0	1
57000668	57	      *	1	0	1
57000669	57	           CLOSE CUSTOMER-FILE.	0	0	0
57000671	57	           MOVE 'Finishing BANKDATA'	0	0	1
57000672	57	             to TIMESTAMP-FUNCTION	0	0	1
57000673	57	           perform TIMESTAMP.	0	0	1
57000675	57	       A999.	0	0	1
57000676	57	           EXIT.	0	0	1
57000678	57	      *	1	0	0
57000679	57	      * Finish	1	0	1
57000680	57	      *	1	0	1
57000681	57	       PROGRAM-DONE SECTION.	0	0	0
57000682	57	       PD010.	0	0	1
57000684	57	           GOBACK.	0	0	1
57000685	57	       PD999.	0	0	1
57000686	57	           EXIT.	0	0	1
57000688	57	      *	1	0	0
57000689	57	      * Define and Populate the ACCOUNT datastore	1	0	1
57000690	57	      *	1	0	1
57000691	57	       DEFINE-ACC SECTION.	0	0	0
57000692	57	       DA010.	0	0	1
57000693	57	      D    DISPLAY 'IN DEFINE-ACC SECTION'.	0	0	1
57000695	57	      *	1	0	0
57000696	57	      * Decide how many accounts this customer will have. To allow	1	0	1
57000697	57	      * for growth make it between 1 and 5 (max is 10 at the moment	1	0	1
57000698	57	      * this maximum is dictated by the alternate key index which is	1	0	1
57000699	57	      * currently set to 10).	1	0	1
57000700	57	      *	1	0	1
57000701	57	           COMPUTE NO-OF-ACCOUNTS =  ((5 - 1)	0	0	0
57000702	57	                                        * FUNCTION RANDOM) + 1	0	0	1
57000703	57	      D    DISPLAY 'Creating accounts ' NO-OF-ACCOUNTS	0	0	1
57000704	57	           PERFORM POPULATE-ACC VARYING WS-CNT FROM 1 BY 1	0	0	1
57000705	57	               UNTIL WS-CNT > NO-OF-ACCOUNTS.	0	0	1
57000706	57	           EXEC SQL	0	0	1
57000707	57	             COMMIT WORK	0	0	1
57000708	57	           END-EXEC.	0	0	1
57000710	57	       DA999.	0	0	1
57000711	57	           EXIT.	0	0	1
57000713	57	      *	1	0	0
57000714	57	      * Populate account/s records and write to VSAM ACCOUNT datastore	1	0	1
57000715	57	      *	1	0	1
57000716	57	       POPULATE-ACC SECTION.	0	0	0
57000717	57	       PA010.	0	0	1
57000719	57	      *	1	0	0
57000720	57	      * Generate the account open date but it MUST be after	1	0	1
57000721	57	      * the DOB (otherwise that would just be silly)	1	0	1
57000722	57	      *	1	0	1
57000723	57	           MOVE 0 TO HV-ACCOUNT-OPENED-DAY	0	0	0
57000724	57	                     HV-ACCOUNT-OPENED-MONTH	0	0	1
57000725	57	                     HV-ACCOUNT-OPENED-YEAR	0	0	1
57000726	57	           MOVE 0 TO OPENED-DATE-ATTEMPTS	0	0	1
57000727	57	      D    DISPLAY 'About to generate opened date'	0	0	1
57000728	57	           MOVE 'N' TO OPENED-DATE-VALID	0	0	1
57000729	57	           PERFORM GENERATE-OPENED-DATE	0	0	1
57000730	57	                   UNTIL OPENED-DATE-VALID = 'Y'.	0	0	1
57000731	57	      D    DISPLAY 'Back from generate opened date after '	0	0	1
57000732	57	      D    OPENED-DATE-ATTEMPTS ' goes'	0	0	1
57000736	57	      *	1	0	0
57000737	57	      * Now insert the ACCOUNT record into the ACCOUNT table.	1	0	1
57000738	57	      *	1	0	1
57000740	57	           MOVE 'ACCT' TO	0	0	0
57000741	57	              HV-ACCOUNT-EYECATCHER OF HOST-ACCOUNT-ROW.	0	0	1
57000742	57	           MOVE CUSTOMER-NUMBER TO	0	0	1
57000743	57	              HV-ACCOUNT-CUST-NO OF HOST-ACCOUNT-ROW.	0	0	1
57000744	57	           MOVE SORTCODE TO	0	0	1
57000745	57	              HV-ACCOUNT-SORT-CODE OF HOST-ACCOUNT-ROW.	0	0	1
57000746	57	           MOVE WS-ACCOUNT-NUMBER TO	0	0	1
57000747	57	              HV-ACCOUNT-NUMBER OF HOST-ACCOUNT-ROW.	0	0	1
57000749	57	           MOVE WS-ACCOUNT-NUMBER TO LAST-ACCOUNT-NUMBER	0	0	1
57000751	57	      *    ADD 1 TO NUMBER-OF-ACCOUNTS GIVING NUMBER-OF-ACCOUNTS	1	0	0
57000753	57	      *    ADD 1 TO WS-ACCOUNT-NUMBER GIVING WS-ACCOUNT-NUMBER	1	0	1
57000755	57	           MOVE WS-ACCOUNT-TYPE(WS-CNT) TO	0	0	0
57000756	57	              HV-ACCOUNT-TYPE OF HOST-ACCOUNT-ROW.	0	0	1
57000757	57	           MOVE WS-ACCOUNT-INT-RATE(WS-CNT) TO	0	0	1
57000758	57	              HV-ACCOUNT-INTEREST-RATE OF HOST-ACCOUNT-ROW.	0	0	1
57000759	57	           MOVE '.' TO HV-ACCOUNT-OPENED-DELIM1.	0	0	1
57000760	57	           MOVE '.' TO HV-ACCOUNT-OPENED-DELIM2.	0	0	1
57000761	57	      *	1	0	0
57000762	57	      * Convert the overdraft into a field compatible with INTEGER on	1	0	1
57000763	57	      * the table	1	0	1
57000764	57	      *	1	0	1
57000765	57	           MOVE WS-ACCOUNT-OVERDRAFT-LIM(WS-CNT) TO	0	0	0
57000766	57	              WS-OVERDRAFT-CONVERSION.	0	0	1
57000767	57	           MOVE WS-OVERDRAFT-CONVERSION TO	0	0	1
57000768	57	              HV-ACCOUNT-OVERDRAFT-LIMIT OF HOST-ACCOUNT-ROW.	0	0	1
57000769	57	           MOVE '2021' TO	0	0	1
57000770	57	              HV-ACCOUNT-LAST-STMT-YEAR OF HOST-ACCOUNT-ROW.	0	0	1
57000771	57	           MOVE '.' TO HV-ACCOUNT-LAST-STMT-DELIM1.	0	0	1
57000772	57	           MOVE '07' TO	0	0	1
57000773	57	              HV-ACCOUNT-LAST-STMT-MONTH OF HOST-ACCOUNT-ROW.	0	0	1
57000774	57	           MOVE '.' TO HV-ACCOUNT-LAST-STMT-DELIM2.	0	0	1
57000775	57	           MOVE '01' TO	0	0	1
57000776	57	              HV-ACCOUNT-LAST-STMT-DAY OF HOST-ACCOUNT-ROW.	0	0	1
57000777	57	           MOVE '2021' TO	0	0	1
57000778	57	              HV-ACCOUNT-NEXT-STMT-YEAR OF HOST-ACCOUNT-ROW.	0	0	1
57000779	57	           MOVE '.' TO HV-ACCOUNT-NEXT-STMT-DELIM1.	0	0	1
57000780	57	           MOVE '08' TO	0	0	1
57000781	57	              HV-ACCOUNT-NEXT-STMT-MONTH OF HOST-ACCOUNT-ROW.	0	0	1
57000782	57	           MOVE '.' TO HV-ACCOUNT-NEXT-STMT-DELIM2.	0	0	1
57000783	57	           MOVE '01' TO	0	0	1
57000784	57	              HV-ACCOUNT-NEXT-STMT-DAY OF HOST-ACCOUNT-ROW.	0	0	1
57000785	57	           COMPUTE HV-ACCOUNT-AVAILABLE-BALANCE	0	0	1
57000786	57	                  = ((999999 - 1)	0	0	1
57000787	57	                                   * FUNCTION RANDOM) + 1.	0	0	1
57000788	57	           MOVE HV-ACCOUNT-AVAILABLE-BALANCE  TO	0	0	1
57000789	57	              HV-ACCOUNT-ACTUAL-BALANCE.	0	0	1
57000792	57	      *	1	0	0
57000793	57	      *    If it is a LOAN or a MORTGAGE then it should really have	1	0	1
57000794	57	      *    a negative balance (it doesn't make any sense for these	1	0	1
57000795	57	      *    accounts to have a positive balance).	1	0	1
57000796	57	      *	1	0	1
57000797	57	           IF HV-ACCOUNT-TYPE OF HOST-ACCOUNT-ROW = 'LOAN    ' OR	0	0	0
57000798	57	           HV-ACCOUNT-TYPE OF HOST-ACCOUNT-ROW = 'MORTGAGE'	0	0	1
57000799	57	                COMPUTE HV-ACCOUNT-ACTUAL-BALANCE =	0	0	1
57000800	57	                   0 - HV-ACCOUNT-ACTUAL-BALANCE OF HOST-ACCOUNT-ROW	0	0	1
57000802	57	                COMPUTE HV-ACCOUNT-AVAILABLE-BALANCE	0	0	1
57000803	57	                   OF HOST-ACCOUNT-ROW =	0	0	1
57000804	57	                   0 - HV-ACCOUNT-AVAILABLE-BALANCE OF HOST-ACCOUNT-ROW	0	0	1
57000806	57	           END-IF.	0	0	1
57000808	57	           EXEC SQL	0	0	1
57000809	57	              INSERT INTO ACCOUNT	0	0	1
57000810	57	                     (ACCOUNT_EYECATCHER,	0	0	1
57000811	57	                      ACCOUNT_CUSTOMER_NUMBER,	0	0	1
57000812	57	                      ACCOUNT_SORTCODE,	0	0	1
57000813	57	                      ACCOUNT_NUMBER,	0	0	1
57000814	57	                      ACCOUNT_TYPE,	0	0	1
57000815	57	                      ACCOUNT_INTEREST_RATE,	0	0	1
57000816	57	                      ACCOUNT_OPENED,	0	0	1
57000817	57	                      ACCOUNT_OVERDRAFT_LIMIT,	0	0	1
57000818	57	                      ACCOUNT_LAST_STATEMENT,	0	0	1
57000819	57	                      ACCOUNT_NEXT_STATEMENT,	0	0	1
57000820	57	                      ACCOUNT_AVAILABLE_BALANCE,	0	0	1
57000821	57	                      ACCOUNT_ACTUAL_BALANCE	0	0	1
57000822	57	                      )	0	0	1
57000823	57	              VALUES (:HV-ACCOUNT-EYECATCHER,	0	0	1
57000824	57	                      :HV-ACCOUNT-CUST-NO,	0	0	1
57000825	57	                      :HV-ACCOUNT-SORT-CODE,	0	0	1
57000826	57	                      :HV-ACCOUNT-NUMBER,	0	0	1
57000827	57	                      :HV-ACCOUNT-TYPE,	0	0	1
57000828	57	                      :HV-ACCOUNT-INTEREST-RATE,	0	0	1
57000829	57	                      :HV-ACCOUNT-OPENED,	0	0	1
57000830	57	                      :HV-ACCOUNT-OVERDRAFT-LIMIT,	0	0	1
57000831	57	                      :HV-ACCOUNT-LAST-STMT-DATE,	0	0	1
57000832	57	                      :HV-ACCOUNT-NEXT-STMT-DATE,	0	0	1
57000833	57	                      :HV-ACCOUNT-AVAILABLE-BALANCE,	0	0	1
57000834	57	                      :HV-ACCOUNT-ACTUAL-BALANCE	0	0	1
57000835	57	                     )	0	0	1
57000836	57	           END-EXEC.	0	0	1
57000838	57	      *	1	0	0
57000839	57	      * Check the SQLCODE	1	0	1
57000840	57	      *	1	0	1
57000841	57	           IF SQLCODE NOT = 0	0	0	0
57000842	57	              MOVE SQLCODE TO WS-SQLCODE-DISPLAY	0	0	1
57000843	57	              EVALUATE TRUE	0	0	1
57000844	57	              WHEN SQLERRD(3) EQUAL 13172878	0	0	1
57000845	57	                 MOVE 'TIMEOUT  (00C900E)' TO DISP-REASON-CODE	0	0	1
57000846	57	              WHEN SQLERRD(3) EQUAL 13172872	0	0	1
57000847	57	                 MOVE 'DEADLOCK (00C9088)' TO DISP-REASON-CODE	0	0	1
57000848	57	              WHEN OTHER	0	0	1
57000849	57	                  MOVE 'Unknown ReasonCode' TO DISP-REASON-CODE	0	0	1
57000850	57	              END-EVALUATE	0	0	1
57000851	57	              DISPLAY DISP-REASON-CODE	0	0	1
57000854	57	              DISPLAY 'Error inserting rows on ACCOUNT table.'	0	0	1
57000855	57	                  'For ACC no=' HV-ACCOUNT-NUMBER ' for SORTCODE='	0	0	1
57000856	57	                  HV-ACCOUNT-SORT-CODE	0	0	1
57000857	57	                  'SQLCODE=' WS-SQLCODE-DISPLAY	0	0	1
57000858	57	                     ',SQLSTATE=' SQLSTATE	0	0	1
57000859	57	                      ',SQLERRMC=' sqlerrmc(1:sqlerrmL)	0	0	1
57000860	57	                      ',sqlerrd(1)=' sqlerrd(1)	0	0	1
57000861	57	                      ',sqlerrd(2)=' sqlerrd(2)	0	0	1
57000862	57	                      ',sqlerrd(3)=' sqlerrd(3)	0	0	1
57000863	57	                      ',sqlerrd(4)=' sqlerrd(4)	0	0	1
57000864	57	                      ',sqlerrd(5)=' sqlerrd(5)	0	0	1
57000865	57	                      ',sqlerrd(6)=' sqlerrd(6)	0	0	1
57000866	57	              MOVE 12 TO RETURN-CODE	0	0	1
57000867	57	              PERFORM PROGRAM-DONE	0	0	1
57000869	57	           END-IF.	0	0	1
57000870	57	           MOVE WS-ACCOUNT-NUMBER TO LAST-ACCOUNT-NUMBER	0	0	1
57000871	57	           ADD 1 TO NUMBER-OF-ACCOUNTS GIVING NUMBER-OF-ACCOUNTS	0	0	1
57000872	57	           ADD 1 TO WS-ACCOUNT-NUMBER.	0	0	1
57000874	57	       PA999.	0	0	1
57000875	57	           EXIT.	0	0	1
57000877	57	      *	1	0	0
57000878	57	      * Generate the account opened date	1	0	1
57000879	57	      *	1	0	1
57000880	57	       GENERATE-OPENED-DATE SECTION.	0	0	0
57000881	57	       GOD010.	0	0	1
57000883	57	           COMPUTE WS-ACCOUNT-OPENED-DAY	0	0	1
57000884	57	                  =  ((28 - 1)	0	0	1
57000885	57	                                    * FUNCTION RANDOM) + 1.	0	0	1
57000886	57	           MOVE WS-ACCOUNT-OPENED-DAY TO HV-ACCOUNT-OPENED-DAY.	0	0	1
57000887	57	           COMPUTE WS-ACCOUNT-OPENED-MONTH	0	0	1
57000888	57	                  =  ((12 - 1)	0	0	1
57000889	57	                                    * FUNCTION RANDOM) + 1.	0	0	1
57000890	57	           MOVE WS-ACCOUNT-OPENED-MONTH TO HV-ACCOUNT-OPENED-MONTH.	0	0	1
57000891	57	           COMPUTE WS-ACCOUNT-OPENED-YEAR	0	0	1
57000892	57	                  =  ((2014 -	0	0	1
57000893	57	                                    CUSTOMER-BIRTH-YEAR)	0	0	1
57000894	57	                                    * FUNCTION RANDOM) +	0	0	1
57000895	57	                                    CUSTOMER-BIRTH-YEAR.	0	0	1
57000896	57	           MOVE WS-ACCOUNT-OPENED-YEAR TO HV-ACCOUNT-OPENED-YEAR.	0	0	1
57000897	57	      D    DISPLAY 'DATE OF BIRTH IS '	0	0	1
57000898	57	      D             CUSTOMER-BIRTH-DAY	0	0	1
57000899	57	      D             '/'	0	0	1
57000900	57	      D             CUSTOMER-BIRTH-MONTH	0	0	1
57000901	57	      D             '/'	0	0	1
57000902	57	      D             CUSTOMER-BIRTH-YEAR	0	0	1
57000904	57	      D    DISPLAY 'ACCOUNT OPENED  '	0	0	1
57000905	57	      D             HV-ACCOUNT-OPENED-DAY	0	0	1
57000906	57	      D             '/'	0	0	1
57000907	57	      D             HV-ACCOUNT-OPENED-MONTH	0	0	1
57000908	57	      D             '/'	0	0	1
57000909	57	      D             HV-ACCOUNT-OPENED-YEAR	0	0	1
57000911	57	           ADD 1 TO OPENED-DATE-ATTEMPTS GIVING OPENED-DATE-ATTEMPTS.	0	0	1
57000912	57	           IF HV-ACCOUNT-OPENED-YEAR	0	0	1
57000913	57	              > CUSTOMER-BIRTH-YEAR	0	0	1
57000914	57	             MOVE 'Y' TO OPENED-DATE-VALID	0	0	1
57000915	57	             GO TO GOD999	0	0	1
57000916	57	           END-IF.	0	0	1
57000917	57	           IF OPENED-DATE-ATTEMPTS > 100	0	0	1
57000918	57	             MOVE 'Y' TO OPENED-DATE-VALID	0	0	1
57000919	57	             MOVE CUSTOMER-BIRTH-DAY   TO HV-ACCOUNT-OPENED-DAY	0	0	1
57000920	57	             MOVE CUSTOMER-BIRTH-MONTH TO HV-ACCOUNT-OPENED-MONTH	0	0	1
57000921	57	             MOVE CUSTOMER-BIRTH-YEAR  TO HV-ACCOUNT-OPENED-YEAR	0	0	1
57000922	57	           END-IF.	0	0	1
57000923	57	       GOD999.	0	0	1
57000924	57	           EXIT.	0	0	1
57000927	57	      *****************************************************************	1	0	0
57000928	57	      *** Initialise Arrays                                         ***	1	0	1
57000929	57	      *****************************************************************	1	0	1
57000930	57	       INITIALISE-ARRAYS SECTION.	0	0	0
57000931	57	       IA010.	0	0	1
57000933	57	           MOVE TITLE-ALPHABET TO TITLE-WORDS.	0	0	1
57000935	57	           MOVE 50 TO FORENAMES-CNT.	0	0	1
57000937	57	           MOVE 'Michael' TO FORENAME(01).	0	0	1
57000938	57	           MOVE 'Will'    TO FORENAME(02).	0	0	1
57000939	57	           MOVE 'Geoff'   TO FORENAME(03).	0	0	1
57000940	57	           MOVE 'Chris'   TO FORENAME(04).	0	0	1
57000941	57	           MOVE 'Dave'    TO FORENAME(05).	0	0	1
57000942	57	           MOVE 'Luke'    TO FORENAME(06).	0	0	1
57000943	57	           MOVE 'Adam'    TO FORENAME(07).	0	0	1
57000944	57	           MOVE 'Giuseppe' TO FORENAME(08).	0	0	1
57000945	57	           MOVE 'James'   TO FORENAME(09).	0	0	1
57000946	57	           MOVE 'Jon'     TO FORENAME(10).	0	0	1
57000947	57	           MOVE 'Andy'    TO FORENAME(11).	0	0	1
57000948	57	           MOVE 'Lou'     TO FORENAME(12).	0	0	1
57000949	57	           MOVE 'Robert'  TO FORENAME(13).	0	0	1
57000950	57	           MOVE 'Sam'     TO FORENAME(14).	0	0	1
57000951	57	           MOVE 'Frederick' TO FORENAME(15).	0	0	1
57000952	57	           MOVE 'Buford'  TO FORENAME(16).	0	0	1
57000953	57	           MOVE 'William' TO FORENAME(17).	0	0	1
57000954	57	           MOVE 'Howard'  TO FORENAME(18).	0	0	1
57000955	57	           MOVE 'Anthony' TO FORENAME(19).	0	0	1
57000956	57	           MOVE 'Bruce'   TO FORENAME(20).	0	0	1
57000957	57	           MOVE 'Peter'   TO FORENAME(21).	0	0	1
57000958	57	           MOVE 'Stephen' TO FORENAME(22).	0	0	1
57000959	57	           MOVE 'Donald'  TO FORENAME(23).	0	0	1
57000960	57	           MOVE 'Dennis'  TO FORENAME(24).	0	0	1
57000961	57	           MOVE 'Harold'  TO FORENAME(25).	0	0	1
57000962	57	           MOVE 'Amy'     TO FORENAME(26).	0	0	1
57000963	57	           MOVE 'Belinda' TO FORENAME(27).	0	0	1
57000964	57	           MOVE 'Charlotte' TO FORENAME(28).	0	0	1
57000965	57	           MOVE 'Donna' TO FORENAME(29).	0	0	1
57000966	57	           MOVE 'Felicia' TO FORENAME(30).	0	0	1
57000967	57	           MOVE 'Gretchen' TO FORENAME(31).	0	0	1
57000968	57	           MOVE 'Henrietta' TO FORENAME(32).	0	0	1
57000969	57	           MOVE 'Imogen' TO FORENAME(33).	0	0	1
57000970	57	           MOVE 'Josephine' TO FORENAME(34).	0	0	1
57000971	57	           MOVE 'Kimberley' TO FORENAME(35).	0	0	1
57000972	57	           MOVE 'Lucy' TO FORENAME(36).	0	0	1
57000973	57	           MOVE 'Monica' TO FORENAME(37).	0	0	1
57000974	57	           MOVE 'Natalie' TO FORENAME(38).	0	0	1
57000975	57	           MOVE 'Ophelia' TO FORENAME(39).	0	0	1
57000976	57	           MOVE 'Patricia' TO FORENAME(40).	0	0	1
57000977	57	           MOVE 'Querida' TO FORENAME(41).	0	0	1
57000978	57	           MOVE 'Rachel' TO FORENAME(42).	0	0	1
57000979	57	           MOVE 'Samantha' TO FORENAME(43).	0	0	1
57000980	57	           MOVE 'Tanya'   TO FORENAME(44).	0	0	1
57000981	57	           MOVE 'Ulrika'  TO FORENAME(45).	0	0	1
57000982	57	           MOVE 'Virginia' TO FORENAME(46).	0	0	1
57000983	57	           MOVE 'Wendy'   TO FORENAME(47).	0	0	1
57000984	57	           MOVE 'Xaviera' TO FORENAME(48).	0	0	1
57000985	57	           MOVE 'Yvonne'  TO FORENAME(49).	0	0	1
57000986	57	           MOVE 'Zsa Zsa' TO FORENAME(50).	0	0	1
57000988	57	           MOVE 30 TO INITIALS-CNT.	0	0	1
57000990	57	           MOVE 'ABCDEFGHIJLKMNOPQRSTUVWXYZ    ' TO INITIALS.	0	0	1
57000992	57	           MOVE 50 TO SURNAMES-CNT.	0	0	1
57000994	57	           MOVE 'Jones'        TO SURNAME(01).	0	0	1
57000995	57	           MOVE 'Davidson'     TO SURNAME(02).	0	0	1
57000996	57	           MOVE 'Baker'        TO SURNAME(03).	0	0	1
57000997	57	           MOVE 'Smith'        TO SURNAME(04).	0	0	1
57000998	57	           MOVE 'Taylor'       TO SURNAME(05).	0	0	1
57000999	57	           MOVE 'Evans'        TO SURNAME(06).	0	0	1
57001000	57	           MOVE 'Roberts'      TO SURNAME(07).	0	0	1
57001001	57	           MOVE 'Wright'       TO SURNAME(08).	0	0	1
57001002	57	           MOVE 'Walker'       TO SURNAME(09).	0	0	1
57001003	57	           MOVE 'Green'        TO SURNAME(10).	0	0	1
57001004	57	           MOVE 'Price'        TO SURNAME(11).	0	0	1
57001005	57	           MOVE 'Downton'      TO SURNAME(12).	0	0	1
57001006	57	           MOVE 'Gatting'      TO SURNAME(13).	0	0	1
57001007	57	           MOVE 'Robinson'     TO SURNAME(14).	0	0	1
57001008	57	           MOVE 'Justice'      TO SURNAME(15).	0	0	1
57001009	57	           MOVE 'Tell'         TO SURNAME(16).	0	0	1
57001010	57	           MOVE 'Stark'        TO SURNAME(17).	0	0	1
57001011	57	           MOVE 'Strange'      TO SURNAME(18).	0	0	1
57001012	57	           MOVE 'Parker'       TO SURNAME(19).	0	0	1
57001013	57	           MOVE 'Blake'        TO SURNAME(20).	0	0	1
57001014	57	           MOVE 'Jackson'      TO SURNAME(21).	0	0	1
57001015	57	           MOVE 'Groves'       TO SURNAME(22).	0	0	1
57001016	57	           MOVE 'Palmer'       TO SURNAME(23).	0	0	1
57001017	57	           MOVE 'Ramsbottom'   TO SURNAME(24).	0	0	1
57001018	57	           MOVE 'Lloyd'        TO SURNAME(24).	0	0	1
57001019	57	           MOVE 'Hughes'       TO SURNAME(25).	0	0	1
57001020	57	           MOVE 'Briggs'       TO SURNAME(26).	0	0	1
57001021	57	           MOVE 'Higins'       TO SURNAME(27).	0	0	1
57001022	57	           MOVE 'Goodwin'      TO SURNAME(28).	0	0	1
57001023	57	           MOVE 'Valmont'      TO SURNAME(29).	0	0	1
57001024	57	           MOVE 'Brown'        TO SURNAME(30).	0	0	1
57001025	57	           MOVE 'Hopkins'      TO SURNAME(31).	0	0	1
57001026	57	           MOVE 'Bonney'       TO SURNAME(32).	0	0	1
57001027	57	           MOVE 'Jenkins'      TO SURNAME(33).	0	0	1
57001028	57	           MOVE 'Lloyd'        TO SURNAME(34).	0	0	1
57001029	57	           MOVE 'Wilmore'      TO SURNAME(35).	0	0	1
57001030	57	           MOVE 'Franklin'     TO SURNAME(36).	0	0	1
57001031	57	           MOVE 'Renton'       TO SURNAME(37).	0	0	1
57001032	57	           MOVE 'Seward'       TO SURNAME(38).	0	0	1
57001033	57	           MOVE 'Morris'       TO SURNAME(39).	0	0	1
57001034	57	           MOVE 'Johnson'      TO SURNAME(40).	0	0	1
57001035	57	           MOVE 'Brennan'      TO SURNAME(41).	0	0	1
57001036	57	           MOVE 'Thomson'      TO SURNAME(42).	0	0	1
57001037	57	           MOVE 'Barker'       TO SURNAME(43).	0	0	1
57001038	57	           MOVE 'Corbett'      TO SURNAME(44).	0	0	1
57001039	57	           MOVE 'Weber'        TO SURNAME(45).	0	0	1
57001040	57	           MOVE 'Leigh'        TO SURNAME(46).	0	0	1
57001041	57	           MOVE 'Croft'        TO SURNAME(47).	0	0	1
57001042	57	           MOVE 'Walken'       TO SURNAME(48).	0	0	1
57001043	57	           MOVE 'Dubois'       TO SURNAME(49).	0	0	1
57001044	57	           MOVE 'Stephens'     TO SURNAME(50).	0	0	1
57001046	57	           MOVE 26 TO STREET-NAME-T-CNT.	0	0	1
57001047	57	           MOVE 19 TO STREET-NAME-R-CNT.	0	0	1
57001049	57	           MOVE 'Acacia' to    STREET-NAME-TREE(1).	0	0	1
57001050	57	           MOVE 'Birch' to     STREET-NAME-TREE(2).	0	0	1
57001051	57	           MOVE 'Cypress' to   STREET-NAME-TREE(3).	0	0	1
57001052	57	           MOVE 'Douglas' to   STREET-NAME-TREE(4).	0	0	1
57001053	57	           MOVE 'Elm' to       STREET-NAME-TREE(5).	0	0	1
57001054	57	           MOVE 'Fir' to       STREET-NAME-TREE(6).	0	0	1
57001055	57	           MOVE 'Gorse' to     STREET-NAME-TREE(7).	0	0	1
57001056	57	           MOVE 'Holly' to     STREET-NAME-TREE(8).	0	0	1
57001057	57	           MOVE 'Ironwood' to  STREET-NAME-TREE(9).	0	0	1
57001058	57	           MOVE 'Joshua' to    STREET-NAME-TREE(10).	0	0	1
57001059	57	           MOVE 'Kapok' to     STREET-NAME-TREE(11).	0	0	1
57001060	57	           MOVE 'Laburnam' to  STREET-NAME-TREE(12).	0	0	1
57001061	57	           MOVE 'Maple' to     STREET-NAME-TREE(13).	0	0	1
57001062	57	           MOVE 'Nutmeg' to    STREET-NAME-TREE(14).	0	0	1
57001063	57	           MOVE 'Oak' to       STREET-NAME-TREE(15).	0	0	1
57001064	57	           MOVE 'Pine' to      STREET-NAME-TREE(16).	0	0	1
57001065	57	           MOVE 'Quercine' to  STREET-NAME-TREE(17).	0	0	1
57001066	57	           MOVE 'Rowan' to     STREET-NAME-TREE(18).	0	0	1
57001067	57	           MOVE 'Sycamore' to  STREET-NAME-TREE(19).	0	0	1
57001068	57	           MOVE 'Thorn' to     STREET-NAME-TREE(20).	0	0	1
57001069	57	           MOVE 'Ulmus' to     STREET-NAME-TREE(21).	0	0	1
57001070	57	           MOVE 'Viburnum' to  STREET-NAME-TREE(22).	0	0	1
57001071	57	           MOVE 'Willow' to    STREET-NAME-TREE(23).	0	0	1
57001072	57	           MOVE 'Xylophone' to STREET-NAME-TREE(24).	0	0	1
57001073	57	           MOVE 'Yew' to       STREET-NAME-TREE(25).	0	0	1
57001074	57	           MOVE 'Zebratree' to STREET-NAME-TREE(26).	0	0	1
57001077	57	           MOVE 'Avenue' to    STREET-NAME-ROAD(1).	0	0	1
57001078	57	           MOVE 'Boulevard' to STREET-NAME-ROAD(2).	0	0	1
57001079	57	           MOVE 'Close' to     STREET-NAME-ROAD(3).	0	0	1
57001080	57	           MOVE 'Crescent' to  STREET-NAME-ROAD(4).	0	0	1
57001081	57	           MOVE 'Drive' to     STREET-NAME-ROAD(5).	0	0	1
57001082	57	           MOVE 'Escalade' to  STREET-NAME-ROAD(6).	0	0	1
57001083	57	           MOVE 'Frontage' to  STREET-NAME-ROAD(7).	0	0	1
57001084	57	           MOVE 'Lane' to      STREET-NAME-ROAD(8).	0	0	1
57001085	57	           MOVE 'Mews' to      STREET-NAME-ROAD(9).	0	0	1
57001086	57	           MOVE 'Rise' to      STREET-NAME-ROAD(10).	0	0	1
57001087	57	           MOVE 'Court' to     STREET-NAME-ROAD(11).	0	0	1
57001088	57	           MOVE 'Opening' to   STREET-NAME-ROAD(12).	0	0	1
57001089	57	           MOVE 'Loke' to      STREET-NAME-ROAD(13).	0	0	1
57001090	57	           MOVE 'Square' to    STREET-NAME-ROAD(14).	0	0	1
57001091	57	           MOVE 'Houses' to    STREET-NAME-ROAD(15).	0	0	1
57001092	57	           MOVE 'Gate' to      STREET-NAME-ROAD(16).	0	0	1
57001093	57	           MOVE 'Street' to    STREET-NAME-ROAD(17).	0	0	1
57001094	57	           MOVE 'Grove' to     STREET-NAME-ROAD(18).	0	0	1
57001095	57	           MOVE 'March' to     STREET-NAME-ROAD(19).	0	0	1
57001097	57	           MOVE 50 TO TOWN-COUNT.	0	0	1
57001099	57	           MOVE 'Norwich'      TO TOWN(01).	0	0	1
57001100	57	           MOVE 'Acle   '      TO TOWN(02).	0	0	1
57001101	57	           MOVE 'Aylsham'      TO TOWN(03).	0	0	1
57001102	57	           MOVE 'Wymondham'    TO TOWN(04).	0	0	1
57001103	57	           MOVE 'Attleborough' TO TOWN(05).	0	0	1
57001104	57	           MOVE 'Cromer '      TO TOWN(06).	0	0	1
57001105	57	           MOVE 'Cambridge'    TO TOWN(07).	0	0	1
57001106	57	           MOVE 'Peterborough' TO TOWN(08).	0	0	1
57001107	57	           MOVE 'Weobley'      TO TOWN(09).	0	0	1
57001108	57	           MOVE 'Wembley'      TO TOWN(10).	0	0	1
57001109	57	           MOVE 'Hereford'     TO TOWN(11).	0	0	1
57001110	57	           MOVE 'Ross-on-Wye'  TO TOWN(12).	0	0	1
57001111	57	           MOVE 'Hay-on-Wye'   TO TOWN(13).	0	0	1
57001112	57	           MOVE 'Nottingham'   TO TOWN(14).	0	0	1
57001113	57	           MOVE 'Northampton'  TO TOWN(15).	0	0	1
57001114	57	           MOVE 'Nuneaton'     TO TOWN(16).	0	0	1
57001115	57	           MOVE 'Oxford'       TO TOWN(17).	0	0	1
57001116	57	           MOVE 'Oswestry'     TO TOWN(18).	0	0	1
57001117	57	           MOVE 'Ormskirk'     TO TOWN(19).	0	0	1
57001118	57	           MOVE 'Royston'      TO TOWN(20).	0	0	1
57001119	57	           MOVE 'Chilcomb'     TO TOWN(21).	0	0	1
57001120	57	           MOVE 'Winchester'   TO TOWN(22).	0	0	1
57001121	57	           MOVE 'Wrexham'      TO TOWN(23).	0	0	1
57001122	57	           MOVE 'Crewe  '      TO TOWN(24).	0	0	1
57001123	57	           MOVE 'Plymouth'     TO TOWN(25).	0	0	1
57001124	57	           MOVE 'Portsmouth'   TO TOWN(26).	0	0	1
57001125	57	           MOVE 'Forfar '      TO TOWN(27).	0	0	1
57001126	57	           MOVE 'Fife   '      TO TOWN(28).	0	0	1
57001127	57	           MOVE 'Aberdeen'     TO TOWN(29).	0	0	1
57001128	57	           MOVE 'Glasgow'      TO TOWN(30).	0	0	1
57001129	57	           MOVE 'Birmingham'   TO TOWN(31).	0	0	1
57001130	57	           MOVE 'Bolton'       TO TOWN(32).	0	0	1
57001131	57	           MOVE 'Whitby '      TO TOWN(33).	0	0	1
57001132	57	           MOVE 'Manchester'   TO TOWN(34).	0	0	1
57001133	57	           MOVE 'Chester '     TO TOWN(35).	0	0	1
57001134	57	           MOVE 'Leicester'    TO TOWN(36).	0	0	1
57001135	57	           MOVE 'Lowestoft'    TO TOWN(37).	0	0	1
57001136	57	           MOVE 'Ipswich'      TO TOWN(38).	0	0	1
57001137	57	           MOVE 'Colchester'   TO TOWN(39).	0	0	1
57001138	57	           MOVE 'Dover  '      TO TOWN(40).	0	0	1
57001139	57	           MOVE 'Brighton'     TO TOWN(41).	0	0	1
57001140	57	           MOVE 'Salisbury'    TO TOWN(42).	0	0	1
57001141	57	           MOVE 'Bristol'      TO TOWN(43).	0	0	1
57001142	57	           MOVE 'Bath   '      TO TOWN(44).	0	0	1
57001143	57	           MOVE 'Gloucester'   TO TOWN(45).	0	0	1
57001144	57	           MOVE 'Cheltenham'   TO TOWN(46).	0	0	1
57001145	57	           MOVE 'Durham '      TO TOWN(47).	0	0	1
57001146	57	           MOVE 'Carlisle'     TO TOWN(48).	0	0	1
57001147	57	           MOVE 'York   '      TO TOWN(49).	0	0	1
57001148	57	           MOVE 'Exeter '      TO TOWN(50).	0	0	1
57001151	57	           MOVE 5 TO ACCOUNT-TYPES-COUNT.	0	0	1
57001153	57	           MOVE 'ISA     ' TO WS-ACCOUNT-TYPE(1).	0	0	1
57001154	57	           MOVE 'SAVING  ' TO WS-ACCOUNT-TYPE(2).	0	0	1
57001155	57	           MOVE 'CURRENT ' TO WS-ACCOUNT-TYPE(3).	0	0	1
57001156	57	           MOVE 'LOAN    ' TO WS-ACCOUNT-TYPE(4).	0	0	1
57001157	57	           MOVE 'MORTGAGE' TO WS-ACCOUNT-TYPE(5).	0	0	1
57001160	57	           MOVE 5 TO ACCOUNT-INT-RATES-COUNT.	0	0	1
57001161	57	           MOVE 2.10       TO WS-ACCOUNT-INT-RATE(1).	0	0	1
57001162	57	           MOVE 1.75       TO WS-ACCOUNT-INT-RATE(2).	0	0	1
57001163	57	           MOVE 000000     TO WS-ACCOUNT-INT-RATE(3).	0	0	1
57001164	57	           MOVE 17.90      TO WS-ACCOUNT-INT-RATE(4).	0	0	1
57001165	57	           MOVE 5.25       TO WS-ACCOUNT-INT-RATE(5).	0	0	1
57001168	57	           MOVE 5 TO ACCOUNT-OVERDRAFT-COUNT.	0	0	1
57001170	57	           MOVE 0          TO WS-ACCOUNT-OVERDRAFT-LIM(1).	0	0	1
57001171	57	           MOVE 0          TO WS-ACCOUNT-OVERDRAFT-LIM(2).	0	0	1
57001172	57	           MOVE 00000100   TO WS-ACCOUNT-OVERDRAFT-LIM(3).	0	0	1
57001173	57	           MOVE 0          TO WS-ACCOUNT-OVERDRAFT-LIM(4).	0	0	1
57001174	57	           MOVE 0          TO WS-ACCOUNT-OVERDRAFT-LIM(5).	0	0	1
57001177	57	       IA999.	0	0	1
57001178	57	           EXIT.	0	0	1
57001180	57	      *	1	0	0
57001181	57	      * Delete the rows on the DB2 table	1	0	1
57001182	57	      *	1	0	1
57001183	57	       DELETE-DB2-ROWS SECTION.	0	0	0
57001184	57	       DBR010.	0	0	1
57001185	57	      *	1	0	0
57001186	57	      * Delete the ACCOUNT table data	1	0	1
57001187	57	      *	1	0	1
57001188	57	           MOVE SORTCODE TO HV-ACCOUNT-SORT-CODE.	0	0	0
57001189	57	           MOVE 'Deleting from ACCOUNT table'	0	0	1
57001190	57	             to TIMESTAMP-FUNCTION	0	0	1
57001191	57	           perform TIMESTAMP	0	0	1
57001192	57	           EXEC SQL	0	0	1
57001193	57	              DELETE FROM ACCOUNT	0	0	1
57001194	57	              WHERE ACCOUNT_SORTCODE = :HV-ACCOUNT-SORT-CODE	0	0	1
57001195	57	           END-EXEC.	0	0	1
57001198	57	      *	1	0	0
57001199	57	      * Check the SQL code if it was NOT OK (0) or NOTFND (+100)	1	0	1
57001200	57	      * then abend	1	0	1
57001201	57	      *	1	0	1
57001202	57	           MOVE 'Deleting from ACCOUNT table COMPLETE'	0	0	0
57001203	57	             to TIMESTAMP-FUNCTION	0	0	1
57001204	57	           perform TIMESTAMP	0	0	1
57001205	57	           IF SQLCODE NOT = +100 AND	0	0	1
57001206	57	           SQLCODE NOT = 0	0	0	1
57001208	57	              MOVE SQLCODE TO DISP-SQLCD	0	0	1
57001209	57	              IF SQLCODE < 0	0	0	1
57001210	57	                 MOVE '-' TO DISP-SIGN	0	0	1
57001211	57	              ELSE	0	0	1
57001212	57	                 MOVE '+' TO DISP-SIGN	0	0	1
57001213	57	              END-IF	0	0	1
57001214	57	              EVALUATE TRUE	0	0	1
57001215	57	              WHEN SQLERRD(3) EQUAL 13172878	0	0	1
57001216	57	                 MOVE 'TIMEOUT  (00C900E)' TO DISP-REASON-CODE	0	0	1
57001217	57	              WHEN SQLERRD(3) EQUAL 13172872	0	0	1
57001218	57	                 MOVE 'DEADLOCK (00C9088)' TO DISP-REASON-CODE	0	0	1
57001219	57	              WHEN OTHER	0	0	1
57001220	57	                  MOVE 'Unknown ReasonCode' TO DISP-REASON-CODE	0	0	1
57001221	57	              END-EVALUATE	0	0	1
57001223	57	              DISPLAY 'Error deleting rows from ACCOUNT table. For'	0	0	1
57001224	57	                      ' SORTCODE=' HV-ACCOUNT-SORT-CODE	0	0	1
57001225	57	                      ' SQLCODE=' DISP-LOT	0	0	1
57001226	57	                      ' SQLREASON=' DISP-REASON-CODE ' ( '	0	0	1
57001227	57	                      SQLERRD (3) ')'	0	0	1
57001228	57	                      ',SQLSTATE=' SQLSTATE	0	0	1
57001229	57	                      ',SQLERRMC=' sqlerrmc(1:sqlerrmL)	0	0	1
57001230	57	                      ',sqlerrd(1)=' sqlerrd(1)	0	0	1
57001231	57	                      ',sqlerrd(2)=' sqlerrd(2)	0	0	1
57001232	57	                      ',sqlerrd(3)=' sqlerrd(3)	0	0	1
57001233	57	                      ',sqlerrd(4)=' sqlerrd(4)	0	0	1
57001234	57	                      ',sqlerrd(5)=' sqlerrd(5)	0	0	1
57001235	57	                      ',sqlerrd(6)=' sqlerrd(6)	0	0	1
57001237	57	              MOVE 12 TO RETURN-CODE	0	0	1
57001238	57	              PERFORM PROGRAM-DONE	0	0	1
57001240	57	           END-IF.	0	0	1
57001242	57	      *	1	0	0
57001243	57	      * Delete the CONTROL table data	1	0	1
57001244	57	      *	1	0	1
57001245	57	           MOVE SPACES TO HV-CONTROL-NAME	0	0	0
57001246	57	           STRING SORTCODE DELIMITED BY SIZE	0	0	1
57001247	57	           '-' DELIMITED BY SIZE	0	0	1
57001248	57	           'ACCOUNT-LAST' DELIMITED BY SIZE	0	0	1
57001249	57	           INTO HV-CONTROL-NAME	0	0	1
57001251	57	           MOVE 'Deleting from CONTROL table'	0	0	1
57001252	57	             to TIMESTAMP-FUNCTION.	0	0	1
57001254	57	           PERFORM TIMESTAMP.	0	0	1
57001256	57	           EXEC SQL	0	0	1
57001257	57	              DELETE FROM CONTROL	0	0	1
57001258	57	              WHERE CONTROL_NAME = :HV-CONTROL-NAME	0	0	1
57001259	57	           END-EXEC.	0	0	1
57001262	57	      *	1	0	0
57001263	57	      *    Check the SQL code if it was NOT OK (0) or NOTFND (+100)	1	0	1
57001264	57	      *    then abend	1	0	1
57001265	57	      *	1	0	1
57001266	57	           MOVE 'Deleting from CONTROL table COMPLETE'	0	0	0
57001267	57	             to TIMESTAMP-FUNCTION.	0	0	1
57001269	57	           PERFORM TIMESTAMP.	0	0	1
57001271	57	           IF SQLCODE NOT = +100 AND	0	0	1
57001272	57	           SQLCODE NOT = 0	0	0	1
57001274	57	              MOVE SQLCODE TO DISP-SQLCD	0	0	1
57001275	57	              IF SQLCODE < 0	0	0	1
57001276	57	                 MOVE '-' TO DISP-SIGN	0	0	1
57001277	57	              ELSE	0	0	1
57001278	57	                 MOVE '+' TO DISP-SIGN	0	0	1
57001279	57	              END-IF	0	0	1
57001280	57	              EVALUATE TRUE	0	0	1
57001281	57	              WHEN SQLERRD(3) EQUAL 13172878	0	0	1
57001282	57	                 MOVE 'TIMEOUT  (00C900E)' TO DISP-REASON-CODE	0	0	1
57001283	57	              WHEN SQLERRD(3) EQUAL 13172872	0	0	1
57001284	57	                 MOVE 'DEADLOCK (00C9088)' TO DISP-REASON-CODE	0	0	1
57001285	57	              WHEN OTHER	0	0	1
57001286	57	                  MOVE 'Unknown ReasonCode' TO DISP-REASON-CODE	0	0	1
57001287	57	              END-EVALUATE	0	0	1
57001289	57	              DISPLAY 'Error deleting rows from CONTROL table. For'	0	0	1
57001290	57	                      ' CONTROL_NAME=' HV-CONTROL-NAME	0	0	1
57001291	57	                      ' SQLCODE=' DISP-LOT	0	0	1
57001292	57	                      ' SQLREASON=' DISP-REASON-CODE ' ( '	0	0	1
57001293	57	                      SQLERRD (3) ')'	0	0	1
57001294	57	                      ',SQLSTATE=' SQLSTATE	0	0	1
57001295	57	                      ',SQLERRMC=' sqlerrmc(1:sqlerrmL)	0	0	1
57001296	57	                      ',sqlerrd(1)=' sqlerrd(1)	0	0	1
57001297	57	                      ',sqlerrd(2)=' sqlerrd(2)	0	0	1
57001298	57	                      ',sqlerrd(3)=' sqlerrd(3)	0	0	1
57001299	57	                      ',sqlerrd(4)=' sqlerrd(4)	0	0	1
57001300	57	                      ',sqlerrd(5)=' sqlerrd(5)	0	0	1
57001301	57	                      ',sqlerrd(6)=' sqlerrd(6)	0	0	1
57001303	57	              MOVE 12 TO RETURN-CODE	0	0	1
57001304	57	              PERFORM PROGRAM-DONE	0	0	1
57001306	57	           END-IF.	0	0	1
57001308	57	      *	1	0	0
57001309	57	      * Delete the CONTROL table data	1	0	1
57001310	57	      *	1	0	1
57001311	57	           MOVE SPACES TO HV-CONTROL-NAME	0	0	0
57001312	57	           STRING SORTCODE DELIMITED BY SIZE	0	0	1
57001313	57	           '-' DELIMITED BY SIZE	0	0	1
57001314	57	           'ACCOUNT-COUNT' DELIMITED BY SIZE	0	0	1
57001315	57	           INTO HV-CONTROL-NAME	0	0	1
57001317	57	           MOVE 'Deleting from CONTROL table'	0	0	1
57001318	57	             to TIMESTAMP-FUNCTION.	0	0	1
57001320	57	           PERFORM TIMESTAMP.	0	0	1
57001322	57	           EXEC SQL	0	0	1
57001323	57	              DELETE FROM CONTROL	0	0	1
57001324	57	              WHERE CONTROL_NAME = :HV-CONTROL-NAME	0	0	1
57001325	57	           END-EXEC.	0	0	1
57001328	57	      *	1	0	0
57001329	57	      *    Check the SQL code if it was NOT OK (0) or NOTFND (+100)	1	0	1
57001330	57	      *    then abend	1	0	1
57001331	57	      *	1	0	1
57001332	57	           MOVE 'Deleting from CONTROL table COMPLETE'	0	0	0
57001333	57	             to TIMESTAMP-FUNCTION.	0	0	1
57001335	57	           PERFORM TIMESTAMP.	0	0	1
57001337	57	           IF SQLCODE NOT = +100 AND	0	0	1
57001338	57	           SQLCODE NOT = 0	0	0	1
57001340	57	              MOVE SQLCODE TO DISP-SQLCD	0	0	1
57001341	57	              IF SQLCODE < 0	0	0	1
57001342	57	                 MOVE '-' TO DISP-SIGN	0	0	1
57001343	57	              ELSE	0	0	1
57001344	57	                 MOVE '+' TO DISP-SIGN	0	0	1
57001345	57	              END-IF	0	0	1
57001346	57	              EVALUATE TRUE	0	0	1
57001347	57	              WHEN SQLERRD(3) EQUAL 13172878	0	0	1
57001348	57	                 MOVE 'TIMEOUT  (00C900E)' TO DISP-REASON-CODE	0	0	1
57001349	57	              WHEN SQLERRD(3) EQUAL 13172872	0	0	1
57001350	57	                 MOVE 'DEADLOCK (00C9088)' TO DISP-REASON-CODE	0	0	1
57001351	57	              WHEN OTHER	0	0	1
57001352	57	                  MOVE 'Unknown ReasonCode' TO DISP-REASON-CODE	0	0	1
57001353	57	              END-EVALUATE	0	0	1
57001355	57	              DISPLAY 'Error deleting rows from CONTROL table. For'	0	0	1
57001356	57	                      ' CONTROL_NAME=' HV-CONTROL-NAME	0	0	1
57001357	57	                      ' SQLCODE=' DISP-LOT	0	0	1
57001358	57	                      ' SQLREASON=' DISP-REASON-CODE ' ( '	0	0	1
57001359	57	                      SQLERRD (3) ')'	0	0	1
57001360	57	                      ',SQLSTATE=' SQLSTATE	0	0	1
57001361	57	                      ',SQLERRMC=' sqlerrmc(1:sqlerrmL)	0	0	1
57001362	57	                      ',sqlerrd(1)=' sqlerrd(1)	0	0	1
57001363	57	                      ',sqlerrd(2)=' sqlerrd(2)	0	0	1
57001364	57	                      ',sqlerrd(3)=' sqlerrd(3)	0	0	1
57001365	57	                      ',sqlerrd(4)=' sqlerrd(4)	0	0	1
57001366	57	                      ',sqlerrd(5)=' sqlerrd(5)	0	0	1
57001367	57	                      ',sqlerrd(6)=' sqlerrd(6)	0	0	1
57001369	57	              MOVE 12 TO RETURN-CODE	0	0	1
57001370	57	              PERFORM PROGRAM-DONE	0	0	1
57001372	57	           END-IF.	0	0	1
57001375	57	           EXEC SQL	0	0	1
57001376	57	              COMMIT WORK	0	0	1
57001377	57	           END-EXEC.	0	0	1
57001380	57	       DBR999.	0	0	1
57001381	57	           EXIT.	0	0	1
57001389	57	      *	1	0	0
57001390	57	      * Get todays date and store it as an INTEGER	1	0	1
57001391	57	      *	1	0	1
57001392	57	       GET-TODAYS-DATE SECTION.	0	0	0
57001393	57	       GTD010.	0	0	1
57001394	57	      D    DISPLAY 'IN GET-TODAYS-DATE SECTION'.	0	0	1
57001396	57	           MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE-DATA.	0	0	1
57001398	57	           MOVE WS-CURRENT-DATE-DATA (1:8) TO WS-CURRENT-DATE-9.	0	0	1
57001400	57	           COMPUTE WS-TODAY-INT =	0	0	1
57001401	57	              FUNCTION INTEGER-OF-DATE (WS-CURRENT-DATE-9).	0	0	1
57001403	57	       GTD999.	0	0	1
57001404	57	           EXIT.	0	0	1
57001406	57	       CALC-DAY-OF-WEEK SECTION.	0	0	1
57001407	57	       CDW010.	0	0	1
57001408	57	      *	1	0	0
57001409	57	      *    Calculate the day of the week. If WS-DAY-OF-WEEK-VAL	1	0	1
57001410	57	      *    contains 1 this is Sunday and so on.	1	0	1
57001411	57	      *	1	0	1
57001414	57	           STRING 'MONDAY   TUESDAY  WEDNESDAYTHURSDAY FRIDAY   '	0	0	0
57001415	57	                  DELIMITED BY SIZE	0	0	1
57001416	57	                  'SATURDAY SUNDAY   '	0	0	1
57001417	57	                  DELIMITED BY SIZE	0	0	1
57001418	57	                  INTO WS-WEEKDAYS	0	0	1
57001419	57	           END-STRING.	0	0	1
57001421	57	      *    COMPUTE WS-DAY-OF-WEEK-VAL =	1	0	0
57001422	57	      *       (FUNCTION	1	0	1
57001423	57	      *        MOD(FUNCTION	1	0	1
57001424	57	      *        INTEGER-OF-DATE(WS-CURRENT-DATE-9) 7))+1.	1	0	1
57001426	57	           DIVIDE WS-CURRENT-DATE-9 BY 7 GIVING WS-DT	0	0	0
57001427	57	                                         REMAINDER	0	0	1
57001428	57	                                         WS-DT-REM.	0	0	1
57001429	57	           IF WS-DT-REM = 0	0	0	1
57001430	57	              MOVE 7 TO WS-DT-REM	0	0	1
57001431	57	           END-IF.	0	0	1
57001433	57	           MOVE WS-WEEKDAY(WS-DT-REM) TO WS-DAY-TODAY.	0	0	1
57001435	57	      D    DISPLAY 'WS-DT-REM' WS-DT-REM.	0	0	1
57001436	57	      D    DISPLAY 'DAY OF THE WEEK IS ' WS-DAY-TODAY.	0	0	1
57001438	57	       CDW999.	0	0	1
57001439	57	           EXIT.	0	0	1
57001441	57	       TIMESTAMP SECTION.	0	0	1
57001442	57	           CALL 'CEEGMT' USING BY REFERENCE gmt-lilian	0	0	1
57001443	57	                                           BY REFERENCE gmt-seconds	0	0	1
57001444	57	                                           BY REFERENCE fc	0	0	1
57001446	57	      ***	1	0	0
57001447	57	      *** Move gmt to an integer so that we don't round up	1	0	1
57001448	57	      *** in the division	1	0	1
57001449	57	      ***	1	0	1
57001450	57	           MOVE gmt-seconds TO period-next-f.	0	0	0
57001451	57	           COMPUTE period-next   = period-next-f.	0	0	1
57001453	57	      ***	1	0	0
57001454	57	      *** Convert back into text	1	0	1
57001455	57	      ***	1	0	1
57001456	57	           MOVE 14               TO datm-length.	0	0	0
57001457	57	           MOVE 'YYYYMMDDHHMISS' TO datm-format.	0	0	1
57001458	57	           CALL 'CEEDATM' USING BY REFERENCE period-next	0	0	1
57001459	57	                                BY REFERENCE datm-picture	0	0	1
57001460	57	                                BY REFERENCE datm-conv	0	0	1
57001461	57	                                BY REFERENCE fc.	0	0	1
57001462	57	      D    DISPLAY TIMESTAMP-FUNCTION ' AT ' DATM-CONV(1:14).	0	0	1
57001463	57	           EXIT.	0	0	1
58000000	58	<<<< file not found >>>>	0	0	0
58000001	58	<<<< file not found >>>>	0	0	0
59000001	59	       CBL CICS('SP,EDF')	0	0	1
59000002	59	      ******************************************************************	1	0	0
59000003	59	      *                                                                *	1	0	1
59000004	59	      *  Copyright IBM Corp. 2023                                      *	1	0	1
59000005	59	      *                                                                *	1	0	1
59000006	59	      ******************************************************************	1	0	1
59000008	59	       IDENTIFICATION DIVISION.	0	0	0
59000009	59	       PROGRAM-ID. GETCOMPY.	0	0	1
59000010	59	       AUTHOR. James O'Grady.	0	0	1
59000013	59	       ENVIRONMENT DIVISION.	0	0	1
59000014	59	       CONFIGURATION SECTION.	0	0	1
59000015	59	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
59000016	59	       SOURCE-COMPUTER.  IBM-370.	0	0	0
59000017	59	       OBJECT-COMPUTER.  IBM-370.	0	0	1
59000019	59	       INPUT-OUTPUT SECTION.	0	0	1
59000022	59	       DATA DIVISION.	0	0	1
59000023	59	       FILE SECTION.	0	0	1
59000026	59	       WORKING-STORAGE SECTION.	0	0	1
59000029	59	       LINKAGE SECTION.	0	0	1
59000030	59	       01 DFHCOMMAREA.	0	0	1
59000031	59	           COPY GETCOMPY.	0	0	1
59000035	59	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
59000036	59	       PREMIERE SECTION.	0	0	1
59000037	59	       A010.	0	0	1
59000038	59	           move 'CICS Banking Sample Application' to COMPANY-NAME.	0	0	1
59000040	59	           EXEC CICS RETURN	0	0	1
59000041	59	           END-EXEC.	0	0	1
59000043	59	           GOBACK.	0	0	1
60000000	60	<<<< file not found >>>>	0	0	0
60000001	60	<<<< file not found >>>>	0	0	0
61000001	61	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	1
61000002	61	       CBL CICS('SP,EDF')	0	0	1
61000003	61	       CBL SQL	0	0	1
61000004	61	      ******************************************************************	1	0	0
61000005	61	      *                                                                *	1	0	1
61000006	61	      *  Copyright IBM Corp. 2023                                      *	1	0	1
61000007	61	      *                                                                *	1	0	1
61000008	61	      ******************************************************************	1	0	1
61000009	61	      ******************************************************************	1	0	1
61000010	61	      * This program will get called when someone pays some cash in to	1	0	1
61000011	61	      * the bank over the counter or takes out some cash out over the	1	0	1
61000012	61	      * counter.	1	0	1
61000013	61	      *	1	0	1
61000014	61	      * This program takes an account number and amount, it then	1	0	1
61000015	61	      * accesses the DB2 datastore and retrieves the associated	1	0	1
61000016	61	      * Account record and applies the amount and returns the	1	0	1
61000017	61	      * updated actual amount and the available balance from the Account	1	0	1
61000018	61	      * datastore.	1	0	1
61000019	61	      *	1	0	1
61000020	61	      * If the update is successfully applied to the Account then a	1	0	1
61000021	61	      * record is written to the PROCTRAN (Processed Transaction)	1	0	1
61000022	61	      * datastore.	1	0	1
61000023	61	      *	1	0	1
61000024	61	      * If the transaction cannot be successfullty applied to the	1	0	1
61000025	61	      * Account datastore, because the account no longer exists	1	0	1
61000026	61	      * (for example) then the SUCCESS flag is set to 'N' and a fail	1	0	1
61000027	61	      * code gets written to the return data, for the calling routine	1	0	1
61000028	61	      * to handle.	1	0	1
61000029	61	      *	1	0	1
61000030	61	      ******************************************************************	1	0	1
61000032	61	       IDENTIFICATION DIVISION.	0	0	0
61000033	61	       PROGRAM-ID. DBCRFUN.	0	0	1
61000034	61	       AUTHOR. Jon Collett.	0	0	1
61000036	61	       ENVIRONMENT DIVISION.	0	0	1
61000037	61	       CONFIGURATION SECTION.	0	0	1
61000038	61	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
61000039	61	       SOURCE-COMPUTER.  IBM-370.	0	0	0
61000040	61	       OBJECT-COMPUTER.  IBM-370.	0	0	1
61000042	61	       INPUT-OUTPUT SECTION.	0	0	1
61000045	61	       DATA DIVISION.	0	0	1
61000046	61	       WORKING-STORAGE SECTION.	0	0	1
61000048	61	       COPY SORTCODE.	0	0	1
61000052	61	       77 SYSIDERR-RETRY                PIC 999.	0	0	1
61000054	61	      * Get the ACCOUNT DB2 copybook	1	0	0
61000055	61	           EXEC SQL	0	0	0
61000056	61	              INCLUDE ACCDB2	0	0	1
61000057	61	           END-EXEC.	0	0	1
61000059	61	      * ACCOUNT Host variables for DB2	1	0	0
61000060	61	       01 HOST-ACCOUNT-ROW.	0	0	0
61000061	61	          03 HV-ACCOUNT-EYECATCHER      PIC X(4).	0	0	1
61000062	61	          03 HV-ACCOUNT-CUST-NO         PIC X(10).	0	0	1
61000063	61	          03 HV-ACCOUNT-KEY.	0	0	1
61000064	61	             05 HV-ACCOUNT-SORTCODE     PIC X(6).	0	0	1
61000065	61	             05 HV-ACCOUNT-ACC-NO       PIC X(8).	0	0	1
61000066	61	          03 HV-ACCOUNT-ACC-TYPE        PIC X(8).	0	0	1
61000067	61	          03 HV-ACCOUNT-INT-RATE        PIC S9(4)V99 COMP-3.	0	0	1
61000068	61	          03 HV-ACCOUNT-OPENED          PIC X(10).	0	0	1
61000069	61	          03 HV-ACCOUNT-OVERDRAFT-LIM   PIC S9(9) COMP.	0	0	1
61000070	61	          03 HV-ACCOUNT-LAST-STMT       PIC X(10).	0	0	1
61000071	61	          03 HV-ACCOUNT-NEXT-STMT       PIC X(10).	0	0	1
61000072	61	          03 HV-ACCOUNT-AVAIL-BAL       PIC S9(10)V99 COMP-3.	0	0	1
61000073	61	          03 HV-ACCOUNT-ACTUAL-BAL      PIC S9(10)V99 COMP-3.	0	0	1
61000075	61	      * PROCTRAN DB2 copybook	1	0	0
61000076	61	          EXEC SQL	0	0	0
61000077	61	             INCLUDE PROCDB2	0	0	1
61000078	61	          END-EXEC.	0	0	1
61000080	61	      * PROCTRAN host variables for DB2	1	0	0
61000081	61	       01 HOST-PROCTRAN-ROW.	0	0	0
61000082	61	          03 HV-PROCTRAN-EYECATCHER     PIC X(4).	0	0	1
61000083	61	          03 HV-PROCTRAN-SORT-CODE      PIC X(6).	0	0	1
61000084	61	          03 HV-PROCTRAN-ACC-NUMBER     PIC X(8).	0	0	1
61000085	61	          03 HV-PROCTRAN-DATE           PIC X(10).	0	0	1
61000086	61	          03 HV-PROCTRAN-TIME           PIC X(6).	0	0	1
61000087	61	          03 HV-PROCTRAN-REF            PIC X(12).	0	0	1
61000088	61	          03 HV-PROCTRAN-TYPE           PIC X(3).	0	0	1
61000089	61	          03 HV-PROCTRAN-DESC           PIC X(40).	0	0	1
61000090	61	          03 HV-PROCTRAN-AMOUNT         PIC S9(10)V99 COMP-3.	0	0	1
61000092	61	      * Pull in the SQL COMMAREA	1	0	0
61000093	61	        EXEC SQL	0	0	0
61000094	61	          INCLUDE SQLCA	0	0	1
61000095	61	        END-EXEC.	0	0	1
61000097	61	       01 WS-CICS-WORK-AREA.	0	0	1
61000098	61	          05 WS-CICS-RESP               PIC S9(8) COMP.	0	0	1
61000099	61	          05 WS-CICS-RESP2              PIC S9(8) COMP.	0	0	1
61000102	61	       LOCAL-STORAGE SECTION.	0	0	1
61000103	61	       01 FILE-RETRY                    PIC 999.	0	0	1
61000104	61	       01 WS-EXIT-RETRY-LOOP            PIC X         VALUE ' '.	0	0	1
61000106	61	       01 DB2-DATE-REFORMAT.	0	0	1
61000107	61	          03 DB2-DATE-REF-YR            PIC 9(4).	0	0	1
61000108	61	          03 FILLER                     PIC X.	0	0	1
61000109	61	          03 DB2-DATE-REF-MNTH          PIC 99.	0	0	1
61000110	61	          03 FILLER                     PIC X.	0	0	1
61000111	61	          03 DB2-DATE-REF-DAY           PIC 99.	0	0	1
61000113	61	       01 DATA-STORE-TYPE               PIC X.	0	0	1
61000114	61	          88 DATASTORE-TYPE-DLI                       VALUE '1'.	0	0	1
61000115	61	          88 DATASTORE-TYPE-DB2                       VALUE '2'.	0	0	1
61000116	61	          88 DATASTORE-TYPE-VSAM                      VALUE 'V'.	0	0	1
61000118	61	       01 WS-ACC-DATA.	0	0	1
61000119	61	          COPY ACCOUNT.	0	0	1
61000121	61	       01 WS-EIBTASKN12                 PIC 9(12)     VALUE 0.	0	0	1
61000122	61	       01 WS-SQLCODE-DISP               PIC 9(9)      VALUE 0.	0	0	1
61000124	61	       01 DESIRED-ACC-KEY.	0	0	1
61000125	61	          03 DESIRED-SORT-CODE          PIC 9(6).	0	0	1
61000126	61	          03 DESIRED-ACC-NO             PIC 9(8).	0	0	1
61000128	61	       01 NEW-ACCOUNT-AVAILABLE-BALANCE PIC S9(10)V99 VALUE 0.	0	0	1
61000129	61	       01 NEW-ACCOUNT-ACTUAL-BALANCE    PIC S9(10)V99 VALUE 0.	0	0	1
61000130	61	       01 WS-ACC-REC-LEN                PIC S9(4) COMP	0	0	1
61000131	61	                                                      VALUE 0.	0	0	1
61000133	61	       01 WS-U-TIME                     PIC S9(15) COMP-3.	0	0	1
61000134	61	       01 WS-ORIG-DATE                  PIC X(10).	0	0	1
61000135	61	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
61000136	61	          03 WS-ORIG-DATE-DD            PIC 99.	0	0	1
61000137	61	          03 FILLER                     PIC X.	0	0	1
61000138	61	          03 WS-ORIG-DATE-MM            PIC 99.	0	0	1
61000139	61	          03 FILLER                     PIC X.	0	0	1
61000140	61	          03 WS-ORIG-DATE-YYYY          PIC 9999.	0	0	1
61000142	61	       01 WS-ORIG-DATE-GRP-X.	0	0	1
61000143	61	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
61000144	61	          03 FILLER                     PIC X         VALUE '.'.	0	0	1
61000145	61	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
61000146	61	          03 FILLER                     PIC X         VALUE '.'.	0	0	1
61000147	61	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
61000149	61	       01 PROCTRAN-AREA.	0	0	1
61000150	61	          COPY PROCTRAN.	0	0	1
61000152	61	       01 WS-PASSED-DATA.	0	0	1
61000153	61	          02 WS-TEST-KEY                PIC X(4).	0	0	1
61000154	61	          02 WS-SORT-CODE               PIC 9(6).	0	0	1
61000155	61	          02 WS-CUSTOMER-RANGE.	0	0	1
61000156	61	             07 WS-CUSTOMER-RANGE-TOP   PIC X.	0	0	1
61000157	61	             07 WS-CUSTOMER-RANGE-MIDDLE	0	0	1
61000158	61	                                        PIC X.	0	0	1
61000159	61	             07 WS-CUSTOMER-RANGE-BOTTOM	0	0	1
61000160	61	                                        PIC X.	0	0	1
61000162	61	      * 01 CUSTOMER-KY.	1	0	0
61000163	61	      *    03 REQUIRED-SORT-CODE         PIC 9(6)      VALUE 0.	1	0	1
61000164	61	      *    03 REQUIRED-ACC-NUM           PIC 9(8)      VALUE 0.	1	0	1
61000166	61	       01 PROCTRAN-RIDFLD               PIC S9(8) COMP.	0	0	0
61000168	61	       01 SQLCODE-DISPLAY               PIC S9(8) DISPLAY	0	0	1
61000169	61	             SIGN LEADING SEPARATE.	0	0	1
61000171	61	       01 MY-ABEND-CODE                 PIC XXXX.	0	0	1
61000173	61	       01 WS-STORM-DRAIN                PIC X         VALUE 'N'.	0	0	1
61000174	61	       01 STORM-DRAIN-CONDITION         PIC X(20).	0	0	1
61000176	61	       01 NUMERIC-AMOUNT-DISPLAY        PIC +9(10).99.	0	0	1
61000178	61	       01 WS-TIME-DATA.	0	0	1
61000179	61	          03 WS-TIME-NOW                PIC 9(6).	0	0	1
61000180	61	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
61000181	61	             05 WS-TIME-NOW-GRP-HH      PIC 99.	0	0	1
61000182	61	             05 WS-TIME-NOW-GRP-MM      PIC 99.	0	0	1
61000183	61	             05 WS-TIME-NOW-GRP-SS      PIC 99.	0	0	1
61000185	61	       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.	0	0	1
61000187	61	       01 ABNDINFO-REC.	0	0	1
61000188	61	           COPY ABNDINFO.	0	0	1
61000190	61	       01 WS-SUFFICIENT-FUNDS           PIC X VALUE 'N'.	0	0	1
61000191	61	       01 WS-DIFFERENCE                 PIC S9(10)V99.	0	0	1
61000193	61	       LINKAGE SECTION.	0	0	1
61000194	61	       01 DFHCOMMAREA.	0	0	1
61000195	61	          COPY PAYDBCR.	0	0	1
61000198	61	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
61000199	61	       PREMIERE SECTION.	0	0	1
61000200	61	       A010.	0	0	1
61000201	61	           MOVE 'N' TO COMM-SUCCESS	0	0	1
61000202	61	           MOVE '0' TO COMM-FAIL-CODE	0	0	1
61000204	61	      *	1	0	0
61000205	61	      *    Set up some Abend handling	1	0	1
61000206	61	      *	1	0	1
61000207	61	           EXEC CICS HANDLE ABEND	0	0	0
61000208	61	              LABEL(ABEND-HANDLING)	0	0	1
61000209	61	           END-EXEC.	0	0	1
61000211	61	           MOVE SORTCODE TO COMM-SORTC.	0	0	1
61000212	61	           MOVE SORTCODE TO DESIRED-SORT-CODE.	0	0	1
61000214	61	      *	1	0	0
61000215	61	      *    Determine what kind of ACCOUNT datastore we should	1	0	1
61000216	61	      *    be accessing	1	0	1
61000217	61	      *	1	0	1
61000220	61	      *	1	0	1
61000221	61	      *           Go and update the ACCOUNT record	1	0	1
61000222	61	      *	1	0	1
61000223	61	            PERFORM UPDATE-ACCOUNT-DB2.	0	0	0
61000224	61	      *	1	0	0
61000225	61	      *    The COMMAREA values have now been set so all we need to do	1	0	1
61000226	61	      *    is finish	1	0	1
61000227	61	      *	1	0	1
61000229	61	           PERFORM GET-ME-OUT-OF-HERE.	0	0	0
61000231	61	       A999.	0	0	1
61000232	61	           EXIT.	0	0	1
61000235	61	       UPDATE-ACCOUNT-DB2 SECTION.	0	0	1
61000236	61	       UAD010.	0	0	1
61000238	61	           MOVE COMM-ACCNO TO DESIRED-ACC-NO.	0	0	1
61000239	61	           MOVE DESIRED-SORT-CODE TO HV-ACCOUNT-SORTCODE.	0	0	1
61000240	61	           MOVE DESIRED-ACC-NO TO HV-ACCOUNT-ACC-NO.	0	0	1
61000242	61	      *	1	0	0
61000243	61	      *    Retrieve the account information	1	0	1
61000244	61	      *	1	0	1
61000245	61	           EXEC SQL	0	0	0
61000246	61	              SELECT ACCOUNT_EYECATCHER,	0	0	1
61000247	61	                     ACCOUNT_CUSTOMER_NUMBER,	0	0	1
61000248	61	                     ACCOUNT_SORTCODE,	0	0	1
61000249	61	                     ACCOUNT_NUMBER,	0	0	1
61000250	61	                     ACCOUNT_TYPE,	0	0	1
61000251	61	                     ACCOUNT_INTEREST_RATE,	0	0	1
61000252	61	                     ACCOUNT_OPENED,	0	0	1
61000253	61	                     ACCOUNT_OVERDRAFT_LIMIT,	0	0	1
61000254	61	                     ACCOUNT_LAST_STATEMENT,	0	0	1
61000255	61	                     ACCOUNT_NEXT_STATEMENT,	0	0	1
61000256	61	                     ACCOUNT_AVAILABLE_BALANCE,	0	0	1
61000257	61	                     ACCOUNT_ACTUAL_BALANCE	0	0	1
61000258	61	              INTO  :HV-ACCOUNT-EYECATCHER,	0	0	1
61000259	61	                    :HV-ACCOUNT-CUST-NO,	0	0	1
61000260	61	                    :HV-ACCOUNT-SORTCODE,	0	0	1
61000261	61	                    :HV-ACCOUNT-ACC-NO,	0	0	1
61000262	61	                    :HV-ACCOUNT-ACC-TYPE,	0	0	1
61000263	61	                    :HV-ACCOUNT-INT-RATE,	0	0	1
61000264	61	                    :HV-ACCOUNT-OPENED,	0	0	1
61000265	61	                    :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
61000266	61	                    :HV-ACCOUNT-LAST-STMT,	0	0	1
61000267	61	                    :HV-ACCOUNT-NEXT-STMT,	0	0	1
61000268	61	                    :HV-ACCOUNT-AVAIL-BAL,	0	0	1
61000269	61	                    :HV-ACCOUNT-ACTUAL-BAL	0	0	1
61000270	61	              FROM ACCOUNT	0	0	1
61000271	61	              WHERE  (ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND	0	0	1
61000272	61	                      ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO)	0	0	1
61000273	61	           END-EXEC.	0	0	1
61000275	61	      *	1	0	0
61000276	61	      *    Check that select was successful. If it wasn't then deal with	1	0	1
61000277	61	      *    it	1	0	1
61000278	61	      *	1	0	1
61000279	61	           IF SQLCODE NOT = 0	0	0	0
61000281	61	              MOVE 'N' TO COMM-SUCCESS	0	0	1
61000283	61	              IF SQLCODE = +100	0	0	1
61000284	61	                 MOVE '1' TO COMM-FAIL-CODE	0	0	1
61000285	61	              ELSE	0	0	1
61000286	61	                 MOVE '2' TO COMM-FAIL-CODE	0	0	1
61000287	61	              END-IF	0	0	1
61000289	61	      *	1	0	0
61000290	61	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
61000291	61	      *       is applicable in a workload if activated	1	0	1
61000292	61	      *	1	0	1
61000293	61	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
61000295	61	              GO TO UAD999	0	0	1
61000297	61	           END-IF.	0	0	1
61000300	61	      *	1	0	0
61000301	61	      *    Is the amount being requested a debit or a credit?	1	0	1
61000302	61	      *    If it is a CREDIT (+) then we don't need to ensure that	1	0	1
61000303	61	      *    the available balance has sufficient funds, because this	1	0	1
61000304	61	      *    is money coming in.	1	0	1
61000305	61	      *	1	0	1
61000307	61	           IF COMM-AMT < 0	0	0	0
61000308	61	      *	1	0	0
61000309	61	      *       The amount being requested is a DEBIT/Payment (-)	1	0	1
61000310	61	      *       so we do need to check that the available	1	0	1
61000311	61	      *       balance is sufficient to cover the amount being	1	0	1
61000312	61	      *       asked for. If there are NOT sufficient funds the	1	0	1
61000313	61	      *       request is denied so remove the record LOCK and	1	0	1
61000314	61	      *       and finish.	1	0	1
61000315	61	      *	1	0	1
61000316	61	      D       DISPLAY 'COMM-AMT IS negative'	0	0	0
61000319	61	      *	1	0	0
61000320	61	      *       Check to see whether the Payment is being	1	0	1
61000321	61	      *       requested from a MORTGAGE or LOAN account. We only make	1	0	1
61000322	61	      *       this check for PAYMENTs (we don't make this check for	1	0	1
61000323	61	      *       requests via the Teller). How do we know it is a PAYMENT	1	0	1
61000324	61	      *       as opposed to a Teller, this is determined by the	1	0	1
61000325	61	      *       COMM-FACILTYPE(496 = NONE)	1	0	1
61000326	61	      *       If it is a PAYMENT being requested from a MORTGAGE or	1	0	1
61000327	61	      *       LOAN account then set an appropriate fail code (4)	1	0	1
61000328	61	      *       and finish up.	1	0	1
61000329	61	      *	1	0	1
61000330	61	              IF (HV-ACCOUNT-ACC-TYPE = 'MORTGAGE'	0	0	0
61000331	61	              AND COMM-FACILTYPE = 496)	0	0	1
61000332	61	              OR (HV-ACCOUNT-ACC-TYPE = 'LOAN    '	0	0	1
61000333	61	              AND COMM-FACILTYPE = 496)	0	0	1
61000334	61	                 MOVE 'N' TO COMM-SUCCESS	0	0	1
61000335	61	                 MOVE '4' TO COMM-FAIL-CODE	0	0	1
61000337	61	                 GO TO UAD999	0	0	1
61000338	61	              END-IF	0	0	1
61000340	61	              MOVE 0 TO WS-DIFFERENCE	0	0	1
61000341	61	              COMPUTE WS-DIFFERENCE = HV-ACCOUNT-AVAIL-BAL	0	0	1
61000342	61	                 + COMM-AMT	0	0	1
61000344	61	              IF WS-DIFFERENCE < 0 AND COMM-FACILTYPE = 496	0	0	1
61000345	61	      D          DISPLAY 'insufficient funds!'	0	0	1
61000346	61	                 MOVE 'N' TO COMM-SUCCESS	0	0	1
61000347	61	                 MOVE '3' TO COMM-FAIL-CODE	0	0	1
61000349	61	                 GO TO UAD999	0	0	1
61000350	61	              END-IF	0	0	1
61000352	61	           END-IF.	0	0	1
61000355	61	      *	1	0	0
61000356	61	      *    Check to see whether a Credit is being	1	0	1
61000357	61	      *    requested from a MORTGAGE or LOAN account. We only make	1	0	1
61000358	61	      *    this check for requests via the PAYMENT link	1	0	1
61000359	61	      *    (we don't make this check for	1	0	1
61000360	61	      *    requests via the Teller). How do we know it is a PAYMENT	1	0	1
61000361	61	      *    as opposed to a Teller, this is determined by the	1	0	1
61000362	61	      *    COMM-FACILTYPE(496 = NONE)	1	0	1
61000363	61	      *    If it is a PAYMENT credit being requested	1	0	1
61000364	61	      *    from a MORTGAGE or LOAN	1	0	1
61000365	61	      *    account then set an appropriate fail code (4), remove	1	0	1
61000366	61	      *    the record lock and finish up.	1	0	1
61000367	61	      *	1	0	1
61000368	61	           IF (HV-ACCOUNT-ACC-TYPE = 'MORTGAGE' AND	0	0	0
61000369	61	           COMM-FACILTYPE = 496)	0	0	1
61000370	61	           OR (HV-ACCOUNT-ACC-TYPE = 'LOAN    '	0	0	1
61000371	61	           AND COMM-FACILTYPE = 496)	0	0	1
61000372	61	              MOVE 'N' TO COMM-SUCCESS	0	0	1
61000373	61	              MOVE '4' TO COMM-FAIL-CODE	0	0	1
61000375	61	              GO TO UAD999	0	0	1
61000376	61	           END-IF.	0	0	1
61000379	61	      *	1	0	0
61000380	61	      *    If the SQLCODE from the SELECT is OK then update	1	0	1
61000381	61	      *    the record and update the details on the	1	0	1
61000382	61	      *    PROCTRAN (Processed transaction) datastore.	1	0	1
61000383	61	      *	1	0	1
61000384	61	           COMPUTE HV-ACCOUNT-AVAIL-BAL =	0	0	0
61000385	61	              HV-ACCOUNT-AVAIL-BAL + COMM-AMT.	0	0	1
61000386	61	           COMPUTE HV-ACCOUNT-ACTUAL-BAL =	0	0	1
61000387	61	              HV-ACCOUNT-ACTUAL-BAL + COMM-AMT.	0	0	1
61000389	61	      *	1	0	0
61000390	61	      *    Update the account record	1	0	1
61000391	61	      *	1	0	1
61000392	61	           EXEC SQL	0	0	0
61000393	61	              UPDATE ACCOUNT	0	0	1
61000394	61	              SET ACCOUNT_EYECATCHER = :HV-ACCOUNT-EYECATCHER,	0	0	1
61000395	61	                  ACCOUNT_CUSTOMER_NUMBER = :HV-ACCOUNT-CUST-NO,	0	0	1
61000396	61	                  ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE,	0	0	1
61000397	61	                  ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO,	0	0	1
61000398	61	                  ACCOUNT_TYPE = :HV-ACCOUNT-ACC-TYPE,	0	0	1
61000399	61	                  ACCOUNT_INTEREST_RATE = :HV-ACCOUNT-INT-RATE,	0	0	1
61000400	61	                  ACCOUNT_OPENED = :HV-ACCOUNT-OPENED,	0	0	1
61000401	61	                  ACCOUNT_OVERDRAFT_LIMIT = :HV-ACCOUNT-OVERDRAFT-LIM,	0	0	1
61000402	61	                  ACCOUNT_LAST_STATEMENT = :HV-ACCOUNT-LAST-STMT,	0	0	1
61000403	61	                  ACCOUNT_NEXT_STATEMENT = :HV-ACCOUNT-NEXT-STMT,	0	0	1
61000404	61	                  ACCOUNT_AVAILABLE_BALANCE = :HV-ACCOUNT-AVAIL-BAL,	0	0	1
61000405	61	                  ACCOUNT_ACTUAL_BALANCE = :HV-ACCOUNT-ACTUAL-BAL	0	0	1
61000406	61	              WHERE (ACCOUNT_SORTCODE = :HV-ACCOUNT-SORTCODE AND	0	0	1
61000407	61	                     ACCOUNT_NUMBER = :HV-ACCOUNT-ACC-NO)	0	0	1
61000408	61	           END-EXEC.	0	0	1
61000410	61	      *	1	0	0
61000411	61	      *    If the rewrite was successful then we need to pass back	1	0	1
61000412	61	      *    the amended available balance and actual balance.	1	0	1
61000413	61	      *	1	0	1
61000414	61	           MOVE SQLCODE TO SQLCODE-DISPLAY.	0	0	0
61000416	61	           MOVE HV-ACCOUNT-AVAIL-BAL TO	0	0	1
61000417	61	              COMM-AV-BAL.	0	0	1
61000418	61	           MOVE HV-ACCOUNT-ACTUAL-BAL TO	0	0	1
61000419	61	              COMM-ACT-BAL.	0	0	1
61000421	61	      *	1	0	0
61000422	61	      *    If the RESP CODE was NOT OK then we need to set flags	1	0	1
61000423	61	      *    accordingly	1	0	1
61000424	61	      *	1	0	1
61000425	61	           IF SQLCODE NOT = 0	0	0	0
61000426	61	              MOVE 'N' TO COMM-SUCCESS	0	0	1
61000427	61	              MOVE '2' TO COMM-FAIL-CODE	0	0	1
61000428	61	      *	1	0	0
61000429	61	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
61000430	61	      *       is applicable in a workload if activated	1	0	1
61000431	61	      *	1	0	1
61000432	61	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
61000433	61	              GO TO UAD999	0	0	1
61000435	61	           END-IF.	0	0	1
61000437	61	      *	1	0	0
61000438	61	      *    If the RESP CODE was normal then we need to write to the	1	0	1
61000439	61	      *    PROCTRAN (processed transaction) datastore.	1	0	1
61000440	61	      *	1	0	1
61000441	61	           PERFORM WRITE-TO-PROCTRAN.	0	0	0
61000443	61	       UAD999.	0	0	1
61000444	61	           EXIT.	0	0	1
61000447	61	       WRITE-TO-PROCTRAN SECTION.	0	0	1
61000448	61	       WTP010.	0	0	1
61000450	61	      *	1	0	0
61000451	61	      *          Write to the PROCTRAN datastore deatils regarding the	1	0	1
61000452	61	      *          successfully applied transaction.	1	0	1
61000453	61	      *	1	0	1
61000454	61	            PERFORM WRITE-TO-PROCTRAN-DB2.	0	0	0
61000456	61	       WTP999.	0	0	1
61000457	61	           EXIT.	0	0	1
61000460	61	       WRITE-TO-PROCTRAN-DB2 SECTION.	0	0	1
61000461	61	       WTPD010.	0	0	1
61000463	61	           INITIALIZE HOST-PROCTRAN-ROW.	0	0	1
61000464	61	           INITIALIZE WS-EIBTASKN12.	0	0	1
61000466	61	           MOVE 'PRTR' TO HV-PROCTRAN-EYECATCHER.	0	0	1
61000467	61	           MOVE COMM-SORTC TO HV-PROCTRAN-SORT-CODE.	0	0	1
61000468	61	           MOVE COMM-ACCNO TO HV-PROCTRAN-ACC-NUMBER.	0	0	1
61000469	61	           MOVE EIBTASKN TO WS-EIBTASKN12.	0	0	1
61000470	61	           MOVE WS-EIBTASKN12 TO HV-PROCTRAN-REF.	0	0	1
61000472	61	      *	1	0	0
61000473	61	      *    Populate the current time and date	1	0	1
61000474	61	      *	1	0	1
61000475	61	           EXEC CICS ASKTIME	0	0	0
61000476	61	              ABSTIME(WS-U-TIME)	0	0	1
61000477	61	           END-EXEC.	0	0	1
61000479	61	           EXEC CICS FORMATTIME	0	0	1
61000480	61	                     ABSTIME(WS-U-TIME)	0	0	1
61000481	61	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
61000482	61	                     TIME(HV-PROCTRAN-TIME)	0	0	1
61000483	61	                     DATESEP('.')	0	0	1
61000484	61	           END-EXEC.	0	0	1
61000486	61	           MOVE WS-ORIG-DATE TO WS-ORIG-DATE-GRP-X.	0	0	1
61000487	61	           MOVE WS-ORIG-DATE-GRP-X TO HV-PROCTRAN-DATE.	0	0	1
61000489	61	           MOVE SPACES TO HV-PROCTRAN-DESC.	0	0	1
61000491	61	           IF COMM-AMT < 0	0	0	1
61000492	61	              MOVE 'DEB' TO HV-PROCTRAN-TYPE	0	0	1
61000493	61	              MOVE 'COUNTER WTHDRW' TO HV-PROCTRAN-DESC	0	0	1
61000495	61	      *	1	0	0
61000496	61	      *       If it is a debit from a PAYMENT	1	0	1
61000497	61	      *	1	0	1
61000498	61	              IF COMM-FACILTYPE = 496	0	0	0
61000499	61	                 MOVE 'PDR' TO HV-PROCTRAN-TYPE	0	0	1
61000500	61	                 MOVE COMM-ORIGIN(1:14) TO	0	0	1
61000501	61	                    HV-PROCTRAN-DESC	0	0	1
61000502	61	              END-IF	0	0	1
61000504	61	           ELSE	0	0	1
61000505	61	              MOVE 'CRE' TO HV-PROCTRAN-TYPE	0	0	1
61000506	61	              MOVE 'COUNTER RECVED' TO HV-PROCTRAN-DESC	0	0	1
61000508	61	      *	1	0	0
61000509	61	      *       If it is a credit from a PAYMENT	1	0	1
61000510	61	      *	1	0	1
61000511	61	              IF COMM-FACILTYPE = 496	0	0	0
61000512	61	                 MOVE 'PCR' TO HV-PROCTRAN-TYPE	0	0	1
61000513	61	                 MOVE COMM-ORIGIN(1:14) TO	0	0	1
61000514	61	                    HV-PROCTRAN-DESC	0	0	1
61000515	61	              END-IF	0	0	1
61000517	61	           END-IF.	0	0	1
61000519	61	           MOVE COMM-AMT TO HV-PROCTRAN-AMOUNT.	0	0	1
61000521	61	      *	1	0	0
61000522	61	      *    Write a record to PROCTRAN	1	0	1
61000523	61	      *	1	0	1
61000524	61	           EXEC SQL	0	0	0
61000525	61	              INSERT INTO PROCTRAN	0	0	1
61000526	61	                     (	0	0	1
61000527	61	                      PROCTRAN_EYECATCHER,	0	0	1
61000528	61	                      PROCTRAN_SORTCODE,	0	0	1
61000529	61	                      PROCTRAN_NUMBER,	0	0	1
61000530	61	                      PROCTRAN_DATE,	0	0	1
61000531	61	                      PROCTRAN_TIME,	0	0	1
61000532	61	                      PROCTRAN_REF,	0	0	1
61000533	61	                      PROCTRAN_TYPE,	0	0	1
61000534	61	                      PROCTRAN_DESC,	0	0	1
61000535	61	                      PROCTRAN_AMOUNT	0	0	1
61000536	61	                     )	0	0	1
61000537	61	              VALUES	0	0	1
61000538	61	                     (	0	0	1
61000539	61	                      :HV-PROCTRAN-EYECATCHER,	0	0	1
61000540	61	                      :HV-PROCTRAN-SORT-CODE,	0	0	1
61000541	61	                      :HV-PROCTRAN-ACC-NUMBER,	0	0	1
61000542	61	                      :HV-PROCTRAN-DATE,	0	0	1
61000543	61	                      :HV-PROCTRAN-TIME,	0	0	1
61000544	61	                      :HV-PROCTRAN-REF,	0	0	1
61000545	61	                      :HV-PROCTRAN-TYPE,	0	0	1
61000546	61	                      :HV-PROCTRAN-DESC,	0	0	1
61000547	61	                      :HV-PROCTRAN-AMOUNT	0	0	1
61000548	61	                     )	0	0	1
61000549	61	           END-EXEC.	0	0	1
61000551	61	      *	1	0	0
61000552	61	      *    Check the SQLCODE	1	0	1
61000553	61	      *	1	0	1
61000554	61	           IF SQLCODE NOT = 0	0	0	0
61000555	61	              MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
61000557	61	              DISPLAY 'UNABLE TO WRITE TO PROCTRAN DB2 DATASTORE'	0	0	1
61000558	61	              ' SQLCODE=' SQLCODE-DISPLAY	0	0	1
61000559	61	              'WITH THE FOLLOWING DATA:' HOST-PROCTRAN-ROW	0	0	1
61000560	61	      *	1	0	0
61000561	61	      *       You need to issue a ROLLBACK to get rid of the updated	1	0	1
61000562	61	      *       ACCOUNT record	1	0	1
61000563	61	      *	1	0	1
61000564	61	              EXEC CICS SYNCPOINT ROLLBACK	0	0	0
61000565	61	                 RESP(WS-CICS-RESP)	0	0	1
61000566	61	                 RESP2(WS-CICS-RESP2)	0	0	1
61000567	61	              END-EXEC	0	0	1
61000569	61	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
61000570	61	      *	1	0	0
61000571	61	      *          Preserve the RESP and RESP2, then set up the	1	0	1
61000572	61	      *          standard ABEND info before getting the applid,	1	0	1
61000573	61	      *          date/time etc. and linking to the Abend Handler	1	0	1
61000574	61	      *          program.	1	0	1
61000575	61	      *	1	0	1
61000576	61	                 INITIALIZE ABNDINFO-REC	0	0	0
61000577	61	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
61000578	61	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
61000579	61	      *	1	0	0
61000580	61	      *          Get supplemental information	1	0	1
61000581	61	      *	1	0	1
61000582	61	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
61000583	61	                 END-EXEC	0	0	1
61000585	61	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
61000586	61	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
61000588	61	                 PERFORM POPULATE-TIME-DATE	0	0	1
61000590	61	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
61000591	61	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
61000592	61	                       ':' DELIMITED BY SIZE,	0	0	1
61000593	61	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
61000594	61	                        ':' DELIMITED BY SIZE,	0	0	1
61000595	61	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
61000596	61	                        INTO ABND-TIME	0	0	1
61000597	61	                 END-STRING	0	0	1
61000599	61	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
61000600	61	                 MOVE 'HROL'      TO ABND-CODE	0	0	1
61000602	61	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
61000603	61	                 END-EXEC	0	0	1
61000605	61	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
61000607	61	                 STRING 'WTPD010 - COULD NOT ROLL BACK, POSSIBLE DATA'	0	0	1
61000608	61	                       DELIMITED BY SIZE,	0	0	1
61000609	61	                       'INTEGRITY ISSUE BETWEEN ACCOUNT AND PROCTRAN '	0	0	1
61000610	61	                       DELIMITED BY SIZE,	0	0	1
61000611	61	                       'FOR ROW:' DELIMITED BY SIZE,	0	0	1
61000612	61	                       HOST-PROCTRAN-ROW DELIMITED BY SIZE,	0	0	1
61000613	61	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
61000614	61	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
61000615	61	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
61000616	61	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
61000617	61	                       INTO ABND-FREEFORM	0	0	1
61000618	61	                 END-STRING	0	0	1
61000620	61	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
61000621	61	                           COMMAREA(ABNDINFO-REC)	0	0	1
61000622	61	                 END-EXEC	0	0	1
61000624	61	                 DISPLAY ' COULD NOT ROLL BACK, POSSIBLE DATA '	0	0	1
61000625	61	                    'INTEGRITY ISSUE BETWEEN ACCOUNT AND PROCTRAN '	0	0	1
61000626	61	                    'FOR ROW:' HOST-PROCTRAN-ROW	0	0	1
61000627	61	                    'RESP CODE=' WS-CICS-RESP ' RESP2 CODE='	0	0	1
61000628	61	                    WS-CICS-RESP2	0	0	1
61000630	61	                 EXEC CICS ABEND	0	0	1
61000631	61	                    ABCODE ('HROL')	0	0	1
61000632	61	                    CANCEL	0	0	1
61000633	61	                 END-EXEC	0	0	1
61000634	61	              END-IF	0	0	1
61000636	61	              MOVE 'N' TO COMM-SUCCESS	0	0	1
61000637	61	              MOVE '02' TO COMM-FAIL-CODE	0	0	1
61000638	61	      *	1	0	0
61000639	61	      *       Check if SQLCODE indicates that Storm Drain processing	1	0	1
61000640	61	      *       is applicable in a workload if activated	1	0	1
61000641	61	      *	1	0	1
61000642	61	              PERFORM CHECK-FOR-STORM-DRAIN-DB2	0	0	0
61000644	61	           ELSE	0	0	1
61000646	61	      *	1	0	0
61000647	61	      *       If the WRITE to PROCTRAN worked then it was a success	1	0	1
61000648	61	      *	1	0	1
61000649	61	              MOVE 'Y' TO COMM-SUCCESS	0	0	0
61000650	61	              MOVE '0' TO COMM-FAIL-CODE	0	0	1
61000652	61	           END-IF.	0	0	1
61000654	61	       WTPD999.	0	0	1
61000655	61	           EXIT.	0	0	1
61000658	61	       GET-ME-OUT-OF-HERE SECTION.	0	0	1
61000659	61	       GMOOH010.	0	0	1
61000660	61	           EXEC CICS RETURN	0	0	1
61000661	61	           END-EXEC.	0	0	1
61000662	61	           GOBACK.	0	0	1
61000664	61	       GMOOH999.	0	0	1
61000665	61	           EXIT.	0	0	1
61000668	61	       CHECK-FOR-STORM-DRAIN-DB2 SECTION.	0	0	1
61000669	61	       CFSDD010.	0	0	1
61000670	61	      *	1	0	0
61000671	61	      *    Check if the Sqclode that is returned one that will	1	0	1
61000672	61	      *    trigger Storm Drain is active in Workload	1	0	1
61000673	61	      *	1	0	1
61000675	61	           EVALUATE SQLCODE	0	0	0
61000677	61	              WHEN 923	0	0	1
61000678	61	                 MOVE 'DB2 Connection lost ' TO STORM-DRAIN-CONDITION	0	0	1
61000680	61	              WHEN OTHER	0	0	1
61000681	61	                 MOVE 'Not Storm Drain     ' TO STORM-DRAIN-CONDITION	0	0	1
61000683	61	           END-EVALUATE.	0	0	1
61000685	61	           IF STORM-DRAIN-CONDITION NOT EQUAL 'Not Storm Drain     '	0	0	1
61000686	61	              DISPLAY 'DBCRFUN: Check-For-Storm-Drain-DB2: Storm '	0	0	1
61000687	61	                      'Drain condition (' STORM-DRAIN-CONDITION ') '	0	0	1
61000688	61	                      'has been met (' SQLCODE-DISPLAY ').'	0	0	1
61000689	61	           ELSE	0	0	1
61000691	61	              CONTINUE	0	0	1
61000692	61	           END-IF.	0	0	1
61000694	61	       CFSDD999.	0	0	1
61000695	61	           EXIT.	0	0	1
61000698	61	      *	1	0	0
61000699	61	      * How ABENDs are dealt with	1	0	1
61000700	61	      *	1	0	1
61000701	61	       ABEND-HANDLING SECTION.	0	0	0
61000702	61	       AH010.	0	0	1
61000704	61	           EXEC CICS ASSIGN ABCODE(MY-ABEND-CODE)	0	0	1
61000705	61	           END-EXEC.	0	0	1
61000707	61	      *	1	0	0
61000708	61	      *    Evaluate the Abend code that is returned	1	0	1
61000709	61	      *      - For DB2 AD2Z ... provide some diagnostics	1	0	1
61000710	61	      *      - For VSAM RLS abends: AFCR, AFCS and AFCT record the	1	0	1
61000711	61	      *        Abend as happening but do not abend ... leave this to	1	0	1
61000712	61	      *        CPSM WLM "Storm drain" (Abend probability) to handle	1	0	1
61000713	61	      *    If not a "storm drain" ... take the abend afterwards	1	0	1
61000714	61	      *	1	0	1
61000716	61	           EVALUATE MY-ABEND-CODE	0	0	0
61000717	61	      *	1	0	0
61000718	61	      *       DB2 AD2Z abend	1	0	1
61000719	61	      *	1	0	1
61000720	61	              WHEN 'AD2Z'	0	0	0
61000722	61	                 MOVE SQLCODE TO SQLCODE-DISPLAY	0	0	1
61000723	61	                 DISPLAY 'DB2 DEADLOCK DETECTED IN DBCRFUN, SQLCODE='	0	0	1
61000724	61	                    SQLCODE-DISPLAY	0	0	1
61000726	61	                 DISPLAY 'DB2 DEADLOCK FOR ACCOUNT '	0	0	1
61000727	61	                   HV-ACCOUNT-ACC-NO	0	0	1
61000728	61	                 DISPLAY  'SQLSTATE=' SQLSTATE	0	0	1
61000729	61	                        ',SQLERRMC=' SQLERRMC(1:SQLERRML)	0	0	1
61000730	61	                        ',SQLERRD(1)=' SQLERRD(1)	0	0	1
61000731	61	                        ',SQLERRD(2)=' SQLERRD(2)	0	0	1
61000732	61	                        ',SQLERRD(3)=' SQLERRD(3)	0	0	1
61000733	61	                        ',SQLERRD(4)=' SQLERRD(4)	0	0	1
61000734	61	                        ',SQLERRD(5)=' SQLERRD(5)	0	0	1
61000735	61	                        ',SQLERRD(6)=' SQLERRD(6)	0	0	1
61000737	61	      *	1	0	0
61000738	61	      *          VSAM RLS abends, subject to CPSM WLM Storm Drain check	1	0	1
61000739	61	      *          if handled (as here) and Workload Abend Thresholds are	1	0	1
61000740	61	      *          set.	1	0	1
61000741	61	      *	1	0	1
61000742	61	              WHEN 'AFCR'	0	0	0
61000743	61	              WHEN 'AFCS'	0	0	1
61000744	61	              WHEN 'AFCT'	0	0	1
61000745	61	                 MOVE 'Y' TO WS-STORM-DRAIN	0	0	1
61000746	61	                 DISPLAY 'DBCRFUN: Check-For-Storm-Drain-VSAM: Storm '	0	0	1
61000747	61	                        'Drain condition (Abend ' MY-ABEND-CODE ') '	0	0	1
61000748	61	                        'has been met.'	0	0	1
61000750	61	                 EXEC CICS SYNCPOINT	0	0	1
61000751	61	                    ROLLBACK	0	0	1
61000752	61	                    RESP(WS-CICS-RESP)	0	0	1
61000753	61	                    RESP2(WS-CICS-RESP2)	0	0	1
61000754	61	                 END-EXEC	0	0	1
61000756	61	                 IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
61000757	61	      *	1	0	0
61000758	61	      *             Preserve the RESP and RESP2, then set up the	1	0	1
61000759	61	      *             standard ABEND info before getting the applid,	1	0	1
61000760	61	      *             date/time etc. and linking to the Abend Handler	1	0	1
61000761	61	      *             program.	1	0	1
61000762	61	      *	1	0	1
61000763	61	                    INITIALIZE ABNDINFO-REC	0	0	0
61000764	61	                    MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
61000765	61	                    MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
61000766	61	      *	1	0	0
61000767	61	      *             Get supplemental information	1	0	1
61000768	61	      *	1	0	1
61000769	61	                    EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
61000770	61	                    END-EXEC	0	0	1
61000772	61	                    MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
61000773	61	                    MOVE EIBTRNID   TO ABND-TRANID	0	0	1
61000775	61	                    PERFORM POPULATE-TIME-DATE	0	0	1
61000777	61	                    MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
61000778	61	                    STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
61000779	61	                       ':' DELIMITED BY SIZE,	0	0	1
61000780	61	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
61000781	61	                        ':' DELIMITED BY SIZE,	0	0	1
61000782	61	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
61000783	61	                        INTO ABND-TIME	0	0	1
61000784	61	                    END-STRING	0	0	1
61000786	61	                    MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
61000787	61	                    MOVE 'HROL'      TO ABND-CODE	0	0	1
61000789	61	                    EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
61000790	61	                    END-EXEC	0	0	1
61000792	61	                    MOVE ZEROS      TO ABND-SQLCODE	0	0	1
61000794	61	                    STRING 'AH010 - Unable to perform Synpoint '	0	0	1
61000795	61	                       DELIMITED BY SIZE,	0	0	1
61000796	61	                       'Rollback.' DELIMITED BY SIZE,	0	0	1
61000797	61	                       ' Possible Integrity issue following VSAM RLS '	0	0	1
61000798	61	                       DELIMITED BY SIZE,	0	0	1
61000799	61	                       'abend.' DELIMITED BY SIZE,	0	0	1
61000800	61	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
61000801	61	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
61000802	61	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
61000803	61	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
61000804	61	                       INTO ABND-FREEFORM	0	0	1
61000805	61	                    END-STRING	0	0	1
61000807	61	                    EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
61000808	61	                           COMMAREA(ABNDINFO-REC)	0	0	1
61000809	61	                    END-EXEC	0	0	1
61000811	61	                    DISPLAY 'DBCRFUN: Unable to perform Synpoint '	0	0	1
61000812	61	                       'Rollback.'	0	0	1
61000813	61	                       ' Possible Integrity issue following VSAM RLS'	0	0	1
61000814	61	                       ' abend'	0	0	1
61000815	61	                       ' RESP CODE=' WS-CICS-RESP	0	0	1
61000816	61	                       ' RESP2 CODE=' WS-CICS-RESP2	0	0	1
61000818	61	                    EXEC CICS ABEND	0	0	1
61000819	61	                       ABCODE ('HROL')	0	0	1
61000820	61	                       CANCEL	0	0	1
61000821	61	                    END-EXEC	0	0	1
61000823	61	                 END-IF	0	0	1
61000825	61	                 MOVE 'N' TO COMM-SUCCESS	0	0	1
61000826	61	                 MOVE '2' TO COMM-FAIL-CODE	0	0	1
61000828	61	                 EXEC CICS RETURN	0	0	1
61000829	61	                 END-EXEC	0	0	1
61000831	61	           END-EVALUATE.	0	0	1
61000833	61	           IF WS-STORM-DRAIN = 'N'	0	0	1
61000834	61	              EXEC CICS ABEND	0	0	1
61000835	61	                 ABCODE( MY-ABEND-CODE)	0	0	1
61000836	61	                 NODUMP	0	0	1
61000837	61	                 CANCEL	0	0	1
61000838	61	              END-EXEC	0	0	1
61000840	61	           END-IF.	0	0	1
61000842	61	       AH999.	0	0	1
61000843	61	           EXIT.	0	0	1
61000846	61	       POPULATE-TIME-DATE SECTION.	0	0	1
61000847	61	       PTD10.	0	0	1
61000849	61	           EXEC CICS ASKTIME	0	0	1
61000850	61	              ABSTIME(WS-U-TIME)	0	0	1
61000851	61	           END-EXEC.	0	0	1
61000853	61	           EXEC CICS FORMATTIME	0	0	1
61000854	61	                     ABSTIME(WS-U-TIME)	0	0	1
61000855	61	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
61000856	61	                     TIME(WS-TIME-NOW)	0	0	1
61000857	61	                     DATESEP	0	0	1
61000858	61	           END-EXEC.	0	0	1
61000860	61	       PTD999.	0	0	1
61000861	61	           EXIT.	0	0	1
62000000	62	<<<< file not found >>>>	0	0	0
62000001	62	<<<< file not found >>>>	0	0	0
63000001	63	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	1
63000002	63	       CBL CICS('SP,EDF')	0	0	1
63000003	63	      ******************************************************************	1	0	0
63000004	63	      *                                                                *	1	0	1
63000005	63	      *  Copyright IBM Corp. 2023                                      *	1	0	1
63000006	63	      *                                                                *	1	0	1
63000007	63	      ******************************************************************	1	0	1
63000010	63	      ******************************************************************	1	0	1
63000011	63	      * This is the Display Customer program in the BANKING application	1	0	1
63000012	63	      * BMS suite. It will not only display customer details, it will	1	0	1
63000013	63	      * also delete the customer record if pf5 is pressed or	1	0	1
63000014	63	      * will allow the customer record to be updated if	1	0	1
63000015	63	      * pf10 is pressed.	1	0	1
63000016	63	      *	1	0	1
63000017	63	      ******************************************************************	1	0	1
63000018	63	       IDENTIFICATION DIVISION.	0	0	0
63000019	63	       PROGRAM-ID. BNK1DCS.	0	0	1
63000020	63	       AUTHOR. Jon Collett.	0	0	1
63000022	63	       ENVIRONMENT DIVISION.	0	0	1
63000023	63	       CONFIGURATION SECTION.	0	0	1
63000024	63	      * SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
63000025	63	       SOURCE-COMPUTER.  IBM-370.	0	0	0
63000026	63	       OBJECT-COMPUTER.  IBM-370.	0	0	1
63000028	63	       INPUT-OUTPUT SECTION.	0	0	1
63000029	63	       DATA DIVISION.	0	0	1
63000031	63	       WORKING-STORAGE SECTION.	0	0	1
63000032	63	       01 WS-CICS-WORK-AREA.	0	0	1
63000033	63	          03 WS-CICS-RESP             PIC S9(8) COMP VALUE 0.	0	0	1
63000034	63	          03 WS-CICS-RESP2            PIC S9(8) COMP VALUE 0.	0	0	1
63000036	63	       01 WS-FAIL-INFO.	0	0	1
63000037	63	          03 FILLER                   PIC X(9)  VALUE 'BNK1DCS  '.	0	0	1
63000038	63	          03 WS-CICS-FAIL-MSG         PIC X(70) VALUE ' '.	0	0	1
63000039	63	          03 FILLER                   PIC X(6)  VALUE ' RESP='.	0	0	1
63000040	63	          03 WS-CICS-RESP-DISP        PIC 9(10) VALUE 0.	0	0	1
63000041	63	          03 FILLER                   PIC X(7)  VALUE ' RESP2='.	0	0	1
63000042	63	          03 WS-CICS-RESP2-DISP       PIC 9(10) VALUE 0.	0	0	1
63000043	63	          03 FILLER                   PIC X(15) VALUE ' ABENDING TASK.'.	0	0	1
63000044	63	       01 SWITCHES.	0	0	1
63000045	63	           03 VALID-DATA-SW           PIC X VALUE 'Y'.	0	0	1
63000046	63	              88 VALID-DATA           VALUE 'Y'.	0	0	1
63000048	63	       01 FLAGS.	0	0	1
63000049	63	           03 SEND-FLAG               PIC X.	0	0	1
63000050	63	              88 SEND-ERASE           VALUE '1'.	0	0	1
63000051	63	              88 SEND-DATAONLY        VALUE '2'.	0	0	1
63000052	63	              88 SEND-DATAONLY-ALARM  VALUE '3'.	0	0	1
63000054	63	       01 ACTION-ALPHA.	0	0	1
63000055	63	           03 ACTION-NUM              PIC 9.	0	0	1
63000057	63	      *	1	0	0
63000058	63	      * The end of session message	1	0	1
63000059	63	      *	1	0	1
63000060	63	       01 END-OF-SESSION-MESSAGE      PIC X(13) VALUE 'Session Ended'.	0	0	0
63000062	63	       01 RESPONSE-CODE               PIC S9(8) COMP.	0	0	1
63000064	63	       01 COMMUNICATION-AREA          PIC X.	0	0	1
63000066	63	       COPY BNK1DCM.	0	0	1
63000068	63	       COPY DFHAID.	0	0	1
63000070	63	       01 WS-UCTRANS                  PIC S9(8) COMP VALUE 0.	0	0	1
63000071	63	       01 STORED-UCTRANS              PIC S9(8) COMP VALUE 0.	0	0	1
63000073	63	       01 COMM-DOB-SPLIT.	0	0	1
63000074	63	          03 COMM-DOB-SPLIT-DD         PIC 99.	0	0	1
63000075	63	          03 COMM-DOB-SPLIT-MM         PIC 99.	0	0	1
63000076	63	          03 COMM-DOB-SPLIT-YYYY       PIC 9999.	0	0	1
63000078	63	       01 COMM-ADDR-SPLIT.	0	0	1
63000079	63	          03 COMM-ADDR-SPLIT1         PIC X(60).	0	0	1
63000080	63	          03 COMM-ADDR-SPLIT2         PIC X(60).	0	0	1
63000081	63	          03 COMM-ADDR-SPLIT3         PIC X(40).	0	0	1
63000083	63	       01 COMM-DOB-UPD-FORMAT.	0	0	1
63000084	63	          03 COMM-DOB-UPD-X.	0	0	1
63000085	63	             05 COMM-DOBX-DD     PIC XX.	0	0	1
63000086	63	             05 COMM-DOBX-MM     PIC XX.	0	0	1
63000087	63	             05 COMM-DOBX-YYYY   PIC XXXX.	0	0	1
63000088	63	          03 COMM-DOB-UPD-9 REDEFINES COMM-DOB-UPD-X.	0	0	1
63000089	63	             05 COMM-DOB9-DD     PIC 99.	0	0	1
63000090	63	             05 COMM-DOB9-MM     PIC 99.	0	0	1
63000091	63	             05 COMM-DOB9-YYYY   PIC 9999.	0	0	1
63000093	63	       01 COMM-CS-REVIEW-UPD-FORMAT.	0	0	1
63000094	63	          03 COMM-CS-REVIEW-UPD-X.	0	0	1
63000095	63	             05 COMM-CS-REVIEWX-DD     PIC XX.	0	0	1
63000096	63	             05 COMM-CS-REVIEWX-MM     PIC XX.	0	0	1
63000097	63	             05 COMM-CS-REVIEWX-YYYY   PIC XXXX.	0	0	1
63000098	63	          03 COMM-CS-REVIEW-UPD-9 REDEFINES COMM-CS-REVIEW-UPD-X.	0	0	1
63000099	63	             05 COMM-CS-REVIEW9-DD     PIC 99.	0	0	1
63000100	63	             05 COMM-CS-REVIEW9-MM     PIC 99.	0	0	1
63000101	63	             05 COMM-CS-REVIEW9-YYYY   PIC 9999.	0	0	1
63000103	63	       01 CREDIT-SCORE-UPD-FORMAT.	0	0	1
63000104	63	          03 CREDIT-SCORE-UPD-X.	0	0	1
63000105	63	             05 CREDIT-SCORE-X   PIC X(3).	0	0	1
63000106	63	          03 CREDIT-SCORE-UPD-9 REDEFINES CREDIT-SCORE-UPD-X.	0	0	1
63000107	63	             05 CREDIT-SCORE-9   PIC 9(3).	0	0	1
63000109	63	       01 COMM-ADDR-UPD-SPLIT.	0	0	1
63000110	63	          03 COMM-ADDR-UPD1           PIC X(60).	0	0	1
63000111	63	          03 COMM-ADDR-UPD2           PIC X(60).	0	0	1
63000112	63	          03 COMM-ADDR-UPD3           PIC X(40).	0	0	1
63000114	63	       01 INQCUST-COMMAREA.	0	0	1
63000115	63	           COPY INQCUST.	0	0	1
63000117	63	       01 DELCUS-COMMAREA.	0	0	1
63000118	63	           COPY DELCUS.	0	0	1
63000120	63	       01 UPDCUST-COMMAREA.	0	0	1
63000121	63	           COPY UPDCUST.	0	0	1
63000123	63	       01 WS-COMM-AREA.	0	0	1
63000124	63	          03 WS-COMM-TERM              PIC S9(8) COMP.	0	0	1
63000125	63	          03 WS-COMM-EYE               PIC X(4).	0	0	1
63000126	63	          03 WS-COMM-SCODE             PIC X(6).	0	0	1
63000127	63	          03 WS-COMM-CUSTNO            PIC X(10).	0	0	1
63000128	63	          03 WS-COMM-NAME              PIC X(60).	0	0	1
63000129	63	          03 WS-COMM-ADDR              PIC X(160).	0	0	1
63000130	63	          03 WS-COMM-DOB               PIC 9(8).	0	0	1
63000131	63	          03 WS-COMM-CREDIT-SCORE      PIC 9(3).	0	0	1
63000132	63	          03 WS-COMM-CS-REVIEW-DATE    PIC 9(8).	0	0	1
63000133	63	          03 WS-COMM-DEL-SUCCESS       PIC X.	0	0	1
63000134	63	          03 WS-COMM-DEL-FAIL-CD       PIC X.	0	0	1
63000135	63	          03 WS-COMM-UPDATE            PIC X.	0	0	1
63000137	63	       01 WS-VALIDATE-NAME             PIC X(60) VALUE ' '.	0	0	1
63000138	63	       01 WS-UNSTR-TITLE               PIC X(9)  VALUE ' '.	0	0	1
63000139	63	       01 WS-TITLE-VALID               PIC X     VALUE ' '.	0	0	1
63000141	63	       COPY DFHBMSCA.	0	0	1
63000143	63	       01 WS-U-TIME                      PIC S9(15) COMP-3.	0	0	1
63000144	63	       01 WS-ORIG-DATE                   PIC X(10).	0	0	1
63000145	63	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
63000146	63	          03 WS-ORIG-DATE-DD             PIC 99.	0	0	1
63000147	63	          03 FILLER                      PIC X.	0	0	1
63000148	63	          03 WS-ORIG-DATE-MM             PIC 99.	0	0	1
63000149	63	          03 FILLER                      PIC X.	0	0	1
63000150	63	          03 WS-ORIG-DATE-YYYY           PIC 9999.	0	0	1
63000152	63	       01 WS-ORIG-DATE-GRP-X.	0	0	1
63000153	63	          03 WS-ORIG-DATE-DD-X           PIC XX.	0	0	1
63000154	63	          03 FILLER                      PIC X VALUE '.'.	0	0	1
63000155	63	          03 WS-ORIG-DATE-MM-X           PIC XX.	0	0	1
63000156	63	          03 FILLER                      PIC X VALUE '.'.	0	0	1
63000157	63	          03 WS-ORIG-DATE-YYYY-X         PIC X(4).	0	0	1
63000159	63	       01 WS-TIME-DATA.	0	0	1
63000160	63	           03 WS-TIME-NOW                  PIC 9(6).	0	0	1
63000161	63	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
63000162	63	              05 WS-TIME-NOW-GRP-HH     PIC 99.	0	0	1
63000163	63	              05 WS-TIME-NOW-GRP-MM     PIC 99.	0	0	1
63000164	63	              05 WS-TIME-NOW-GRP-SS     PIC 99.	0	0	1
63000166	63	       01 WS-ABEND-PGM                  PIC X(8) VALUE 'ABNDPROC'.	0	0	1
63000168	63	       01 ABNDINFO-REC.	0	0	1
63000169	63	           COPY ABNDINFO.	0	0	1
63000172	63	       LINKAGE SECTION.	0	0	1
63000173	63	       01 DFHCOMMAREA.	0	0	1
63000174	63	          03 COMM-TERM                 PIC S9(8) COMP.	0	0	1
63000175	63	          03 COMM-EYE                  PIC X(4).	0	0	1
63000176	63	          03 COMM-SCODE                PIC X(6).	0	0	1
63000177	63	          03 COMM-CUSTNO               PIC X(10).	0	0	1
63000178	63	          03 COMM-NAME                 PIC X(60).	0	0	1
63000179	63	          03 COMM-ADDR                 PIC X(160).	0	0	1
63000180	63	          03 COMM-DOB                  PIC 9(8).	0	0	1
63000181	63	          03 COMM-CREDIT-SCORE         PIC 9(3).	0	0	1
63000182	63	          03 COMM-CS-REVIEW-DATE       PIC 9(8).	0	0	1
63000183	63	          03 COMM-DEL-SUCCESS          PIC X.	0	0	1
63000184	63	          03 COMM-DEL-FAIL-CD          PIC X.	0	0	1
63000185	63	          03 COMM-UPD                  PIC X.	0	0	1
63000188	63	       PROCEDURE DIVISION USING DFHCOMMAREA.	0	0	1
63000189	63	       PREMIERE SECTION.	0	0	1
63000190	63	       A010.	0	0	1
63000192	63	      *	1	0	0
63000193	63	      *    Set up the Abend handling	1	0	1
63000194	63	      *	1	0	1
63000195	63	           EXEC CICS HANDLE ABEND	0	0	0
63000196	63	                LABEL(ABEND-HANDLING)	0	0	1
63000197	63	           END-EXEC.	0	0	1
63000199	63	           EVALUATE TRUE	0	0	1
63000201	63	      *	1	0	0
63000202	63	      *       Is it the first time through? If so, send the map	1	0	1
63000203	63	      *       with erased (empty) data fields.	1	0	1
63000204	63	      *	1	0	1
63000205	63	              WHEN EIBCALEN = ZERO	0	0	0
63000206	63	                 MOVE LOW-VALUE TO BNK1DCO	0	0	1
63000207	63	                 MOVE -1 TO CUSTNOL	0	0	1
63000208	63	                 SET SEND-ERASE TO TRUE	0	0	1
63000209	63	                 INITIALIZE WS-COMM-AREA	0	0	1
63000211	63	                 PERFORM STORE-TERM-DEF	0	0	1
63000213	63	                 MOVE STORED-UCTRANS TO WS-COMM-TERM	0	0	1
63000215	63	                 PERFORM SEND-MAP	0	0	1
63000217	63	      *	1	0	0
63000218	63	      *       If a PA key is pressed, just carry on	1	0	1
63000219	63	      *	1	0	1
63000220	63	              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3	0	0	0
63000221	63	                 CONTINUE	0	0	1
63000223	63	      *	1	0	0
63000224	63	      *       When Pf3 is pressed, return to the main menu	1	0	1
63000225	63	      *	1	0	1
63000226	63	              WHEN EIBAID = DFHPF3	0	0	0
63000228	63	      *	1	0	0
63000229	63	      *          Set the terminal UCTRAN back to its starting position	1	0	1
63000230	63	      *	1	0	1
63000231	63	                 PERFORM RESTORE-TERM-DEF	0	0	0
63000233	63	                 EXEC CICS RETURN	0	0	1
63000234	63	                    TRANSID('OMEN')	0	0	1
63000235	63	                    IMMEDIATE	0	0	1
63000236	63	                    RESP(WS-CICS-RESP)	0	0	1
63000237	63	                    RESP2(WS-CICS-RESP2)	0	0	1
63000238	63	                 END-EXEC	0	0	1
63000240	63	      *	1	0	0
63000241	63	      *       When Pf5 is pressed (delete customer record), process the	1	0	1
63000242	63	      *       incoming data	1	0	1
63000243	63	      *	1	0	1
63000244	63	              WHEN EIBAID = DFHPF5	0	0	0
63000245	63	                 PERFORM PROCESS-MAP	0	0	1
63000247	63	      *	1	0	0
63000248	63	      *       When Pf10 is pressed (update customer record), process the	1	0	1
63000249	63	      *       incoming data	1	0	1
63000250	63	      *	1	0	1
63000251	63	              WHEN EIBAID = DFHPF10	0	0	0
63000252	63	                 PERFORM PROCESS-MAP	0	0	1
63000254	63	      *	1	0	0
63000255	63	      *       If the aid or Pf12 is pressed, then send a termination	1	0	1
63000256	63	      *       message.	1	0	1
63000257	63	      *	1	0	1
63000258	63	              WHEN EIBAID = DFHAID OR DFHPF12	0	0	0
63000259	63	      *	1	0	0
63000260	63	      *          Set the terminal UCTRAN back to its starting position	1	0	1
63000261	63	      *	1	0	1
63000262	63	                 PERFORM RESTORE-TERM-DEF	0	0	0
63000264	63	                 PERFORM SEND-TERMINATION-MSG	0	0	1
63000266	63	                 EXEC CICS	0	0	1
63000267	63	                    RETURN	0	0	1
63000268	63	                 END-EXEC	0	0	1
63000270	63	      *	1	0	0
63000271	63	      *       When CLEAR is pressed	1	0	1
63000272	63	      *	1	0	1
63000273	63	              WHEN EIBAID = DFHCLEAR	0	0	0
63000274	63	      *	1	0	0
63000275	63	      *          Set the terminal UCTRAN back to its starting position	1	0	1
63000276	63	      *	1	0	1
63000277	63	                 PERFORM RESTORE-TERM-DEF	0	0	0
63000279	63	                 EXEC CICS SEND CONTROL	0	0	1
63000280	63	                          ERASE	0	0	1
63000281	63	                          FREEKB	0	0	1
63000282	63	                 END-EXEC	0	0	1
63000284	63	                 EXEC CICS RETURN	0	0	1
63000285	63	                 END-EXEC	0	0	1
63000287	63	      *	1	0	0
63000288	63	      *       When enter is pressed then process the content	1	0	1
63000289	63	      *	1	0	1
63000290	63	              WHEN EIBAID = DFHENTER	0	0	0
63000291	63	                 PERFORM PROCESS-MAP	0	0	1
63000293	63	      *	1	0	0
63000294	63	      *       When anything else happens, send the invalid key message	1	0	1
63000295	63	      *	1	0	1
63000296	63	              WHEN OTHER	0	0	0
63000297	63	                 MOVE SPACES                 TO MESSAGEO	0	0	1
63000298	63	                 MOVE 'Invalid key pressed.' TO MESSAGEO	0	0	1
63000299	63	                 MOVE -1 TO CUSTNOL	0	0	1
63000300	63	                 SET SEND-DATAONLY-ALARM TO TRUE	0	0	1
63000301	63	                 PERFORM SEND-MAP	0	0	1
63000303	63	           END-EVALUATE.	0	0	1
63000305	63	      *	1	0	0
63000306	63	      *     Having processed the input or processed the error, check	1	0	1
63000307	63	      *     to see if it is the first time through and if it is NOT	1	0	1
63000308	63	      *     the first time through, then set the return information	1	0	1
63000309	63	      *     accordingly.	1	0	1
63000310	63	      *	1	0	1
63000311	63	           IF EIBCALEN NOT = ZERO	0	0	0
63000312	63	              MOVE COMM-TERM OF DFHCOMMAREA   TO WS-COMM-TERM	0	0	1
63000313	63	              MOVE COMM-EYE OF DFHCOMMAREA    TO WS-COMM-EYE	0	0	1
63000314	63	              MOVE COMM-SCODE OF DFHCOMMAREA  TO WS-COMM-SCODE	0	0	1
63000315	63	              MOVE COMM-CUSTNO OF DFHCOMMAREA TO WS-COMM-CUSTNO	0	0	1
63000316	63	              MOVE COMM-NAME OF DFHCOMMAREA   TO WS-COMM-NAME	0	0	1
63000317	63	              MOVE COMM-ADDR OF DFHCOMMAREA   TO WS-COMM-ADDR	0	0	1
63000318	63	              MOVE COMM-DOB OF DFHCOMMAREA    TO WS-COMM-DOB	0	0	1
63000319	63	              MOVE COMM-CREDIT-SCORE OF DFHCOMMAREA	0	0	1
63000320	63	                 TO WS-COMM-CREDIT-SCORE	0	0	1
63000321	63	              MOVE COMM-CS-REVIEW-DATE OF DFHCOMMAREA	0	0	1
63000322	63	                 TO WS-COMM-CS-REVIEW-DATE	0	0	1
63000323	63	               MOVE COMM-UPD OF DFHCOMMAREA   TO WS-COMM-UPDATE	0	0	1
63000324	63	           END-IF.	0	0	1
63000326	63	           EXEC CICS	0	0	1
63000327	63	              RETURN TRANSID('ODCS')	0	0	1
63000328	63	              COMMAREA(WS-COMM-AREA)	0	0	1
63000329	63	              LENGTH(266)	0	0	1
63000330	63	              RESP(WS-CICS-RESP)	0	0	1
63000331	63	              RESP2(WS-CICS-RESP2)	0	0	1
63000332	63	           END-EXEC.	0	0	1
63000334	63	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63000335	63	      *	1	0	0
63000336	63	      *       Preserve the RESP and RESP2, then set up the	1	0	1
63000337	63	      *       standard ABEND info before getting the applid,	1	0	1
63000338	63	      *       date/time etc. and linking to the Abend Handler	1	0	1
63000339	63	      *       program.	1	0	1
63000340	63	      *	1	0	1
63000341	63	              INITIALIZE ABNDINFO-REC	0	0	0
63000342	63	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63000343	63	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63000344	63	      *	1	0	0
63000345	63	      *       Get supplemental information	1	0	1
63000346	63	      *	1	0	1
63000347	63	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63000348	63	              END-EXEC	0	0	1
63000350	63	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63000351	63	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63000353	63	              PERFORM POPULATE-TIME-DATE	0	0	1
63000355	63	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63000356	63	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63000357	63	                    ':' DELIMITED BY SIZE,	0	0	1
63000358	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63000359	63	                     ':' DELIMITED BY SIZE,	0	0	1
63000360	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63000361	63	                     INTO ABND-TIME	0	0	1
63000362	63	              END-STRING	0	0	1
63000364	63	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63000365	63	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
63000367	63	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63000368	63	              END-EXEC	0	0	1
63000370	63	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63000372	63	              STRING 'A010 - RETURN TRANSID(ODCS) FAIL'	0	0	1
63000373	63	                    DELIMITED BY SIZE,	0	0	1
63000374	63	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63000375	63	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63000376	63	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
63000377	63	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63000378	63	                    INTO ABND-FREEFORM	0	0	1
63000379	63	              END-STRING	0	0	1
63000381	63	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63000382	63	                        COMMAREA(ABNDINFO-REC)	0	0	1
63000383	63	              END-EXEC	0	0	1
63000386	63	              INITIALIZE WS-FAIL-INFO	0	0	1
63000387	63	              MOVE 'BNK1DCS - A010 - RETURN TRANSID(ODCS) FAIL' TO	0	0	1
63000388	63	                 WS-CICS-FAIL-MSG	0	0	1
63000389	63	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63000390	63	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63000392	63	              PERFORM RESTORE-TERM-DEF	0	0	1
63000393	63	              PERFORM ABEND-THIS-TASK	0	0	1
63000394	63	           END-IF.	0	0	1
63000396	63	       A999.	0	0	1
63000397	63	           EXIT.	0	0	1
63000400	63	       PROCESS-MAP SECTION.	0	0	1
63000401	63	       PM010.	0	0	1
63000402	63	      *	1	0	0
63000403	63	      *    Retrieve the data from the map	1	0	1
63000404	63	      *	1	0	1
63000405	63	           PERFORM RECEIVE-MAP.	0	0	0
63000407	63	      *	1	0	0
63000408	63	      *    Check to see if it just DFHENTER by itself	1	0	1
63000409	63	      *    if it is, then validate the data.	1	0	1
63000410	63	      *	1	0	1
63000411	63	           IF EIBAID = DFHENTER AND COMM-UPD NOT = 'Y'	0	0	0
63000412	63	              MOVE -1 TO CUSTNOL	0	0	1
63000414	63	              PERFORM EDIT-DATA	0	0	1
63000416	63	      *	1	0	0
63000417	63	      *       If the data passes validation go on to	1	0	1
63000418	63	      *       get the customer record	1	0	1
63000419	63	      *	1	0	1
63000420	63	              IF VALID-DATA	0	0	0
63000422	63	                 PERFORM GET-CUST-DATA	0	0	1
63000423	63	              ELSE	0	0	1
63000424	63	                 INITIALIZE INQCUST-COMMAREA	0	0	1
63000425	63	                 SET INQCUST-PCB-POINTER TO NULL	0	0	1
63000426	63	              END-IF	0	0	1
63000427	63	           END-IF.	0	0	1
63000429	63	      *	1	0	0
63000430	63	      *    Check to see if it DFHENTER with the UPDATE flag set.	1	0	1
63000431	63	      *    If it is then, we need to validate and process the	1	0	1
63000432	63	      *    updated data.	1	0	1
63000433	63	      *	1	0	1
63000434	63	           IF EIBAID = DFHENTER AND COMM-UPD = 'Y'	0	0	0
63000435	63	              PERFORM EDIT-DATA2	0	0	1
63000436	63	      *	1	0	0
63000437	63	      *       If the data passes validation go on to	1	0	1
63000438	63	      *       update the customer record	1	0	1
63000439	63	      *	1	0	1
63000440	63	              IF VALID-DATA	0	0	0
63000441	63	                 PERFORM UPDATE-CUST-DATA	0	0	1
63000442	63	              END-IF	0	0	1
63000443	63	           END-IF.	0	0	1
63000445	63	      *	1	0	0
63000446	63	      *    Check to see if it is pF5 (delete customer), validate	1	0	1
63000447	63	      *    & process accordingly (delete the record).	1	0	1
63000448	63	      *	1	0	1
63000449	63	           IF EIBAID = DFHPF5	0	0	0
63000450	63	              PERFORM EDIT-DATA	0	0	1
63000452	63	              PERFORM VALIDATE-DATA	0	0	1
63000453	63	      *	1	0	0
63000454	63	      *       If the data passes validation go on to	1	0	1
63000455	63	      *       delete the customer record	1	0	1
63000456	63	      *	1	0	1
63000457	63	              IF VALID-DATA	0	0	0
63000458	63	                 PERFORM DEL-CUST-DATA	0	0	1
63000459	63	              END-IF	0	0	1
63000460	63	              MOVE -1 TO CUSTNOL	0	0	1
63000462	63	           END-IF.	0	0	1
63000464	63	      *	1	0	0
63000465	63	      *    If it is pf10 (update customer) request to	1	0	1
63000466	63	      *    unlock the fields to allow an update to take place.	1	0	1
63000467	63	      *	1	0	1
63000468	63	           IF EIBAID = DFHPF10	0	0	0
63000469	63	              PERFORM EDIT-DATA	0	0	1
63000470	63	              PERFORM VALIDATE-DATA	0	0	1
63000471	63	      *	1	0	0
63000472	63	      *       If the data passes both sets of validation unprotect	1	0	1
63000473	63	      *       the data on the screen	1	0	1
63000474	63	      *	1	0	1
63000475	63	              IF VALID-DATA	0	0	0
63000476	63	                 PERFORM UNPROT-CUST-DATA	0	0	1
63000477	63	                 MOVE SPACES TO MESSAGEO	0	0	1
63000478	63	                 STRING 'Amend data then press <ENTER>.'	0	0	1
63000479	63	                    DELIMITED BY SIZE,	0	0	1
63000480	63	                    ' '	0	0	1
63000481	63	                    DELIMITED BY SIZE	0	0	1
63000482	63	                    INTO MESSAGEO	0	0	1
63000483	63	              END-IF	0	0	1
63000484	63	           END-IF.	0	0	1
63000486	63	           SET SEND-DATAONLY-ALARM TO TRUE.	0	0	1
63000487	63	      *	1	0	0
63000488	63	      *    Output the data to the screen	1	0	1
63000489	63	      *	1	0	1
63000490	63	           PERFORM SEND-MAP.	0	0	0
63000492	63	       PM999.	0	0	1
63000493	63	           EXIT.	0	0	1
63000496	63	       RECEIVE-MAP SECTION.	0	0	1
63000497	63	       RM010.	0	0	1
63000498	63	      *	1	0	0
63000499	63	      *    Retrieve the data	1	0	1
63000500	63	      *	1	0	1
63000502	63	      *	1	0	1
63000503	63	      *    To ensure that we get the correct case and the	1	0	1
63000504	63	      *    terminal doesn't change the case from ower case to	1	0	1
63000505	63	      *    upper case we need to turn off upper case translation, do	1	0	1
63000506	63	      *    the receive and then turn it on again.	1	0	1
63000507	63	      *	1	0	1
63000509	63	           EXEC CICS INQUIRE	0	0	0
63000510	63	                TERMINAL(EIBTRMID)	0	0	1
63000511	63	                UCTRANST(WS-UCTRANS)	0	0	1
63000512	63	                RESP(WS-CICS-RESP)	0	0	1
63000513	63	                RESP2(WS-CICS-RESP2)	0	0	1
63000514	63	           END-EXEC.	0	0	1
63000516	63	      *	1	0	0
63000517	63	      *    If Uppercase translation is switched on, then set it to	1	0	1
63000518	63	      *    NOUCTRAN(451).	1	0	1
63000519	63	      *	1	0	1
63000520	63	           IF WS-UCTRANS = DFHVALUE(UCTRAN) OR	0	0	0
63000521	63	           WS-UCTRANS = DFHVALUE(TRANIDONLY)	0	0	1
63000523	63	              MOVE DFHVALUE(NOUCTRAN) TO WS-UCTRANS	0	0	1
63000525	63	              EXEC CICS SET TERMINAL(EIBTRMID)	0	0	1
63000526	63	                 UCTRANST(WS-UCTRANS)	0	0	1
63000527	63	                 RESP(WS-CICS-RESP)	0	0	1
63000528	63	                 RESP2(WS-CICS-RESP2)	0	0	1
63000529	63	              END-EXEC	0	0	1
63000532	63	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63000533	63	      *	1	0	0
63000534	63	      *          Preserve the RESP and RESP2, then set up the	1	0	1
63000535	63	      *          standard ABEND info before getting the applid,	1	0	1
63000536	63	      *          date/time etc. and linking to the Abend Handler	1	0	1
63000537	63	      *          program.	1	0	1
63000538	63	      *	1	0	1
63000539	63	                 INITIALIZE ABNDINFO-REC	0	0	0
63000540	63	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63000541	63	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63000542	63	      *	1	0	0
63000543	63	      *          Get supplemental information	1	0	1
63000544	63	      *	1	0	1
63000545	63	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63000546	63	                 END-EXEC	0	0	1
63000548	63	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63000549	63	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63000551	63	                 PERFORM POPULATE-TIME-DATE	0	0	1
63000553	63	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63000554	63	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63000555	63	                       ':' DELIMITED BY SIZE,	0	0	1
63000556	63	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63000557	63	                        ':' DELIMITED BY SIZE,	0	0	1
63000558	63	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63000559	63	                        INTO ABND-TIME	0	0	1
63000560	63	                 END-STRING	0	0	1
63000562	63	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63000563	63	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
63000565	63	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63000566	63	                 END-EXEC	0	0	1
63000568	63	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63000570	63	                 STRING 'RM010 (1) - SET TERMINAL UC FAIL '	0	0	1
63000571	63	                       DELIMITED BY SIZE,	0	0	1
63000572	63	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63000573	63	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63000574	63	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
63000575	63	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63000576	63	                       INTO ABND-FREEFORM	0	0	1
63000577	63	                 END-STRING	0	0	1
63000579	63	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63000580	63	                           COMMAREA(ABNDINFO-REC)	0	0	1
63000581	63	                 END-EXEC	0	0	1
63000583	63	                 INITIALIZE WS-FAIL-INFO	0	0	1
63000584	63	                 MOVE 'BNK1DCS - RM010 (1) - SET TERMINAL UC FAIL ' TO	0	0	1
63000585	63	                    WS-CICS-FAIL-MSG	0	0	1
63000586	63	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63000587	63	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63000589	63	                 PERFORM RESTORE-TERM-DEF	0	0	1
63000590	63	                 PERFORM ABEND-THIS-TASK	0	0	1
63000591	63	              END-IF	0	0	1
63000592	63	           END-IF.	0	0	1
63000594	63	      *	1	0	0
63000595	63	      *    RECEIVE map ASIS	1	0	1
63000596	63	      *	1	0	1
63000597	63	           EXEC CICS	0	0	0
63000598	63	              RECEIVE MAP('BNK1DC')	0	0	1
63000599	63	              MAPSET('BNK1DCM')	0	0	1
63000600	63	              INTO(BNK1DCI)	0	0	1
63000601	63	              TERMINAL	0	0	1
63000602	63	              ASIS	0	0	1
63000603	63	              RESP(WS-CICS-RESP)	0	0	1
63000604	63	              RESP2(WS-CICS-RESP2)	0	0	1
63000605	63	           END-EXEC.	0	0	1
63000607	63	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63000608	63	      *	1	0	0
63000609	63	      *       Preserve the RESP and RESP2, then set up the	1	0	1
63000610	63	      *       standard ABEND info before getting the applid,	1	0	1
63000611	63	      *       date/time etc. and linking to the Abend Handler	1	0	1
63000612	63	      *       program.	1	0	1
63000613	63	      *	1	0	1
63000614	63	              INITIALIZE ABNDINFO-REC	0	0	0
63000615	63	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63000616	63	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63000617	63	      *	1	0	0
63000618	63	      *       Get supplemental information	1	0	1
63000619	63	      *	1	0	1
63000620	63	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63000621	63	              END-EXEC	0	0	1
63000623	63	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63000624	63	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63000626	63	              PERFORM POPULATE-TIME-DATE	0	0	1
63000628	63	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63000629	63	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63000630	63	                    ':' DELIMITED BY SIZE,	0	0	1
63000631	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63000632	63	                     ':' DELIMITED BY SIZE,	0	0	1
63000633	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63000634	63	                     INTO ABND-TIME	0	0	1
63000635	63	              END-STRING	0	0	1
63000637	63	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63000638	63	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
63000640	63	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63000641	63	              END-EXEC	0	0	1
63000643	63	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63000645	63	              STRING 'RM010 - RECEIVE MAP FAIL '	0	0	1
63000646	63	                    DELIMITED BY SIZE,	0	0	1
63000647	63	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63000648	63	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63000649	63	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
63000650	63	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63000651	63	                    INTO ABND-FREEFORM	0	0	1
63000652	63	              END-STRING	0	0	1
63000654	63	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63000655	63	                        COMMAREA(ABNDINFO-REC)	0	0	1
63000656	63	              END-EXEC	0	0	1
63000658	63	              INITIALIZE WS-FAIL-INFO	0	0	1
63000659	63	              MOVE 'BNK1DCS - RM010 - RECEIVE MAP FAIL ' TO	0	0	1
63000660	63	                 WS-CICS-FAIL-MSG	0	0	1
63000661	63	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63000662	63	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63000664	63	              PERFORM RESTORE-TERM-DEF	0	0	1
63000665	63	              PERFORM ABEND-THIS-TASK	0	0	1
63000666	63	           END-IF.	0	0	1
63000668	63	           MOVE CUSTNOI TO INQCUST-CUSTNO.	0	0	1
63000669	63	           MOVE SORTCI  TO INQCUST-SCODE.	0	0	1
63000671	63	       RM999.	0	0	1
63000672	63	           EXIT.	0	0	1
63000675	63	       EDIT-DATA SECTION.	0	0	1
63000676	63	       ED010.	0	0	1
63000677	63	      *	1	0	0
63000678	63	      *    Perform validation on the incoming fields	1	0	1
63000679	63	      *	1	0	1
63000680	63	           IF CUSTNOL = ZERO OR CUSTNOI = LOW-VALUES	0	0	0
63000681	63	              MOVE SPACES TO MESSAGEO	0	0	1
63000682	63	              MOVE 'Please enter a customer number.' TO	0	0	1
63000683	63	                 MESSAGEO	0	0	1
63000684	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63000685	63	              MOVE -1  TO CUSTNOL	0	0	1
63000686	63	              GO TO ED999	0	0	1
63000687	63	           END-IF.	0	0	1
63000690	63	           EXEC CICS BIF DEEDIT	0	0	1
63000691	63	              FIELD(CUSTNOI)	0	0	1
63000692	63	           END-EXEC	0	0	1
63000694	63	           IF CUSTNOI NOT NUMERIC	0	0	1
63000695	63	              MOVE SPACES TO MESSAGEO	0	0	1
63000696	63	              MOVE 'Please enter a customer number.' TO	0	0	1
63000697	63	                 MESSAGEO	0	0	1
63000698	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63000699	63	              MOVE -1  TO CUSTNOL	0	0	1
63000700	63	           END-IF.	0	0	1
63000702	63	       ED999.	0	0	1
63000703	63	           EXIT.	0	0	1
63000706	63	       EDIT-DATA2 SECTION.	0	0	1
63000707	63	       ED2010.	0	0	1
63000708	63	      *	1	0	0
63000709	63	      *    Perform more validation	1	0	1
63000710	63	      *	1	0	1
63000712	63	      *	1	0	1
63000713	63	      *    Validate the amended data from the update starting with	1	0	1
63000714	63	      *    Customer Name, this must have a valid title at the begining.	1	0	1
63000715	63	      *	1	0	1
63000716	63	           MOVE CUSTNAMI TO WS-VALIDATE-NAME.	0	0	0
63000718	63	           UNSTRING WS-VALIDATE-NAME DELIMITED BY SPACE	0	0	1
63000719	63	              INTO WS-UNSTR-TITLE.	0	0	1
63000721	63	           MOVE ' ' TO WS-TITLE-VALID.	0	0	1
63000723	63	           EVALUATE WS-UNSTR-TITLE	0	0	1
63000725	63	              WHEN 'Professor'	0	0	1
63000726	63	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
63000728	63	              WHEN 'Mr       '	0	0	1
63000729	63	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
63000731	63	              WHEN 'Mrs      '	0	0	1
63000732	63	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
63000734	63	              WHEN 'Miss     '	0	0	1
63000735	63	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
63000737	63	              WHEN 'Ms       '	0	0	1
63000738	63	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
63000740	63	              WHEN 'Dr       '	0	0	1
63000741	63	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
63000743	63	              WHEN 'Drs      '	0	0	1
63000744	63	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
63000746	63	              WHEN 'Lord     '	0	0	1
63000747	63	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
63000749	63	              WHEN 'Sir      '	0	0	1
63000750	63	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
63000752	63	              WHEN 'Lady     '	0	0	1
63000753	63	                 MOVE 'Y' TO WS-TITLE-VALID	0	0	1
63000755	63	              WHEN OTHER	0	0	1
63000756	63	                 MOVE 'N' TO WS-TITLE-VALID	0	0	1
63000758	63	           END-EVALUATE.	0	0	1
63000760	63	      *	1	0	0
63000761	63	      *    Check to see if the title was valid or not	1	0	1
63000762	63	      *	1	0	1
63000763	63	           IF WS-TITLE-VALID = 'N'	0	0	0
63000764	63	              MOVE SPACES TO MESSAGEO	0	0	1
63000765	63	              STRING 'Valid titles are: Mr,Mrs,Miss,Ms,Dr,Professor,'	0	0	1
63000766	63	                    DELIMITED BY SIZE,	0	0	1
63000767	63	                     'Drs,Lord,Sir,Lady' DELIMITED BY SIZE	0	0	1
63000768	63	                 INTO MESSAGEO	0	0	1
63000769	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63000770	63	              move -1 to custnaml	0	0	1
63000771	63	           END-IF.	0	0	1
63000773	63	      *	1	0	0
63000774	63	      *    Ensure that the address hasn't been set to spaces,	1	0	1
63000775	63	      *    anything else (other than spaces) is considered to	1	0	1
63000776	63	      *    be valid.	1	0	1
63000777	63	      *	1	0	1
63000778	63	           IF CUSTAD1I = SPACES AND	0	0	0
63000779	63	           CUSTAD2I = SPACES AND	0	0	1
63000780	63	           CUSTAD3I = SPACES	0	0	1
63000781	63	              MOVE SPACES TO MESSAGEO	0	0	1
63000782	63	              STRING 'Address must not be all spaces'	0	0	1
63000783	63	                    DELIMITED BY SIZE,	0	0	1
63000784	63	                     ' - please reenter' DELIMITED BY SIZE	0	0	1
63000785	63	                 INTO MESSAGEO	0	0	1
63000786	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63000787	63	              move -1 to CUSTAD1L	0	0	1
63000788	63	           END-IF.	0	0	1
63000790	63	       ED2999.	0	0	1
63000791	63	           EXIT.	0	0	1
63000794	63	       VALIDATE-DATA SECTION.	0	0	1
63000795	63	       VD010.	0	0	1
63000796	63	      *	1	0	0
63000797	63	      *    Perform even more attribute validation	1	0	1
63000798	63	      *	1	0	1
63000799	63	      *	1	0	1
63000800	63	      *    This hasn't been set, so we're relying on it being random!	1	0	1
63000801	63	      *	1	0	1
63000802	63	           IF INQCUST-SCODE = '000000'	0	0	0
63000803	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63000804	63	              MOVE SPACES TO MESSAGEO	0	0	1
63000805	63	              STRING 'The Sort code / Customer number combination is'	0	0	1
63000806	63	                  DELIMITED BY SIZE,	0	0	1
63000807	63	                  ' not VALID.' DELIMITED BY SIZE	0	0	1
63000808	63	                  INTO MESSAGEO	0	0	1
63000809	63	           END-IF.	0	0	1
63000810	63	           IF CUSTNOI = ZERO OR CUSTNOI = '9999999999'	0	0	1
63000811	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63000812	63	              MOVE SPACES TO MESSAGEO	0	0	1
63000813	63	              STRING 'The customer number is'	0	0	1
63000814	63	                  DELIMITED BY SIZE,	0	0	1
63000815	63	                  ' not VALID.' DELIMITED BY SIZE	0	0	1
63000816	63	                  INTO MESSAGEO	0	0	1
63000817	63	           END-IF.	0	0	1
63000819	63	       VD999.	0	0	1
63000820	63	           EXIT.	0	0	1
63000823	63	       GET-CUST-DATA SECTION.	0	0	1
63000824	63	       GCD010.	0	0	1
63000825	63	      *	1	0	0
63000826	63	      *    Set up the fields required by INQCUST then link to it	1	0	1
63000827	63	      *	1	0	1
63000828	63	           INITIALIZE INQCUST-COMMAREA.	0	0	0
63000829	63	           SET INQCUST-PCB-POINTER TO NULL.	0	0	1
63000831	63	           MOVE CUSTNOI TO INQCUST-CUSTNO.	0	0	1
63000833	63	           EXEC CICS LINK	0	0	1
63000834	63	              PROGRAM('INQCUST')	0	0	1
63000835	63	              COMMAREA(INQCUST-COMMAREA)	0	0	1
63000836	63	              RESP(WS-CICS-RESP)	0	0	1
63000837	63	              RESP2(WS-CICS-RESP2)	0	0	1
63000838	63	              SYNCONRETURN	0	0	1
63000839	63	           END-EXEC.	0	0	1
63000841	63	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63000842	63	      *	1	0	0
63000843	63	      *       Preserve the RESP and RESP2, then set up the	1	0	1
63000844	63	      *       standard ABEND info before getting the applid,	1	0	1
63000845	63	      *       date/time etc. and linking to the Abend Handler	1	0	1
63000846	63	      *       program.	1	0	1
63000847	63	      *	1	0	1
63000848	63	              INITIALIZE ABNDINFO-REC	0	0	0
63000849	63	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63000850	63	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63000851	63	      *	1	0	0
63000852	63	      *       Get supplemental information	1	0	1
63000853	63	      *	1	0	1
63000854	63	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63000855	63	              END-EXEC	0	0	1
63000857	63	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63000858	63	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63000860	63	              PERFORM POPULATE-TIME-DATE	0	0	1
63000862	63	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63000863	63	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63000864	63	                    ':' DELIMITED BY SIZE,	0	0	1
63000865	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63000866	63	                     ':' DELIMITED BY SIZE,	0	0	1
63000867	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63000868	63	                     INTO ABND-TIME	0	0	1
63000869	63	              END-STRING	0	0	1
63000871	63	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63000872	63	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
63000874	63	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63000875	63	              END-EXEC	0	0	1
63000877	63	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63000879	63	              STRING 'GCD010 - LINK INQCUST  FAIL '	0	0	1
63000880	63	                    DELIMITED BY SIZE,	0	0	1
63000881	63	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63000882	63	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63000883	63	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
63000884	63	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63000885	63	                    INTO ABND-FREEFORM	0	0	1
63000886	63	              END-STRING	0	0	1
63000888	63	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63000889	63	                        COMMAREA(ABNDINFO-REC)	0	0	1
63000890	63	              END-EXEC	0	0	1
63000892	63	              INITIALIZE WS-FAIL-INFO	0	0	1
63000893	63	              MOVE 'BNK1DCS - GCD010 - LINK INQCUST  FAIL      '	0	0	1
63000894	63	                 TO WS-CICS-FAIL-MSG	0	0	1
63000895	63	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63000896	63	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63000898	63	              PERFORM RESTORE-TERM-DEF	0	0	1
63000899	63	              PERFORM ABEND-THIS-TASK	0	0	1
63000900	63	           END-IF.	0	0	1
63000902	63	      *	1	0	0
63000903	63	      *    Check to see if there was any data returned,	1	0	1
63000904	63	      *    if not output an error message	1	0	1
63000905	63	      *	1	0	1
63000906	63	           IF INQCUST-NAME = SPACES AND INQCUST-ADDR = SPACES	0	0	0
63000907	63	              MOVE SPACES TO MESSAGEO	0	0	1
63000908	63	              MOVE 'Sorry, but that customer number was not found.' TO	0	0	1
63000909	63	                 MESSAGEO	0	0	1
63000910	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63000911	63	              MOVE SPACES   TO SORTCO	0	0	1
63000912	63	              MOVE SPACES TO CUSTNO2O CUSTNAMO	0	0	1
63000913	63	              MOVE SPACES TO CUSTAD1O CUSTAD2O CUSTAD3O	0	0	1
63000914	63	              MOVE SPACES TO DOBDDO DOBMMO DOBYYO	0	0	1
63000915	63	              MOVE SPACES TO CREDSCO SCRDTDDO SCRDTMMO SCRDTYYO	0	0	1
63000916	63	              move -1 to custnol	0	0	1
63000917	63	              GO TO GCD999	0	0	1
63000918	63	           END-IF.	0	0	1
63000919	63	      *	1	0	0
63000920	63	      *    Set the values on the map	1	0	1
63000921	63	      *	1	0	1
63000922	63	           MOVE INQCUST-SCODE       TO SORTCO.	0	0	0
63000923	63	           MOVE INQCUST-CUSTNO      TO CUSTNO2O.	0	0	1
63000924	63	           MOVE INQCUST-NAME        TO CUSTNAMO.	0	0	1
63000926	63	           MOVE INQCUST-ADDR TO COMM-ADDR-SPLIT.	0	0	1
63000927	63	           MOVE COMM-ADDR-SPLIT1 TO CUSTAD1O.	0	0	1
63000928	63	           MOVE COMM-ADDR-SPLIT2 TO CUSTAD2O.	0	0	1
63000929	63	           MOVE COMM-ADDR-SPLIT3 TO CUSTAD3O.	0	0	1
63000931	63	           MOVE INQCUST-DOB          TO COMM-DOB-SPLIT.	0	0	1
63000932	63	           MOVE COMM-DOB-SPLIT-DD   TO DOBDDO.	0	0	1
63000933	63	           MOVE COMM-DOB-SPLIT-MM   TO DOBMMO.	0	0	1
63000934	63	           MOVE COMM-DOB-SPLIT-YYYY TO DOBYYO.	0	0	1
63000936	63	           MOVE INQCUST-CREDIT-SCORE TO CREDIT-SCORE-9.	0	0	1
63000937	63	           MOVE CREDIT-SCORE-X TO CREDSCO.	0	0	1
63000939	63	           MOVE INQCUST-CS-REVIEW-DD  TO	0	0	1
63000940	63	              SCRDTDDO.	0	0	1
63000941	63	           MOVE INQCUST-CS-REVIEW-MM TO	0	0	1
63000942	63	              SCRDTMMO.	0	0	1
63000943	63	           MOVE INQCUST-CS-REVIEW-YYYY TO	0	0	1
63000944	63	              SCRDTYYO.	0	0	1
63000946	63	           MOVE SPACES TO MESSAGEO.	0	0	1
63000947	63	           IF CUSTNOI = ZERO OR CUSTNOI = '9999999999'	0	0	1
63000948	63	             MOVE   'Customer lookup successful.'	0	0	1
63000949	63	                     TO MESSAGEO	0	0	1
63000950	63	           ELSE	0	0	1
63000951	63	           STRING 'Customer lookup successful. <PF5> to Delete. <PF10'	0	0	1
63000952	63	                 DELIMITED BY SIZE,	0	0	1
63000953	63	                '> to Update.                       '	0	0	1
63000954	63	                 DELIMITED BY SIZE	0	0	1
63000955	63	                 INTO MESSAGEO	0	0	1
63000956	63	           END-IF.	0	0	1
63000957	63	       GCD999.	0	0	1
63000958	63	           EXIT.	0	0	1
63000961	63	       DEL-CUST-DATA SECTION.	0	0	1
63000962	63	       DCD010.	0	0	1
63000963	63	      *	1	0	0
63000964	63	      *    Set up the fields required by DELCUS then link to it	1	0	1
63000965	63	      *	1	0	1
63000966	63	           INITIALIZE DELCUS-COMMAREA	0	0	0
63000967	63	           MOVE CUSTNO2I TO COMM-CUSTNO OF DELCUS-COMMAREA.	0	0	1
63000969	63	           EXEC CICS LINK	0	0	1
63000970	63	              PROGRAM('DELCUS')	0	0	1
63000971	63	              COMMAREA(DELCUS-COMMAREA)	0	0	1
63000972	63	              RESP(WS-CICS-RESP)	0	0	1
63000973	63	              RESP2(WS-CICS-RESP2)	0	0	1
63000974	63	              SYNCONRETURN	0	0	1
63000975	63	           END-EXEC.	0	0	1
63000977	63	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63000978	63	      *	1	0	0
63000979	63	      *       Preserve the RESP and RESP2, then set up the	1	0	1
63000980	63	      *       standard ABEND info before getting the applid,	1	0	1
63000981	63	      *       date/time etc. and linking to the Abend Handler	1	0	1
63000982	63	      *       program.	1	0	1
63000983	63	      *	1	0	1
63000984	63	              INITIALIZE ABNDINFO-REC	0	0	0
63000985	63	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63000986	63	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63000987	63	      *	1	0	0
63000988	63	      *       Get supplemental information	1	0	1
63000989	63	      *	1	0	1
63000990	63	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63000991	63	              END-EXEC	0	0	1
63000993	63	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63000994	63	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63000996	63	              PERFORM POPULATE-TIME-DATE	0	0	1
63000998	63	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63000999	63	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63001000	63	                    ':' DELIMITED BY SIZE,	0	0	1
63001001	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63001002	63	                     ':' DELIMITED BY SIZE,	0	0	1
63001003	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63001004	63	                     INTO ABND-TIME	0	0	1
63001005	63	              END-STRING	0	0	1
63001007	63	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63001008	63	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
63001010	63	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63001011	63	              END-EXEC	0	0	1
63001013	63	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63001015	63	              STRING 'DCD010 - LINK DELCUS  FAIL '	0	0	1
63001016	63	                    DELIMITED BY SIZE,	0	0	1
63001017	63	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63001018	63	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63001019	63	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
63001020	63	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63001021	63	                    INTO ABND-FREEFORM	0	0	1
63001022	63	              END-STRING	0	0	1
63001024	63	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63001025	63	                        COMMAREA(ABNDINFO-REC)	0	0	1
63001026	63	              END-EXEC	0	0	1
63001028	63	              INITIALIZE WS-FAIL-INFO	0	0	1
63001029	63	              MOVE 'BNK1DCS - DCD010 - LINK DELCUS  FAIL      '	0	0	1
63001030	63	                 TO WS-CICS-FAIL-MSG	0	0	1
63001031	63	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63001032	63	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63001034	63	              PERFORM RESTORE-TERM-DEF	0	0	1
63001035	63	              PERFORM ABEND-THIS-TASK	0	0	1
63001036	63	           END-IF.	0	0	1
63001038	63	      *	1	0	0
63001039	63	      *    Check to see if there was any data returned,	1	0	1
63001040	63	      *    if not output an error message	1	0	1
63001041	63	      *	1	0	1
63001042	63	           IF COMM-DEL-SUCCESS OF DELCUS-COMMAREA = 'N' AND	0	0	0
63001043	63	           COMM-DEL-FAIL-CD OF DELCUS-COMMAREA = '1'	0	0	1
63001044	63	              MOVE SPACES TO MESSAGEO	0	0	1
63001045	63	              STRING 'Sorry but that Cust no was not found.'	0	0	1
63001046	63	                 DELIMITED BY SIZE,	0	0	1
63001047	63	                 ' Customer NOT deleted.' DELIMITED BY SIZE	0	0	1
63001048	63	                 INTO MESSAGEO	0	0	1
63001049	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63001050	63	              MOVE -1  TO CUSTNO2L	0	0	1
63001051	63	              MOVE COMM-SCODE OF DELCUS-COMMAREA   TO SORTCO	0	0	1
63001052	63	              GO TO DCD999	0	0	1
63001053	63	           END-IF.	0	0	1
63001055	63	           IF COMM-DEL-SUCCESS OF DELCUS-COMMAREA = 'N' AND	0	0	1
63001056	63	           COMM-DEL-FAIL-CD OF DELCUS-COMMAREA = '2'	0	0	1
63001057	63	              MOVE SPACES TO MESSAGEO	0	0	1
63001058	63	              STRING 'Sorry but a datastore error occurred.'	0	0	1
63001059	63	                 DELIMITED BY SIZE,	0	0	1
63001060	63	                 ' Action NOT applied.  ' DELIMITED BY SIZE	0	0	1
63001061	63	                 INTO MESSAGEO	0	0	1
63001062	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63001063	63	              MOVE COMM-SCODE OF DELCUS-COMMAREA   TO SORTCO	0	0	1
63001064	63	              GO TO DCD999	0	0	1
63001065	63	           END-IF.	0	0	1
63001067	63	           IF COMM-DEL-SUCCESS OF DELCUS-COMMAREA = 'N' AND	0	0	1
63001068	63	           COMM-DEL-FAIL-CD OF DELCUS-COMMAREA = '3'	0	0	1
63001069	63	              MOVE SPACES TO MESSAGEO	0	0	1
63001070	63	              STRING 'Sorry but a delete error occurred.'	0	0	1
63001071	63	                 DELIMITED BY SIZE,	0	0	1
63001072	63	                 ' Customer NOT deleted.' DELIMITED BY SIZE	0	0	1
63001073	63	                 INTO MESSAGEO	0	0	1
63001074	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63001075	63	              MOVE COMM-SCODE OF DELCUS-COMMAREA   TO SORTCO	0	0	1
63001076	63	              GO TO DCD999	0	0	1
63001077	63	           END-IF.	0	0	1
63001079	63	           IF COMM-DEL-SUCCESS OF DELCUS-COMMAREA = 'N'	0	0	1
63001080	63	              MOVE SPACES TO MESSAGEO	0	0	1
63001081	63	              STRING 'Sorry but an error occurred.'	0	0	1
63001082	63	                 DELIMITED BY SIZE,	0	0	1
63001083	63	                 ' Customer NOT deleted.' DELIMITED BY SIZE	0	0	1
63001084	63	                 INTO MESSAGEO	0	0	1
63001085	63	              MOVE 'N' TO VALID-DATA-SW	0	0	1
63001086	63	              MOVE COMM-SCODE OF DELCUS-COMMAREA   TO SORTCO	0	0	1
63001087	63	              GO TO DCD999	0	0	1
63001088	63	           END-IF.	0	0	1
63001090	63	      *	1	0	0
63001091	63	      *    Set up map data	1	0	1
63001092	63	      *	1	0	1
63001093	63	           MOVE SPACES TO SORTCO.	0	0	0
63001094	63	           MOVE SPACES TO CUSTNO2O.	0	0	1
63001095	63	           MOVE SPACES TO CUSTNAMO.	0	0	1
63001096	63	           MOVE SPACES TO CUSTAD1O.	0	0	1
63001097	63	           MOVE SPACES TO CUSTAD2O.	0	0	1
63001098	63	           MOVE SPACES TO CUSTAD3O.	0	0	1
63001099	63	           MOVE SPACES TO DOBDDO.	0	0	1
63001100	63	           MOVE SPACES TO DOBMMO.	0	0	1
63001101	63	           MOVE SPACES TO DOBYYO.	0	0	1
63001102	63	           MOVE SPACES TO CREDSCO.	0	0	1
63001103	63	           MOVE SPACES TO SCRDTDDO.	0	0	1
63001104	63	           MOVE SPACES TO SCRDTMMO.	0	0	1
63001105	63	           MOVE SPACES TO SCRDTYYO.	0	0	1
63001107	63	           MOVE SPACES TO MESSAGEO.	0	0	1
63001109	63	           STRING 'Customer ' DELIMITED BY SIZE,	0	0	1
63001110	63	              COMM-CUSTNO OF DELCUS-COMMAREA DELIMITED BY SIZE,	0	0	1
63001111	63	              ' and associated accounts were successfully'	0	0	1
63001112	63	              DELIMITED BY SIZE,	0	0	1
63001113	63	              ' deleted.'	0	0	1
63001114	63	              DELIMITED BY SIZE,	0	0	1
63001115	63	           INTO MESSAGEO.	0	0	1
63001117	63	       DCD999.	0	0	1
63001118	63	           EXIT.	0	0	1
63001121	63	       UPDATE-CUST-DATA SECTION.	0	0	1
63001122	63	       UPDCD010.	0	0	1
63001123	63	      *	1	0	0
63001124	63	      *    Set up the fields required by UPDUCUST then link to it	1	0	1
63001125	63	      *	1	0	1
63001126	63	           INITIALIZE UPDCUST-COMMAREA.	0	0	0
63001128	63	           MOVE SORTCI TO COMM-SCODE OF UPDCUST-COMMAREA.	0	0	1
63001129	63	           MOVE CUSTNO2I TO COMM-CUSTNO OF UPDCUST-COMMAREA.	0	0	1
63001130	63	           MOVE CUSTNAMI TO COMM-NAME OF UPDCUST-COMMAREA.	0	0	1
63001131	63	           STRING CUSTAD1I	0	0	1
63001132	63	                    DELIMITED BY SIZE,	0	0	1
63001133	63	                  CUSTAD2I	0	0	1
63001134	63	                    DELIMITED BY SIZE,	0	0	1
63001135	63	                  CUSTAD3I	0	0	1
63001136	63	                    DELIMITED BY SIZE,	0	0	1
63001137	63	           INTO COMM-ADDR OF UPDCUST-COMMAREA.	0	0	1
63001139	63	           MOVE DOBDDI TO COMM-DOBX-DD.	0	0	1
63001140	63	           MOVE DOBMMI TO COMM-DOBX-MM.	0	0	1
63001141	63	           MOVE DOBYYI TO COMM-DOBX-YYYY.	0	0	1
63001142	63	           MOVE COMM-DOB-UPD-9 TO COMM-DOB OF UPDCUST-COMMAREA.	0	0	1
63001143	63	           MOVE CREDSCI TO CREDIT-SCORE-X.	0	0	1
63001144	63	           MOVE CREDIT-SCORE-9 TO COMM-CREDIT-SCORE OF UPDCUST-COMMAREA.	0	0	1
63001146	63	           MOVE SCRDTDDI TO COMM-CS-REVIEWX-DD.	0	0	1
63001147	63	           MOVE SCRDTMMI TO COMM-CS-REVIEWX-MM.	0	0	1
63001148	63	           MOVE SCRDTYYI TO COMM-CS-REVIEWX-YYYY.	0	0	1
63001149	63	           MOVE COMM-CS-REVIEW-UPD-9	0	0	1
63001150	63	             TO COMM-CS-REVIEW-DATE OF UPDCUST-COMMAREA.	0	0	1
63001152	63	           MOVE SPACE TO COMM-UPD-SUCCESS.	0	0	1
63001153	63	           MOVE SPACE TO COMM-UPD-FAIL-CD.	0	0	1
63001155	63	           EXEC CICS LINK	0	0	1
63001156	63	              PROGRAM('UPDCUST')	0	0	1
63001157	63	              COMMAREA(UPDCUST-COMMAREA)	0	0	1
63001158	63	              RESP(WS-CICS-RESP)	0	0	1
63001159	63	              RESP2(WS-CICS-RESP2)	0	0	1
63001160	63	              SYNCONRETURN	0	0	1
63001161	63	           END-EXEC.	0	0	1
63001163	63	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63001164	63	      *	1	0	0
63001165	63	      *       Preserve the RESP and RESP2, then set up the	1	0	1
63001166	63	      *       standard ABEND info before getting the applid,	1	0	1
63001167	63	      *       date/time etc. and linking to the Abend Handler	1	0	1
63001168	63	      *       program.	1	0	1
63001169	63	      *	1	0	1
63001170	63	              INITIALIZE ABNDINFO-REC	0	0	0
63001171	63	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63001172	63	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63001173	63	      *	1	0	0
63001174	63	      *       Get supplemental information	1	0	1
63001175	63	      *	1	0	1
63001176	63	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63001177	63	              END-EXEC	0	0	1
63001179	63	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63001180	63	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63001182	63	              PERFORM POPULATE-TIME-DATE	0	0	1
63001184	63	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63001185	63	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63001186	63	                    ':' DELIMITED BY SIZE,	0	0	1
63001187	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63001188	63	                     ':' DELIMITED BY SIZE,	0	0	1
63001189	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63001190	63	                     INTO ABND-TIME	0	0	1
63001191	63	              END-STRING	0	0	1
63001193	63	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63001194	63	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
63001196	63	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63001197	63	              END-EXEC	0	0	1
63001199	63	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63001201	63	              STRING 'UAPDC010 - LINK UPDCUST  FAIL'	0	0	1
63001202	63	                    DELIMITED BY SIZE,	0	0	1
63001203	63	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63001204	63	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63001205	63	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
63001206	63	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63001207	63	                    INTO ABND-FREEFORM	0	0	1
63001208	63	              END-STRING	0	0	1
63001210	63	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63001211	63	                        COMMAREA(ABNDINFO-REC)	0	0	1
63001212	63	              END-EXEC	0	0	1
63001215	63	              INITIALIZE WS-FAIL-INFO	0	0	1
63001216	63	              MOVE 'BNK1DCS - UPDCD010 - LINK UPDCUST  FAIL    '	0	0	1
63001217	63	                 TO WS-CICS-FAIL-MSG	0	0	1
63001218	63	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63001219	63	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63001221	63	              PERFORM RESTORE-TERM-DEF	0	0	1
63001222	63	              PERFORM ABEND-THIS-TASK	0	0	1
63001223	63	           END-IF.	0	0	1
63001226	63	      *	1	0	0
63001227	63	      *    Check to see if there was any data returned,	1	0	1
63001228	63	      *    if not output an error message	1	0	1
63001229	63	      *	1	0	1
63001230	63	           IF COMM-UPD-SUCCESS = 'N'	0	0	0
63001232	63	              EVALUATE COMM-UPD-FAIL-CD	0	0	1
63001233	63	                 WHEN '1'	0	0	1
63001234	63	                    MOVE SPACES TO MESSAGEO	0	0	1
63001235	63	                    STRING 'Sorry but that Cust no was not found.'	0	0	1
63001236	63	                       DELIMITED BY SIZE,	0	0	1
63001237	63	                       ' Customer NOT updated.' DELIMITED BY SIZE	0	0	1
63001238	63	                       INTO MESSAGEO	0	0	1
63001239	63	                    MOVE 'N' TO VALID-DATA-SW	0	0	1
63001240	63	                    MOVE -1 TO CUSTNO2L	0	0	1
63001241	63	                    MOVE COMM-SCODE OF UPDCUST-COMMAREA   TO SORTCO	0	0	1
63001242	63	                    GO TO UPDCD999	0	0	1
63001244	63	                 WHEN '2'	0	0	1
63001245	63	                    MOVE SPACES TO MESSAGEO	0	0	1
63001246	63	                    STRING 'Sorry but a datastore error occurred.'	0	0	1
63001247	63	                       DELIMITED BY SIZE,	0	0	1
63001248	63	                       ' Customer NOT updated.' DELIMITED BY SIZE	0	0	1
63001249	63	                       INTO MESSAGEO	0	0	1
63001250	63	                    MOVE 'N' TO VALID-DATA-SW	0	0	1
63001251	63	                    MOVE -1 TO CUSTNO2L	0	0	1
63001252	63	                    MOVE COMM-SCODE OF UPDCUST-COMMAREA   TO SORTCO	0	0	1
63001253	63	                    GO TO UPDCD999	0	0	1
63001255	63	                 WHEN '3'	0	0	1
63001256	63	                    MOVE SPACES TO MESSAGEO	0	0	1
63001257	63	                    STRING 'Sorry but an update error occurred.'	0	0	1
63001258	63	                       DELIMITED BY SIZE,	0	0	1
63001259	63	                       ' Customer NOT updated.' DELIMITED BY SIZE	0	0	1
63001260	63	                       INTO MESSAGEO	0	0	1
63001261	63	                    MOVE 'N' TO VALID-DATA-SW	0	0	1
63001262	63	                    MOVE COMM-SCODE OF UPDCUST-COMMAREA   TO SORTCO	0	0	1
63001263	63	                    MOVE -1 TO CUSTNO2L	0	0	1
63001264	63	                    GO TO UPDCD999	0	0	1
63001266	63	                 WHEN OTHER	0	0	1
63001267	63	                    MOVE SPACES TO MESSAGEO	0	0	1
63001268	63	                    STRING 'Sorry but an unknown error occurred.'	0	0	1
63001269	63	                       DELIMITED BY SIZE,	0	0	1
63001270	63	                       ' Customer NOT updated.' DELIMITED BY SIZE	0	0	1
63001271	63	                       INTO MESSAGEO	0	0	1
63001272	63	                    MOVE 'N' TO VALID-DATA-SW	0	0	1
63001273	63	                    MOVE COMM-SCODE OF UPDCUST-COMMAREA   TO SORTCO	0	0	1
63001274	63	                    MOVE -1 TO CUSTNO2L	0	0	1
63001275	63	                    GO TO UPDCD999	0	0	1
63001277	63	              END-EVALUATE	0	0	1
63001279	63	           END-IF.	0	0	1
63001281	63	      *	1	0	0
63001282	63	      *    Set up the map data	1	0	1
63001283	63	      *	1	0	1
63001284	63	           MOVE COMM-SCODE  OF UPDCUST-COMMAREA TO SORTCO.	0	0	0
63001285	63	           MOVE COMM-CUSTNO OF UPDCUST-COMMAREA TO CUSTNO2O.	0	0	1
63001286	63	           MOVE COMM-NAME   OF UPDCUST-COMMAREA TO CUSTNAMO.	0	0	1
63001288	63	           MOVE COMM-ADDR  OF UPDCUST-COMMAREA TO COMM-ADDR-SPLIT.	0	0	1
63001289	63	           MOVE COMM-ADDR-SPLIT1     TO CUSTAD1O.	0	0	1
63001290	63	           MOVE COMM-ADDR-SPLIT2     TO CUSTAD2O.	0	0	1
63001291	63	           MOVE COMM-ADDR-SPLIT3     TO CUSTAD3O.	0	0	1
63001293	63	           MOVE COMM-DOB   OF UPDCUST-COMMAREA TO COMM-DOB-SPLIT.	0	0	1
63001294	63	           MOVE COMM-DOB-SPLIT-DD    TO DOBDDO.	0	0	1
63001295	63	           MOVE COMM-DOB-SPLIT-MM    TO DOBMMO.	0	0	1
63001296	63	           MOVE COMM-DOB-SPLIT-YYYY  TO DOBYYO.	0	0	1
63001298	63	           MOVE COMM-CREDIT-SCORE OF UPDCUST-COMMAREA TO CREDIT-SCORE-9.	0	0	1
63001299	63	           MOVE CREDIT-SCORE-X TO CREDSCO.	0	0	1
63001301	63	           MOVE COMM-CS-DAY   OF UPDCUST-COMMAREA	0	0	1
63001302	63	              TO SCRDTDDO.	0	0	1
63001303	63	           MOVE COMM-CS-MONTH OF UPDCUST-COMMAREA	0	0	1
63001304	63	              TO SCRDTMMO.	0	0	1
63001305	63	           MOVE COMM-CS-YEAR  OF UPDCUST-COMMAREA	0	0	1
63001306	63	              TO SCRDTYYO.	0	0	1
63001308	63	           MOVE SPACES TO MESSAGEO.	0	0	1
63001309	63	           STRING 'Customer ' DELIMITED BY SIZE,	0	0	1
63001310	63	                 COMM-CUSTNO OF UPDCUST-COMMAREA DELIMITED BY SIZE,	0	0	1
63001311	63	                 ' was updated successfully'	0	0	1
63001312	63	                 DELIMITED BY SIZE,	0	0	1
63001313	63	                 INTO MESSAGEO.	0	0	1
63001314	63	           MOVE -1  TO CUSTNOL.	0	0	1
63001315	63	           PERFORM  PROT-CUST-DATA.	0	0	1
63001317	63	       UPDCD999.	0	0	1
63001318	63	           EXIT.	0	0	1
63001321	63	       UNPROT-CUST-DATA SECTION.	0	0	1
63001322	63	       UCD010.	0	0	1
63001324	63	      *	1	0	0
63001325	63	      *    Unprotect the fields on the screen to allow	1	0	1
63001326	63	      *    editing. Preserve the information on the screen in	1	0	1
63001327	63	      *    the comm area	1	0	1
63001328	63	      *	1	0	1
63001329	63	           MOVE 'CUST'   TO COMM-EYE OF DFHCOMMAREA.	0	0	0
63001330	63	           MOVE SORTCO   TO COMM-SCODE OF DFHCOMMAREA.	0	0	1
63001331	63	           MOVE CUSTNO2O TO COMM-CUSTNO OF DFHCOMMAREA.	0	0	1
63001332	63	           MOVE CUSTNAMO TO COMM-NAME OF DFHCOMMAREA.	0	0	1
63001334	63	           MOVE CUSTAD1O TO COMM-ADDR-UPD1 .	0	0	1
63001335	63	           MOVE CUSTAD2O TO COMM-ADDR-UPD2.	0	0	1
63001336	63	           MOVE CUSTAD3O TO COMM-ADDR-UPD3.	0	0	1
63001337	63	           MOVE COMM-ADDR-UPD-SPLIT TO COMM-ADDR OF DFHCOMMAREA.	0	0	1
63001339	63	           MOVE DOBDDO   TO COMM-DOBX-DD.	0	0	1
63001340	63	           MOVE DOBMMO   TO COMM-DOBX-MM.	0	0	1
63001341	63	           MOVE DOBYYO   TO COMM-DOBX-YYYY.	0	0	1
63001342	63	           MOVE COMM-DOB-UPD-9 TO COMM-DOB OF DFHCOMMAREA.	0	0	1
63001344	63	           MOVE CREDSCO  TO CREDIT-SCORE-X.	0	0	1
63001345	63	           MOVE CREDIT-SCORE-9 TO COMM-CREDIT-SCORE OF DFHCOMMAREA.	0	0	1
63001347	63	           MOVE SCRDTDDO TO COMM-CS-REVIEWX-DD.	0	0	1
63001348	63	           MOVE SCRDTMMO TO COMM-CS-REVIEWX-MM.	0	0	1
63001349	63	           MOVE SCRDTYYO TO COMM-CS-REVIEWX-YYYY.	0	0	1
63001350	63	           MOVE COMM-CS-REVIEW-UPD-9	0	0	1
63001351	63	              TO COMM-CS-REVIEW-DATE OF DFHCOMMAREA.	0	0	1
63001353	63	      *	1	0	0
63001354	63	      *    Set a flag to indicate that this is preserved	1	0	1
63001355	63	      *    UPDATE data	1	0	1
63001356	63	      *	1	0	1
63001357	63	           MOVE 'Y'      TO COMM-UPD.	0	0	0
63001359	63	      *	1	0	0
63001360	63	      *    At the moment the fields are protected, but we	1	0	1
63001361	63	      *    need to allow editing on the map for Customer Name	1	0	1
63001362	63	      *    and Customer Address, the remaining fields	1	0	1
63001363	63	      *    (Customer Sortcode, and DOB) are already protected.	1	0	1
63001364	63	      *	1	0	1
63001366	63	           MOVE DFHGREEN TO CUSTNAMC.	0	0	0
63001367	63	           MOVE 'A' TO CUSTNAMA.	0	0	1
63001368	63	           MOVE DFHUNDLN TO CUSTNAMH.	0	0	1
63001370	63	      *	1	0	0
63001371	63	      *    Postion the cursor at the customer name	1	0	1
63001372	63	      *	1	0	1
63001373	63	           MOVE -1 TO CUSTNAML.	0	0	0
63001375	63	           MOVE DFHGREEN TO CUSTAD1C.	0	0	1
63001376	63	           MOVE 'A' TO CUSTAD1A.	0	0	1
63001377	63	           MOVE DFHUNDLN TO CUSTAD1H.	0	0	1
63001379	63	           MOVE DFHGREEN TO CUSTAD2C.	0	0	1
63001380	63	           MOVE 'A' TO CUSTAD2A.	0	0	1
63001381	63	           MOVE DFHUNDLN TO CUSTAD2H.	0	0	1
63001383	63	           MOVE DFHGREEN TO CUSTAD3C.	0	0	1
63001384	63	           MOVE 'A' TO CUSTAD3A.	0	0	1
63001385	63	           MOVE DFHUNDLN TO CUSTAD3H.	0	0	1
63001387	63	      *	1	0	0
63001388	63	      *    The Customer Number field is editable and we	1	0	1
63001389	63	      *    need to dynamically protect that (to stop editing of it).	1	0	1
63001390	63	      *	1	0	1
63001391	63	           MOVE DFHBMASK TO CUSTNOA.	0	0	0
63001393	63	      *	1	0	0
63001394	63	      *    Also, make the Customer Number field white (neutral) the	1	0	1
63001395	63	      *    same as other protected fields and remove the underscore.	1	0	1
63001396	63	      *	1	0	1
63001397	63	           MOVE DFHNEUTR TO CUSTNOC.	0	0	0
63001398	63	           MOVE HIGH-VALUES  TO CUSTNOH.	0	0	1
63001400	63	       UCD999.	0	0	1
63001401	63	           EXIT.	0	0	1
63001404	63	       SEND-MAP SECTION.	0	0	1
63001405	63	       SM010.	0	0	1
63001406	63	      *	1	0	0
63001407	63	      *    If the map needs to have its data erased	1	0	1
63001408	63	      *	1	0	1
63001409	63	           IF SEND-ERASE	0	0	0
63001410	63	              EXEC CICS SEND MAP('BNK1DC')	0	0	1
63001411	63	                 MAPSET('BNK1DCM')	0	0	1
63001412	63	                 FROM(BNK1DCO)	0	0	1
63001413	63	                 ERASE	0	0	1
63001414	63	                 CURSOR	0	0	1
63001415	63	                 RESP(WS-CICS-RESP)	0	0	1
63001416	63	                 RESP2(WS-CICS-RESP2)	0	0	1
63001417	63	              END-EXEC	0	0	1
63001419	63	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63001420	63	      *	1	0	0
63001421	63	      *          Preserve the RESP and RESP2, then set up the	1	0	1
63001422	63	      *          standard ABEND info before getting the applid,	1	0	1
63001423	63	      *          date/time etc. and linking to the Abend Handler	1	0	1
63001424	63	      *          program.	1	0	1
63001425	63	      *	1	0	1
63001426	63	                 INITIALIZE ABNDINFO-REC	0	0	0
63001427	63	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63001428	63	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63001429	63	      *	1	0	0
63001430	63	      *          Get supplemental information	1	0	1
63001431	63	      *	1	0	1
63001432	63	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63001433	63	                 END-EXEC	0	0	1
63001435	63	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63001436	63	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63001438	63	                 PERFORM POPULATE-TIME-DATE	0	0	1
63001440	63	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63001441	63	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63001442	63	                       ':' DELIMITED BY SIZE,	0	0	1
63001443	63	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63001444	63	                        ':' DELIMITED BY SIZE,	0	0	1
63001445	63	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63001446	63	                        INTO ABND-TIME	0	0	1
63001447	63	                 END-STRING	0	0	1
63001449	63	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63001450	63	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
63001452	63	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63001453	63	                 END-EXEC	0	0	1
63001455	63	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63001457	63	                 STRING 'SM010 - SEND MAP ERASE FAIL '	0	0	1
63001458	63	                       DELIMITED BY SIZE,	0	0	1
63001459	63	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63001460	63	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63001461	63	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
63001462	63	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63001463	63	                       INTO ABND-FREEFORM	0	0	1
63001464	63	                 END-STRING	0	0	1
63001466	63	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63001467	63	                           COMMAREA(ABNDINFO-REC)	0	0	1
63001468	63	                 END-EXEC	0	0	1
63001470	63	                 INITIALIZE WS-FAIL-INFO	0	0	1
63001471	63	                 MOVE 'BNK1DCS - SM010 - SEND MAP ERASE FAIL '	0	0	1
63001472	63	                    TO WS-CICS-FAIL-MSG	0	0	1
63001473	63	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63001474	63	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63001476	63	                 PERFORM RESTORE-TERM-DEF	0	0	1
63001477	63	                 PERFORM ABEND-THIS-TASK	0	0	1
63001478	63	              END-IF	0	0	1
63001480	63	              GO TO SM999	0	0	1
63001481	63	           END-IF.	0	0	1
63001483	63	      *	1	0	0
63001484	63	      *    If the map just needs a resend of only the data	1	0	1
63001485	63	      *	1	0	1
63001486	63	           IF SEND-DATAONLY	0	0	0
63001487	63	              EXEC CICS SEND MAP('BNK1DC')	0	0	1
63001488	63	                 MAPSET('BNK1DCM')	0	0	1
63001489	63	                 FROM(BNK1DCO)	0	0	1
63001490	63	                 DATAONLY	0	0	1
63001491	63	                 CURSOR	0	0	1
63001492	63	                 RESP(WS-CICS-RESP)	0	0	1
63001493	63	                 RESP2(WS-CICS-RESP2)	0	0	1
63001494	63	              END-EXEC	0	0	1
63001496	63	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63001497	63	      *	1	0	0
63001498	63	      *          Preserve the RESP and RESP2, then set up the	1	0	1
63001499	63	      *          standard ABEND info before getting the applid,	1	0	1
63001500	63	      *          date/time etc. and linking to the Abend Handler	1	0	1
63001501	63	      *          program.	1	0	1
63001502	63	      *	1	0	1
63001503	63	                 INITIALIZE ABNDINFO-REC	0	0	0
63001504	63	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63001505	63	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63001506	63	      *	1	0	0
63001507	63	      *          Get supplemental information	1	0	1
63001508	63	      *	1	0	1
63001509	63	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63001510	63	                 END-EXEC	0	0	1
63001512	63	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63001513	63	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63001515	63	                 PERFORM POPULATE-TIME-DATE	0	0	1
63001517	63	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63001518	63	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63001519	63	                       ':' DELIMITED BY SIZE,	0	0	1
63001520	63	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63001521	63	                        ':' DELIMITED BY SIZE,	0	0	1
63001522	63	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63001523	63	                        INTO ABND-TIME	0	0	1
63001524	63	                 END-STRING	0	0	1
63001526	63	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63001527	63	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
63001529	63	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63001530	63	                 END-EXEC	0	0	1
63001532	63	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63001534	63	                 STRING 'SM010 - SEND MAP DATAONLY FAIL '	0	0	1
63001535	63	                       DELIMITED BY SIZE,	0	0	1
63001536	63	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63001537	63	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63001538	63	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
63001539	63	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63001540	63	                       INTO ABND-FREEFORM	0	0	1
63001541	63	                 END-STRING	0	0	1
63001543	63	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63001544	63	                           COMMAREA(ABNDINFO-REC)	0	0	1
63001545	63	                 END-EXEC	0	0	1
63001547	63	                 INITIALIZE WS-FAIL-INFO	0	0	1
63001548	63	                 MOVE 'BNK1DCS - SM010 - SEND MAP DATAONLY FAIL '	0	0	1
63001549	63	                    TO WS-CICS-FAIL-MSG	0	0	1
63001550	63	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63001551	63	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63001553	63	                 PERFORM RESTORE-TERM-DEF	0	0	1
63001554	63	                 PERFORM ABEND-THIS-TASK	0	0	1
63001555	63	              END-IF	0	0	1
63001557	63	              GO TO SM999	0	0	1
63001558	63	           END-IF.	0	0	1
63001560	63	      *	1	0	0
63001561	63	      *    If we have elected to send the map and a beep	1	0	1
63001562	63	      *	1	0	1
63001563	63	           IF SEND-DATAONLY-ALARM	0	0	0
63001564	63	              EXEC CICS SEND MAP('BNK1DC')	0	0	1
63001565	63	                 MAPSET('BNK1DCM')	0	0	1
63001566	63	                 FROM(BNK1DCO)	0	0	1
63001567	63	                 DATAONLY	0	0	1
63001568	63	                 CURSOR	0	0	1
63001569	63	                 ALARM	0	0	1
63001570	63	                 RESP(WS-CICS-RESP)	0	0	1
63001571	63	                 RESP2(WS-CICS-RESP2)	0	0	1
63001572	63	              END-EXEC	0	0	1
63001574	63	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63001575	63	      *	1	0	0
63001576	63	      *          Preserve the RESP and RESP2, then set up the	1	0	1
63001577	63	      *          standard ABEND info before getting the applid,	1	0	1
63001578	63	      *          date/time etc. and linking to the Abend Handler	1	0	1
63001579	63	      *          program.	1	0	1
63001580	63	      *	1	0	1
63001581	63	                 INITIALIZE ABNDINFO-REC	0	0	0
63001582	63	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63001583	63	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63001584	63	      *	1	0	0
63001585	63	      *          Get supplemental information	1	0	1
63001586	63	      *	1	0	1
63001587	63	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63001588	63	                 END-EXEC	0	0	1
63001590	63	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63001591	63	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63001593	63	                 PERFORM POPULATE-TIME-DATE	0	0	1
63001595	63	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63001596	63	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63001597	63	                       ':' DELIMITED BY SIZE,	0	0	1
63001598	63	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63001599	63	                        ':' DELIMITED BY SIZE,	0	0	1
63001600	63	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63001601	63	                        INTO ABND-TIME	0	0	1
63001602	63	                 END-STRING	0	0	1
63001604	63	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63001605	63	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
63001607	63	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63001608	63	                 END-EXEC	0	0	1
63001610	63	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63001612	63	                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL '	0	0	1
63001613	63	                       DELIMITED BY SIZE,	0	0	1
63001614	63	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63001615	63	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63001616	63	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
63001617	63	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63001618	63	                       INTO ABND-FREEFORM	0	0	1
63001619	63	                 END-STRING	0	0	1
63001621	63	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63001622	63	                           COMMAREA(ABNDINFO-REC)	0	0	1
63001623	63	                 END-EXEC	0	0	1
63001626	63	                 INITIALIZE WS-FAIL-INFO	0	0	1
63001627	63	                 MOVE 'BNK1DCS - SM010 - SEND MAP DATAONLY ALARM FAIL '	0	0	1
63001628	63	                    TO WS-CICS-FAIL-MSG	0	0	1
63001629	63	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63001630	63	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63001632	63	                 PERFORM RESTORE-TERM-DEF	0	0	1
63001633	63	                 PERFORM ABEND-THIS-TASK	0	0	1
63001634	63	              END-IF	0	0	1
63001636	63	           END-IF.	0	0	1
63001638	63	       SM999.	0	0	1
63001639	63	           EXIT.	0	0	1
63001642	63	       STORE-TERM-DEF SECTION.	0	0	1
63001643	63	       STD010.	0	0	1
63001645	63	      *	1	0	0
63001646	63	      *    Inquire on the terminal and store the UCTRANS settings	1	0	1
63001647	63	      *	1	0	1
63001648	63	           EXEC CICS INQUIRE	0	0	0
63001649	63	                TERMINAL(EIBTRMID)	0	0	1
63001650	63	                UCTRANST(WS-UCTRANS)	0	0	1
63001651	63	                RESP(WS-CICS-RESP)	0	0	1
63001652	63	                RESP2(WS-CICS-RESP2)	0	0	1
63001653	63	           END-EXEC.	0	0	1
63001655	63	      *	1	0	0
63001656	63	      *    Store the original UCTRAN value	1	0	1
63001657	63	      *	1	0	1
63001658	63	           MOVE WS-UCTRANS TO STORED-UCTRANS.	0	0	0
63001660	63	      *	1	0	0
63001661	63	      *    If Uppercase translation is switched on,	1	0	1
63001662	63	      *    then set it to NOUCTRAN(451).	1	0	1
63001663	63	      *	1	0	1
63001664	63	           IF WS-UCTRANS = DFHVALUE(UCTRAN) OR	0	0	0
63001665	63	           WS-UCTRANS = DFHVALUE(TRANIDONLY)	0	0	1
63001667	63	              MOVE DFHVALUE(NOUCTRAN) TO WS-UCTRANS	0	0	1
63001669	63	              EXEC CICS SET TERMINAL(EIBTRMID)	0	0	1
63001670	63	                 UCTRANST(WS-UCTRANS)	0	0	1
63001671	63	                 RESP(WS-CICS-RESP)	0	0	1
63001672	63	                 RESP2(WS-CICS-RESP2)	0	0	1
63001673	63	              END-EXEC	0	0	1
63001676	63	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63001677	63	      *	1	0	0
63001678	63	      *          Preserve the RESP and RESP2, then set up the	1	0	1
63001679	63	      *          standard ABEND info before getting the applid,	1	0	1
63001680	63	      *          date/time etc. and linking to the Abend Handler	1	0	1
63001681	63	      *          program.	1	0	1
63001682	63	      *	1	0	1
63001683	63	                 INITIALIZE ABNDINFO-REC	0	0	0
63001684	63	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63001685	63	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63001686	63	      *	1	0	0
63001687	63	      *          Get supplemental information	1	0	1
63001688	63	      *	1	0	1
63001689	63	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63001690	63	                 END-EXEC	0	0	1
63001692	63	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63001693	63	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63001695	63	                 PERFORM POPULATE-TIME-DATE	0	0	1
63001697	63	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63001698	63	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63001699	63	                       ':' DELIMITED BY SIZE,	0	0	1
63001700	63	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63001701	63	                       ':' DELIMITED BY SIZE,	0	0	1
63001702	63	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63001703	63	                        INTO ABND-TIME	0	0	1
63001704	63	                 END-STRING	0	0	1
63001706	63	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63001707	63	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
63001709	63	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63001710	63	                 END-EXEC	0	0	1
63001712	63	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63001714	63	                 STRING 'STD010 - SET TERMINAL UC FAIL '	0	0	1
63001715	63	                       DELIMITED BY SIZE,	0	0	1
63001716	63	                       'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63001717	63	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63001718	63	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
63001719	63	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63001720	63	                       INTO ABND-FREEFORM	0	0	1
63001721	63	                 END-STRING	0	0	1
63001723	63	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63001724	63	                           COMMAREA(ABNDINFO-REC)	0	0	1
63001725	63	                 END-EXEC	0	0	1
63001728	63	                 INITIALIZE WS-FAIL-INFO	0	0	1
63001729	63	                 MOVE 'BNK1DCS - STD010 - SET TERMINAL UC FAIL ' TO	0	0	1
63001730	63	                    WS-CICS-FAIL-MSG	0	0	1
63001731	63	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63001732	63	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63001734	63	                 PERFORM RESTORE-TERM-DEF	0	0	1
63001735	63	                 PERFORM ABEND-THIS-TASK	0	0	1
63001736	63	              END-IF	0	0	1
63001737	63	           END-IF.	0	0	1
63001739	63	       STD999.	0	0	1
63001740	63	           EXIT.	0	0	1
63001743	63	       RESTORE-TERM-DEF SECTION.	0	0	1
63001744	63	       RTD010.	0	0	1
63001745	63	      *	1	0	0
63001746	63	      *    We must now restore the UCTRAN setting back to what it	1	0	1
63001747	63	      *    was at the start	1	0	1
63001748	63	      *	1	0	1
63001750	63	           MOVE DFHCOMMAREA TO WS-COMM-AREA.	0	0	0
63001752	63	           MOVE WS-COMM-TERM TO WS-UCTRANS.	0	0	1
63001754	63	           EXEC CICS SET TERMINAL(EIBTRMID)	0	0	1
63001755	63	               UCTRANST(WS-UCTRANS)	0	0	1
63001756	63	               RESP(WS-CICS-RESP)	0	0	1
63001757	63	               RESP2(WS-CICS-RESP2)	0	0	1
63001758	63	           END-EXEC.	0	0	1
63001760	63	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63001761	63	      *	1	0	0
63001762	63	      *       Preserve the RESP and RESP2, then set up the	1	0	1
63001763	63	      *       standard ABEND info before getting the applid,	1	0	1
63001764	63	      *       date/time etc. and linking to the Abend Handler	1	0	1
63001765	63	      *       program.	1	0	1
63001766	63	      *	1	0	1
63001767	63	              INITIALIZE ABNDINFO-REC	0	0	0
63001768	63	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63001769	63	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63001770	63	      *	1	0	0
63001771	63	      *       Get supplemental information	1	0	1
63001772	63	      *	1	0	1
63001773	63	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63001774	63	              END-EXEC	0	0	1
63001776	63	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63001777	63	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63001779	63	              PERFORM POPULATE-TIME-DATE	0	0	1
63001781	63	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63001782	63	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63001783	63	                    ':' DELIMITED BY SIZE,	0	0	1
63001784	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63001785	63	                     ':' DELIMITED BY SIZE,	0	0	1
63001786	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63001787	63	                     INTO ABND-TIME	0	0	1
63001788	63	              END-STRING	0	0	1
63001790	63	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63001791	63	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
63001793	63	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63001794	63	              END-EXEC	0	0	1
63001796	63	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63001798	63	              STRING 'RTD010 - SET TERMINAL UC FAIL'	0	0	1
63001799	63	                    DELIMITED BY SIZE,	0	0	1
63001800	63	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63001801	63	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63001802	63	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
63001803	63	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63001804	63	                    INTO ABND-FREEFORM	0	0	1
63001805	63	              END-STRING	0	0	1
63001807	63	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63001808	63	                        COMMAREA(ABNDINFO-REC)	0	0	1
63001809	63	              END-EXEC	0	0	1
63001811	63	              INITIALIZE WS-FAIL-INFO	0	0	1
63001812	63	              MOVE 'BNK1DCS - RTD010 - SET TERMINAL UC FAIL '	0	0	1
63001813	63	                 TO WS-CICS-FAIL-MSG	0	0	1
63001814	63	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63001815	63	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63001816	63	      *	1	0	0
63001817	63	      *       If restoring the terminal definition	1	0	1
63001818	63	      *       doesn't work, we can't	1	0	1
63001819	63	      *       do it again. This led to AICA abends!	1	0	1
63001820	63	      *	1	0	1
63001821	63	              PERFORM ABEND-THIS-TASK	0	0	0
63001822	63	           END-IF.	0	0	1
63001824	63	       RTD999.	0	0	1
63001825	63	           EXIT.	0	0	1
63001828	63	       SEND-TERMINATION-MSG SECTION.	0	0	1
63001829	63	       STM010.	0	0	1
63001830	63	      *	1	0	0
63001831	63	      *    Send the termination message	1	0	1
63001832	63	      *	1	0	1
63001833	63	           EXEC CICS SEND TEXT	0	0	0
63001834	63	              FROM(END-OF-SESSION-MESSAGE)	0	0	1
63001835	63	              ERASE	0	0	1
63001836	63	              FREEKB	0	0	1
63001837	63	              RESP(WS-CICS-RESP)	0	0	1
63001838	63	              RESP2(WS-CICS-RESP2)	0	0	1
63001839	63	           END-EXEC.	0	0	1
63001841	63	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
63001842	63	      *	1	0	0
63001843	63	      *       Preserve the RESP and RESP2, then set up the	1	0	1
63001844	63	      *       standard ABEND info before getting the applid,	1	0	1
63001845	63	      *       date/time etc. and linking to the Abend Handler	1	0	1
63001846	63	      *       program.	1	0	1
63001847	63	      *	1	0	1
63001848	63	              INITIALIZE ABNDINFO-REC	0	0	0
63001849	63	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
63001850	63	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
63001851	63	      *	1	0	0
63001852	63	      *       Get supplemental information	1	0	1
63001853	63	      *	1	0	1
63001854	63	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
63001855	63	              END-EXEC	0	0	1
63001857	63	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
63001858	63	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
63001860	63	              PERFORM POPULATE-TIME-DATE	0	0	1
63001862	63	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
63001863	63	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
63001864	63	                    ':' DELIMITED BY SIZE,	0	0	1
63001865	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
63001866	63	                     ':' DELIMITED BY SIZE,	0	0	1
63001867	63	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
63001868	63	                     INTO ABND-TIME	0	0	1
63001869	63	              END-STRING	0	0	1
63001871	63	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
63001872	63	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
63001874	63	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
63001875	63	              END-EXEC	0	0	1
63001877	63	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
63001879	63	              STRING 'STM010 - SEND TEXT FAIL'	0	0	1
63001880	63	                    DELIMITED BY SIZE,	0	0	1
63001881	63	                    'EIBRESP=' DELIMITED BY SIZE,	0	0	1
63001882	63	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
63001883	63	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
63001884	63	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
63001885	63	                    INTO ABND-FREEFORM	0	0	1
63001886	63	              END-STRING	0	0	1
63001888	63	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
63001889	63	                        COMMAREA(ABNDINFO-REC)	0	0	1
63001890	63	              END-EXEC	0	0	1
63001893	63	              INITIALIZE WS-FAIL-INFO	0	0	1
63001894	63	              MOVE 'BNK1DCS - STM010 - SEND TEXT FAIL'	0	0	1
63001895	63	                 TO WS-CICS-FAIL-MSG	0	0	1
63001896	63	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
63001897	63	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
63001899	63	              PERFORM RESTORE-TERM-DEF	0	0	1
63001900	63	              PERFORM ABEND-THIS-TASK	0	0	1
63001901	63	           END-IF.	0	0	1
63001903	63	       STM999.	0	0	1
63001904	63	           EXIT.	0	0	1
63001907	63	       ABEND-THIS-TASK SECTION.	0	0	1
63001908	63	       ATT010.	0	0	1
63001909	63	           DISPLAY WS-FAIL-INFO.	0	0	1
63001911	63	           EXEC CICS ABEND	0	0	1
63001912	63	              ABCODE('HBNK')	0	0	1
63001913	63	              NODUMP	0	0	1
63001914	63	              CANCEL	0	0	1
63001915	63	           END-EXEC.	0	0	1
63001917	63	       ATT999.	0	0	1
63001918	63	           EXIT.	0	0	1
63001921	63	       POPULATE-TIME-DATE SECTION.	0	0	1
63001922	63	       PTD10.	0	0	1
63001923	63	      D    DISPLAY 'POPULATE-TIME-DATE SECTION'.	0	0	1
63001925	63	           EXEC CICS ASKTIME	0	0	1
63001926	63	              ABSTIME(WS-U-TIME)	0	0	1
63001927	63	           END-EXEC.	0	0	1
63001929	63	           EXEC CICS FORMATTIME	0	0	1
63001930	63	                     ABSTIME(WS-U-TIME)	0	0	1
63001931	63	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
63001932	63	                     TIME(WS-TIME-NOW)	0	0	1
63001933	63	                     DATESEP	0	0	1
63001934	63	           END-EXEC.	0	0	1
63001936	63	       PTD999.	0	0	1
63001937	63	           EXIT.	0	0	1
63001940	63	       PROT-CUST-DATA SECTION.	0	0	1
63001941	63	       PCD010.	0	0	1
63001942	63	      *	1	0	0
63001943	63	      *    Resolve data on the map	1	0	1
63001944	63	      *	1	0	1
63001945	63	           MOVE COMM-SCODE OF UPDCUST-COMMAREA TO SORTCO.	0	0	0
63001946	63	           MOVE COMM-CUSTNO OF UPDCUST-COMMAREA TO CUSTNO2O.	0	0	1
63001947	63	           MOVE COMM-NAME OF UPDCUST-COMMAREA   TO CUSTNAMO.	0	0	1
63001949	63	           MOVE COMM-ADDR OF UPDCUST-COMMAREA TO COMM-ADDR-SPLIT.	0	0	1
63001950	63	           MOVE COMM-ADDR-SPLIT1     TO CUSTAD1O.	0	0	1
63001951	63	           MOVE COMM-ADDR-SPLIT2     TO CUSTAD2O.	0	0	1
63001952	63	           MOVE COMM-ADDR-SPLIT3     TO CUSTAD3O.	0	0	1
63001954	63	           MOVE COMM-DOB OF UPDCUST-COMMAREA TO COMM-DOB-SPLIT.	0	0	1
63001955	63	           MOVE COMM-DOB-SPLIT-DD    TO DOBDDO.	0	0	1
63001956	63	           MOVE COMM-DOB-SPLIT-MM    TO DOBMMO.	0	0	1
63001957	63	           MOVE COMM-DOB-SPLIT-YYYY  TO DOBYYO.	0	0	1
63001959	63	           MOVE 'CUST'   TO COMM-EYE OF DFHCOMMAREA.	0	0	1
63001960	63	           MOVE SORTCO   TO COMM-SCODE OF DFHCOMMAREA.	0	0	1
63001961	63	           MOVE CUSTNO2O TO COMM-CUSTNO OF DFHCOMMAREA.	0	0	1
63001962	63	           MOVE CUSTNAMO TO COMM-NAME OF DFHCOMMAREA.	0	0	1
63001964	63	           MOVE CUSTAD1O TO COMM-ADDR-UPD1.	0	0	1
63001965	63	           MOVE CUSTAD2O TO COMM-ADDR-UPD2.	0	0	1
63001966	63	           MOVE CUSTAD3O TO COMM-ADDR-UPD3.	0	0	1
63001967	63	           MOVE COMM-ADDR-UPD-SPLIT TO COMM-ADDR OF DFHCOMMAREA.	0	0	1
63001970	63	           MOVE DOBDDO   TO COMM-DOBX-DD.	0	0	1
63001971	63	           MOVE DOBMMO   TO COMM-DOBX-MM.	0	0	1
63001972	63	           MOVE DOBYYO   TO COMM-DOBX-YYYY.	0	0	1
63001973	63	           MOVE COMM-DOB-UPD-9 TO COMM-DOB OF DFHCOMMAREA.	0	0	1
63001975	63	           MOVE CREDSCO  TO CREDIT-SCORE-X.	0	0	1
63001976	63	           MOVE CREDIT-SCORE-9 TO COMM-CREDIT-SCORE OF DFHCOMMAREA.	0	0	1
63001978	63	           MOVE SCRDTDDO TO COMM-CS-REVIEWX-DD.	0	0	1
63001979	63	           MOVE SCRDTMMO TO COMM-CS-REVIEWX-MM.	0	0	1
63001980	63	           MOVE SCRDTYYO TO COMM-CS-REVIEWX-YYYY.	0	0	1
63001982	63	           MOVE COMM-CS-REVIEW-UPD-9	0	0	1
63001983	63	              TO COMM-CS-REVIEW-DATE OF DFHCOMMAREA.	0	0	1
63001985	63	      *	1	0	0
63001986	63	      *    Set a flag to indicate that this is preserved UPDATE data	1	0	1
63001987	63	      *	1	0	1
63001988	63	           MOVE 'N'      TO COMM-UPD.	0	0	0
63001990	63	      *	1	0	0
63001991	63	      *    At the moment the fields are protected, but we need to allow	1	0	1
63001992	63	      *    editing on the map for Customer Name and Customer Address,	1	0	1
63001993	63	      *    the remaining fields (Customer Sortcode, and DOB) are already	1	0	1
63001994	63	      *    protected.	1	0	1
63001995	63	      *	1	0	1
63001996	63	           MOVE DFHNEUTR TO CUSTNO2C.	0	0	0
63001997	63	           MOVE DFHBMPRF TO CUSTNO2A.	0	0	1
63001999	63	           MOVE DFHNEUTR TO CUSTNAMC.	0	0	1
63002000	63	           MOVE DFHBMPRF TO CUSTNAMA.	0	0	1
63002001	63	           MOVE HIGH-VALUES  TO CUSTNAMH.	0	0	1
63002003	63	      *	1	0	0
63002004	63	      *    Postion the cursor at the customer number	1	0	1
63002005	63	      *	1	0	1
63002006	63	           MOVE -1 TO CUSTNOL.	0	0	0
63002009	63	           MOVE DFHNEUTR TO CUSTAD1C.	0	0	1
63002010	63	           MOVE DFHBMPRF TO CUSTAD1A.	0	0	1
63002011	63	           MOVE HIGH-VALUES  TO CUSTAD1H.	0	0	1
63002012	63	.	0	0	1
63002014	63	           MOVE DFHNEUTR TO CUSTAD2C.	0	0	1
63002015	63	           MOVE DFHBMPRF TO CUSTAD2A.	0	0	1
63002016	63	           MOVE HIGH-VALUES  TO CUSTAD2H.	0	0	1
63002019	63	           MOVE DFHNEUTR TO CUSTAD3C.	0	0	1
63002020	63	           MOVE DFHBMPRF TO CUSTAD3A.	0	0	1
63002021	63	           MOVE HIGH-VALUES  TO CUSTAD3H.	0	0	1
63002023	63	      *	1	0	0
63002024	63	      *    The Customer Number field is editable and we	1	0	1
63002025	63	      *    need to allow this again	1	0	1
63002026	63	      *	1	0	1
63002027	63	           MOVE DFHBMFSE TO CUSTNOA.	0	0	0
63002029	63	      *	1	0	0
63002030	63	      *    Also, make the Customer Number field green the	1	0	1
63002031	63	      *    same as other unprotected fields and add the underscore.	1	0	1
63002032	63	      *	1	0	1
63002033	63	           MOVE DFHGREEN TO CUSTNOC.	0	0	0
63002034	63	           MOVE DFHUNDLN TO CUSTNOH.	0	0	1
63002035	63	           MOVE COMM-CUSTNO OF UPDCUST-COMMAREA TO CUSTNOO CUSTNO2O.	0	0	1
63002037	63	       PCD999.	0	0	1
63002038	63	           EXIT.	0	0	1
63002041	63	       ABEND-HANDLING SECTION.	0	0	1
63002042	63	       AH010.	0	0	1
63002043	63	           PERFORM RESTORE-TERM-DEF.	0	0	1
63002045	63	           EXEC CICS HANDLE	0	0	1
63002046	63	              ABEND	0	0	1
63002047	63	              CANCEL	0	0	1
63002048	63	           END-EXEC.	0	0	1
63002050	63	           PERFORM ABEND-THIS-TASK.	0	0	1
63002052	63	       AH999.	0	0	1
63002053	63	           EXIT.	0	0	1
64000000	64	<<<< file not found >>>>	0	0	0
64000001	64	<<<< file not found >>>>	0	0	0
65000000	65	<<<< included file >>>>	0	0	0
65000001	65	*******                                                                 01000000	1	0	0
65000002	65	*******   COPYRIGHT = 5655-018 (C) COPYRIGHT IBM CORP. 1985  =          01100000	1	0	0
65000003	65	*******               THIS MODULE IS "RESTRICTED MATERIALS OF=IBM"      01200000	1	0	0
65000004	65	*******               LICENSED MATERIALS - PROPERTY OF IBM   =          01300000	1	0	0
65000005	65	*******               REFER TO COPYRIGHT INSTRUCTIONS        =          01400000	1	0	0
65000006	65	*******               FORM NUMBER G120-2083                  =          01500000	1	0	0
65000007	65	*******                                                                 01600000	1	0	0
65000008	65	       01      DFHBMSCA.                                                02000000	0	0	1
65000009	65	         02    DFHBMPEM  PICTURE X   VALUE  IS  '^'.                    04000000	0	0	0
65000010	65	         02    DFHBMPNL  PICTURE X   VALUE  IS  ' '.                    06000000	0	0	0
65000011	65	         02    DFHBMPFF  PICTURE X   VALUE  IS  ' '.                    06600000	0	0	0
65000012	65	         02    DFHBMPCR  PICTURE X   VALUE  IS  ' '.                    07300000	0	0	0
65000013	65	         02    DFHBMASK  PICTURE X   VALUE  IS  '0'.                    08000000	0	0	0
65000014	65	         02    DFHBMUNP  PICTURE X   VALUE  IS  ' '.                    10000000	0	0	0
65000015	65	         02    DFHBMUNN  PICTURE X   VALUE  IS  '&'.                    12000000	0	0	0
65000016	65	         02    DFHBMPRO  PICTURE X   VALUE  IS  '-'.                    14000000	0	0	0
65000017	65	         02    DFHBMBRY  PICTURE X   VALUE  IS  'H'.                    16000000	0	0	0
65000018	65	         02    DFHBMDAR  PICTURE X   VALUE  IS  '<'.                    18000000	0	0	0
65000019	65	         02    DFHBMFSE  PICTURE X   VALUE  IS  'A'.                    20000000	0	0	0
65000020	65	         02    DFHBMPRF  PICTURE X   VALUE  IS  '/'.                    22000000	0	0	0
65000021	65	         02    DFHBMASF  PICTURE X   VALUE  IS  '1'.                    24000000	0	0	0
65000022	65	         02    DFHBMASB  PICTURE X   VALUE  IS  '8'.                    26000000	0	0	0
65000023	65	         02    DFHBMEOF  PICTURE X   VALUE  IS  'Ø'.                    26600000	0	0	0
65000024	65	         02    DFHBMCUR  PICTURE X   VALUE  IS  ' '.                    26700000	0	0	0
65000025	65	         02    DFHBMEC   PICTURE X   VALUE  IS  'b'.                    26800000	0	0	0
65000026	65	         02    DFHBMFLG  PICTURE X.                                     26900000	0	0	0
65000027	65	             88    DFHERASE VALUES ARE 'Ø', 'b'.                        27000000	0	0	0
65000028	65	             88    DFHCURSR VALUES ARE ' ', 'b'.                        27100000	0	0	0
65000029	65	         02    DFHBMDET  PICTURE X   VALUE  IS  ' '.                    27300000	0	0	0
65000030	65	         02    DFHBMPSO-BIN PIC 9(4) COMP VALUE 3599.                   27500000	0	0	0
65000031	65	******* ABOVE VALUE 3599 = X'0E0F' ADDED BY PTM 81385 (APAR PN23267)    27700000	1	0	1
65000032	65	         02    FILLER REDEFINES DFHBMPSO-BIN.                           27770000	0	0	1
65000033	65	           03  DFHBMPSO  PICTURE X.                                     27840000	0	0	0
65000034	65	           03  DFHBMPSI  PICTURE X.                                     27910000	0	0	0
65000035	65	         02    DFHSA     PICTURE X   VALUE  IS  ' '.                    28000000	0	0	0
65000036	65	         02    DFHCOLOR  PICTURE X   VALUE  IS  'â'.                    30000000	0	0	0
65000037	65	         02    DFHPS     PICTURE X   VALUE  IS  '{'.                    32000000	0	0	0
65000038	65	         02    DFHHLT    PICTURE X   VALUE  IS  ' '.                    34000000	0	0	0
65000039	65	         02    DFH3270   PICTURE X   VALUE  IS  'ä'.                    37000000	0	0	0
65000040	65	         02    DFHVAL    PICTURE X   VALUE  IS  'A'.                    40000000	0	0	0
65000041	65	         02    DFHOUTLN  PICTURE X   VALUE  IS  'B'.                    41000000	0	0	0
65000042	65	         02    DFHBKTRN  PICTURE X   VALUE  IS  'ã'.                    42000000	0	0	0
65000043	65	         02    DFHALL    PICTURE X   VALUE  IS  ' '.                    43000000	0	0	0
65000044	65	         02    DFHERROR  PICTURE X   VALUE  IS  ''.                     46000000	0	0	0
65000045	65	         02    DFHDFT    PICTURE X   VALUE  IS  ' '.                    49000000	0	0	0
65000046	65	         02    DFHDFCOL  PICTURE X   VALUE  IS  ' '.                    52000000	0	0	0
65000047	65	         02    DFHBLUE   PICTURE X   VALUE  IS  '1'.                    55000000	0	0	0
65000048	65	         02    DFHRED    PICTURE X   VALUE  IS  '2'.                    58000000	0	0	0
65000049	65	         02    DFHPINK   PICTURE X   VALUE  IS  '3'.                    61000000	0	0	0
65000050	65	         02    DFHGREEN  PICTURE X   VALUE  IS  '4'.                    640000	0	0	0
65000051	65	         02    DFHTURQ   PICTURE X   VALUE  IS  '5'.                    640000	0	0	0
65000052	65	         02    DFHYELLO  PICTURE X   VALUE  IS  '5'.                    640000	0	0	0
65000053	65	         02    DFHNEUTR  PICTURE X   VALUE  IS  '6'.                    640000	0	0	0
66000001	66	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	0
66000002	66	       CBL CICS('SP,EDF')	0	0	1
66000003	66	      ******************************************************************	1	0	0
66000004	66	      *                                                                *	1	0	1
66000005	66	      *  Copyright IBM Corp. 2023                                      *	1	0	1
66000006	66	      *                                                                *	1	0	1
66000007	66	      ******************************************************************	1	0	1
66000010	66	      ******************************************************************	1	0	1
66000011	66	      * This is the BANK MENU (i.e. the first program initiated by the	1	0	1
66000012	66	      * BMS suite). It displays the map and allows the user to select	1	0	1
66000013	66	      * an option, validates the option number/letter and returns with	1	0	1
66000014	66	      * the appropriate transaction.	1	0	1
66000015	66	      *	1	0	1
66000016	66	      ******************************************************************	1	0	1
66000017	66	       IDENTIFICATION DIVISION.	0	0	0
66000018	66	       PROGRAM-ID. BNKMENU.	0	0	1
66000019	66	       AUTHOR. Jon Collett.	0	0	1
66000021	66	       ENVIRONMENT DIVISION.	0	0	1
66000022	66	       CONFIGURATION SECTION.	0	0	1
66000023	66	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
66000024	66	        SOURCE-COMPUTER.  IBM-370.	0	0	0
66000025	66	       OBJECT-COMPUTER.  IBM-370.	0	0	1
66000027	66	       INPUT-OUTPUT SECTION.	0	0	1
66000030	66	       DATA DIVISION.	0	0	1
66000031	66	       WORKING-STORAGE SECTION.	0	0	1
66000033	66	       01 WS-CICS-WORK-AREA.	0	0	1
66000034	66	          03 WS-CICS-RESP              PIC S9(8) COMP VALUE 0.	0	0	1
66000035	66	          03 WS-CICS-RESP2             PIC S9(8) COMP VALUE 0.	0	0	1
66000037	66	       01 WS-FAIL-INFO.	0	0	1
66000038	66	          03 FILLER                    PIC X(9) VALUE 'BNKMENU  '.	0	0	1
66000039	66	          03 WS-CICS-FAIL-MSG          PIC X(70) VALUE ' '.	0	0	1
66000040	66	          03 FILLER                    PIC X(6)  VALUE ' RESP='.	0	0	1
66000041	66	          03 WS-CICS-RESP-DISP         PIC 9(10) VALUE 0.	0	0	1
66000042	66	          03 FILLER                    PIC X(7)  VALUE ' RESP2='.	0	0	1
66000043	66	          03 WS-CICS-RESP2-DISP        PIC 9(10) VALUE 0.	0	0	1
66000044	66	          03 FILLER                   PIC X(15) VALUE ' ABENDING TASK.'.	0	0	1
66000046	66	       01 SWITCHES.	0	0	1
66000047	66	           03 VALID-DATA-SW            PIC X VALUE 'Y'.	0	0	1
66000048	66	              88 VALID-DATA                VALUE 'Y'.	0	0	1
66000050	66	       01 FLAGS.	0	0	1
66000051	66	           03 SEND-FLAG                PIC X.	0	0	1
66000052	66	              88 SEND-ERASE              VALUE '1'.	0	0	1
66000053	66	              88 SEND-DATAONLY           VALUE '2'.	0	0	1
66000054	66	              88 SEND-DATAONLY-ALARM     VALUE '3'.	0	0	1
66000056	66	       01 ACTION-ALPHA.	0	0	1
66000057	66	           03 ACTION-CHAR              PIC X.	0	0	1
66000059	66	      *	1	0	0
66000060	66	      * The end of session message	1	0	1
66000061	66	      *	1	0	1
66000062	66	       01 END-OF-SESSION-MESSAGE       PIC X(13) VALUE 'Session Ended'.	0	0	0
66000064	66	       01 RESPONSE-CODE                PIC S9(8) COMP.	0	0	1
66000066	66	       01 COMMUNICATION-AREA           PIC X.	0	0	1
66000068	66	       COPY BNK1MAI.	0	0	1
66000070	66	       COPY DFHAID.	0	0	1
66000072	66	       01 WS-U-TIME                    PIC S9(15) COMP-3.	0	0	1
66000073	66	       01 WS-ORIG-DATE                 PIC X(10).	0	0	1
66000074	66	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
66000075	66	          03 WS-ORIG-DATE-DD           PIC 99.	0	0	1
66000076	66	          03 FILLER                    PIC X.	0	0	1
66000077	66	          03 WS-ORIG-DATE-MM           PIC 99.	0	0	1
66000078	66	          03 FILLER                    PIC X.	0	0	1
66000079	66	          03 WS-ORIG-DATE-YYYY         PIC 9999.	0	0	1
66000081	66	       01 WS-ORIG-DATE-GRP-X.	0	0	1
66000082	66	          03 WS-ORIG-DATE-DD-X         PIC XX.	0	0	1
66000083	66	          03 FILLER                    PIC X VALUE '.'.	0	0	1
66000084	66	          03 WS-ORIG-DATE-MM-X         PIC XX.	0	0	1
66000085	66	          03 FILLER                    PIC X VALUE '.'.	0	0	1
66000086	66	          03 WS-ORIG-DATE-YYYY-X       PIC X(4).	0	0	1
66000089	66	       01 WS-TIME-DATA.	0	0	1
66000090	66	           03 WS-TIME-NOW              PIC 9(6).	0	0	1
66000091	66	           03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
66000092	66	              05 WS-TIME-NOW-GRP-HH       PIC 99.	0	0	1
66000093	66	              05 WS-TIME-NOW-GRP-MM       PIC 99.	0	0	1
66000094	66	              05 WS-TIME-NOW-GRP-SS       PIC 99.	0	0	1
66000096	66	       01 WS-ABEND-PGM                 PIC X(8) VALUE 'ABNDPROC'.	0	0	1
66000098	66	       01 ABNDINFO-REC.	0	0	1
66000099	66	           COPY ABNDINFO.	0	0	1
66000102	66	       LINKAGE SECTION.	0	0	1
66000104	66	       01 DFHCOMMAREA                  PIC X.	0	0	1
66000107	66	       PROCEDURE DIVISION.	0	0	1
66000108	66	       PREMIERE SECTION.	0	0	1
66000109	66	       A010.	0	0	1
66000111	66	           EVALUATE TRUE	0	0	1
66000112	66	      *	1	0	0
66000113	66	      *       Is it the first time through? If so, send the map	1	0	1
66000114	66	      *       with erased (empty) data fields.	1	0	1
66000115	66	      *	1	0	1
66000116	66	              WHEN EIBCALEN = ZERO	0	0	0
66000117	66	                 MOVE LOW-VALUE TO BNK1MEO	0	0	1
66000118	66	                 MOVE -1 TO ACTIONL	0	0	1
66000119	66	                 SET SEND-ERASE TO TRUE	0	0	1
66000120	66	                 PERFORM SEND-MAP	0	0	1
66000122	66	      *	1	0	0
66000123	66	      *       If a PA key is pressed, just carry on	1	0	1
66000124	66	      *	1	0	1
66000125	66	              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3	0	0	0
66000126	66	                 CONTINUE	0	0	1
66000128	66	      *	1	0	0
66000129	66	      *       When Pf3 or Pf12 is pressed, terminate	1	0	1
66000130	66	      *	1	0	1
66000131	66	              WHEN EIBAID = DFHPF3 OR DFHPF12	0	0	0
66000132	66	                 PERFORM SEND-TERMINATION-MSG	0	0	1
66000134	66	                 EXEC CICS	0	0	1
66000135	66	                    RETURN	0	0	1
66000136	66	                 END-EXEC	0	0	1
66000138	66	      *	1	0	0
66000139	66	      *       When CLEAR is pressed	1	0	1
66000140	66	      *	1	0	1
66000141	66	              WHEN EIBAID = DFHCLEAR	0	0	0
66000142	66	                EXEC CICS SEND CONTROL	0	0	1
66000143	66	                          ERASE	0	0	1
66000144	66	                          FREEKB	0	0	1
66000145	66	                END-EXEC	0	0	1
66000146	66	                EXEC CICS RETURN	0	0	1
66000147	66	                END-EXEC	0	0	1
66000149	66	      *	1	0	0
66000150	66	      *       When enter is pressed then process the content	1	0	1
66000151	66	      *	1	0	1
66000152	66	              WHEN EIBAID = DFHENTER	0	0	0
66000153	66	                 PERFORM PROCESS-MENU-MAP	0	0	1
66000155	66	      *	1	0	0
66000156	66	      *       When anything else happens, send the invalid key message	1	0	1
66000157	66	      *	1	0	1
66000158	66	              WHEN OTHER	0	0	0
66000159	66	                 MOVE LOW-VALUES TO BNK1MEO	0	0	1
66000160	66	                 MOVE 'Invalid key pressed.' TO MESSAGEO	0	0	1
66000161	66	                 MOVE -1 TO ACTIONL	0	0	1
66000162	66	                 SET SEND-DATAONLY-ALARM TO TRUE	0	0	1
66000163	66	                 PERFORM SEND-MAP	0	0	1
66000165	66	           END-EVALUATE.	0	0	1
66000167	66	      *	1	0	0
66000168	66	      *    Now RETURN	1	0	1
66000169	66	      *	1	0	1
66000170	66	           EXEC CICS	0	0	0
66000171	66	              RETURN TRANSID('OMEN')	0	0	1
66000172	66	              COMMAREA(COMMUNICATION-AREA)	0	0	1
66000173	66	              LENGTH(1)	0	0	1
66000174	66	              RESP(WS-CICS-RESP)	0	0	1
66000175	66	              RESP2(WS-CICS-RESP2)	0	0	1
66000176	66	           END-EXEC.	0	0	1
66000178	66	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000179	66	      *	1	0	0
66000180	66	      *       Preserve the RESP and RESP2, then set up the	1	0	1
66000181	66	      *       standard ABEND info before getting the applid,	1	0	1
66000182	66	      *       date/time etc. and linking to the Abend Handler	1	0	1
66000183	66	      *       program.	1	0	1
66000184	66	      *	1	0	1
66000185	66	              INITIALIZE ABNDINFO-REC	0	0	0
66000186	66	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000187	66	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000188	66	      *	1	0	0
66000189	66	      *       Get supplemental information	1	0	1
66000190	66	      *	1	0	1
66000191	66	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66000192	66	              END-EXEC	0	0	1
66000194	66	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66000195	66	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66000197	66	              PERFORM POPULATE-TIME-DATE	0	0	1
66000199	66	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66000200	66	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66000201	66	                    ':' DELIMITED BY SIZE,	0	0	1
66000202	66	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66000203	66	                     ':' DELIMITED BY SIZE,	0	0	1
66000204	66	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66000205	66	                     INTO ABND-TIME	0	0	1
66000206	66	              END-STRING	0	0	1
66000208	66	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66000209	66	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
66000211	66	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66000212	66	              END-EXEC	0	0	1
66000214	66	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66000216	66	              STRING 'A010 - RETURN TRANSID(MENU) FAIL.'	0	0	1
66000217	66	                    DELIMITED BY SIZE,	0	0	1
66000218	66	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66000219	66	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66000220	66	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
66000221	66	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66000222	66	                    INTO ABND-FREEFORM	0	0	1
66000223	66	              END-STRING	0	0	1
66000225	66	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66000226	66	                        COMMAREA(ABNDINFO-REC)	0	0	1
66000227	66	              END-EXEC	0	0	1
66000229	66	              INITIALIZE WS-FAIL-INFO	0	0	1
66000230	66	              MOVE 'BNKMENU - A010 - RETURN TRANSID(MENU) FAIL' TO	0	0	1
66000231	66	                 WS-CICS-FAIL-MSG	0	0	1
66000232	66	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66000233	66	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66000234	66	              PERFORM ABEND-THIS-TASK	0	0	1
66000235	66	           END-IF.	0	0	1
66000237	66	       A999.	0	0	1
66000238	66	           EXIT.	0	0	1
66000241	66	       PROCESS-MENU-MAP SECTION.	0	0	1
66000242	66	       PMM010.	0	0	1
66000243	66	      *	1	0	0
66000244	66	      *    Retrieve the data from the map and validate it	1	0	1
66000245	66	      *	1	0	1
66000246	66	           PERFORM RECEIVE-MENU-MAP.	0	0	0
66000248	66	           PERFORM EDIT-MENU-DATA.	0	0	1
66000250	66	      *	1	0	0
66000251	66	      *    If the data passes validation go on to	1	0	1
66000252	66	      *    invoke other transactions	1	0	1
66000253	66	      *	1	0	1
66000254	66	           IF VALID-DATA	0	0	0
66000255	66	              PERFORM INVOKE-OTHER-TXNS	0	0	1
66000256	66	           END-IF.	0	0	1
66000258	66	           SET SEND-DATAONLY-ALARM TO TRUE.	0	0	1
66000260	66	      *	1	0	0
66000261	66	      *    Output the data to the screen	1	0	1
66000262	66	      *	1	0	1
66000263	66	           PERFORM SEND-MAP.	0	0	0
66000265	66	       PMM999.	0	0	1
66000266	66	           EXIT.	0	0	1
66000269	66	       RECEIVE-MENU-MAP SECTION.	0	0	1
66000270	66	       RMM010.	0	0	1
66000271	66	      *	1	0	0
66000272	66	      *    Retrieve the data	1	0	1
66000273	66	      *	1	0	1
66000274	66	           EXEC CICS	0	0	0
66000275	66	              RECEIVE MAP('BNK1ME')	0	0	1
66000276	66	              MAPSET('BNK1MAI')	0	0	1
66000277	66	              INTO(BNK1MEI)	0	0	1
66000278	66	              RESP(WS-CICS-RESP)	0	0	1
66000279	66	              RESP2(WS-CICS-RESP2)	0	0	1
66000280	66	           END-EXEC.	0	0	1
66000282	66	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000284	66	              IF WS-CICS-RESP = DFHRESP(MAPFAIL)	0	0	1
66000285	66	                 MOVE LOW-VALUES TO BNK1MEO	0	0	1
66000286	66	                 MOVE -1 TO ACTIONL	0	0	1
66000287	66	                 SET SEND-ERASE TO TRUE	0	0	1
66000288	66	                 PERFORM SEND-MAP	0	0	1
66000289	66	              ELSE	0	0	1
66000291	66	      *	1	0	0
66000292	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66000293	66	      *          standard ABEND info before getting the applid,	1	0	1
66000294	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66000295	66	      *          program.	1	0	1
66000296	66	      *	1	0	1
66000297	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66000298	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000299	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000300	66	      *	1	0	0
66000301	66	      *          Get supplemental information	1	0	1
66000302	66	      *	1	0	1
66000303	66	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66000304	66	                 END-EXEC	0	0	1
66000306	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66000307	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66000309	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66000311	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66000312	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66000313	66	                       ':' DELIMITED BY SIZE,	0	0	1
66000314	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66000315	66	                        ':' DELIMITED BY SIZE,	0	0	1
66000316	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66000317	66	                        INTO ABND-TIME	0	0	1
66000318	66	                 END-STRING	0	0	1
66000320	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66000321	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66000323	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66000324	66	                 END-EXEC	0	0	1
66000326	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66000328	66	                 STRING 'RMM010  - RECEIVE MAP FAIL.'	0	0	1
66000329	66	                       DELIMITED BY SIZE,	0	0	1
66000330	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66000331	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66000332	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66000333	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66000334	66	                       INTO ABND-FREEFORM	0	0	1
66000335	66	                 END-STRING	0	0	1
66000337	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66000338	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66000339	66	                 END-EXEC	0	0	1
66000342	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66000343	66	                 MOVE 'BNKMENU - RMM010 - RECEIVE MAP FAIL' TO	0	0	1
66000344	66	                    WS-CICS-FAIL-MSG	0	0	1
66000345	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66000346	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66000347	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66000348	66	              END-IF	0	0	1
66000349	66	           END-IF.	0	0	1
66000351	66	       RMM999.	0	0	1
66000352	66	           EXIT.	0	0	1
66000355	66	       EDIT-MENU-DATA SECTION.	0	0	1
66000356	66	       EMD010.	0	0	1
66000357	66	      *	1	0	0
66000358	66	      *    Perform validation on the incoming field	1	0	1
66000359	66	      *	1	0	1
66000360	66	           IF ACTIONI NOT = '1' AND ACTIONI NOT = '2' AND	0	0	0
66000361	66	           ACTIONI NOT = '3' AND ACTIONI NOT = '4' AND	0	0	1
66000362	66	           ACTIONI NOT = '5' AND ACTIONI NOT = '6' AND	0	0	1
66000363	66	           ACTIONI NOT = '7' AND ACTIONI NOT = 'A'	0	0	1
66000365	66	              MOVE SPACES TO MESSAGEO	0	0	1
66000366	66	              MOVE 'You must enter a valid value (1-7 or A).' TO	0	0	1
66000367	66	                 MESSAGEO	0	0	1
66000368	66	              MOVE 'N' TO VALID-DATA-SW	0	0	1
66000369	66	           ELSE	0	0	1
66000370	66	              MOVE ACTIONI TO ACTION-ALPHA	0	0	1
66000371	66	           END-IF.	0	0	1
66000373	66	       EMD999.	0	0	1
66000374	66	           EXIT.	0	0	1
66000377	66	       INVOKE-OTHER-TXNS SECTION.	0	0	1
66000378	66	       IOT010.	0	0	1
66000379	66	      *	1	0	0
66000380	66	      *    Invoke the transaction that matches the chosen menu option	1	0	1
66000381	66	      *	1	0	1
66000383	66	      *	1	0	1
66000384	66	      *    1 = Display CUSTOMER details	1	0	1
66000385	66	      *	1	0	1
66000386	66	           IF ACTIONI = '1'	0	0	0
66000387	66	              EXEC CICS RETURN	0	0	1
66000388	66	                 TRANSID('ODCS')	0	0	1
66000389	66	                 IMMEDIATE	0	0	1
66000390	66	                 RESP(WS-CICS-RESP)	0	0	1
66000391	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66000392	66	              END-EXEC	0	0	1
66000394	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000395	66	      *	1	0	0
66000396	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66000397	66	      *          standard ABEND info before getting the applid,	1	0	1
66000398	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66000399	66	      *          program.	1	0	1
66000400	66	      *	1	0	1
66000401	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66000402	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000403	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000404	66	      *	1	0	0
66000405	66	      *          Get supplemental information	1	0	1
66000406	66	      *	1	0	1
66000407	66	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66000408	66	                 END-EXEC	0	0	1
66000410	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66000411	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66000413	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66000415	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66000416	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66000417	66	                       ':' DELIMITED BY SIZE,	0	0	1
66000418	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66000419	66	                      ':' DELIMITED BY SIZE,	0	0	1
66000420	66	                       WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66000421	66	                       INTO ABND-TIME	0	0	1
66000422	66	                 END-STRING	0	0	1
66000424	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66000425	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66000427	66	                EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66000428	66	                 END-EXEC	0	0	1
66000430	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66000432	66	                 STRING 'IOT010 - RETURN TRANSID(ODCS) FAIL.'	0	0	1
66000433	66	                       DELIMITED BY SIZE,	0	0	1
66000434	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66000435	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66000436	66	                      ' RESP2=' DELIMITED BY SIZE,	0	0	1
66000437	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66000438	66	                       INTO ABND-FREEFORM	0	0	1
66000439	66	                 END-STRING	0	0	1
66000441	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66000442	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66000443	66	                 END-EXEC	0	0	1
66000445	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66000446	66	                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(ODCS) FAIL'	0	0	1
66000447	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66000448	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66000449	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66000450	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66000451	66	              END-IF	0	0	1
66000453	66	           END-IF.	0	0	1
66000455	66	      *	1	0	0
66000456	66	      *    2 = Display ACCOUNT details	1	0	1
66000457	66	      *	1	0	1
66000458	66	           IF ACTIONI = '2'	0	0	0
66000459	66	              EXEC CICS RETURN	0	0	1
66000460	66	                 TRANSID('ODAC')	0	0	1
66000461	66	                 IMMEDIATE	0	0	1
66000462	66	                 RESP(WS-CICS-RESP)	0	0	1
66000463	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66000464	66	              END-EXEC	0	0	1
66000466	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000467	66	      *	1	0	0
66000468	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66000469	66	      *          standard ABEND info before getting the applid,	1	0	1
66000470	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66000471	66	      *          program.	1	0	1
66000472	66	      *	1	0	1
66000473	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66000474	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000475	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000476	66	      *	1	0	0
66000477	66	      *          Get supplemental information	1	0	1
66000478	66	      *	1	0	1
66000479	66	                  EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66000480	66	                  END-EXEC	0	0	1
66000482	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66000483	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66000485	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66000487	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66000488	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66000489	66	                       ':' DELIMITED BY SIZE,	0	0	1
66000490	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66000491	66	                        ':' DELIMITED BY SIZE,	0	0	1
66000492	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66000493	66	                        INTO ABND-TIME	0	0	1
66000494	66	                 END-STRING	0	0	1
66000496	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66000497	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66000499	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66000500	66	                 END-EXEC	0	0	1
66000502	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66000504	66	                 STRING 'IOT010 - RETURN TRANSID(ODAC) FAIL.'	0	0	1
66000505	66	                       DELIMITED BY SIZE,	0	0	1
66000506	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66000507	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66000508	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66000509	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66000510	66	                       INTO ABND-FREEFORM	0	0	1
66000511	66	                 END-STRING	0	0	1
66000513	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66000514	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66000515	66	                 END-EXEC	0	0	1
66000518	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66000519	66	                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(ODAC) FAIL'	0	0	1
66000520	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66000521	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66000522	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66000523	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66000524	66	              END-IF	0	0	1
66000526	66	           END-IF.	0	0	1
66000528	66	      *	1	0	0
66000529	66	      *    3 = Create a CUSTOMER	1	0	1
66000530	66	      *	1	0	1
66000531	66	           IF ACTIONI = '3'	0	0	0
66000532	66	              EXEC CICS RETURN	0	0	1
66000533	66	                 TRANSID('OCCS')	0	0	1
66000534	66	                 IMMEDIATE	0	0	1
66000535	66	                 RESP(WS-CICS-RESP)	0	0	1
66000536	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66000537	66	              END-EXEC	0	0	1
66000539	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000540	66	      *	1	0	0
66000541	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66000542	66	      *          standard ABEND info before getting the applid,	1	0	1
66000543	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66000544	66	      *          program.	1	0	1
66000545	66	      *	1	0	1
66000546	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66000547	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000548	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000549	66	      *	1	0	0
66000550	66	      *          Get supplemental information	1	0	1
66000551	66	      *	1	0	1
66000552	66	                  EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66000553	66	                  END-EXEC	0	0	1
66000555	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66000556	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66000558	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66000560	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66000561	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66000562	66	                       ':' DELIMITED BY SIZE,	0	0	1
66000563	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66000564	66	                        ':' DELIMITED BY SIZE,	0	0	1
66000565	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66000566	66	                        INTO ABND-TIME	0	0	1
66000567	66	                 END-STRING	0	0	1
66000569	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66000570	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66000572	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66000573	66	                 END-EXEC	0	0	1
66000575	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66000577	66	                 STRING 'IOT010 - RETURN TRANSID(OCCS) FAIL.'	0	0	1
66000578	66	                       DELIMITED BY SIZE,	0	0	1
66000579	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66000580	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66000581	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66000582	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66000583	66	                       INTO ABND-FREEFORM	0	0	1
66000584	66	                 END-STRING	0	0	1
66000586	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66000587	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66000588	66	                 END-EXEC	0	0	1
66000591	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66000592	66	                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OCCS) FAIL'	0	0	1
66000593	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66000594	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66000595	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66000596	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66000597	66	              END-IF	0	0	1
66000599	66	           END-IF.	0	0	1
66000601	66	      *	1	0	0
66000602	66	      *    4 = Create an account	1	0	1
66000603	66	      *	1	0	1
66000604	66	           IF ACTIONI = '4'	0	0	0
66000605	66	              EXEC CICS RETURN	0	0	1
66000606	66	                 TRANSID('OCAC')	0	0	1
66000607	66	                 IMMEDIATE	0	0	1
66000608	66	                 RESP(WS-CICS-RESP)	0	0	1
66000609	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66000610	66	              END-EXEC	0	0	1
66000612	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000613	66	      *	1	0	0
66000614	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66000615	66	      *          standard ABEND info before getting the applid,	1	0	1
66000616	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66000617	66	      *          program.	1	0	1
66000618	66	      *	1	0	1
66000619	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66000620	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000621	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000622	66	      *	1	0	0
66000623	66	      *          Get supplemental information	1	0	1
66000624	66	      *	1	0	1
66000625	66	                  EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66000626	66	                  END-EXEC	0	0	1
66000628	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66000629	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66000631	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66000633	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66000634	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66000635	66	                       ':' DELIMITED BY SIZE,	0	0	1
66000636	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66000637	66	                        ':' DELIMITED BY SIZE,	0	0	1
66000638	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66000639	66	                        INTO ABND-TIME	0	0	1
66000640	66	                 END-STRING	0	0	1
66000642	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66000643	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66000645	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66000646	66	                 END-EXEC	0	0	1
66000648	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66000650	66	                 STRING 'IOT010 - RETURN TRANSID(OCAC) FAIL.'	0	0	1
66000651	66	                       DELIMITED BY SIZE,	0	0	1
66000652	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66000653	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66000654	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66000655	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66000656	66	                       INTO ABND-FREEFORM	0	0	1
66000657	66	                 END-STRING	0	0	1
66000659	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66000660	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66000661	66	                 END-EXEC	0	0	1
66000664	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66000665	66	                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OCAC) FAIL'	0	0	1
66000666	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66000667	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66000668	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66000669	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66000670	66	              END-IF	0	0	1
66000672	66	           END-IF.	0	0	1
66000674	66	      *	1	0	0
66000675	66	      *    5 = Update an account	1	0	1
66000676	66	      *	1	0	1
66000677	66	           IF ACTIONI = '5'	0	0	0
66000678	66	              EXEC CICS RETURN	0	0	1
66000679	66	                 TRANSID('OUAC')	0	0	1
66000680	66	                 IMMEDIATE	0	0	1
66000681	66	                 RESP(WS-CICS-RESP)	0	0	1
66000682	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66000683	66	              END-EXEC	0	0	1
66000685	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000686	66	      *	1	0	0
66000687	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66000688	66	      *          standard ABEND info before getting the applid,	1	0	1
66000689	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66000690	66	      *          program.	1	0	1
66000691	66	      *	1	0	1
66000692	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66000693	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000694	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000695	66	      *	1	0	0
66000696	66	      *          Get supplemental information	1	0	1
66000697	66	      *	1	0	1
66000698	66	                  EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66000699	66	                  END-EXEC	0	0	1
66000701	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66000702	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66000704	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66000706	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66000707	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66000708	66	                       ':' DELIMITED BY SIZE,	0	0	1
66000709	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66000710	66	                        ':' DELIMITED BY SIZE,	0	0	1
66000711	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66000712	66	                        INTO ABND-TIME	0	0	1
66000713	66	                 END-STRING	0	0	1
66000715	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66000716	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66000718	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66000719	66	                 END-EXEC	0	0	1
66000721	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66000723	66	                 STRING 'IOT010 - RETURN TRANSID(OUAC) FAIL.'	0	0	1
66000724	66	                       DELIMITED BY SIZE,	0	0	1
66000725	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66000726	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66000727	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66000728	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66000729	66	                       INTO ABND-FREEFORM	0	0	1
66000730	66	                 END-STRING	0	0	1
66000732	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66000733	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66000734	66	                 END-EXEC	0	0	1
66000737	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66000738	66	                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OUAC) FAIL'	0	0	1
66000739	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66000740	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66000741	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66000742	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66000743	66	              END-IF	0	0	1
66000745	66	           END-IF.	0	0	1
66000747	66	      *	1	0	0
66000748	66	      *    6 = Credit/Debit funds to an account	1	0	1
66000749	66	      *	1	0	1
66000750	66	           IF ACTIONI = '6'	0	0	0
66000751	66	              EXEC CICS RETURN	0	0	1
66000752	66	                 TRANSID('OCRA')	0	0	1
66000753	66	                 IMMEDIATE	0	0	1
66000754	66	                 RESP(WS-CICS-RESP)	0	0	1
66000755	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66000756	66	              END-EXEC	0	0	1
66000758	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000759	66	      *	1	0	0
66000760	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66000761	66	      *          standard ABEND info before getting the applid,	1	0	1
66000762	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66000763	66	      *          program.	1	0	1
66000764	66	      *	1	0	1
66000765	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66000766	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000767	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000768	66	      *	1	0	0
66000769	66	      *          Get supplemental information	1	0	1
66000770	66	      *	1	0	1
66000771	66	                  EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66000772	66	                  END-EXEC	0	0	1
66000774	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66000775	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66000777	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66000779	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66000780	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66000781	66	                       ':' DELIMITED BY SIZE,	0	0	1
66000782	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66000783	66	                        ':' DELIMITED BY SIZE,	0	0	1
66000784	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66000785	66	                        INTO ABND-TIME	0	0	1
66000786	66	                 END-STRING	0	0	1
66000788	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66000789	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66000791	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66000792	66	                 END-EXEC	0	0	1
66000794	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66000796	66	                 STRING 'IOT010 - RETURN TRANSID(OCRA) FAIL.'	0	0	1
66000797	66	                       DELIMITED BY SIZE,	0	0	1
66000798	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66000799	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66000800	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66000801	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66000802	66	                       INTO ABND-FREEFORM	0	0	1
66000803	66	                 END-STRING	0	0	1
66000805	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66000806	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66000807	66	                 END-EXEC	0	0	1
66000810	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66000811	66	                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OCRA) FAIL'	0	0	1
66000812	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66000813	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66000814	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66000815	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66000816	66	              END-IF	0	0	1
66000818	66	           END-IF.	0	0	1
66000820	66	      *	1	0	0
66000821	66	      *    7 = Transfer funds between an account	1	0	1
66000822	66	      *	1	0	1
66000823	66	           IF ACTIONI = '7'	0	0	0
66000824	66	              EXEC CICS RETURN	0	0	1
66000825	66	                 TRANSID('OTFN')	0	0	1
66000826	66	                 IMMEDIATE	0	0	1
66000827	66	                 RESP(WS-CICS-RESP)	0	0	1
66000828	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66000829	66	              END-EXEC	0	0	1
66000831	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000832	66	      *	1	0	0
66000833	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66000834	66	      *          standard ABEND info before getting the applid,	1	0	1
66000835	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66000836	66	      *          program.	1	0	1
66000837	66	      *	1	0	1
66000838	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66000839	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000840	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000841	66	      *	1	0	0
66000842	66	      *          Get supplemental information	1	0	1
66000843	66	      *	1	0	1
66000844	66	                  EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66000845	66	                  END-EXEC	0	0	1
66000847	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66000848	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66000850	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66000852	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66000853	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66000854	66	                       ':' DELIMITED BY SIZE,	0	0	1
66000855	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66000856	66	                        ':' DELIMITED BY SIZE,	0	0	1
66000857	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66000858	66	                        INTO ABND-TIME	0	0	1
66000859	66	                 END-STRING	0	0	1
66000861	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66000862	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66000864	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66000865	66	                 END-EXEC	0	0	1
66000867	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66000869	66	                 STRING 'IOT010 - RETURN TRANSID(OTFN) FAIL.'	0	0	1
66000870	66	                       DELIMITED BY SIZE,	0	0	1
66000871	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66000872	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66000873	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66000874	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66000875	66	                       INTO ABND-FREEFORM	0	0	1
66000876	66	                 END-STRING	0	0	1
66000878	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66000879	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66000880	66	                 END-EXEC	0	0	1
66000883	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66000884	66	                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OTFN) FAIL'	0	0	1
66000885	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66000886	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66000887	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66000888	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66000889	66	              END-IF	0	0	1
66000891	66	           END-IF.	0	0	1
66000894	66	      *	1	0	0
66000895	66	      *    A = Look up accounts for a given customer	1	0	1
66000896	66	      *	1	0	1
66000897	66	           IF ACTIONI = 'A'	0	0	0
66000898	66	              EXEC CICS RETURN	0	0	1
66000899	66	                 TRANSID('OCCA')	0	0	1
66000900	66	                 IMMEDIATE	0	0	1
66000901	66	                 RESP(WS-CICS-RESP)	0	0	1
66000902	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66000903	66	              END-EXEC	0	0	1
66000905	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000906	66	      *	1	0	0
66000907	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66000908	66	      *          standard ABEND info before getting the applid,	1	0	1
66000909	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66000910	66	      *          program.	1	0	1
66000911	66	      *	1	0	1
66000912	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66000913	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000914	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000915	66	      *	1	0	0
66000916	66	      *          Get supplemental information	1	0	1
66000917	66	      *	1	0	1
66000918	66	                  EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66000919	66	                  END-EXEC	0	0	1
66000921	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66000922	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66000924	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66000926	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66000927	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66000928	66	                       ':' DELIMITED BY SIZE,	0	0	1
66000929	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66000930	66	                        ':' DELIMITED BY SIZE,	0	0	1
66000931	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66000932	66	                        INTO ABND-TIME	0	0	1
66000933	66	                 END-STRING	0	0	1
66000935	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66000936	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66000938	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66000939	66	                 END-EXEC	0	0	1
66000941	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66000943	66	                 STRING 'IOT010 - RETURN TRANSID(OCCA) FAIL.'	0	0	1
66000944	66	                       DELIMITED BY SIZE,	0	0	1
66000945	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66000946	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66000947	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66000948	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66000949	66	                       INTO ABND-FREEFORM	0	0	1
66000950	66	                 END-STRING	0	0	1
66000952	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66000953	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66000954	66	                 END-EXEC	0	0	1
66000957	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66000958	66	                 MOVE 'BNKMENU - IOT010 - RETURN TRANSID(OCCA) FAIL'	0	0	1
66000959	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66000960	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66000961	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66000962	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66000963	66	              END-IF	0	0	1
66000965	66	           END-IF.	0	0	1
66000968	66	       IOT999.	0	0	1
66000969	66	           EXIT.	0	0	1
66000972	66	       SEND-MAP SECTION.	0	0	1
66000973	66	       SMM010.	0	0	1
66000974	66	      *	1	0	0
66000975	66	      *    If the map needs to have its data erased	1	0	1
66000976	66	      *	1	0	1
66000978	66	           IF SEND-ERASE	0	0	0
66000979	66	              EXEC CICS SEND MAP('BNK1ME')	0	0	1
66000980	66	                 MAPSET('BNK1MAI')	0	0	1
66000981	66	                 FROM(BNK1MEO)	0	0	1
66000982	66	                 ERASE	0	0	1
66000983	66	                 RESP(WS-CICS-RESP)	0	0	1
66000984	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66000985	66	              END-EXEC	0	0	1
66000987	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66000988	66	      *	1	0	0
66000989	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66000990	66	      *          standard ABEND info before getting the applid,	1	0	1
66000991	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66000992	66	      *          program.	1	0	1
66000993	66	      *	1	0	1
66000994	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66000995	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66000996	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66000997	66	      *	1	0	0
66000998	66	      *          Get supplemental information	1	0	1
66000999	66	      *	1	0	1
66001000	66	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66001001	66	                 END-EXEC	0	0	1
66001003	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66001004	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66001006	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66001008	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66001009	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66001010	66	                       ':' DELIMITED BY SIZE,	0	0	1
66001011	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66001012	66	                        ':' DELIMITED BY SIZE,	0	0	1
66001013	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66001014	66	                        INTO ABND-TIME	0	0	1
66001015	66	                 END-STRING	0	0	1
66001017	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66001018	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66001020	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66001021	66	                 END-EXEC	0	0	1
66001023	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66001025	66	                 STRING 'SMM010 - SEND MAP ERASE FAIL.'	0	0	1
66001026	66	                       DELIMITED BY SIZE,	0	0	1
66001027	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66001028	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66001029	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66001030	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66001031	66	                       INTO ABND-FREEFORM	0	0	1
66001032	66	                 END-STRING	0	0	1
66001034	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66001035	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66001036	66	                 END-EXEC	0	0	1
66001038	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66001039	66	                 MOVE 'BNKMENU - SMM010 - SEND MAP ERASE FAIL'	0	0	1
66001040	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66001041	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66001042	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66001043	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66001044	66	              END-IF	0	0	1
66001046	66	              GO TO SMM999	0	0	1
66001047	66	           END-IF.	0	0	1
66001049	66	      *	1	0	0
66001050	66	      *    If the map just needs a resend of only the data	1	0	1
66001051	66	      *	1	0	1
66001052	66	           IF SEND-DATAONLY	0	0	0
66001053	66	              EXEC CICS SEND MAP('BNK1ME')	0	0	1
66001054	66	                 MAPSET('BNK1MAI')	0	0	1
66001055	66	                 FROM(BNK1MEO)	0	0	1
66001056	66	                 DATAONLY	0	0	1
66001057	66	                 RESP(WS-CICS-RESP)	0	0	1
66001058	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66001059	66	              END-EXEC	0	0	1
66001061	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66001063	66	      *	1	0	0
66001064	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66001065	66	      *          standard ABEND info before getting the applid,	1	0	1
66001066	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66001067	66	      *          program.	1	0	1
66001068	66	      *	1	0	1
66001069	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66001070	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66001071	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66001072	66	      *	1	0	0
66001073	66	      *          Get supplemental information	1	0	1
66001074	66	      *	1	0	1
66001075	66	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66001076	66	                 END-EXEC	0	0	1
66001078	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66001079	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66001081	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66001083	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66001084	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66001085	66	                       ':' DELIMITED BY SIZE,	0	0	1
66001086	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66001087	66	                        ':' DELIMITED BY SIZE,	0	0	1
66001088	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66001089	66	                        INTO ABND-TIME	0	0	1
66001090	66	                 END-STRING	0	0	1
66001092	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66001093	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66001095	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66001096	66	                 END-EXEC	0	0	1
66001098	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66001100	66	                 STRING 'SMM010 - SEND MAP DATAONLY FAIL.'	0	0	1
66001101	66	                       DELIMITED BY SIZE,	0	0	1
66001102	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66001103	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66001104	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66001105	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66001106	66	                       INTO ABND-FREEFORM	0	0	1
66001107	66	                 END-STRING	0	0	1
66001109	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66001110	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66001111	66	                 END-EXEC	0	0	1
66001114	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66001115	66	                 MOVE 'BNKMENU - SMM010 - SEND MAP DATAONLY FAIL'	0	0	1
66001116	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66001117	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66001118	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66001119	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66001120	66	              END-IF	0	0	1
66001122	66	              GO TO SMM999	0	0	1
66001123	66	           END-IF.	0	0	1
66001125	66	      *	1	0	0
66001126	66	      *    If we have elected to send the map and a beep	1	0	1
66001127	66	      *	1	0	1
66001128	66	           IF SEND-DATAONLY-ALARM	0	0	0
66001129	66	              EXEC CICS SEND MAP('BNK1ME')	0	0	1
66001130	66	                 MAPSET('BNK1MAI')	0	0	1
66001131	66	                 FROM(BNK1MEO)	0	0	1
66001132	66	                 DATAONLY	0	0	1
66001133	66	                 ALARM	0	0	1
66001134	66	                 RESP(WS-CICS-RESP)	0	0	1
66001135	66	                 RESP2(WS-CICS-RESP2)	0	0	1
66001136	66	              END-EXEC	0	0	1
66001138	66	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66001140	66	      *	1	0	0
66001141	66	      *          Preserve the RESP and RESP2, then set up the	1	0	1
66001142	66	      *          standard ABEND info before getting the applid,	1	0	1
66001143	66	      *          date/time etc. and linking to the Abend Handler	1	0	1
66001144	66	      *          program.	1	0	1
66001145	66	      *	1	0	1
66001146	66	                 INITIALIZE ABNDINFO-REC	0	0	0
66001147	66	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66001148	66	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66001149	66	      *	1	0	0
66001150	66	      *          Get supplemental information	1	0	1
66001151	66	      *	1	0	1
66001152	66	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66001153	66	                 END-EXEC	0	0	1
66001155	66	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66001156	66	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66001158	66	                 PERFORM POPULATE-TIME-DATE	0	0	1
66001160	66	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66001161	66	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66001162	66	                       ':' DELIMITED BY SIZE,	0	0	1
66001163	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66001164	66	                        ':' DELIMITED BY SIZE,	0	0	1
66001165	66	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66001166	66	                        INTO ABND-TIME	0	0	1
66001167	66	                 END-STRING	0	0	1
66001169	66	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66001170	66	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
66001172	66	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66001173	66	                 END-EXEC	0	0	1
66001175	66	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66001177	66	                 STRING 'SMM010 - SEND MAP DATAONLY ALARM FAIL.'	0	0	1
66001178	66	                       DELIMITED BY SIZE,	0	0	1
66001179	66	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66001180	66	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66001181	66	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
66001182	66	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66001183	66	                       INTO ABND-FREEFORM	0	0	1
66001184	66	                 END-STRING	0	0	1
66001186	66	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66001187	66	                           COMMAREA(ABNDINFO-REC)	0	0	1
66001188	66	                 END-EXEC	0	0	1
66001191	66	                 INITIALIZE WS-FAIL-INFO	0	0	1
66001192	66	                 MOVE 'BNKMENU - SMM010 - SEND MAP DATAONLY ALARM FAIL'	0	0	1
66001193	66	                    TO WS-CICS-FAIL-MSG	0	0	1
66001194	66	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66001195	66	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66001196	66	                 PERFORM ABEND-THIS-TASK	0	0	1
66001197	66	              END-IF	0	0	1
66001199	66	           END-IF.	0	0	1
66001201	66	       SMM999.	0	0	1
66001202	66	           EXIT.	0	0	1
66001205	66	       SEND-TERMINATION-MSG SECTION.	0	0	1
66001206	66	       STM010.	0	0	1
66001207	66	      *	1	0	0
66001208	66	      *    Send the termination message	1	0	1
66001209	66	      *	1	0	1
66001210	66	           EXEC CICS SEND TEXT	0	0	0
66001211	66	              FROM(END-OF-SESSION-MESSAGE)	0	0	1
66001212	66	              ERASE	0	0	1
66001213	66	              FREEKB	0	0	1
66001214	66	              RESP(WS-CICS-RESP)	0	0	1
66001215	66	              RESP2(WS-CICS-RESP2)	0	0	1
66001216	66	           END-EXEC.	0	0	1
66001218	66	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
66001219	66	      *	1	0	0
66001220	66	      *       Preserve the RESP and RESP2, then set up the	1	0	1
66001221	66	      *       standard ABEND info before getting the applid,	1	0	1
66001222	66	      *       date/time etc. and linking to the Abend Handler	1	0	1
66001223	66	      *       program.	1	0	1
66001224	66	      *	1	0	1
66001225	66	              INITIALIZE ABNDINFO-REC	0	0	0
66001226	66	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
66001227	66	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
66001228	66	      *	1	0	0
66001229	66	      *       Get supplemental information	1	0	1
66001230	66	      *	1	0	1
66001231	66	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
66001232	66	              END-EXEC	0	0	1
66001234	66	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
66001235	66	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
66001237	66	              PERFORM POPULATE-TIME-DATE	0	0	1
66001239	66	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
66001240	66	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
66001241	66	                     ':' DELIMITED BY SIZE,	0	0	1
66001242	66	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
66001243	66	                     ':' DELIMITED BY SIZE,	0	0	1
66001244	66	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
66001245	66	                     INTO ABND-TIME	0	0	1
66001246	66	              END-STRING	0	0	1
66001248	66	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
66001249	66	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
66001251	66	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
66001252	66	              END-EXEC	0	0	1
66001254	66	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
66001256	66	              STRING 'STM010 - SEND TEXT FAIL.'	0	0	1
66001257	66	                    DELIMITED BY SIZE,	0	0	1
66001258	66	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
66001259	66	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
66001260	66	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
66001261	66	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
66001262	66	                    INTO ABND-FREEFORM	0	0	1
66001263	66	              END-STRING	0	0	1
66001265	66	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
66001266	66	                        COMMAREA(ABNDINFO-REC)	0	0	1
66001267	66	              END-EXEC	0	0	1
66001270	66	              INITIALIZE WS-FAIL-INFO	0	0	1
66001271	66	              MOVE 'BNKMENU - STM010 - SEND TEXT FAIL'	0	0	1
66001272	66	                 TO WS-CICS-FAIL-MSG	0	0	1
66001273	66	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
66001274	66	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
66001275	66	              PERFORM ABEND-THIS-TASK	0	0	1
66001276	66	           END-IF.	0	0	1
66001278	66	       STM999.	0	0	1
66001279	66	           EXIT.	0	0	1
66001282	66	       ABEND-THIS-TASK SECTION.	0	0	1
66001283	66	       ATT010.	0	0	1
66001284	66	           DISPLAY WS-FAIL-INFO.	0	0	1
66001286	66	           EXEC CICS ABEND	0	0	1
66001287	66	              ABCODE('HBNK')	0	0	1
66001288	66	              NODUMP	0	0	1
66001289	66	           END-EXEC.	0	0	1
66001291	66	       ATT999.	0	0	1
66001292	66	           EXIT.	0	0	1
66001295	66	       POPULATE-TIME-DATE SECTION.	0	0	1
66001296	66	       PTD010.	0	0	1
66001297	66	      D    DISPLAY 'POPULATE-TIME-DATE SECTION'.	0	0	1
66001299	66	           EXEC CICS ASKTIME	0	0	1
66001300	66	              ABSTIME(WS-U-TIME)	0	0	1
66001301	66	           END-EXEC.	0	0	1
66001303	66	           EXEC CICS FORMATTIME	0	0	1
66001304	66	                     ABSTIME(WS-U-TIME)	0	0	1
66001305	66	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
66001306	66	                     TIME(WS-TIME-NOW)	0	0	1
66001307	66	                     DATESEP	0	0	1
66001308	66	           END-EXEC.	0	0	1
66001310	66	       PTD999.	0	0	1
66001311	66	           EXIT.	0	0	1
67000000	67	<<<< file not found >>>>	0	0	0
67000001	67	<<<< file not found >>>>	0	0	0
68000001	68	       PROCESS CICS,NODYNAM,NSYMBOL(NATIONAL),TRUNC(STD)	0	0	1
68000002	68	       CBL CICS('SP,EDF')	0	0	1
68000003	68	      ******************************************************************	1	0	0
68000004	68	      *                                                                *	1	0	1
68000005	68	      *  Copyright IBM Corp. 2023                                      *	1	0	1
68000006	68	      *                                                                *	1	0	1
68000007	68	      ******************************************************************	1	0	1
68000010	68	      ******************************************************************	1	0	1
68000011	68	      * This is the Transfer Funds between accounts program (in the	1	0	1
68000012	68	      * same bank) in the BANKING application BMS suite.	1	0	1
68000013	68	      *	1	0	1
68000014	68	      ******************************************************************	1	0	1
68000015	68	       IDENTIFICATION DIVISION.	0	0	0
68000016	68	       PROGRAM-ID. BNK1TFN.	0	0	1
68000017	68	       AUTHOR. Jon Collett.	0	0	1
68000019	68	       ENVIRONMENT DIVISION.	0	0	1
68000020	68	       CONFIGURATION SECTION.	0	0	1
68000021	68	      *SOURCE-COMPUTER.   IBM-370 WITH DEBUGGING MODE.	1	0	0
68000022	68	       SOURCE-COMPUTER.  IBM-370.	0	0	0
68000023	68	       OBJECT-COMPUTER.  IBM-370.	0	0	1
68000025	68	       INPUT-OUTPUT SECTION.	0	0	1
68000027	68	       DATA DIVISION.	0	0	1
68000028	68	       WORKING-STORAGE SECTION.	0	0	1
68000030	68	       01 WS-CICS-WORK-AREA.	0	0	1
68000031	68	          03 WS-CICS-RESP               PIC S9(8) COMP	0	0	1
68000032	68	                                                      VALUE 0.	0	0	1
68000033	68	          03 WS-CICS-RESP2              PIC S9(8) COMP	0	0	1
68000034	68	                                                      VALUE 0.	0	0	1
68000036	68	       01 WS-FAIL-INFO.	0	0	1
68000037	68	          03 FILLER                     PIC X(9)      VALUE 'BNK1TFN  '.	0	0	1
68000038	68	          03 WS-CICS-FAIL-MSG           PIC X(70)     VALUE ' '.	0	0	1
68000039	68	          03 FILLER                     PIC X(6)      VALUE ' RESP='.	0	0	1
68000040	68	          03 WS-CICS-RESP-DISP          PIC 9(10)     VALUE 0.	0	0	1
68000041	68	          03 FILLER                     PIC X(7)      VALUE ' RESP2='.	0	0	1
68000042	68	          03 WS-CICS-RESP2-DISP         PIC 9(10)     VALUE 0.	0	0	1
68000043	68	          03 FILLER                     PIC X(15)     VALUE	0	0	1
68000044	68	                                                      ' ABENDING TASK.'.	0	0	1
68000045	68	       01 SWITCHES.	0	0	1
68000046	68	          03 VALID-DATA-SW              PIC X         VALUE 'Y'.	0	0	1
68000047	68	             88 VALID-DATA                            VALUE 'Y'.	0	0	1
68000049	68	       01 FLAGS.	0	0	1
68000050	68	          03 SEND-FLAG                  PIC X.	0	0	1
68000051	68	             88 SEND-ERASE                            VALUE '1'.	0	0	1
68000052	68	             88 SEND-DATAONLY                         VALUE '2'.	0	0	1
68000053	68	             88 SEND-DATAONLY-ALARM                   VALUE '3'.	0	0	1
68000055	68	       01 ACTION-ALPHA.	0	0	1
68000056	68	          03 ACTION-NUM                 PIC 9.	0	0	1
68000058	68	      *	1	0	0
68000059	68	      * The end of session message	1	0	1
68000060	68	      *	1	0	1
68000061	68	       01 END-OF-SESSION-MESSAGE        PIC X(13)     VALUE	0	0	0
68000062	68	                                                        'Session Ended'.	0	0	1
68000064	68	       01 RESPONSE-CODE                 PIC S9(8) COMP.	0	0	1
68000066	68	       01 COMMUNICATION-AREA            PIC X.	0	0	1
68000068	68	       COPY BNK1TFM.	0	0	1
68000070	68	       COPY DFHAID.	0	0	1
68000072	68	       01 WS-AMOUNT-AS-FLOAT COMP-2.	0	0	1
68000074	68	       01 WS-NUM-COUNT-TOTAL            PIC S9(8) BINARY.	0	0	1
68000075	68	       01 WS-NUM-COUNT-POINT            PIC S9(8) BINARY.	0	0	1
68000076	68	       01 WS-NUM-COUNT-SPACE            PIC S9(8) BINARY.	0	0	1
68000077	68	       01 WS-NUM-COUNT-MINUS            PIC S9(8) BINARY.	0	0	1
68000079	68	       01 WS-AMOUNT-UNSTR               PIC X(13).	0	0	1
68000080	68	       01 WS-AMOUNT-UNSTR-L             PIC S9(8) BINARY.	0	0	1
68000081	68	       01 WS-AMOUNT-UNSTR-REVERSE       PIC X(13).	0	0	1
68000083	68	       01 COMM-DOB-SPLIT.	0	0	1
68000084	68	          03 COMM-DOB-SPLIT-DD          PIC 99.	0	0	1
68000085	68	          03 COMM-DOB-SPLIT-MM          PIC 99.	0	0	1
68000086	68	          03 COMM-DOB-SPLIT-YYYY        PIC 9999.	0	0	1
68000088	68	       01 COMM-ADDR-SPLIT.	0	0	1
68000089	68	          03 COMM-ADDR-SPLIT1           PIC X(60).	0	0	1
68000090	68	          03 COMM-ADDR-SPLIT2           PIC X(60).	0	0	1
68000091	68	          03 COMM-ADDR-SPLIT3           PIC X(40).	0	0	1
68000093	68	       01 WS-CONVERSIONA.	0	0	1
68000094	68	          03 WS-CONVERT-PIC1            PIC X(13).	0	0	1
68000095	68	          03 WS-CONVERT-PIC1SP REDEFINES WS-CONVERT-PIC1.	0	0	1
68000096	68	             05 WS-CONVERT-PIC1-1ST     PIC X(10).	0	0	1
68000097	68	             05 WS-CONVERT-PIC1-POINT   PIC X.	0	0	1
68000098	68	             05 WS-CONVERT-PIC1-2ND     PIC XX.	0	0	1
68000100	68	       01 WS-CONVERSIONB.	0	0	1
68000101	68	          03 WS-CONVERT-PICX            PIC X(13).	0	0	1
68000102	68	          03 WS-CONVERT-SPLIT REDEFINES WS-CONVERT-PICX.	0	0	1
68000103	68	             05 WS-CONVERT-DEC          PIC 9(10).	0	0	1
68000104	68	             05 WS-CONVERT-POINT        PIC X.	0	0	1
68000105	68	             05 WS-CONVERT-REMAIN       PIC 99.	0	0	1
68000107	68	       01 WS-CONVERTED-VAL1             PIC S9(10)V99 VALUE 0.	0	0	1
68000108	68	       01 WS-CONVERTED-VAL2             PIC S9(10)V99 VALUE 0.	0	0	1
68000109	68	       01 WS-CONVERTED-VAL3             PIC S9(10)V99 VALUE 0.	0	0	1
68000110	68	       01 WS-CONVERTED-VAL4             PIC S9(10)V99 VALUE 0.	0	0	1
68000112	68	       01 SUBPGM-PARMS.	0	0	1
68000113	68	          03 SUBPGM-FACCNO              PIC 9(8).	0	0	1
68000114	68	          03 SUBPGM-FSCODE              PIC 9(6).	0	0	1
68000115	68	          03 SUBPGM-TACCNO              PIC 9(8).	0	0	1
68000116	68	          03 SUBPGM-TSCODE              PIC 9(6).	0	0	1
68000117	68	          03 SUBPGM-AMT                 PIC S9(10)V99.	0	0	1
68000118	68	          03 SUBPGM-FAVBAL              PIC S9(10)V99.	0	0	1
68000119	68	          03 SUBPGM-FACTBAL             PIC S9(10)V99.	0	0	1
68000120	68	          03 SUBPGM-TAVBAL              PIC S9(10)V99.	0	0	1
68000121	68	          03 SUBPGM-TACTBAL             PIC S9(10)V99.	0	0	1
68000122	68	          03 SUBPGM-FAIL-CODE           PIC X.	0	0	1
68000123	68	          03 SUBPGM-SUCCESS             PIC X.	0	0	1
68000125	68	       01 WS-COMMAREA.	0	0	1
68000126	68	          03 WS-COMMAREA-FACCNO         PIC 9(8).	0	0	1
68000127	68	          03 WS-COMMAREA-TACCNO         PIC 9(8).	0	0	1
68000128	68	          03 WS-COMMAREA-AMT            PIC 9(12).	0	0	1
68000130	68	       01 COMPANY-NAME-FULL             PIC X(32).	0	0	1
68000131	68	       01 FROM-AVAILABLE-BALANCE-DISPLAY	0	0	1
68000132	68	                                        PIC +9(10).99.	0	0	1
68000133	68	       01 FROM-ACTUAL-BALANCE-DISPLAY   PIC +9(10).99.	0	0	1
68000134	68	       01 TO-AVAILABLE-BALANCE-DISPLAY  PIC +9(10).99.	0	0	1
68000135	68	       01 TO-ACTUAL-BALANCE-DISPLAY     PIC +9(10).99.	0	0	1
68000137	68	       01 WS-U-TIME                     PIC S9(15) COMP-3.	0	0	1
68000138	68	       01 WS-ORIG-DATE                  PIC X(10).	0	0	1
68000139	68	       01 WS-ORIG-DATE-GRP REDEFINES WS-ORIG-DATE.	0	0	1
68000140	68	          03 WS-ORIG-DATE-DD            PIC 99.	0	0	1
68000141	68	          03 FILLER                     PIC X.	0	0	1
68000142	68	          03 WS-ORIG-DATE-MM            PIC 99.	0	0	1
68000143	68	          03 FILLER                     PIC X.	0	0	1
68000144	68	          03 WS-ORIG-DATE-YYYY          PIC 9999.	0	0	1
68000146	68	       01 WS-ORIG-DATE-GRP-X.	0	0	1
68000147	68	          03 WS-ORIG-DATE-DD-X          PIC XX.	0	0	1
68000148	68	          03 FILLER                     PIC X         VALUE '.'.	0	0	1
68000149	68	          03 WS-ORIG-DATE-MM-X          PIC XX.	0	0	1
68000150	68	          03 FILLER                     PIC X         VALUE '.'.	0	0	1
68000151	68	          03 WS-ORIG-DATE-YYYY-X        PIC X(4).	0	0	1
68000153	68	       01 WS-TIME-DATA.	0	0	1
68000154	68	          03 WS-TIME-NOW                PIC 9(6).	0	0	1
68000155	68	          03 WS-TIME-NOW-GRP REDEFINES WS-TIME-NOW.	0	0	1
68000156	68	             05 WS-TIME-NOW-GRP-HH      PIC 99.	0	0	1
68000157	68	             05 WS-TIME-NOW-GRP-MM      PIC 99.	0	0	1
68000158	68	             05 WS-TIME-NOW-GRP-SS      PIC 99.	0	0	1
68000160	68	       01 WS-ABEND-PGM                  PIC X(8)      VALUE 'ABNDPROC'.	0	0	1
68000162	68	       01 ABNDINFO-REC.	0	0	1
68000163	68	           COPY ABNDINFO.	0	0	1
68000165	68	       LINKAGE SECTION.	0	0	1
68000167	68	       01 DFHCOMMAREA.	0	0	1
68000168	68	          03 COMMAREA-FACCNO            PIC 9(8).	0	0	1
68000169	68	          03 COMMAREA-TACCNO            PIC 9(8).	0	0	1
68000170	68	          03 COMMAREA-AMT               PIC 9(12).	0	0	1
68000173	68	       PROCEDURE DIVISION.	0	0	1
68000174	68	       PREMIERE SECTION.	0	0	1
68000175	68	       A010.	0	0	1
68000177	68	           EVALUATE TRUE	0	0	1
68000179	68	      *	1	0	0
68000180	68	      *       Is it the first time through? If so, send the map	1	0	1
68000181	68	      *       with erased (empty) data fields.	1	0	1
68000182	68	      *	1	0	1
68000183	68	              WHEN EIBCALEN = ZERO	0	0	0
68000184	68	                 MOVE LOW-VALUE TO BNK1TFO	0	0	1
68000185	68	                 SET SEND-ERASE TO TRUE	0	0	1
68000186	68	                 PERFORM SEND-MAP	0	0	1
68000188	68	      *	1	0	0
68000189	68	      *       If a PA key is pressed, just carry on	1	0	1
68000190	68	      *	1	0	1
68000191	68	              WHEN EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3	0	0	0
68000192	68	                 CONTINUE	0	0	1
68000194	68	      *	1	0	0
68000195	68	      *       When Pf3 is pressed, return to the main menu	1	0	1
68000196	68	      *	1	0	1
68000197	68	              WHEN EIBAID = DFHPF3	0	0	0
68000198	68	                 EXEC CICS RETURN	0	0	1
68000199	68	                    TRANSID('OMEN')	0	0	1
68000200	68	                    IMMEDIATE	0	0	1
68000201	68	                    RESP(WS-CICS-RESP)	0	0	1
68000202	68	                    RESP2(WS-CICS-RESP2)	0	0	1
68000203	68	                 END-EXEC	0	0	1
68000205	68	      *	1	0	0
68000206	68	      *       If the aid or Pf12 is pressed, then send a termination	1	0	1
68000207	68	      *       message.	1	0	1
68000208	68	      *	1	0	1
68000209	68	              WHEN EIBAID = DFHAID OR DFHPF12	0	0	0
68000210	68	                 PERFORM SEND-TERMINATION-MSG	0	0	1
68000211	68	                 EXEC CICS	0	0	1
68000212	68	                    RETURN	0	0	1
68000213	68	                 END-EXEC	0	0	1
68000215	68	      *	1	0	0
68000216	68	      *       When CLEAR is pressed	1	0	1
68000217	68	      *	1	0	1
68000218	68	              WHEN EIBAID = DFHCLEAR	0	0	0
68000219	68	                EXEC CICS SEND CONTROL	0	0	1
68000220	68	                          ERASE	0	0	1
68000221	68	                          FREEKB	0	0	1
68000222	68	                END-EXEC	0	0	1
68000223	68	                EXEC CICS RETURN	0	0	1
68000224	68	                END-EXEC	0	0	1
68000226	68	      *	1	0	0
68000227	68	      *       When enter is pressed then process the content	1	0	1
68000228	68	      *	1	0	1
68000229	68	              WHEN EIBAID = DFHENTER	0	0	0
68000230	68	                 PERFORM PROCESS-MAP	0	0	1
68000232	68	      *	1	0	0
68000233	68	      *       When anything else happens, send the invalid key message	1	0	1
68000234	68	      *	1	0	1
68000235	68	              WHEN OTHER	0	0	0
68000236	68	                 MOVE LOW-VALUES TO BNK1TFO	0	0	1
68000237	68	                 MOVE 'Invalid key pressed.' TO MESSAGEO	0	0	1
68000238	68	      *           MOVE 10 TO CUSTNOL	1	0	0
68000239	68	                 SET SEND-DATAONLY-ALARM TO TRUE	0	0	0
68000240	68	                 PERFORM SEND-MAP	0	0	1
68000242	68	           END-EVALUATE.	0	0	1
68000244	68	      *	1	0	0
68000245	68	      *     Now RETURN	1	0	1
68000246	68	      *	1	0	1
68000247	68	            EXEC CICS	0	0	0
68000248	68	               RETURN TRANSID('OTFN')	0	0	1
68000249	68	               COMMAREA(WS-COMMAREA)	0	0	1
68000250	68	               LENGTH(29)	0	0	1
68000251	68	               RESP(WS-CICS-RESP)	0	0	1
68000252	68	               RESP2(WS-CICS-RESP2)	0	0	1
68000253	68	            END-EXEC.	0	0	1
68000255	68	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
68000256	68	      *	1	0	0
68000257	68	      *       Preserve the RESP and RESP2, then set up the	1	0	1
68000258	68	      *       standard ABEND info before getting the applid,	1	0	1
68000259	68	      *       date/time etc. and linking to the Abend Handler	1	0	1
68000260	68	      *       program.	1	0	1
68000261	68	      *	1	0	1
68000262	68	              INITIALIZE ABNDINFO-REC	0	0	0
68000263	68	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
68000264	68	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
68000265	68	      *	1	0	0
68000266	68	      *       Get supplemental information	1	0	1
68000267	68	      *	1	0	1
68000268	68	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
68000269	68	              END-EXEC	0	0	1
68000271	68	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
68000272	68	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
68000274	68	              PERFORM POPULATE-TIME-DATE	0	0	1
68000276	68	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
68000277	68	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
68000278	68	                    ':' DELIMITED BY SIZE,	0	0	1
68000279	68	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
68000280	68	                     ':' DELIMITED BY SIZE,	0	0	1
68000281	68	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
68000282	68	                     INTO ABND-TIME	0	0	1
68000283	68	              END-STRING	0	0	1
68000285	68	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
68000286	68	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
68000288	68	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
68000289	68	              END-EXEC	0	0	1
68000291	68	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
68000293	68	              STRING 'A010 - RETURN TRANSID(OCCS) FAIL.'	0	0	1
68000294	68	                    DELIMITED BY SIZE,	0	0	1
68000295	68	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
68000296	68	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
68000297	68	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
68000298	68	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
68000299	68	                    INTO ABND-FREEFORM	0	0	1
68000300	68	              END-STRING	0	0	1
68000302	68	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
68000303	68	                        COMMAREA(ABNDINFO-REC)	0	0	1
68000304	68	              END-EXEC	0	0	1
68000307	68	              INITIALIZE WS-FAIL-INFO	0	0	1
68000308	68	              MOVE 'BNK1TFN - A010 - RETURN TRANSID(OCCS) FAIL' TO	0	0	1
68000309	68	                 WS-CICS-FAIL-MSG	0	0	1
68000310	68	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
68000311	68	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
68000312	68	              PERFORM ABEND-THIS-TASK	0	0	1
68000313	68	           END-IF.	0	0	1
68000315	68	       A999.	0	0	1
68000316	68	           EXIT.	0	0	1
68000319	68	       PROCESS-MAP SECTION.	0	0	1
68000320	68	       PM010.	0	0	1
68000321	68	      *	1	0	0
68000322	68	      *    Retrieve the data from the map	1	0	1
68000323	68	      *	1	0	1
68000325	68	           PERFORM RECEIVE-MAP.	0	0	0
68000327	68	      *	1	0	0
68000328	68	      *    Validate the received data	1	0	1
68000329	68	      *	1	0	1
68000330	68	           PERFORM EDIT-DATA.	0	0	0
68000332	68	      *	1	0	0
68000333	68	      *    If the data passes validation go on to	1	0	1
68000334	68	      *    get an account	1	0	1
68000335	68	      *	1	0	1
68000336	68	           IF VALID-DATA	0	0	0
68000337	68	              PERFORM GET-ACC-DATA	0	0	1
68000338	68	           END-IF.	0	0	1
68000340	68	           SET SEND-DATAONLY-ALARM TO TRUE.	0	0	1
68000342	68	      *	1	0	0
68000343	68	      *    Output the data to the screen	1	0	1
68000344	68	      *	1	0	1
68000345	68	           PERFORM SEND-MAP.	0	0	0
68000347	68	       PM999.	0	0	1
68000348	68	           EXIT.	0	0	1
68000351	68	       RECEIVE-MAP SECTION.	0	0	1
68000352	68	       RM010.	0	0	1
68000353	68	      *	1	0	0
68000354	68	      *    Retrieve the data	1	0	1
68000355	68	      *	1	0	1
68000356	68	           EXEC CICS	0	0	0
68000357	68	              RECEIVE MAP('BNK1TF')	0	0	1
68000358	68	              MAPSET('BNK1TFM')	0	0	1
68000359	68	              INTO(BNK1TFI)	0	0	1
68000360	68	              RESP(WS-CICS-RESP)	0	0	1
68000361	68	              RESP2(WS-CICS-RESP2)	0	0	1
68000362	68	           END-EXEC.	0	0	1
68000364	68	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
68000365	68	      *	1	0	0
68000366	68	      *       Preserve the RESP and RESP2, then set up the	1	0	1
68000367	68	      *       standard ABEND info before getting the applid,	1	0	1
68000368	68	      *       date/time etc. and linking to the Abend Handler	1	0	1
68000369	68	      *       program.	1	0	1
68000370	68	      *	1	0	1
68000371	68	              INITIALIZE ABNDINFO-REC	0	0	0
68000372	68	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
68000373	68	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
68000374	68	      *	1	0	0
68000375	68	      *       Get supplemental information	1	0	1
68000376	68	      *	1	0	1
68000377	68	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
68000378	68	              END-EXEC	0	0	1
68000380	68	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
68000381	68	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
68000383	68	              PERFORM POPULATE-TIME-DATE	0	0	1
68000385	68	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
68000386	68	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
68000387	68	                    ':' DELIMITED BY SIZE,	0	0	1
68000388	68	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
68000389	68	                     ':' DELIMITED BY SIZE,	0	0	1
68000390	68	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
68000391	68	                     INTO ABND-TIME	0	0	1
68000392	68	              END-STRING	0	0	1
68000394	68	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
68000395	68	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
68000397	68	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
68000398	68	              END-EXEC	0	0	1
68000400	68	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
68000402	68	              STRING 'RM010 - RECEIVE MAP FAIL.'	0	0	1
68000403	68	                    DELIMITED BY SIZE,	0	0	1
68000404	68	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
68000405	68	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
68000406	68	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
68000407	68	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
68000408	68	                    INTO ABND-FREEFORM	0	0	1
68000409	68	              END-STRING	0	0	1
68000411	68	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
68000412	68	                        COMMAREA(ABNDINFO-REC)	0	0	1
68000413	68	              END-EXEC	0	0	1
68000416	68	              INITIALIZE WS-FAIL-INFO	0	0	1
68000417	68	              MOVE 'BNK1TFN - RM010 - RECEIVE MAP FAIL ' TO	0	0	1
68000418	68	                 WS-CICS-FAIL-MSG	0	0	1
68000419	68	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
68000420	68	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
68000421	68	              PERFORM ABEND-THIS-TASK	0	0	1
68000422	68	           END-IF.	0	0	1
68000424	68	       RM999.	0	0	1
68000425	68	           EXIT.	0	0	1
68000428	68	       EDIT-DATA SECTION.	0	0	1
68000429	68	       ED010.	0	0	1
68000430	68	      *	1	0	0
68000431	68	      *    Perform validation on the incoming fields	1	0	1
68000432	68	      *	1	0	1
68000433	68	           EXEC CICS BIF DEEDIT	0	0	0
68000434	68	              FIELD(FACCNOI)	0	0	1
68000435	68	           END-EXEC.	0	0	1
68000437	68	           IF FACCNOI NOT NUMERIC	0	0	1
68000438	68	              MOVE 'Please enter a FROM account no  ' TO	0	0	1
68000439	68	                 MESSAGEO	0	0	1
68000440	68	              MOVE 'N' TO VALID-DATA-SW	0	0	1
68000441	68	              GO TO ED999	0	0	1
68000442	68	           END-IF.	0	0	1
68000444	68	           EXEC CICS BIF DEEDIT	0	0	1
68000445	68	              FIELD(TACCNOI)	0	0	1
68000446	68	           END-EXEC.	0	0	1
68000448	68	           IF TACCNOI NOT NUMERIC	0	0	1
68000449	68	              MOVE 'Please enter a TO account no    ' TO	0	0	1
68000450	68	                 MESSAGEO	0	0	1
68000451	68	              MOVE 'N' TO VALID-DATA-SW	0	0	1
68000452	68	              GO TO ED999	0	0	1
68000453	68	           END-IF.	0	0	1
68000455	68	           IF FACCNOI = TACCNOI	0	0	1
68000456	68	              MOVE 'The FROM & TO account should be different ' TO	0	0	1
68000457	68	                 MESSAGEO	0	0	1
68000458	68	              MOVE 'N' TO VALID-DATA-SW	0	0	1
68000459	68	              GO TO ED999	0	0	1
68000460	68	           END-IF.	0	0	1
68000462	68	           IF FACCNOI = '00000000' OR TACCNOI = '00000000'	0	0	1
68000463	68	              MOVE 'Account no 00000000 is not valid          ' TO	0	0	1
68000464	68	                 MESSAGEO	0	0	1
68000465	68	              MOVE 'N' TO VALID-DATA-SW	0	0	1
68000466	68	              GO TO ED999	0	0	1
68000467	68	           END-IF.	0	0	1
68000469	68	      *	1	0	0
68000470	68	      *    Validate the Amount entered	1	0	1
68000471	68	      *	1	0	1
68000472	68	           PERFORM VALIDATE-AMOUNT.	0	0	0
68000474	68	       ED999.	0	0	1
68000475	68	           EXIT.	0	0	1
68000478	68	       GET-ACC-DATA SECTION.	0	0	1
68000479	68	       GCD010.	0	0	1
68000480	68	      *	1	0	0
68000481	68	      *    Set up the fields required by XFRFUN then link to it to	1	0	1
68000482	68	      *    get account information and perform the transfer, then	1	0	1
68000483	68	      *    check what gets returned.	1	0	1
68000484	68	      *	1	0	1
68000485	68	           INITIALIZE SUBPGM-PARMS.	0	0	0
68000487	68	           MOVE FACCNOI TO  SUBPGM-FACCNO.	0	0	1
68000488	68	           MOVE TACCNOI TO  SUBPGM-TACCNO.	0	0	1
68000489	68	           MOVE 'N'     TO  SUBPGM-SUCCESS.	0	0	1
68000491	68	      *	1	0	0
68000492	68	      * Provide the correct Amount	1	0	1
68000493	68	      *	1	0	1
68000494	68	           MOVE WS-AMOUNT-AS-FLOAT TO SUBPGM-AMT.	0	0	0
68000496	68	           EXEC CICS LINK	0	0	1
68000497	68	              PROGRAM('XFRFUN')	0	0	1
68000498	68	              COMMAREA(SUBPGM-PARMS)	0	0	1
68000499	68	              RESP(WS-CICS-RESP)	0	0	1
68000500	68	              RESP2(WS-CICS-RESP2)	0	0	1
68000501	68	              SYNCONRETURN	0	0	1
68000502	68	           END-EXEC.	0	0	1
68000504	68	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
68000505	68	      *	1	0	0
68000506	68	      *       Preserve the RESP and RESP2, then set up the	1	0	1
68000507	68	      *       standard ABEND info before getting the applid,	1	0	1
68000508	68	      *       date/time etc. and linking to the Abend Handler	1	0	1
68000509	68	      *       program.	1	0	1
68000510	68	      *	1	0	1
68000511	68	              INITIALIZE ABNDINFO-REC	0	0	0
68000512	68	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
68000513	68	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
68000514	68	      *	1	0	0
68000515	68	      *       Get supplemental information	1	0	1
68000516	68	      *	1	0	1
68000517	68	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
68000518	68	              END-EXEC	0	0	1
68000520	68	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
68000521	68	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
68000523	68	              PERFORM POPULATE-TIME-DATE	0	0	1
68000525	68	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
68000526	68	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
68000527	68	                    ':' DELIMITED BY SIZE,	0	0	1
68000528	68	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
68000529	68	                     ':' DELIMITED BY SIZE,	0	0	1
68000530	68	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
68000531	68	                     INTO ABND-TIME	0	0	1
68000532	68	              END-STRING	0	0	1
68000534	68	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
68000535	68	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
68000537	68	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
68000538	68	              END-EXEC	0	0	1
68000540	68	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
68000542	68	              STRING 'GCD010 - LINK XFRFUN FAIL.'	0	0	1
68000543	68	                    DELIMITED BY SIZE,	0	0	1
68000544	68	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
68000545	68	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
68000546	68	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
68000547	68	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
68000548	68	                    INTO ABND-FREEFORM	0	0	1
68000549	68	              END-STRING	0	0	1
68000551	68	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
68000552	68	                        COMMAREA(ABNDINFO-REC)	0	0	1
68000553	68	              END-EXEC	0	0	1
68000555	68	              INITIALIZE WS-FAIL-INFO	0	0	1
68000556	68	              MOVE 'BNK1TFN - GCD010 - LINK XFRFUN  FAIL      '	0	0	1
68000557	68	                 TO WS-CICS-FAIL-MSG	0	0	1
68000558	68	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
68000559	68	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
68000560	68	              PERFORM ABEND-THIS-TASK	0	0	1
68000561	68	           END-IF.	0	0	1
68000563	68	      *	1	0	0
68000564	68	      *    Map the returned data to the screen output fields	1	0	1
68000565	68	      *	1	0	1
68000566	68	           MOVE SUBPGM-FACCNO    TO FACCNO2O	0	0	0
68000567	68	           MOVE SUBPGM-FSCODE    TO FSORTCO	0	0	1
68000568	68	           MOVE SUBPGM-TACCNO    TO TACCNO2O	0	0	1
68000569	68	           MOVE SUBPGM-TSCODE    TO TSORTCO	0	0	1
68000570	68	           MOVE ZERO             TO FROM-ACTUAL-BALANCE-DISPLAY	0	0	1
68000571	68	           MOVE ZERO             TO FROM-AVAILABLE-BALANCE-DISPLAY	0	0	1
68000572	68	           MOVE ZERO             TO TO-ACTUAL-BALANCE-DISPLAY	0	0	1
68000573	68	           MOVE ZERO             TO TO-AVAILABLE-BALANCE-DISPLAY	0	0	1
68000574	68	           MOVE FROM-ACTUAL-BALANCE-DISPLAY TO FACTBALO	0	0	1
68000575	68	           MOVE FROM-AVAILABLE-BALANCE-DISPLAY TO FAVBALO	0	0	1
68000576	68	           MOVE TO-ACTUAL-BALANCE-DISPLAY    TO TACTBALO	0	0	1
68000577	68	           MOVE TO-AVAILABLE-BALANCE-DISPLAY TO TAVBALO	0	0	1
68000579	68	      *	1	0	0
68000580	68	      *    If an error was flagged by XFRFUN then set up an appropriate	1	0	1
68000581	68	      *    error message.	1	0	1
68000582	68	           IF SUBPGM-SUCCESS = 'N'	0	0	0
68000584	68	              MOVE 'N' TO VALID-DATA-SW	0	0	1
68000586	68	              EVALUATE SUBPGM-FAIL-CODE	0	0	1
68000587	68	                 WHEN '1'	0	0	1
68000588	68	                    MOVE SPACES TO MESSAGEO	0	0	1
68000589	68	                    STRING 'Sorry the FROM ACCOUNT no was not found'	0	0	1
68000590	68	                           '. Transfer not applied. '	0	0	1
68000591	68	                           DELIMITED BY SIZE	0	0	1
68000592	68	                           INTO MESSAGEO	0	0	1
68000593	68	                    GO TO GCD999	0	0	1
68000595	68	                 WHEN '2'	0	0	1
68000596	68	                    MOVE SPACES TO MESSAGEO	0	0	1
68000597	68	                    STRING 'Sorry the TO ACCOUNT no was not found'	0	0	1
68000598	68	                           '. Transfer not applied. '	0	0	1
68000599	68	                           DELIMITED BY SIZE	0	0	1
68000600	68	                           INTO MESSAGEO	0	0	1
68000601	68	                    GO TO GCD999	0	0	1
68000603	68	                 WHEN '3'	0	0	1
68000604	68	                    MOVE SPACES TO MESSAGEO	0	0	1
68000605	68	                    STRING 'Sorry but the transfer could not be applied'	0	0	1
68000606	68	                           ' due to an unexpected error.'	0	0	1
68000607	68	                           DELIMITED BY SIZE	0	0	1
68000608	68	                           INTO MESSAGEO	0	0	1
68000610	68	                 WHEN '4'	0	0	1
68000611	68	                    MOVE SPACES TO MESSAGEO	0	0	1
68000612	68	                    STRING 'Please supply an amount greater than zero.'	0	0	1
68000613	68	                           DELIMITED BY SIZE	0	0	1
68000614	68	                           INTO MESSAGEO	0	0	1
68000615	68	                    GO TO GCD999	0	0	1
68000617	68	                 WHEN OTHER	0	0	1
68000618	68	                    MOVE SPACES TO MESSAGEO	0	0	1
68000619	68	                    STRING 'Sorry but the transfer could not be applied'	0	0	1
68000620	68	                           ' due to an error.'	0	0	1
68000621	68	                           DELIMITED BY SIZE	0	0	1
68000622	68	                           INTO MESSAGEO	0	0	1
68000623	68	                    GO TO GCD999	0	0	1
68000625	68	              END-EVALUATE	0	0	1
68000627	68	           END-IF.	0	0	1
68000629	68	           IF SUBPGM-SUCCESS NOT = 'Y'	0	0	1
68000630	68	              MOVE SPACES TO MESSAGEO	0	0	1
68000631	68	              STRING 'Sorry but the transfer could not be applied'	0	0	1
68000632	68	                     ' unable to determine success.'	0	0	1
68000633	68	                     DELIMITED BY SIZE	0	0	1
68000634	68	                     INTO MESSAGEO	0	0	1
68000635	68	              GO TO GCD999	0	0	1
68000636	68	           ELSE	0	0	1
68000637	68	              MOVE SPACES TO MESSAGEO	0	0	1
68000638	68	              MOVE 'Transfer successfully applied.             ' TO	0	0	1
68000639	68	                 MESSAGEO	0	0	1
68000640	68	           END-IF.	0	0	1
68000642	68	      *	1	0	0
68000643	68	      *    Map the remaining fields	1	0	1
68000644	68	      *	1	0	1
68000645	68	           MOVE SUBPGM-FACCNO    TO FACCNO2O.	0	0	0
68000646	68	           MOVE SUBPGM-FSCODE    TO FSORTCO.	0	0	1
68000647	68	           MOVE SUBPGM-TACCNO    TO TACCNO2O.	0	0	1
68000648	68	           MOVE SUBPGM-TSCODE    TO TSORTCO.	0	0	1
68000649	68	           MOVE SUBPGM-FACTBAL   TO FROM-ACTUAL-BALANCE-DISPLAY.	0	0	1
68000650	68	           MOVE SUBPGM-FAVBAL    TO FROM-AVAILABLE-BALANCE-DISPLAY.	0	0	1
68000651	68	           MOVE SUBPGM-TACTBAL   TO TO-ACTUAL-BALANCE-DISPLAY.	0	0	1
68000652	68	           MOVE SUBPGM-TAVBAL    TO TO-AVAILABLE-BALANCE-DISPLAY.	0	0	1
68000653	68	           MOVE FROM-ACTUAL-BALANCE-DISPLAY TO FACTBALO.	0	0	1
68000654	68	           MOVE FROM-AVAILABLE-BALANCE-DISPLAY TO FAVBALO.	0	0	1
68000655	68	           MOVE TO-ACTUAL-BALANCE-DISPLAY    TO TACTBALO.	0	0	1
68000656	68	           MOVE TO-AVAILABLE-BALANCE-DISPLAY TO TAVBALO.	0	0	1
68000658	68	       GCD999.	0	0	1
68000659	68	           EXIT.	0	0	1
68000662	68	       SEND-MAP SECTION.	0	0	1
68000663	68	       SM010.	0	0	1
68000664	68	      *	1	0	0
68000665	68	      *    Send/show the MAP	1	0	1
68000666	68	      *	1	0	1
68000668	68	      *	1	0	1
68000669	68	      *    If the map needs to have its data erased	1	0	1
68000670	68	      *	1	0	1
68000671	68	           IF SEND-ERASE	0	0	0
68000672	68	              EXEC CICS SEND MAP('BNK1TF')	0	0	1
68000673	68	                 MAPSET('BNK1TFM')	0	0	1
68000674	68	                 FROM(BNK1TFO)	0	0	1
68000675	68	                 ERASE	0	0	1
68000676	68	                 RESP(WS-CICS-RESP)	0	0	1
68000677	68	                 RESP2(WS-CICS-RESP2)	0	0	1
68000678	68	              END-EXEC	0	0	1
68000680	68	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
68000681	68	      *	1	0	0
68000682	68	      *          Preserve the RESP and RESP2, then set up the	1	0	1
68000683	68	      *          standard ABEND info before getting the applid,	1	0	1
68000684	68	      *          date/time etc. and linking to the Abend Handler	1	0	1
68000685	68	      *          program.	1	0	1
68000686	68	      *	1	0	1
68000687	68	                 INITIALIZE ABNDINFO-REC	0	0	0
68000688	68	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
68000689	68	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
68000690	68	      *	1	0	0
68000691	68	      *          Get supplemental information	1	0	1
68000692	68	      *	1	0	1
68000693	68	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
68000694	68	                 END-EXEC	0	0	1
68000696	68	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
68000697	68	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
68000699	68	                 PERFORM POPULATE-TIME-DATE	0	0	1
68000701	68	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
68000702	68	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
68000703	68	                       ':' DELIMITED BY SIZE,	0	0	1
68000704	68	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
68000705	68	                        ':' DELIMITED BY SIZE,	0	0	1
68000706	68	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
68000707	68	                        INTO ABND-TIME	0	0	1
68000708	68	                 END-STRING	0	0	1
68000710	68	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
68000711	68	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
68000713	68	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
68000714	68	                 END-EXEC	0	0	1
68000716	68	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
68000718	68	                 STRING 'SM010 - SEND MAP ERASE FAIL.'	0	0	1
68000719	68	                       DELIMITED BY SIZE,	0	0	1
68000720	68	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
68000721	68	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
68000722	68	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
68000723	68	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
68000724	68	                       INTO ABND-FREEFORM	0	0	1
68000725	68	                 END-STRING	0	0	1
68000727	68	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
68000728	68	                           COMMAREA(ABNDINFO-REC)	0	0	1
68000729	68	                 END-EXEC	0	0	1
68000731	68	                 INITIALIZE WS-FAIL-INFO	0	0	1
68000732	68	                 MOVE 'BNK1TFN - SM010 - SEND MAP ERASE FAIL '	0	0	1
68000733	68	                    TO WS-CICS-FAIL-MSG	0	0	1
68000734	68	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
68000735	68	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
68000736	68	                 PERFORM ABEND-THIS-TASK	0	0	1
68000737	68	              END-IF	0	0	1
68000739	68	              GO TO SM999	0	0	1
68000740	68	           END-IF.	0	0	1
68000742	68	      *	1	0	0
68000743	68	      *    If the map just needs a resend of only the data	1	0	1
68000744	68	      *	1	0	1
68000745	68	           IF SEND-DATAONLY	0	0	0
68000746	68	              EXEC CICS SEND MAP('BNK1TF')	0	0	1
68000747	68	                 MAPSET('BNK1TFM')	0	0	1
68000748	68	                 FROM(BNK1TFO)	0	0	1
68000749	68	                 DATAONLY	0	0	1
68000750	68	                 RESP(WS-CICS-RESP)	0	0	1
68000751	68	                 RESP2(WS-CICS-RESP2)	0	0	1
68000752	68	              END-EXEC	0	0	1
68000754	68	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
68000755	68	      *	1	0	0
68000756	68	      *          Preserve the RESP and RESP2, then set up the	1	0	1
68000757	68	      *          standard ABEND info before getting the applid,	1	0	1
68000758	68	      *          date/time etc. and linking to the Abend Handler	1	0	1
68000759	68	      *          program.	1	0	1
68000760	68	      *	1	0	1
68000761	68	                 INITIALIZE ABNDINFO-REC	0	0	0
68000762	68	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
68000763	68	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
68000764	68	      *	1	0	0
68000765	68	      *          Get supplemental information	1	0	1
68000766	68	      *	1	0	1
68000767	68	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
68000768	68	                 END-EXEC	0	0	1
68000770	68	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
68000771	68	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
68000773	68	                 PERFORM POPULATE-TIME-DATE	0	0	1
68000775	68	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
68000776	68	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
68000777	68	                       ':' DELIMITED BY SIZE,	0	0	1
68000778	68	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
68000779	68	                        ':' DELIMITED BY SIZE,	0	0	1
68000780	68	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
68000781	68	                        INTO ABND-TIME	0	0	1
68000782	68	                 END-STRING	0	0	1
68000784	68	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
68000785	68	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
68000787	68	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
68000788	68	                 END-EXEC	0	0	1
68000790	68	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
68000792	68	                 STRING 'SM010 - SEND MAP DATAONLY FAIL.'	0	0	1
68000793	68	                       DELIMITED BY SIZE,	0	0	1
68000794	68	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
68000795	68	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
68000796	68	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
68000797	68	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
68000798	68	                       INTO ABND-FREEFORM	0	0	1
68000799	68	                 END-STRING	0	0	1
68000801	68	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
68000802	68	                           COMMAREA(ABNDINFO-REC)	0	0	1
68000803	68	                 END-EXEC	0	0	1
68000805	68	                 INITIALIZE WS-FAIL-INFO	0	0	1
68000806	68	                 MOVE 'BNK1TFN - SM010 - SEND MAP DATAONLY FAIL '	0	0	1
68000807	68	                    TO WS-CICS-FAIL-MSG	0	0	1
68000808	68	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
68000809	68	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
68000810	68	                 PERFORM ABEND-THIS-TASK	0	0	1
68000811	68	              END-IF	0	0	1
68000813	68	              GO TO SM999	0	0	1
68000814	68	           END-IF.	0	0	1
68000816	68	      *	1	0	0
68000817	68	      *    If we have elected to send the map and a beep	1	0	1
68000818	68	      *	1	0	1
68000819	68	           IF SEND-DATAONLY-ALARM	0	0	0
68000820	68	              EXEC CICS SEND MAP('BNK1TF')	0	0	1
68000821	68	                 MAPSET('BNK1TFM')	0	0	1
68000822	68	                 FROM(BNK1TFO)	0	0	1
68000823	68	                 DATAONLY	0	0	1
68000824	68	                 ALARM	0	0	1
68000825	68	                 RESP(WS-CICS-RESP)	0	0	1
68000826	68	                 RESP2(WS-CICS-RESP2)	0	0	1
68000827	68	              END-EXEC	0	0	1
68000829	68	              IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
68000830	68	      *	1	0	0
68000831	68	      *          Preserve the RESP and RESP2, then set up the	1	0	1
68000832	68	      *          standard ABEND info before getting the applid,	1	0	1
68000833	68	      *          date/time etc. and linking to the Abend Handler	1	0	1
68000834	68	      *          program.	1	0	1
68000835	68	      *	1	0	1
68000836	68	                 INITIALIZE ABNDINFO-REC	0	0	0
68000837	68	                 MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
68000838	68	                 MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
68000839	68	      *	1	0	0
68000840	68	      *          Get supplemental information	1	0	1
68000841	68	      *	1	0	1
68000842	68	                 EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
68000843	68	                 END-EXEC	0	0	1
68000845	68	                 MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
68000846	68	                 MOVE EIBTRNID   TO ABND-TRANID	0	0	1
68000848	68	                 PERFORM POPULATE-TIME-DATE	0	0	1
68000850	68	                 MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
68000851	68	                 STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
68000852	68	                       ':' DELIMITED BY SIZE,	0	0	1
68000853	68	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
68000854	68	                        ':' DELIMITED BY SIZE,	0	0	1
68000855	68	                        WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
68000856	68	                        INTO ABND-TIME	0	0	1
68000857	68	                 END-STRING	0	0	1
68000859	68	                 MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
68000860	68	                 MOVE 'HBNK'      TO ABND-CODE	0	0	1
68000862	68	                 EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
68000863	68	                 END-EXEC	0	0	1
68000865	68	                 MOVE ZEROS      TO ABND-SQLCODE	0	0	1
68000867	68	                 STRING 'SM010 - SEND MAP DATAONLY ALARM FAIL.'	0	0	1
68000868	68	                       DELIMITED BY SIZE,	0	0	1
68000869	68	                       ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
68000870	68	                       ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
68000871	68	                       ' RESP2=' DELIMITED BY SIZE,	0	0	1
68000872	68	                       ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
68000873	68	                       INTO ABND-FREEFORM	0	0	1
68000874	68	                 END-STRING	0	0	1
68000876	68	                 EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
68000877	68	                           COMMAREA(ABNDINFO-REC)	0	0	1
68000878	68	                 END-EXEC	0	0	1
68000880	68	                 INITIALIZE WS-FAIL-INFO	0	0	1
68000881	68	                 MOVE 'BNK1TFN - SM010 - SEND MAP DATAONLY ALARM FAIL '	0	0	1
68000882	68	                    TO WS-CICS-FAIL-MSG	0	0	1
68000883	68	                 MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
68000884	68	                 MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
68000885	68	                 PERFORM ABEND-THIS-TASK	0	0	1
68000886	68	              END-IF	0	0	1
68000888	68	           END-IF.	0	0	1
68000890	68	       SM999.	0	0	1
68000891	68	           EXIT.	0	0	1
68000894	68	       SEND-TERMINATION-MSG SECTION.	0	0	1
68000895	68	       STM010.	0	0	1
68000896	68	      *	1	0	0
68000897	68	      *    Send the termination message	1	0	1
68000898	68	      *	1	0	1
68000899	68	           EXEC CICS SEND TEXT	0	0	0
68000900	68	              FROM(END-OF-SESSION-MESSAGE)	0	0	1
68000901	68	              ERASE	0	0	1
68000902	68	              FREEKB	0	0	1
68000903	68	              RESP(WS-CICS-RESP)	0	0	1
68000904	68	              RESP2(WS-CICS-RESP2)	0	0	1
68000905	68	           END-EXEC.	0	0	1
68000907	68	           IF WS-CICS-RESP NOT = DFHRESP(NORMAL)	0	0	1
68000908	68	      *	1	0	0
68000909	68	      *       Preserve the RESP and RESP2, then set up the	1	0	1
68000910	68	      *       standard ABEND info before getting the applid,	1	0	1
68000911	68	      *       date/time etc. and linking to the Abend Handler	1	0	1
68000912	68	      *       program.	1	0	1
68000913	68	      *	1	0	1
68000914	68	              INITIALIZE ABNDINFO-REC	0	0	0
68000915	68	              MOVE EIBRESP    TO ABND-RESPCODE	0	0	1
68000916	68	              MOVE EIBRESP2   TO ABND-RESP2CODE	0	0	1
68000917	68	      *	1	0	0
68000918	68	      *       Get supplemental information	1	0	1
68000919	68	      *	1	0	1
68000920	68	              EXEC CICS ASSIGN APPLID(ABND-APPLID)	0	0	0
68000921	68	              END-EXEC	0	0	1
68000923	68	              MOVE EIBTASKN   TO ABND-TASKNO-KEY	0	0	1
68000924	68	              MOVE EIBTRNID   TO ABND-TRANID	0	0	1
68000926	68	              PERFORM POPULATE-TIME-DATE	0	0	1
68000928	68	              MOVE WS-ORIG-DATE TO ABND-DATE	0	0	1
68000929	68	              STRING WS-TIME-NOW-GRP-HH DELIMITED BY SIZE,	0	0	1
68000930	68	                    ':' DELIMITED BY SIZE,	0	0	1
68000931	68	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE,	0	0	1
68000932	68	                     ':' DELIMITED BY SIZE,	0	0	1
68000933	68	                     WS-TIME-NOW-GRP-MM DELIMITED BY SIZE	0	0	1
68000934	68	                     INTO ABND-TIME	0	0	1
68000935	68	              END-STRING	0	0	1
68000937	68	              MOVE WS-U-TIME   TO ABND-UTIME-KEY	0	0	1
68000938	68	              MOVE 'HBNK'      TO ABND-CODE	0	0	1
68000940	68	              EXEC CICS ASSIGN PROGRAM(ABND-PROGRAM)	0	0	1
68000941	68	              END-EXEC	0	0	1
68000943	68	              MOVE ZEROS      TO ABND-SQLCODE	0	0	1
68000945	68	              STRING 'STM010 - SEND TEXT FAIL.'	0	0	1
68000946	68	                    DELIMITED BY SIZE,	0	0	1
68000947	68	                    ' EIBRESP=' DELIMITED BY SIZE,	0	0	1
68000948	68	                    ABND-RESPCODE DELIMITED BY SIZE,	0	0	1
68000949	68	                    ' RESP2=' DELIMITED BY SIZE,	0	0	1
68000950	68	                    ABND-RESP2CODE DELIMITED BY SIZE	0	0	1
68000951	68	                    INTO ABND-FREEFORM	0	0	1
68000952	68	              END-STRING	0	0	1
68000954	68	              EXEC CICS LINK PROGRAM(WS-ABEND-PGM)	0	0	1
68000955	68	                        COMMAREA(ABNDINFO-REC)	0	0	1
68000956	68	              END-EXEC	0	0	1
68000958	68	              INITIALIZE WS-FAIL-INFO	0	0	1
68000959	68	              MOVE 'BNK1TFN - STM010 - SEND TEXT FAIL'	0	0	1
68000960	68	                 TO WS-CICS-FAIL-MSG	0	0	1
68000961	68	              MOVE WS-CICS-RESP  TO WS-CICS-RESP-DISP	0	0	1
68000962	68	              MOVE WS-CICS-RESP2 TO WS-CICS-RESP2-DISP	0	0	1
68000963	68	              PERFORM ABEND-THIS-TASK	0	0	1
68000964	68	           END-IF.	0	0	1
68000966	68	       STM999.	0	0	1
68000967	68	           EXIT.	0	0	1
68000970	68	       ABEND-THIS-TASK SECTION.	0	0	1
68000971	68	       ATT010.	0	0	1
68000972	68	      *	1	0	0
68000973	68	      *    Issue an abend	1	0	1
68000974	68	      *	1	0	1
68000975	68	           DISPLAY WS-FAIL-INFO.	0	0	0
68000976	68	           EXEC CICS ABEND	0	0	1
68000977	68	              ABCODE('HBNK')	0	0	1
68000978	68	              NODUMP	0	0	1
68000979	68	           END-EXEC.	0	0	1
68000981	68	       ATT999.	0	0	1
68000982	68	           EXIT.	0	0	1
68000985	68	       VALIDATE-AMOUNT SECTION.	0	0	1
68000986	68	       VA010.	0	0	1
68000987	68	      *	1	0	0
68000988	68	      *    Validate the amount entered.	1	0	1
68000989	68	      *    Is it greater than 0?	1	0	1
68000990	68	      *	1	0	1
68000991	68	           IF AMTL = ZERO	0	0	0
68000992	68	              MOVE 'The Amount entered must be numeric.' TO	0	0	1
68000993	68	                 MESSAGEO	0	0	1
68000994	68	              MOVE 'N' TO VALID-DATA-SW	0	0	1
68000995	68	              MOVE -1 TO AMTL	0	0	1
68000996	68	              GO TO VA999	0	0	1
68000997	68	           END-IF	0	0	1
68000999	68	           IF AMTI(1:AMTL) IS NUMERIC	0	0	1
68001000	68	      *	1	0	0
68001001	68	      *       Is it a positive amount?	1	0	1
68001002	68	      *	1	0	1
68001003	68	              COMPUTE WS-AMOUNT-AS-FLOAT =	0	0	0
68001004	68	                 FUNCTION NUMVAL(AMTI(1:AMTL))	0	0	1
68001006	68	              IF WS-AMOUNT-AS-FLOAT <= 0	0	0	1
68001007	68	                 MOVE SPACES TO MESSAGEO	0	0	1
68001008	68	                 STRING 'Please supply a positive amount.'	0	0	1
68001009	68	                    DELIMITED BY SIZE,	0	0	1
68001010	68	                 INTO MESSAGEO	0	0	1
68001011	68	                 MOVE 'N' TO VALID-DATA-SW	0	0	1
68001012	68	                 MOVE -1 TO AMTL	0	0	1
68001013	68	                 GO TO VA999	0	0	1
68001014	68	              END-IF	0	0	1
68001015	68	              MOVE 'Y' TO VALID-DATA-SW	0	0	1
68001016	68	              GO TO VA999	0	0	1
68001017	68	           END-IF.	0	0	1
68001019	68	           MOVE ZERO TO WS-NUM-COUNT-TOTAL.	0	0	1
68001020	68	           INSPECT AMTI(1:AMTL) TALLYING WS-NUM-COUNT-TOTAL	0	0	1
68001021	68	              FOR LEADING SPACES.	0	0	1
68001023	68	      *	1	0	0
68001024	68	      *    Check if it is numeric	1	0	1
68001025	68	      *	1	0	1
68001026	68	           IF WS-NUM-COUNT-TOTAL = AMTL	0	0	0
68001027	68	              MOVE 'The Amount entered must be numeric.' TO	0	0	1
68001028	68	                 MESSAGEO	0	0	1
68001029	68	              MOVE 'N' TO VALID-DATA-SW	0	0	1
68001030	68	              MOVE -1 TO AMTL	0	0	1
68001031	68	              GO TO VA999	0	0	1
68001032	68	           END-IF.	0	0	1
68001034	68	           COMPUTE WS-AMOUNT-UNSTR-L = AMTL - WS-NUM-COUNT-TOTAL.	0	0	1
68001036	68	      D    DISPLAY 'There are ' ws-num-count-total ' leading spaces'	0	0	1
68001037	68	           IF WS-NUM-COUNT-TOTAL = ZERO	0	0	1
68001038	68	              MOVE SPACES TO WS-AMOUNT-UNSTR	0	0	1
68001039	68	              UNSTRING AMTI(1:AMTL)	0	0	1
68001040	68	                 INTO WS-AMOUNT-UNSTR	0	0	1
68001041	68	           ELSE	0	0	1
68001042	68	              MOVE SPACES TO WS-AMOUNT-UNSTR	0	0	1
68001043	68	              ADD 1 TO WS-NUM-COUNT-TOTAL GIVING WS-NUM-COUNT-TOTAL	0	0	1
68001044	68	              UNSTRING AMTI(WS-NUM-COUNT-TOTAL:AMTL)	0	0	1
68001045	68	                 INTO WS-AMOUNT-UNSTR	0	0	1
68001046	68	           END-IF.	0	0	1
68001048	68	           MOVE ZERO TO WS-NUM-COUNT-TOTAL.	0	0	1
68001050	68	           MOVE FUNCTION REVERSE(WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L))	0	0	1
68001051	68	              TO WS-AMOUNT-UNSTR-REVERSE.	0	0	1
68001053	68	           INSPECT WS-AMOUNT-UNSTR-REVERSE	0	0	1
68001054	68	              TALLYING WS-NUM-COUNT-TOTAL	0	0	1
68001055	68	              FOR LEADING SPACES.	0	0	1
68001057	68	           SUBTRACT WS-NUM-COUNT-TOTAL FROM WS-AMOUNT-UNSTR-L	0	0	1
68001058	68	              GIVING WS-AMOUNT-UNSTR-L.	0	0	1
68001060	68	           MOVE ZERO TO WS-NUM-COUNT-TOTAL WS-NUM-COUNT-SPACE	0	0	1
68001061	68	                        WS-NUM-COUNT-MINUS.	0	0	1
68001063	68	           INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)	0	0	1
68001064	68	              TALLYING	0	0	1
68001065	68	              WS-NUM-COUNT-TOTAL FOR ALL '0'	0	0	1
68001066	68	              WS-NUM-COUNT-TOTAL FOR ALL '1'	0	0	1
68001067	68	              WS-NUM-COUNT-TOTAL FOR ALL '2'	0	0	1
68001068	68	              WS-NUM-COUNT-TOTAL FOR ALL '3'	0	0	1
68001069	68	              WS-NUM-COUNT-TOTAL FOR ALL '4'	0	0	1
68001070	68	              WS-NUM-COUNT-TOTAL FOR ALL '5'	0	0	1
68001071	68	              WS-NUM-COUNT-TOTAL FOR ALL '6'	0	0	1
68001072	68	              WS-NUM-COUNT-TOTAL FOR ALL '7'	0	0	1
68001073	68	              WS-NUM-COUNT-TOTAL FOR ALL '8'	0	0	1
68001074	68	              WS-NUM-COUNT-TOTAL FOR ALL '9'	0	0	1
68001075	68	              WS-NUM-COUNT-TOTAL FOR ALL '.'	0	0	1
68001076	68	              WS-NUM-COUNT-SPACE FOR ALL ' '	0	0	1
68001077	68	              WS-NUM-COUNT-MINUS FOR ALL '-'.	0	0	1
68001079	68	      *	1	0	0
68001080	68	      *    We no longer support transferring negative amounts. Any -	1	0	1
68001081	68	      *    sign is a deal breaker!	1	0	1
68001082	68	      *	1	0	1
68001083	68	           IF WS-NUM-COUNT-MINUS > 0	0	0	0
68001084	68	              MOVE SPACES TO MESSAGEO	0	0	1
68001085	68	              STRING 'Please supply a positive amount.'	0	0	1
68001086	68	                 DELIMITED BY SIZE,	0	0	1
68001087	68	                 INTO MESSAGEO	0	0	1
68001088	68	              MOVE 'N' TO VALID-DATA-SW	0	0	1
68001089	68	              MOVE -1 TO AMTL	0	0	1
68001090	68	              GO TO VA999	0	0	1
68001091	68	           END-IF.	0	0	1
68001093	68	      *	1	0	0
68001094	68	      *    The idea here is that if there is a decimal point,	1	0	1
68001095	68	      *    the field is not numeric. But if it is 1.1 then it is valid.	1	0	1
68001096	68	      *    So first of all we check to see that only the above chars are	1	0	1
68001097	68	      *    OK.	1	0	1
68001098	68	      *    We DO NOT tolerate embedded spaces too.	1	0	1
68001099	68	      *	1	0	1
68001100	68	           IF WS-NUM-COUNT-SPACE > 0	0	0	0
68001101	68	              MOVE SPACES TO MESSAGEO	0	0	1
68001102	68	              STRING	0	0	1
68001103	68	                 'Please supply a numeric amount without embedded'	0	0	1
68001104	68	                 DELIMITED BY SIZE,	0	0	1
68001105	68	                 '  spaces.' DELIMITED BY SIZE	0	0	1
68001106	68	               INTO MESSAGEO	0	0	1
68001107	68	               MOVE 'N' TO VALID-DATA-SW	0	0	1
68001108	68	               MOVE -1 TO AMTL	0	0	1
68001109	68	               GO TO VA999	0	0	1
68001110	68	           END-IF.	0	0	1
68001112	68	           IF WS-NUM-COUNT-TOTAL < WS-AMOUNT-UNSTR-L	0	0	1
68001113	68	              MOVE SPACES TO MESSAGEO	0	0	1
68001114	68	              STRING 'Please supply a numeric amount.'	0	0	1
68001115	68	                 DELIMITED BY SIZE,	0	0	1
68001116	68	                 INTO MESSAGEO	0	0	1
68001117	68	              MOVE 'N' TO VALID-DATA-SW	0	0	1
68001118	68	              MOVE -1 TO AMTL	0	0	1
68001119	68	              GO TO VA999	0	0	1
68001120	68	           END-IF.	0	0	1
68001122	68	      *	1	0	0
68001123	68	      *    Check to make sure we only have 0 to 1 decimal points	1	0	1
68001124	68	      *	1	0	1
68001125	68	           MOVE ZERO TO WS-NUM-COUNT-POINT.	0	0	0
68001126	68	           INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)	0	0	1
68001127	68	              TALLYING	0	0	1
68001128	68	              WS-NUM-COUNT-POINT FOR ALL '.'.	0	0	1
68001130	68	           IF WS-NUM-COUNT-POINT > 1	0	0	1
68001131	68	              MOVE SPACES TO MESSAGEO	0	0	1
68001132	68	              STRING 'Use one decimal point for amount only.'	0	0	1
68001133	68	                 DELIMITED BY SIZE,	0	0	1
68001134	68	                 INTO MESSAGEO	0	0	1
68001135	68	              MOVE 'N' TO VALID-DATA-SW	0	0	1
68001136	68	              MOVE -1 TO AMTL	0	0	1
68001137	68	              GO TO VA999	0	0	1
68001138	68	           END-IF.	0	0	1
68001139	68	      *	1	0	0
68001140	68	      *    Check to see if we have too many decimals!	1	0	1
68001141	68	      *	1	0	1
68001142	68	           IF WS-NUM-COUNT-POINT = 1	0	0	0
68001143	68	              MOVE ZERO TO WS-NUM-COUNT-TOTAL	0	0	1
68001144	68	              INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)	0	0	1
68001145	68	                 TALLYING	0	0	1
68001146	68	                 WS-NUM-COUNT-TOTAL FOR CHARACTERS AFTER '.'	0	0	1
68001148	68	              IF WS-NUM-COUNT-TOTAL > 2	0	0	1
68001149	68	      D          DISPLAY 'WS-NUM-COUNT-TOTAL IS ' WS-NUM-COUNT-TOTAL	0	0	1
68001150	68	                 MOVE ZERO TO WS-NUM-COUNT-TOTAL WS-NUM-COUNT-POINT	0	0	1
68001151	68	                 INSPECT WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)	0	0	1
68001152	68	                    TALLYING WS-NUM-COUNT-POINT	0	0	1
68001153	68	                    FOR CHARACTERS BEFORE '.'	0	0	1
68001155	68	                 ADD 2 TO WS-NUM-COUNT-POINT GIVING WS-NUM-COUNT-POINT	0	0	1
68001156	68	                 INSPECT WS-AMOUNT-UNSTR	0	0	1
68001157	68	                    (WS-NUM-COUNT-POINT:WS-AMOUNT-UNSTR-L)	0	0	1
68001158	68	                    TALLYING	0	0	1
68001159	68	                    WS-NUM-COUNT-TOTAL FOR ALL '0'	0	0	1
68001160	68	                    WS-NUM-COUNT-TOTAL FOR ALL '1'	0	0	1
68001161	68	                    WS-NUM-COUNT-TOTAL FOR ALL '2'	0	0	1
68001162	68	                    WS-NUM-COUNT-TOTAL FOR ALL '3'	0	0	1
68001163	68	                    WS-NUM-COUNT-TOTAL FOR ALL '4'	0	0	1
68001164	68	                    WS-NUM-COUNT-TOTAL FOR ALL '5'	0	0	1
68001165	68	                    WS-NUM-COUNT-TOTAL FOR ALL '6'	0	0	1
68001166	68	                    WS-NUM-COUNT-TOTAL FOR ALL '7'	0	0	1
68001167	68	                    WS-NUM-COUNT-TOTAL FOR ALL '8'	0	0	1
68001168	68	                    WS-NUM-COUNT-TOTAL FOR ALL '9'	0	0	1
68001169	68	                    AFTER '.'	0	0	1
68001171	68	                 IF WS-NUM-COUNT-TOTAL > 2	0	0	1
68001172	68	      *	1	0	0
68001173	68	      *             More than two of them are numeric	1	0	1
68001174	68	      *	1	0	1
68001175	68	                    MOVE SPACES TO MESSAGEO	0	0	0
68001176	68	                    STRING	0	0	1
68001177	68	                       'Only up to two decimal places are supported.'	0	0	1
68001178	68	                       DELIMITED BY SIZE,	0	0	1
68001179	68	                    INTO MESSAGEO	0	0	1
68001180	68	                    MOVE 'N' TO VALID-DATA-SW	0	0	1
68001181	68	                    MOVE -1 TO AMTL	0	0	1
68001182	68	                    GO TO VA999	0	0	1
68001183	68	                 END-IF	0	0	1
68001184	68	              END-IF	0	0	1
68001185	68	           END-IF.	0	0	1
68001187	68	           COMPUTE WS-AMOUNT-AS-FLOAT =	0	0	1
68001188	68	              FUNCTION NUMVAL(WS-AMOUNT-UNSTR(1:WS-AMOUNT-UNSTR-L)).	0	0	1
68001190	68	           IF WS-AMOUNT-AS-FLOAT = ZERO	0	0	1
68001191	68	              MOVE SPACES TO MESSAGEO	0	0	1
68001192	68	              STRING 'Please supply a non-zero amount.'	0	0	1
68001193	68	                 DELIMITED BY SIZE,	0	0	1
68001194	68	                 INTO MESSAGEO	0	0	1
68001195	68	                 MOVE 'N' TO VALID-DATA-SW	0	0	1
68001196	68	                 MOVE -1 TO AMTL	0	0	1
68001197	68	                 GO TO VA999	0	0	1
68001198	68	           END-IF.	0	0	1
68001200	68	           MOVE SPACES TO MESSAGEO.	0	0	1
68001201	68	           MOVE 'Y' TO VALID-DATA-SW.	0	0	1
68001203	68	       VA999.	0	0	1
68001204	68	           EXIT.	0	0	1
68001207	68	       POPULATE-TIME-DATE SECTION.	0	0	1
68001208	68	       PTD010.	0	0	1
68001209	68	      *	1	0	0
68001210	68	      *    Fomate the date and time	1	0	1
68001211	68	      *	1	0	1
68001212	68	           EXEC CICS ASKTIME	0	0	0
68001213	68	              ABSTIME(WS-U-TIME)	0	0	1
68001214	68	           END-EXEC.	0	0	1
68001216	68	           EXEC CICS FORMATTIME	0	0	1
68001217	68	                     ABSTIME(WS-U-TIME)	0	0	1
68001218	68	                     DDMMYYYY(WS-ORIG-DATE)	0	0	1
68001219	68	                     TIME(WS-TIME-NOW)	0	0	1
68001220	68	                     DATESEP	0	0	1
68001221	68	           END-EXEC.	0	0	1
68001223	68	       PTD999.	0	0	1
68001224	68	           EXIT.	0	0	1
69000000	69	<<<< file not found >>>>	0	0	0
69000001	69	<<<< file not found >>>>	0	0	0
70000001	70	      ******************************************************************	1	0	0
70000002	70	      *                                                                *	1	0	0
70000003	70	      *  Copyright IBM Corp. 2023                                      *	1	0	0
70000004	70	      *                                                                *	1	0	0
70000005	70	      *                                                                *	1	0	0
70000006	70	      ******************************************************************	1	0	0
70000007	70	          03 COMM-EYE                  PIC X(4).	0	0	1
70000008	70	          03 COMM-SCODE                PIC X(6).	0	0	0
70000009	70	          03 COMM-CUSTNO               PIC X(10).	0	0	0
70000010	70	          03 COMM-NAME                 PIC X(60).	0	0	0
70000011	70	          03 COMM-ADDR                 PIC X(160).	0	0	0
70000012	70	          03 COMM-DOB                  PIC 9(8).	0	0	0
70000013	70	          03 COMM-DOB-GROUP REDEFINES COMM-DOB.	0	0	0
70000014	70	             05 COMM-BIRTH-DAY               PIC 99.	0	0	0
70000015	70	             05 COMM-BIRTH-MONTH             PIC 99.	0	0	0
70000016	70	             05 COMM-BIRTH-YEAR              PIC 9999.	0	0	0
70000017	70	          03 COMM-CREDIT-SCORE         PIC 9(3).	0	0	0
70000018	70	          03 COMM-CS-REVIEW-DATE       PIC 9(8).	0	0	0
70000019	70	          03 COMM-CS-GROUP REDEFINES COMM-CS-REVIEW-DATE.	0	0	0
70000020	70	             05 COMM-CS-DAY                  PIC 99.	0	0	0
70000021	70	             05 COMM-CS-MONTH                PIC 99.	0	0	0
70000022	70	             05 COMM-CS-YEAR                 PIC 9999.	0	0	0
70000023	70	          03 COMM-UPD-SUCCESS          PIC X.	0	0	0
70000024	70	          03 COMM-UPD-FAIL-CD          PIC X.	0	0	0
71000001	71	      ******************************************************************	1	0	1
71000002	71	      *                                                                *	1	0	0
71000003	71	      *  Copyright IBM Corp. 2023                                      *	1	0	0
71000004	71	      *                                                                *	1	0	0
71000005	71	      *                                                                *	1	0	0
71000006	71	      ******************************************************************	1	0	0
71000007	71	       01 INQACC-COMMAREA.	0	0	1
71000008	71	          03 INQACC-EYE                  PIC X(4).	0	0	0
71000009	71	          03 INQACC-CUSTNO               PIC 9(10).	0	0	0
71000010	71	          03 INQACC-SCODE                PIC 9(6).	0	0	0
71000011	71	          03 INQACC-ACCNO                PIC 9(8).	0	0	0
71000012	71	          03 INQACC-ACC-TYPE             PIC X(8).	0	0	0
71000013	71	          03 INQACC-INT-RATE             PIC 9(4)V99.	0	0	0
71000014	71	          03 INQACC-OPENED               PIC 9(8).	0	0	0
71000015	71	          03 INQACC-OPENED-GROUP REDEFINES INQACC-OPENED.	0	0	0
71000016	71	            05 INQACC-OPENED-DAY         PIC 99.	0	0	0
71000017	71	            05 INQACC-OPENED-MONTH         PIC 99.	0	0	0
71000018	71	            05 INQACC-OPENED-YEAR         PIC 9999.	0	0	0
71000019	71	          03 INQACC-OVERDRAFT            PIC 9(8).	0	0	0
71000020	71	          03 INQACC-LAST-STMT-DT         PIC 9(8).	0	0	0
71000021	71	          03 INQACC-LAST-STMT-GROUP REDEFINES INQACC-LAST-STMT-DT.	0	0	0
71000022	71	            05 INQACC-LAST-STMT-DAY         PIC 99.	0	0	0
71000023	71	            05 INQACC-LAST-STMT-MONTH         PIC 99.	0	0	0
71000024	71	            05 INQACC-LAST-STMT-YEAR         PIC 9999.	0	0	0
71000025	71	          03 INQACC-NEXT-STMT-DT         PIC 9(8).	0	0	0
71000026	71	          03 INQACC-NEXT-STMT-GROUP REDEFINES INQACC-NEXT-STMT-DT.	0	0	0
71000027	71	            05 INQACC-NEXT-STMT-DAY         PIC 99.	0	0	0
71000028	71	            05 INQACC-NEXT-STMT-MONTH         PIC 99.	0	0	0
71000029	71	            05 INQACC-NEXT-STMT-YEAR         PIC 9999.	0	0	0
71000030	71	          03 INQACC-AVAIL-BAL            PIC S9(10)V99.	0	0	0
71000031	71	          03 INQACC-ACTUAL-BAL           PIC S9(10)V99.	0	0	0
71000032	71	          03 INQACC-SUCCESS              PIC X.	0	0	0
71000033	71	          03 INQACC-PCB1-POINTER         PIC X(4).	0	0	0
72000001	72	      ******************************************************************	1	0	1
72000002	72	      *                                                                *	1	0	0
72000003	72	      *  Copyright IBM Corp. 2023                                      *	1	0	0
72000004	72	      *                                                                *	1	0	0
72000005	72	      *                                                                *	1	0	0
72000006	72	      ******************************************************************	1	0	0
72000007	72	           EXEC SQL DECLARE ACCOUNT TABLE	0	0	1
72000008	72	              ( ACCOUNT_EYECATCHER             CHAR(4),	0	0	0
72000009	72	                ACCOUNT_CUSTOMER_NUMBER        CHAR(10),	0	0	0
72000010	72	                ACCOUNT_SORTCODE               CHAR(6) NOT NULL,	0	0	0
72000011	72	                ACCOUNT_NUMBER                 CHAR(8) NOT NULL,	0	0	0
72000012	72	                ACCOUNT_TYPE                   CHAR(8),	0	0	0
72000013	72	                ACCOUNT_INTEREST_RATE          DECIMAL(4, 2),	0	0	0
72000014	72	                ACCOUNT_OPENED                 DATE,	0	0	0
72000015	72	                ACCOUNT_OVERDRAFT_LIMIT        INTEGER,	0	0	0
72000016	72	                ACCOUNT_LAST_STATEMENT         DATE,	0	0	0
72000017	72	                ACCOUNT_NEXT_STATEMENT         DATE,	0	0	0
72000018	72	                ACCOUNT_AVAILABLE_BALANCE      DECIMAL(10, 2),	0	0	0
72000019	72	                ACCOUNT_ACTUAL_BALANCE         DECIMAL(10, 2) )	0	0	0
72000020	72	           END-EXEC.	0	0	0
73000001	73	      ******************************************************************	1	0	1
73000002	73	      *                                                                *	1	0	0
73000003	73	      *  Copyright IBM Corp. 2023                                      *	1	0	0
73000004	73	      *                                                                *	1	0	0
73000005	73	      *                                                                *	1	0	0
73000006	73	      ******************************************************************	1	0	0
73000007	73	           03 GETCompanyOperation.	0	0	1
73000008	73	             06 company-name pic x(40).	0	0	0
74000001	74	      ******************************************************************	1	0	1
74000002	74	      *                                                                *	1	0	0
74000003	74	      *  Copyright IBM Corp. 2023                                      *	1	0	0
74000004	74	      *                                                                *	1	0	0
74000005	74	      *                                                                *	1	0	0
74000006	74	      ******************************************************************	1	0	0
74000007	74	       01 INQACC-COMMAREA.	0	0	1
74000008	74	          03 INQACC-EYE                  PIC X(4).	0	0	0
74000009	74	          03 INQACC-CUSTNO               PIC 9(10).	0	0	0
74000010	74	          03 INQACC-SCODE                PIC 9(6).	0	0	0
74000011	74	          03 INQACC-ACCNO                PIC 9(8).	0	0	0
74000012	74	          03 INQACC-ACC-TYPE             PIC X(8).	0	0	0
74000013	74	          03 INQACC-INT-RATE             PIC 9(4)V99.	0	0	0
74000014	74	          03 INQACC-OPENED               PIC 9(8).	0	0	0
74000015	74	          03 INQACC-OPENED-GROUP REDEFINES INQACC-OPENED.	0	0	0
74000016	74	            05 INQACC-OPENED-DAY         PIC 99.	0	0	0
74000017	74	            05 INQACC-OPENED-MONTH         PIC 99.	0	0	0
74000018	74	            05 INQACC-OPENED-YEAR         PIC 9999.	0	0	0
74000019	74	          03 INQACC-OVERDRAFT            PIC 9(8).	0	0	0
74000020	74	          03 INQACC-LAST-STMT-DT         PIC 9(8).	0	0	0
74000021	74	          03 INQACC-LAST-STMT-GROUP REDEFINES INQACC-LAST-STMT-DT.	0	0	0
74000022	74	            05 INQACC-LAST-STMT-DAY         PIC 99.	0	0	0
74000023	74	            05 INQACC-LAST-STMT-MONTH         PIC 99.	0	0	0
74000024	74	            05 INQACC-LAST-STMT-YEAR         PIC 9999.	0	0	0
74000025	74	          03 INQACC-NEXT-STMT-DT         PIC 9(8).	0	0	0
74000026	74	          03 INQACC-NEXT-STMT-GROUP REDEFINES INQACC-NEXT-STMT-DT.	0	0	0
74000027	74	            05 INQACC-NEXT-STMT-DAY         PIC 99.	0	0	0
74000028	74	            05 INQACC-NEXT-STMT-MONTH         PIC 99.	0	0	0
74000029	74	            05 INQACC-NEXT-STMT-YEAR         PIC 9999.	0	0	0
74000030	74	          03 INQACC-AVAIL-BAL            PIC S9(10)V99.	0	0	0
74000031	74	          03 INQACC-ACTUAL-BAL           PIC S9(10)V99.	0	0	0
74000032	74	          03 INQACC-SUCCESS              PIC X.	0	0	0
74000033	74	          03 INQACC-PCB1-POINTER         POINTER.	0	0	0
75000001	75	      ******************************************************************	1	0	1
75000002	75	      *                                                                *	1	0	0
75000003	75	      *  Copyright IBM Corp. 2023                                      *	1	0	0
75000004	75	      *                                                                *	1	0	0
75000005	75	      *                                                                *	1	0	0
75000006	75	      ******************************************************************	1	0	0
75000007	75	           05 Customer-Number-Key.	0	0	1
75000008	75	              10 CNO-KEY                  PIC 9(10) DISPLAY.	0	0	0
76000001	76	      ******************************************************************	1	0	1
76000002	76	      *                                                                *	1	0	0
76000003	76	      *  Copyright IBM Corp. 2023                                      *	1	0	0
76000004	76	      *                                                                *	1	0	0
76000005	76	      *                                                                *	1	0	0
76000006	76	      ******************************************************************	1	0	0
76000007	76	       01  BNK1DDI.	0	0	1
76000008	76	           02  FILLER PIC X(12).	0	0	0
76000009	76	           02  COMPANYL    COMP  PIC  S9(4).	0	0	0
76000010	76	           02  COMPANYF    PICTURE X.	0	0	0
76000011	76	           02  FILLER REDEFINES COMPANYF.	0	0	0
76000012	76	             03 COMPANYA    PICTURE X.	0	0	0
76000013	76	           02  FILLER   PICTURE X(6).	0	0	0
76000014	76	           02  COMPANYI  PIC X(56).	0	0	0
76000015	76	           02  MESSAGEL    COMP  PIC  S9(4).	0	0	0
76000016	76	           02  MESSAGEF    PICTURE X.	0	0	0
76000017	76	           02  FILLER REDEFINES MESSAGEF.	0	0	0
76000018	76	             03 MESSAGEA    PICTURE X.	0	0	0
76000019	76	           02  FILLER   PICTURE X(6).	0	0	0
76000020	76	           02  MESSAGEI  PIC X(79).	0	0	0
76000021	76	           02  DUMMYL    COMP  PIC  S9(4).	0	0	0
76000022	76	           02  DUMMYF    PICTURE X.	0	0	0
76000023	76	           02  FILLER REDEFINES DUMMYF.	0	0	0
76000024	76	             03 DUMMYA    PICTURE X.	0	0	0
76000025	76	           02  FILLER   PICTURE X(6).	0	0	0
76000026	76	           02  DUMMYI  PIC X(1).	0	0	0
76000027	76	       01  BNK1DDO REDEFINES BNK1DDI.	0	0	0
76000028	76	           02  FILLER PIC X(12).	0	0	0
76000029	76	           02  FILLER PICTURE X(3).	0	0	0
76000030	76	           02  COMPANYC    PICTURE X.	0	0	0
76000031	76	           02  COMPANYP    PICTURE X.	0	0	0
76000032	76	           02  COMPANYH    PICTURE X.	0	0	0
76000033	76	           02  COMPANYV    PICTURE X.	0	0	0
76000034	76	           02  COMPANYU    PICTURE X.	0	0	0
76000035	76	           02  COMPANYM    PICTURE X.	0	0	0
76000036	76	           02  COMPANYO  PIC X(56).	0	0	0
76000037	76	           02  FILLER PICTURE X(3).	0	0	0
76000038	76	           02  MESSAGEC    PICTURE X.	0	0	0
76000039	76	           02  MESSAGEP    PICTURE X.	0	0	0
76000040	76	           02  MESSAGEH    PICTURE X.	0	0	0
76000041	76	           02  MESSAGEV    PICTURE X.	0	0	0
76000042	76	           02  MESSAGEU    PICTURE X.	0	0	0
76000043	76	           02  MESSAGEM    PICTURE X.	0	0	0
76000044	76	           02  MESSAGEO  PIC X(79).	0	0	0
76000045	76	           02  FILLER PICTURE X(3).	0	0	0
76000046	76	           02  DUMMYC    PICTURE X.	0	0	0
76000047	76	           02  DUMMYP    PICTURE X.	0	0	0
76000048	76	           02  DUMMYH    PICTURE X.	0	0	0
76000049	76	           02  DUMMYV    PICTURE X.	0	0	0
76000050	76	           02  DUMMYU    PICTURE X.	0	0	0
76000051	76	           02  DUMMYM    PICTURE X.	0	0	0
76000052	76	           02  DUMMYO  PIC X(1).	0	0	0
77000001	77	      ******************************************************************	1	0	1
77000002	77	      *                                                                *	1	0	0
77000003	77	      *  Copyright IBM Corp. 2023                                      *	1	0	0
77000004	77	      *                                                                *	1	0	0
77000005	77	      *                                                                *	1	0	0
77000006	77	      ******************************************************************	1	0	0
77000007	77	           03 PROC-TRAN-DATA.	0	0	1
77000008	77	              05 PROC-TRAN-EYE-CATCHER        PIC X(4).	0	0	0
77000009	77	              88 PROC-TRAN-VALID VALUE 'PRTR'.	0	0	0
77000010	77	              05 PROC-TRAN-LOGICAL-DELETE-AREA REDEFINES	0	0	0
77000011	77	                 PROC-TRAN-EYE-CATCHER.	0	0	0
77000012	77	                 07 PROC-TRAN-LOGICAL-DELETE-FLAG PIC X.	0	0	0
77000013	77	                 88 PROC-TRAN-LOGICALLY-DELETED VALUE X'FF'.	0	0	0
77000014	77	                 07 FILLER PIC X(3).	0	0	0
77000015	77	              05 PROC-TRAN-ID.	0	0	0
77000016	77	                 07 PROC-TRAN-SORT-CODE       PIC 9(6).	0	0	0
77000017	77	                 07 PROC-TRAN-NUMBER          PIC 9(8).	0	0	0
77000018	77	              05 PROC-TRAN-DATE               PIC 9(8).	0	0	0
77000019	77	              05 PROC-TRAN-DATE-GRP REDEFINES PROC-TRAN-DATE.	0	0	0
77000020	77	                 07 PROC-TRAN-DATE-GRP-YYYY   PIC 9999.	0	0	0
77000021	77	                 07 PROC-TRAN-DATE-GRP-MM     PIC 99.	0	0	0
77000022	77	                 07 PROC-TRAN-DATE-GRP-DD     PIC 99.	0	0	0
77000023	77	              05 PROC-TRAN-TIME               PIC 9(6).	0	0	0
77000024	77	              05 PROC-TRAN-TIME-GRP REDEFINES PROC-TRAN-TIME.	0	0	0
77000025	77	                 07 PROC-TRAN-TIME-GRP-HH     PIC 99.	0	0	0
77000026	77	                 07 PROC-TRAN-TIME-GRP-MM     PIC 99.	0	0	0
77000027	77	                 07 PROC-TRAN-TIME-GRP-SS     PIC 99.	0	0	0
77000028	77	              05 PROC-TRAN-REF                PIC 9(12).	0	0	0
77000029	77	              05 PROC-TRAN-TYPE               PIC X(3).	0	0	0
77000030	77	              88 PROC-TY-CHEQUE-ACKNOWLEDGED      VALUE 'CHA'.	0	0	0
77000031	77	              88 PROC-TY-CHEQUE-FAILURE           VALUE 'CHF'.	0	0	0
77000032	77	              88 PROC-TY-CHEQUE-PAID-IN           VALUE 'CHI'.	0	0	0
77000033	77	              88 PROC-TY-CHEQUE-PAID-OUT          VALUE 'CHO'.	0	0	0
77000034	77	              88 PROC-TY-CREDIT                   VALUE 'CRE'.	0	0	0
77000035	77	              88 PROC-TY-DEBIT                    VALUE 'DEB'.	0	0	0
77000036	77	              88 PROC-TY-WEB-CREATE-ACCOUNT       VALUE 'ICA'.	0	0	0
77000037	77	              88 PROC-TY-WEB-CREATE-CUSTOMER      VALUE 'ICC'.	0	0	0
77000038	77	              88 PROC-TY-WEB-DELETE-ACCOUNT       VALUE 'IDA'.	0	0	0
77000039	77	              88 PROC-TY-WEB-DELETE-CUSTOMER      VALUE 'IDC'.	0	0	0
77000040	77	              88 PROC-TY-BRANCH-CREATE-ACCOUNT    VALUE 'OCA'.	0	0	0
77000041	77	              88 PROC-TY-BRANCH-CREATE-CUSTOMER   VALUE 'OCC'.	0	0	0
77000042	77	              88 PROC-TY-BRANCH-DELETE-ACCOUNT    VALUE 'ODA'.	0	0	0
77000043	77	              88 PROC-TY-BRANCH-DELETE-CUSTOMER   VALUE 'ODC'.	0	0	0
77000044	77	              88 PROC-TY-CREATE-SODD              VALUE 'OCS'.	0	0	0
77000045	77	              88 PROC-TY-PAYMENT-CREDIT           VALUE 'PCR'.	0	0	0
77000046	77	              88 PROC-TY-PAYMENT-DEBIT            VALUE 'PDR'.	0	0	0
77000047	77	              88 PROC-TY-TRANSFER                 VALUE 'TFR'.	0	0	0
77000048	77	              05 PROC-TRAN-DESC               PIC X(40).	0	0	0
77000049	77	              05 PROC-TRAN-DESC-XFR REDEFINES PROC-TRAN-DESC.	0	0	0
77000050	77	                07 PROC-TRAN-DESC-XFR-HEADER PIC X(26).	0	0	0
77000051	77	                88 PROC-TRAN-DESC-XFR-FLAG	0	0	0
77000052	77	                   VALUE 'TRANSFER'.	0	0	0
77000053	77	                07 PROC-TRAN-DESC-XFR-SORTCODE	0	0	0
77000054	77	                   PIC 9(6).	0	0	0
77000055	77	                07 PROC-TRAN-DESC-XFR-ACCOUNT	0	0	0
77000056	77	                   PIC 9(8).	0	0	0
77000057	77	              05 PROC-TRAN-DESC-DELACC REDEFINES PROC-TRAN-DESC.	0	0	0
77000058	77	                07 PROC-DESC-DELACC-CUSTOMER PIC 9(10).	0	0	0
77000059	77	                07 PROC-DESC-DELACC-ACCTYPE PIC X(8).	0	0	0
77000060	77	                07 PROC-DESC-DELACC-LAST-DD PIC 99.	0	0	0
77000061	77	                07 PROC-DESC-DELACC-LAST-MM PIC 99.	0	0	0
77000062	77	                07 PROC-DESC-DELACC-LAST-YYYY PIC 9999.	0	0	0
77000063	77	                07 PROC-DESC-DELACC-NEXT-DD PIC 99.	0	0	0
77000064	77	                07 PROC-DESC-DELACC-NEXT-MM PIC 99.	0	0	0
77000065	77	                07 PROC-DESC-DELACC-NEXT-YYYY PIC 9999.	0	0	0
77000066	77	                07 PROC-DESC-DELACC-FOOTER PIC X(6).	0	0	0
77000067	77	                88 PROC-DESC-DELACC-FLAG	0	0	0
77000068	77	                   VALUE 'DELETE'.	0	0	0
77000069	77	              05 PROC-TRAN-DESC-CREACC REDEFINES PROC-TRAN-DESC.	0	0	0
77000070	77	                07 PROC-DESC-CREACC-CUSTOMER PIC 9(10).	0	0	0
77000071	77	                07 PROC-DESC-CREACC-ACCTYPE PIC X(8).	0	0	0
77000072	77	                07 PROC-DESC-CREACC-LAST-DD PIC 99.	0	0	0
77000073	77	                07 PROC-DESC-CREACC-LAST-MM PIC 99.	0	0	0
77000074	77	                07 PROC-DESC-CREACC-LAST-YYYY PIC 9999.	0	0	0
77000075	77	                07 PROC-DESC-CREACC-NEXT-DD PIC 99.	0	0	0
77000076	77	                07 PROC-DESC-CREACC-NEXT-MM PIC 99.	0	0	0
77000077	77	                07 PROC-DESC-CREACC-NEXT-YYYY PIC 9999.	0	0	0
77000078	77	                07 PROC-DESC-CREACC-FOOTER PIC X(6).	0	0	0
77000079	77	                88 PROC-DESC-CREACC-FLAG	0	0	0
77000080	77	                   VALUE 'CREATE'.	0	0	0
77000081	77	              05 PROC-TRAN-DESC-DELCUS REDEFINES PROC-TRAN-DESC.	0	0	0
77000082	77	                07 PROC-DESC-DELCUS-SORTCODE PIC 9(6).	0	0	0
77000083	77	                07 PROC-DESC-DELCUS-CUSTOMER PIC 9(10).	0	0	0
77000084	77	                07 PROC-DESC-DELCUS-NAME     PIC X(14).	0	0	0
77000085	77	                07 PROC-DESC-DELCUS-DOB-YYYY  PIC 9999.	0	0	0
77000086	77	                07 PROC-DESC-DELCUS-FILLER    PIC X.	0	0	0
77000087	77	                88 PROC-DESC-DELCUS-FILLER-SET VALUE '-'.	0	0	0
77000088	77	                07 PROC-DESC-DELCUS-DOB-MM    PIC 99.	0	0	0
77000089	77	                07 PROC-DESC-DELCUS-FILLER2   PIC X.	0	0	0
77000090	77	                88 PROC-DESC-DELCUS-FILLER2-SET VALUE '-'.	0	0	0
77000091	77	                07 PROC-DESC-DELCUS-DOB-DD    PIC 99.	0	0	0
77000092	77	              05 PROC-TRAN-DESC-CRECUS REDEFINES PROC-TRAN-DESC.	0	0	0
77000093	77	                07 PROC-DESC-CRECUS-SORTCODE PIC 9(6).	0	0	0
77000094	77	                07 PROC-DESC-CRECUS-CUSTOMER PIC 9(10).	0	0	0
77000095	77	                07 PROC-DESC-CRECUS-NAME     PIC X(14).	0	0	0
77000096	77	                07 PROC-DESC-CRECUS-DOB-YYYY  PIC 9999.	0	0	0
77000097	77	                07 PROC-DESC-CRECUS-FILLER    PIC X.	0	0	0
77000098	77	                88 PROC-DESC-CRECUS-FILLER-SET VALUE '-'.	0	0	0
77000099	77	                07 PROC-DESC-CRECUS-DOB-MM    PIC 99.	0	0	0
77000100	77	                07 PROC-DESC-CRECUS-FILLER2   PIC X.	0	0	0
77000101	77	                88 PROC-DESC-CRECUS-FILLER2-SET VALUE '-'.	0	0	0
77000102	77	                07 PROC-DESC-CRECUS-DOB-DD    PIC 99.	0	0	0
77000103	77	              05 PROC-TRAN-AMOUNT             PIC S9(10)V99.	0	0	0
78000001	78	      ******************************************************************	1	0	1
78000002	78	      *                                                                *	1	0	0
78000003	78	      *  Copyright IBM Corp. 2023                                      *	1	0	0
78000004	78	      *                                                                *	1	0	0
78000005	78	      *                                                                *	1	0	0
78000006	78	      ******************************************************************	1	0	0
78000007	78	          03 NUMBER-OF-ACCOUNTS        PIC S9(8) BINARY.	0	0	1
78000008	78	          03 CUSTOMER-NUMBER           PIC 9(10).	0	0	0
78000009	78	          03 COMM-SUCCESS              PIC X.	0	0	0
78000010	78	          03 COMM-FAIL-CODE            PIC X.	0	0	0
78000011	78	          03 CUSTOMER-FOUND            PIC X.	0	0	0
78000012	78	          03 COMM-PCB-POINTER          PIC X(4).	0	0	0
78000013	78	          03 ACCOUNT-DETAILS OCCURS 1 TO 20 DEPENDING ON	0	0	0
78000014	78	              NUMBER-OF-ACCOUNTS.	0	0	0
78000015	78	            05 COMM-EYE                  PIC X(4).	0	0	0
78000016	78	            05 COMM-CUSTNO               PIC X(10).	0	0	0
78000017	78	            05 COMM-SCODE                PIC X(6).	0	0	0
78000018	78	            05 COMM-ACCNO                PIC 9(8).	0	0	0
78000019	78	            05 COMM-ACC-TYPE             PIC X(8).	0	0	0
78000020	78	            05 COMM-INT-RATE             PIC 9(4)V99.	0	0	0
78000021	78	            05 COMM-OPENED               PIC 9(8).	0	0	0
78000022	78	            05 COMM-OPENED-GROUP REDEFINES COMM-OPENED.	0	0	0
78000023	78	              07 COMM-OPENED-DAY PIC 99.	0	0	0
78000024	78	              07 COMM-OPENED-MONTH PIC 99.	0	0	0
78000025	78	              07 COMM-OPENED-YEAR PIC 9999.	0	0	0
78000026	78	            05 COMM-OVERDRAFT            PIC 9(8).	0	0	0
78000027	78	            05 COMM-LAST-STMT-DT         PIC 9(8).	0	0	0
78000028	78	            05 COMM-LAST-STMT-GROUP REDEFINES COMM-LAST-STMT-DT.	0	0	0
78000029	78	              07 COMM-LAST-STMT-DAY PIC 99.	0	0	0
78000030	78	              07 COMM-LAST-STMT-MONTH PIC 99.	0	0	0
78000031	78	              07 COMM-LAST-STMT-YEAR PIC 9999.	0	0	0
78000032	78	            05 COMM-NEXT-STMT-DT         PIC 9(8).	0	0	0
78000033	78	            05 COMM-NEXT-STMT-GROUP REDEFINES COMM-NEXT-STMT-DT.	0	0	0
78000034	78	              07 COMM-NEXT-STMT-DAY PIC 99.	0	0	0
78000035	78	              07 COMM-NEXT-STMT-MONTH PIC 99.	0	0	0
78000036	78	              07 COMM-NEXT-STMT-YEAR PIC 9999.	0	0	0
78000037	78	            05 COMM-AVAIL-BAL            PIC S9(10)V99.	0	0	0
78000038	78	            05 COMM-ACTUAL-BAL           PIC S9(10)V99.	0	0	0
79000001	79	      ******************************************************************	1	0	1
79000002	79	      *                                                                *	1	0	0
79000003	79	      *  Copyright IBM Corp. 2023                                      *	1	0	0
79000004	79	      *                                                                *	1	0	0
79000005	79	      *                                                                *	1	0	0
79000006	79	      ******************************************************************	1	0	0
79000007	79	          03 NUMBER-OF-ACCOUNTS        PIC S9(8) BINARY.	0	0	1
79000008	79	          03 CUSTOMER-NUMBER           PIC 9(10).	0	0	0
79000009	79	          03 COMM-SUCCESS              PIC X.	0	0	0
79000010	79	          03 COMM-FAIL-CODE            PIC X.	0	0	0
79000011	79	          03 CUSTOMER-FOUND            PIC X.	0	0	0
79000012	79	          03 COMM-PCB-POINTER          POINTER.	0	0	0
79000013	79	          03 ACCOUNT-DETAILS OCCURS 1 TO 20 DEPENDING ON	0	0	0
79000014	79	              NUMBER-OF-ACCOUNTS.	0	0	0
79000015	79	            05 COMM-EYE                  PIC X(4).	0	0	0
79000016	79	            05 COMM-CUSTNO               PIC X(10).	0	0	0
79000017	79	            05 COMM-SCODE                PIC X(6).	0	0	0
79000018	79	            05 COMM-ACCNO                PIC 9(8).	0	0	0
79000019	79	            05 COMM-ACC-TYPE             PIC X(8).	0	0	0
79000020	79	            05 COMM-INT-RATE             PIC 9(4)V99.	0	0	0
79000021	79	            05 COMM-OPENED               PIC 9(8).	0	0	0
79000022	79	            05 COMM-OPENED-GROUP REDEFINES COMM-OPENED.	0	0	0
79000023	79	              07 COMM-OPENED-DAY PIC 99.	0	0	0
79000024	79	              07 COMM-OPENED-MONTH PIC 99.	0	0	0
79000025	79	              07 COMM-OPENED-YEAR PIC 9999.	0	0	0
79000026	79	            05 COMM-OVERDRAFT            PIC 9(8).	0	0	0
79000027	79	            05 COMM-LAST-STMT-DT         PIC 9(8).	0	0	0
79000028	79	            05 COMM-LAST-STMT-GROUP REDEFINES COMM-LAST-STMT-DT.	0	0	0
79000029	79	              07 COMM-LAST-STMT-DAY PIC 99.	0	0	0
79000030	79	              07 COMM-LAST-STMT-MONTH PIC 99.	0	0	0
79000031	79	              07 COMM-LAST-STMT-YEAR PIC 9999.	0	0	0
79000032	79	            05 COMM-NEXT-STMT-DT         PIC 9(8).	0	0	0
79000033	79	            05 COMM-NEXT-STMT-GROUP REDEFINES COMM-NEXT-STMT-DT.	0	0	0
79000034	79	              07 COMM-NEXT-STMT-DAY PIC 99.	0	0	0
79000035	79	              07 COMM-NEXT-STMT-MONTH PIC 99.	0	0	0
79000036	79	              07 COMM-NEXT-STMT-YEAR PIC 9999.	0	0	0
79000037	79	            05 COMM-AVAIL-BAL            PIC S9(10)V99.	0	0	0
79000038	79	            05 COMM-ACTUAL-BAL           PIC S9(10)V99.	0	0	0
80000001	80	      ******************************************************************	1	0	1
80000002	80	      *                                                                *	1	0	0
80000003	80	      *  Copyright IBM Corp. 2023                                      *	1	0	0
80000004	80	      *                                                                *	1	0	0
80000005	80	      *                                                                *	1	0	0
80000006	80	      ******************************************************************	1	0	0
80000007	80	      * THIS IS AN EMPTY COPYBOOK	1	0	0
80000008	80	      * THIS IS JCs EDIT	1	0	0
81000001	81	      ******************************************************************	1	0	0
81000002	81	      *                                                                *	1	0	0
81000003	81	      *  Copyright IBM Corp. 2023                                      *	1	0	0
81000004	81	      *                                                                *	1	0	0
81000005	81	      *                                                                *	1	0	0
81000006	81	      ******************************************************************	1	0	0
81000007	81	              03 ACCOUNT-DATA.	0	0	1
81000008	81	                 05 ACCOUNT-EYE-CATCHER        PIC X(4).	0	0	0
81000009	81	                 88 ACCOUNT-EYECATCHER-VALUE        VALUE 'ACCT'.	0	0	0
81000010	81	                 05 ACCOUNT-CUST-NO            PIC 9(10).	0	0	0
81000011	81	                 05 ACCOUNT-KEY.	0	0	0
81000012	81	                    07 ACCOUNT-SORT-CODE       PIC 9(6).	0	0	0
81000013	81	                    07 ACCOUNT-NUMBER          PIC 9(8).	0	0	0
81000014	81	                 05 ACCOUNT-TYPE               PIC X(8).	0	0	0
81000015	81	                 05 ACCOUNT-INTEREST-RATE      PIC 9(4)V99.	0	0	0
81000016	81	                 05 ACCOUNT-OPENED             PIC 9(8).	0	0	0
81000017	81	                 05 ACCOUNT-OPENED-GROUP REDEFINES ACCOUNT-OPENED.	0	0	0
81000018	81	                    07 ACCOUNT-OPENED-DAY       PIC 99.	0	0	0
81000019	81	                    07 ACCOUNT-OPENED-MONTH     PIC 99.	0	0	0
81000020	81	                    07 ACCOUNT-OPENED-YEAR      PIC 9999.	0	0	0
81000021	81	                 05 ACCOUNT-OVERDRAFT-LIMIT    PIC 9(8).	0	0	0
81000022	81	                 05 ACCOUNT-LAST-STMT-DATE     PIC 9(8).	0	0	0
81000023	81	                 05 ACCOUNT-LAST-STMT-GROUP	0	0	0
81000024	81	                    REDEFINES ACCOUNT-LAST-STMT-DATE.	0	0	0
81000025	81	                    07 ACCOUNT-LAST-STMT-DAY   PIC 99.	0	0	0
81000026	81	                    07 ACCOUNT-LAST-STMT-MONTH PIC 99.	0	0	0
81000027	81	                    07 ACCOUNT-LAST-STMT-YEAR  PIC 9999.	0	0	0
81000028	81	                 05 ACCOUNT-NEXT-STMT-DATE     PIC 9(8).	0	0	0
81000029	81	                 05 ACCOUNT-NEXT-STMT-GROUP	0	0	0
81000030	81	                   REDEFINES ACCOUNT-NEXT-STMT-DATE.	0	0	0
81000031	81	                    07 ACCOUNT-NEXT-STMT-DAY   PIC 99.	0	0	0
81000032	81	                    07 ACCOUNT-NEXT-STMT-MONTH PIC 99.	0	0	0
81000033	81	                    07 ACCOUNT-NEXT-STMT-YEAR  PIC 9999.	0	0	0
81000034	81	                 05 ACCOUNT-AVAILABLE-BALANCE  PIC S9(10)V99.	0	0	0
81000035	81	                 05 ACCOUNT-ACTUAL-BALANCE     PIC S9(10)V99.	0	0	0
82000001	82	      ******************************************************************	1	0	1
82000002	82	      *                                                                *	1	0	0
82000003	82	      *  Copyright IBM Corp. 2023                                      *	1	0	0
82000004	82	      *                                                                *	1	0	0
82000005	82	      *                                                                *	1	0	0
82000006	82	      ******************************************************************	1	0	0
82000007	82	           EXEC SQL DECLARE STTESTER.CONTROL TABLE	0	0	1
82000008	82	                (CONTROL_NAME       CHAR(32) NOT NULL,	0	0	0
82000009	82	                 CONTROL_VALUE_NUM  INTEGER,	0	0	0
82000010	82	                 CONTROL_VALUE_STR  CHAR(40))	0	0	0
82000011	82	           END-EXEC.	0	0	0
83000001	83	      ******************************************************************	1	0	1
83000002	83	      *                                                                *	1	0	0
83000003	83	      *  Copyright IBM Corp. 2023                                      *	1	0	0
83000004	83	      *                                                                *	1	0	0
83000005	83	      ******************************************************************	1	0	0
83000006	83	          03 INQCUST-EYE                  PIC X(4).	0	0	1
83000007	83	          03 INQCUST-SCODE                PIC X(6).	0	0	0
83000008	83	          03 INQCUST-CUSTNO               PIC 9(10).	0	0	0
83000009	83	          03 INQCUST-NAME                 PIC X(60).	0	0	0
83000010	83	          03 INQCUST-ADDR                 PIC X(160).	0	0	0
83000011	83	          03 INQCUST-DOB.	0	0	0
83000012	83	            05 INQCUST-DOB-DD             PIC 99.	0	0	0
83000013	83	            05 INQCUST-DOB-MM             PIC 99.	0	0	0
83000014	83	            05 INQCUST-DOB-YYYY           PIC 9999.	0	0	0
83000015	83	          03 INQCUST-CREDIT-SCORE         PIC 999.	0	0	0
83000016	83	          03 INQCUST-CS-REVIEW-DT.	0	0	0
83000017	83	            05 INQCUST-CS-REVIEW-DD       PIC 99.	0	0	0
83000018	83	            05 INQCUST-CS-REVIEW-MM       PIC 99.	0	0	0
83000019	83	            05 INQCUST-CS-REVIEW-YYYY     PIC 9999.	0	0	0
83000020	83	          03 INQCUST-INQ-SUCCESS          PIC X.	0	0	0
83000021	83	          03 INQCUST-INQ-FAIL-CD          PIC X.	0	0	0
83000022	83	          03 INQCUST-PCB-POINTER          PIC X(4).	0	0	0
84000001	84	      ******************************************************************	1	0	1
84000002	84	      *                                                                *	1	0	0
84000003	84	      *  Copyright IBM Corp. 2023                                      *	1	0	0
84000004	84	      *                                                                *	1	0	0
84000005	84	      *                                                                *	1	0	0
84000006	84	      ******************************************************************	1	0	0
84000007	84	          03 NEWACCNO-FUNCTION  PIC X.	0	0	1
84000008	84	          88 NEWACCNO-FUNCTION-GETNEW VALUE 'G'.	0	0	0
84000009	84	          88 NEWACCNO-FUNCTION-ROLLBACK VALUE 'R'.	0	0	0
84000010	84	          88 NEWACCNO-FUNCTION-CURRENT VALUE 'C'.	0	0	0
84000011	84	          03 ACCOUNT-NUMBER                  PIC 9(8) DISPLAY.	0	0	0
84000012	84	          03 NEWACCNO-SUCCESS                    PIC X.	0	0	0
84000013	84	          03 NEWACCNO-FAIL-CODE                  PIC X.	0	0	0
85000001	85	      ******************************************************************	1	0	1
85000002	85	      *                                                                *	1	0	0
85000003	85	      *  Copyright IBM Corp. 2023                                      *	1	0	0
85000004	85	      *                                                                *	1	0	0
85000005	85	      *                                                                *	1	0	0
85000006	85	      ******************************************************************	1	0	0
85000007	85	           03 ABND-VSAM-KEY.	0	0	1
85000008	85	              05 ABND-UTIME-KEY                  PIC S9(15) COMP-3.	0	0	0
85000009	85	              05 ABND-TASKNO-KEY                 PIC 9(4).	0	0	0
85000010	85	           03 ABND-APPLID                        PIC X(8).	0	0	0
85000011	85	           03 ABND-TRANID                        PIC X(4).	0	0	0
85000012	85	           03 ABND-DATE                          PIC X(10).	0	0	0
85000013	85	           03 ABND-TIME                          PIC X(8).	0	0	0
85000014	85	           03 ABND-CODE                          PIC X(4).	0	0	0
85000015	85	           03 ABND-PROGRAM                       PIC X(8).	0	0	0
85000016	85	           03 ABND-RESPCODE                      PIC S9(8) DISPLAY	0	0	0
85000017	85	                  SIGN LEADING SEPARATE.	0	0	0
85000018	85	           03 ABND-RESP2CODE                     PIC S9(8) DISPLAY	0	0	0
85000019	85	                  SIGN LEADING SEPARATE.	0	0	0
85000020	85	           03 ABND-SQLCODE                       PIC S9(8) DISPLAY	0	0	0
85000021	85	                  SIGN LEADING SEPARATE.	0	0	0
85000022	85	           03 ABND-FREEFORM                      PIC X(600).	0	0	0
86000001	86	      ******************************************************************	1	0	1
86000002	86	      *                                                                *	1	0	0
86000003	86	      *  Copyright IBM Corp. 2023                                      *	1	0	0
86000004	86	      *                                                                *	1	0	0
86000005	86	      *                                                                *	1	0	0
86000006	86	      ******************************************************************	1	0	0
86000007	86	          03 COMM-ACCNO               PIC X(8).	0	0	1
86000008	86	          03 COMM-AMT                 PIC S9(10)V99.	0	0	0
86000009	86	          03 COMM-SORTC               PIC 9(6).	0	0	0
86000010	86	          03 COMM-AV-BAL              PIC S9(10)V99.	0	0	0
86000011	86	          03 COMM-ACT-BAL             PIC S9(10)V99.	0	0	0
86000012	86	          03 COMM-ORIGIN.	0	0	0
86000013	86	               05 COMM-APPLID           PIC X(8).	0	0	0
86000014	86	               05 COMM-USERID           PIC X(8).	0	0	0
86000015	86	               05 COMM-FACILITY-NAME    PIC X(8).	0	0	0
86000016	86	               05 COMM-NETWRK-ID        PIC X(8).	0	0	0
86000017	86	               05 COMM-FACILTYPE        PIC S9(8) COMP.	0	0	0
86000018	86	               05 FILLER                PIC X(4).	0	0	0
86000019	86	          03 COMM-SUCCESS             PIC X.	0	0	0
86000020	86	          03 COMM-FAIL-CODE           PIC X.	0	0	0
87000001	87	      ******************************************************************	1	0	1
87000002	87	      *                                                                *	1	0	0
87000003	87	      *  Copyright IBM Corp. 2023                                      *	1	0	0
87000004	87	      *                                                                *	1	0	0
87000005	87	      *                                                                *	1	0	0
87000006	87	      ******************************************************************	1	0	0
87000007	87	          03 COMM-EYECATCHER                 PIC X(4).	0	0	1
87000008	87	          03 COMM-KEY.	0	0	0
87000009	87	             05 COMM-SORTCODE                PIC 9(6) DISPLAY.	0	0	0
87000010	87	             05 COMM-NUMBER                  PIC 9(10) DISPLAY.	0	0	0
87000011	87	          03 COMM-NAME                       PIC X(60).	0	0	0
87000012	87	          03 COMM-ADDRESS                    PIC X(160).	0	0	0
87000013	87	          03 COMM-DATE-OF-BIRTH              PIC 9(8).	0	0	0
87000014	87	          03 COMM-DOB-GROUP REDEFINES COMM-DATE-OF-BIRTH.	0	0	0
87000015	87	             05 COMM-BIRTH-DAY               PIC 99.	0	0	0
87000016	87	             05 COMM-BIRTH-MONTH             PIC 99.	0	0	0
87000017	87	             05 COMM-BIRTH-YEAR              PIC 9999.	0	0	0
87000018	87	          03 COMM-CREDIT-SCORE               PIC 999.	0	0	0
87000019	87	          03 COMM-CS-REVIEW-DATE             PIC 9(8).	0	0	0
87000020	87	          03 COMM-CS-REVIEW-DATE-GROUP REDEFINES COMM-CS-REVIEW-DATE.	0	0	0
87000021	87	             05 COMM-CS-REVIEW-DD            PIC 99.	0	0	0
87000022	87	             05 COMM-CS-REVIEW-MM            PIC 99.	0	0	0
87000023	87	             05 COMM-CS-REVIEW-YYYY          PIC 9999.	0	0	0
87000024	87	          03 COMM-SUCCESS                    PIC X.	0	0	0
87000025	87	          03 COMM-FAIL-CODE                  PIC X.	0	0	0
88000001	88	      ******************************************************************	1	0	1
88000002	88	      *                                                                *	1	0	0
88000003	88	      *  Copyright IBM Corp. 2023                                      *	1	0	0
88000004	88	      *                                                                *	1	0	0
88000005	88	      *                                                                *	1	0	0
88000006	88	      ******************************************************************	1	0	0
88000007	88	           03 GETSORTCODEOperation.	0	0	1
88000008	88	             06 SORTCODE pic xXXXXX.	0	0	0
89000001	89	      ******************************************************************	1	0	1
89000002	89	      *                                                                *	1	0	0
89000003	89	      *  Copyright IBM Corp. 2023                                      *	1	0	0
89000004	89	      *                                                                *	1	0	0
89000005	89	      *                                                                *	1	0	0
89000006	89	      ******************************************************************	1	0	0
89000007	89	       01  CSTMAP1I.	0	0	1
89000008	89	           02  FILLER PIC X(12).	0	0	0
89000009	89	           02  CUSTEYEL    COMP  PIC  S9(4).	0	0	0
89000010	89	           02  CUSTEYEF    PICTURE X.	0	0	0
89000011	89	           02  FILLER REDEFINES CUSTEYEF.	0	0	0
89000012	89	             03 CUSTEYEA    PICTURE X.	0	0	0
89000013	89	           02  FILLER   PICTURE X(6).	0	0	0
89000014	89	           02  CUSTEYEI  PIC X(4).	0	0	0
89000015	89	           02  CUSTKEYL    COMP  PIC  S9(4).	0	0	0
89000016	89	           02  CUSTKEYF    PICTURE X.	0	0	0
89000017	89	           02  FILLER REDEFINES CUSTKEYF.	0	0	0
89000018	89	             03 CUSTKEYA    PICTURE X.	0	0	0
89000019	89	           02  FILLER   PICTURE X(6).	0	0	0
89000020	89	           02  CUSTKEYI  PIC X(10).	0	0	0
89000021	89	           02  CUSTNAMEL    COMP  PIC  S9(4).	0	0	0
89000022	89	           02  CUSTNAMEF    PICTURE X.	0	0	0
89000023	89	           02  FILLER REDEFINES CUSTNAMEF.	0	0	0
89000024	89	             03 CUSTNAMEA    PICTURE X.	0	0	0
89000025	89	           02  FILLER   PICTURE X(6).	0	0	0
89000026	89	           02  CUSTNAMEI  PIC X(60).	0	0	0
89000027	89	           02  ADDR1L    COMP  PIC  S9(4).	0	0	0
89000028	89	           02  ADDR1F    PICTURE X.	0	0	0
89000029	89	           02  FILLER REDEFINES ADDR1F.	0	0	0
89000030	89	             03 ADDR1A    PICTURE X.	0	0	0
89000031	89	           02  FILLER   PICTURE X(6).	0	0	0
89000032	89	           02  ADDR1I  PIC X(60).	0	0	0
89000033	89	           02  ADDR2L    COMP  PIC  S9(4).	0	0	0
89000034	89	           02  ADDR2F    PICTURE X.	0	0	0
89000035	89	           02  FILLER REDEFINES ADDR2F.	0	0	0
89000036	89	             03 ADDR2A    PICTURE X.	0	0	0
89000037	89	           02  FILLER   PICTURE X(6).	0	0	0
89000038	89	           02  ADDR2I  PIC X(60).	0	0	0
89000039	89	           02  ADDR3L    COMP  PIC  S9(4).	0	0	0
89000040	89	           02  ADDR3F    PICTURE X.	0	0	0
89000041	89	           02  FILLER REDEFINES ADDR3F.	0	0	0
89000042	89	             03 ADDR3A    PICTURE X.	0	0	0
89000043	89	           02  FILLER   PICTURE X(6).	0	0	0
89000044	89	           02  ADDR3I  PIC X(40).	0	0	0
89000045	89	           02  CUSTDOBL    COMP  PIC  S9(4).	0	0	0
89000046	89	           02  CUSTDOBF    PICTURE X.	0	0	0
89000047	89	           02  FILLER REDEFINES CUSTDOBF.	0	0	0
89000048	89	             03 CUSTDOBA    PICTURE X.	0	0	0
89000049	89	           02  FILLER   PICTURE X(6).	0	0	0
89000050	89	           02  CUSTDOBI  PIC X(10).	0	0	0
89000051	89	       01  CSTMAP1O REDEFINES CSTMAP1I.	0	0	0
89000052	89	           02  FILLER PIC X(12).	0	0	0
89000053	89	           02  FILLER PICTURE X(3).	0	0	0
89000054	89	           02  CUSTEYEC    PICTURE X.	0	0	0
89000055	89	           02  CUSTEYEP    PICTURE X.	0	0	0
89000056	89	           02  CUSTEYEH    PICTURE X.	0	0	0
89000057	89	           02  CUSTEYEV    PICTURE X.	0	0	0
89000058	89	           02  CUSTEYEU    PICTURE X.	0	0	0
89000059	89	           02  CUSTEYEM    PICTURE X.	0	0	0
89000060	89	           02  CUSTEYEO  PIC X(4).	0	0	0
89000061	89	           02  FILLER PICTURE X(3).	0	0	0
89000062	89	           02  CUSTKEYC    PICTURE X.	0	0	0
89000063	89	           02  CUSTKEYP    PICTURE X.	0	0	0
89000064	89	           02  CUSTKEYH    PICTURE X.	0	0	0
89000065	89	           02  CUSTKEYV    PICTURE X.	0	0	0
89000066	89	           02  CUSTKEYU    PICTURE X.	0	0	0
89000067	89	           02  CUSTKEYM    PICTURE X.	0	0	0
89000068	89	           02  CUSTKEYO  PIC X(10).	0	0	0
89000069	89	           02  FILLER PICTURE X(3).	0	0	0
89000070	89	           02  CUSTNAMEC    PICTURE X.	0	0	0
89000071	89	           02  CUSTNAMEP    PICTURE X.	0	0	0
89000072	89	           02  CUSTNAMEH    PICTURE X.	0	0	0
89000073	89	           02  CUSTNAMEV    PICTURE X.	0	0	0
89000074	89	           02  CUSTNAMEU    PICTURE X.	0	0	0
89000075	89	           02  CUSTNAMEM    PICTURE X.	0	0	0
89000076	89	           02  CUSTNAMEO  PIC X(60).	0	0	0
89000077	89	           02  FILLER PICTURE X(3).	0	0	0
89000078	89	           02  ADDR1C    PICTURE X.	0	0	0
89000079	89	           02  ADDR1P    PICTURE X.	0	0	0
89000080	89	           02  ADDR1H    PICTURE X.	0	0	0
89000081	89	           02  ADDR1V    PICTURE X.	0	0	0
89000082	89	           02  ADDR1U    PICTURE X.	0	0	0
89000083	89	           02  ADDR1M    PICTURE X.	0	0	0
89000084	89	           02  ADDR1O  PIC X(60).	0	0	0
89000085	89	           02  FILLER PICTURE X(3).	0	0	0
89000086	89	           02  ADDR2C    PICTURE X.	0	0	0
89000087	89	           02  ADDR2P    PICTURE X.	0	0	0
89000088	89	           02  ADDR2H    PICTURE X.	0	0	0
89000089	89	           02  ADDR2V    PICTURE X.	0	0	0
89000090	89	           02  ADDR2U    PICTURE X.	0	0	0
89000091	89	           02  ADDR2M    PICTURE X.	0	0	0
89000092	89	           02  ADDR2O  PIC X(60).	0	0	0
89000093	89	           02  FILLER PICTURE X(3).	0	0	0
89000094	89	           02  ADDR3C    PICTURE X.	0	0	0
89000095	89	           02  ADDR3P    PICTURE X.	0	0	0
89000096	89	           02  ADDR3H    PICTURE X.	0	0	0
89000097	89	           02  ADDR3V    PICTURE X.	0	0	0
89000098	89	           02  ADDR3U    PICTURE X.	0	0	0
89000099	89	           02  ADDR3M    PICTURE X.	0	0	0
89000100	89	           02  ADDR3O  PIC X(40).	0	0	0
89000101	89	           02  FILLER PICTURE X(3).	0	0	0
89000102	89	           02  CUSTDOBC    PICTURE X.	0	0	0
89000103	89	           02  CUSTDOBP    PICTURE X.	0	0	0
89000104	89	           02  CUSTDOBH    PICTURE X.	0	0	0
89000105	89	           02  CUSTDOBV    PICTURE X.	0	0	0
89000106	89	           02  CUSTDOBU    PICTURE X.	0	0	0
89000107	89	           02  CUSTDOBM    PICTURE X.	0	0	0
89000108	89	           02  CUSTDOBO  PIC X(10).	0	0	0
90000001	90	      ******************************************************************	1	0	1
90000002	90	      *                                                                *	1	0	0
90000003	90	      *  Copyright IBM Corp. 2023                                      *	1	0	0
90000004	90	      *                                                                *	1	0	0
90000005	90	      *                                                                *	1	0	0
90000006	90	      ******************************************************************	1	0	0
90000007	90	          03 NEWCUSNO-FUNCTION  PIC X.	0	0	1
90000008	90	          88 NEWCUSNO-FUNCTION-GETNEW VALUE 'G'.	0	0	0
90000009	90	          88 NEWCUSNO-FUNCTION-ROLLBACK VALUE 'R'.	0	0	0
90000010	90	          88 NEWCUSNO-FUNCTION-CURRENT VALUE 'C'.	0	0	0
90000011	90	          03 CUSTOMER-NUMBER                  PIC 9(10) DISPLAY.	0	0	0
90000012	90	          03 NEWCUSNO-SUCCESS                    PIC X.	0	0	0
90000013	90	          03 NEWCUSNO-FAIL-CODE                  PIC X.	0	0	0
91000001	91	      ******************************************************************	1	0	1
91000002	91	      *                                                                *	1	0	0
91000003	91	      *  Copyright IBM Corp. 2023                                      *	1	0	0
91000004	91	      *                                                                *	1	0	0
91000005	91	      *                                                                *	1	0	0
91000006	91	      ******************************************************************	1	0	0
91000007	91	      * to use this have EIBRESP-STRING PIC X(40).	1	0	0
91000008	91	      * add this copybook somewhere in the PROCEDURE DIVISION	1	0	0
91000009	91	      * perform EIBRESP-TOSTRING	1	0	0
91000010	91	       EIBRESP-TOSTRING.	0	0	1
91000011	91	           MOVE SPACES TO EIBRESP-STRING.	0	0	0
91000012	91	           EVALUATE EIBRESP	0	0	0
91000013	91	           WHEN DFHRESP(NORMAL)	0	0	0
91000014	91	             MOVE 'NORMAL' TO EIBRESP-STRING	0	0	0
91000015	91	           WHEN DFHRESP(ERROR)	0	0	0
91000016	91	             MOVE 'ERROR' TO EIBRESP-STRING	0	0	0
91000017	91	           WHEN DFHRESP(RDATT)	0	0	0
91000018	91	             MOVE 'RDATT' TO EIBRESP-STRING	0	0	0
91000019	91	           WHEN DFHRESP(WRBRK)	0	0	0
91000020	91	             MOVE 'WRBRK' TO EIBRESP-STRING	0	0	0
91000021	91	           WHEN DFHRESP(EOF)	0	0	0
91000022	91	             MOVE 'EOF' TO EIBRESP-STRING	0	0	0
91000023	91	           WHEN DFHRESP(EODS)	0	0	0
91000024	91	             MOVE 'EODS' TO EIBRESP-STRING	0	0	0
91000025	91	           WHEN DFHRESP(EOC)	0	0	0
91000026	91	             MOVE 'EOC' TO EIBRESP-STRING	0	0	0
91000027	91	           WHEN DFHRESP(INBFMH)	0	0	0
91000028	91	             MOVE 'INBFMH' TO EIBRESP-STRING	0	0	0
91000029	91	           WHEN DFHRESP(ENDINPT)	0	0	0
91000030	91	             MOVE 'ENDINPT' TO EIBRESP-STRING	0	0	0
91000031	91	           WHEN DFHRESP(NONVAL)	0	0	0
91000032	91	             MOVE 'NONVAL' TO EIBRESP-STRING	0	0	0
91000033	91	           WHEN DFHRESP(NOSTART)	0	0	0
91000034	91	             MOVE 'NOSTART' TO EIBRESP-STRING	0	0	0
91000035	91	           WHEN DFHRESP(TERMIDERR)	0	0	0
91000036	91	             MOVE 'TERMIDERR' TO EIBRESP-STRING	0	0	0
91000037	91	           WHEN DFHRESP(FILENOTFOUND)	0	0	0
91000038	91	             MOVE 'FILENOTFOUND' TO EIBRESP-STRING	0	0	0
91000039	91	           WHEN DFHRESP(NOTFND)	0	0	0
91000040	91	             MOVE 'NOTFND' TO EIBRESP-STRING	0	0	0
91000041	91	           WHEN DFHRESP(DUPREC)	0	0	0
91000042	91	             MOVE 'DUPREC' TO EIBRESP-STRING	0	0	0
91000043	91	           WHEN DFHRESP(DUPKEY)	0	0	0
91000044	91	             MOVE 'DUPKEY' TO EIBRESP-STRING	0	0	0
91000045	91	           WHEN DFHRESP(INVREQ)	0	0	0
91000046	91	             MOVE 'INVREQ' TO EIBRESP-STRING	0	0	0
91000047	91	           WHEN DFHRESP(IOERR)	0	0	0
91000048	91	             MOVE 'IOERR' TO EIBRESP-STRING	0	0	0
91000049	91	           WHEN DFHRESP(NOSPACE)	0	0	0
91000050	91	             MOVE 'NOSPACE' TO EIBRESP-STRING	0	0	0
91000051	91	           WHEN DFHRESP(NOTOPEN)	0	0	0
91000052	91	             MOVE 'NOTOPEN' TO EIBRESP-STRING	0	0	0
91000053	91	           WHEN DFHRESP(ENDFILE)	0	0	0
91000054	91	             MOVE 'ENDFILE' TO EIBRESP-STRING	0	0	0
91000055	91	           WHEN DFHRESP(ILLOGIC)	0	0	0
91000056	91	             MOVE 'ILLOGIC' TO EIBRESP-STRING	0	0	0
91000057	91	           WHEN DFHRESP(LENGERR)	0	0	0
91000058	91	             MOVE 'LENGERR' TO EIBRESP-STRING	0	0	0
91000059	91	           WHEN DFHRESP(QZERO)	0	0	0
91000060	91	             MOVE 'QZERO' TO EIBRESP-STRING	0	0	0
91000061	91	           WHEN DFHRESP(SIGNAL)	0	0	0
91000062	91	             MOVE 'SIGNAL' TO EIBRESP-STRING	0	0	0
91000063	91	           WHEN DFHRESP(QBUSY)	0	0	0
91000064	91	             MOVE 'QBUSY' TO EIBRESP-STRING	0	0	0
91000065	91	           WHEN DFHRESP(ITEMERR)	0	0	0
91000066	91	             MOVE 'ITEMERR' TO EIBRESP-STRING	0	0	0
91000067	91	           WHEN DFHRESP(PGMIDERR)	0	0	0
91000068	91	             MOVE 'PGMIDERR' TO EIBRESP-STRING	0	0	0
91000069	91	           WHEN DFHRESP(TRANSIDERR)	0	0	0
91000070	91	             MOVE 'TRANSIDERR' TO EIBRESP-STRING	0	0	0
91000071	91	           WHEN DFHRESP(ENDDATA)	0	0	0
91000072	91	             MOVE 'ENDDATA' TO EIBRESP-STRING	0	0	0
91000073	91	           WHEN DFHRESP(INVTSREQ)	0	0	0
91000074	91	             MOVE 'INVTSREQ' TO EIBRESP-STRING	0	0	0
91000075	91	           WHEN DFHRESP(EXPIRED)	0	0	0
91000076	91	             MOVE 'EXPIRED' TO EIBRESP-STRING	0	0	0
91000077	91	           WHEN DFHRESP(RETPAGE)	0	0	0
91000078	91	             MOVE 'RETPAGE' TO EIBRESP-STRING	0	0	0
91000079	91	           WHEN DFHRESP(RTEFAIL)	0	0	0
91000080	91	             MOVE 'RTEFAIL' TO EIBRESP-STRING	0	0	0
91000081	91	           WHEN DFHRESP(RTESOME)	0	0	0
91000082	91	             MOVE 'RTESOME' TO EIBRESP-STRING	0	0	0
91000083	91	           WHEN DFHRESP(TSIOERR)	0	0	0
91000084	91	             MOVE 'TSIOERR' TO EIBRESP-STRING	0	0	0
91000085	91	           WHEN DFHRESP(MAPFAIL)	0	0	0
91000086	91	             MOVE 'MAPFAIL' TO EIBRESP-STRING	0	0	0
91000087	91	           WHEN DFHRESP(INVERRTERM)	0	0	0
91000088	91	             MOVE 'INVERRTERM' TO EIBRESP-STRING	0	0	0
91000089	91	           WHEN DFHRESP(INVMPSZ)	0	0	0
91000090	91	             MOVE 'INVMPSZ' TO EIBRESP-STRING	0	0	0
91000091	91	           WHEN DFHRESP(IGREQID)	0	0	0
91000092	91	             MOVE 'IGREQID' TO EIBRESP-STRING	0	0	0
91000093	91	           WHEN DFHRESP(OVERFLOW)	0	0	0
91000094	91	             MOVE 'OVERFLOW' TO EIBRESP-STRING	0	0	0
91000095	91	           WHEN DFHRESP(INVLDC)	0	0	0
91000096	91	             MOVE 'INVLDC' TO EIBRESP-STRING	0	0	0
91000097	91	           WHEN DFHRESP(NOSTG)	0	0	0
91000098	91	             MOVE 'NOSTG' TO EIBRESP-STRING	0	0	0
91000099	91	           WHEN DFHRESP(JIDERR)	0	0	0
91000100	91	             MOVE 'JIDERR' TO EIBRESP-STRING	0	0	0
91000101	91	           WHEN DFHRESP(QIDERR)	0	0	0
91000102	91	             MOVE 'QIDERR' TO EIBRESP-STRING	0	0	0
91000103	91	           WHEN DFHRESP(NOJBUFSP)	0	0	0
91000104	91	             MOVE 'NOJBUFSP' TO EIBRESP-STRING	0	0	0
91000105	91	           WHEN DFHRESP(DSSTAT)	0	0	0
91000106	91	             MOVE 'DSSTAT' TO EIBRESP-STRING	0	0	0
91000107	91	           WHEN DFHRESP(SELNERR)	0	0	0
91000108	91	             MOVE 'SELNERR' TO EIBRESP-STRING	0	0	0
91000109	91	           WHEN DFHRESP(FUNCERR)	0	0	0
91000110	91	             MOVE 'FUNCERR' TO EIBRESP-STRING	0	0	0
91000111	91	           WHEN DFHRESP(UNEXPIN)	0	0	0
91000112	91	             MOVE 'UNEXPIN' TO EIBRESP-STRING	0	0	0
91000113	91	           WHEN DFHRESP(NOPASSBKRD)	0	0	0
91000114	91	             MOVE 'NOPASSBKRD' TO EIBRESP-STRING	0	0	0
91000115	91	           WHEN DFHRESP(NOPASSBKWR)	0	0	0
91000116	91	             MOVE 'NOPASSBKWR' TO EIBRESP-STRING	0	0	0
91000117	91	           WHEN DFHRESP(SYSIDERR)	0	0	0
91000118	91	             MOVE 'SYSIDERR' TO EIBRESP-STRING	0	0	0
91000119	91	           WHEN DFHRESP(ISCINVREQ)	0	0	0
91000120	91	             MOVE 'ISCINVREQ' TO EIBRESP-STRING	0	0	0
91000121	91	           WHEN DFHRESP(ENQBUSY)	0	0	0
91000122	91	             MOVE 'ENQBUSY' TO EIBRESP-STRING	0	0	0
91000123	91	           WHEN DFHRESP(ENVDEFERR)	0	0	0
91000124	91	             MOVE 'ENVDEFERR' TO EIBRESP-STRING	0	0	0
91000125	91	           WHEN DFHRESP(IGREQCD)	0	0	0
91000126	91	             MOVE 'IGREQCD' TO EIBRESP-STRING	0	0	0
91000127	91	           WHEN DFHRESP(SESSIONERR)	0	0	0
91000128	91	             MOVE 'SESSIONERR' TO EIBRESP-STRING	0	0	0
91000129	91	           WHEN DFHRESP(SYSBUSY)	0	0	0
91000130	91	             MOVE 'SYSBUSY' TO EIBRESP-STRING	0	0	0
91000131	91	           WHEN DFHRESP(SESSBUSY)	0	0	0
91000132	91	             MOVE 'SESSBUSY' TO EIBRESP-STRING	0	0	0
91000133	91	           WHEN DFHRESP(NOTALLOC)	0	0	0
91000134	91	             MOVE 'NOTALLOC' TO EIBRESP-STRING	0	0	0
91000135	91	           WHEN DFHRESP(CBIDERR)	0	0	0
91000136	91	             MOVE 'CBIDERR' TO EIBRESP-STRING	0	0	0
91000137	91	           WHEN DFHRESP(INVEXITREQ)	0	0	0
91000138	91	             MOVE 'INVEXITREQ' TO EIBRESP-STRING	0	0	0
91000139	91	           WHEN DFHRESP(INVPARTNSET)	0	0	0
91000140	91	             MOVE 'INVPARTNSET' TO EIBRESP-STRING	0	0	0
91000141	91	           WHEN DFHRESP(PARTNFAIL)	0	0	0
91000142	91	             MOVE 'PARTNFAIL' TO EIBRESP-STRING	0	0	0
91000143	91	           WHEN DFHRESP(USERIDERR)	0	0	0
91000144	91	             MOVE 'USERIDERR' TO EIBRESP-STRING	0	0	0
91000145	91	           WHEN DFHRESP(NOTAUTH)	0	0	0
91000146	91	             MOVE 'NOTAUTH' TO EIBRESP-STRING	0	0	0
91000147	91	           WHEN DFHRESP(SUPPRESSED)	0	0	0
91000148	91	             MOVE 'SUPPRESSED' TO EIBRESP-STRING	0	0	0
91000149	91	           WHEN DFHRESP(RESIDERR)	0	0	0
91000150	91	             MOVE 'RESIDERR' TO EIBRESP-STRING	0	0	0
91000151	91	           WHEN DFHRESP(NOSPOOL)	0	0	0
91000152	91	             MOVE 'NOSPOOL' TO EIBRESP-STRING	0	0	0
91000153	91	           WHEN DFHRESP(TERMERR)	0	0	0
91000154	91	             MOVE 'TERMERR' TO EIBRESP-STRING	0	0	0
91000155	91	           WHEN DFHRESP(ROLLEDBACK)	0	0	0
91000156	91	             MOVE 'ROLLEDBACK' TO EIBRESP-STRING	0	0	0
91000157	91	           WHEN DFHRESP(END)	0	0	0
91000158	91	             MOVE 'END' TO EIBRESP-STRING	0	0	0
91000159	91	           WHEN DFHRESP(DISABLED)	0	0	0
91000160	91	             MOVE 'DISABLED' TO EIBRESP-STRING	0	0	0
91000161	91	           WHEN DFHRESP(ALLOCERR)	0	0	0
91000162	91	             MOVE 'ALLOCERR' TO EIBRESP-STRING	0	0	0
91000163	91	           WHEN DFHRESP(STRELERR)	0	0	0
91000164	91	             MOVE 'STRELERR' TO EIBRESP-STRING	0	0	0
91000165	91	           WHEN DFHRESP(OPENERR)	0	0	0
91000166	91	             MOVE 'OPENERR' TO EIBRESP-STRING	0	0	0
91000167	91	           WHEN DFHRESP(SPOLBUSY)	0	0	0
91000168	91	             MOVE 'SPOLBUSY' TO EIBRESP-STRING	0	0	0
91000169	91	           WHEN DFHRESP(SPOLERR)	0	0	0
91000170	91	             MOVE 'SPOLERR' TO EIBRESP-STRING	0	0	0
91000171	91	           WHEN DFHRESP(NODEIDERR)	0	0	0
91000172	91	             MOVE 'NODEIDERR' TO EIBRESP-STRING	0	0	0
91000173	91	           WHEN DFHRESP(TASKIDERR)	0	0	0
91000174	91	             MOVE 'TASKIDERR' TO EIBRESP-STRING	0	0	0
91000175	91	           WHEN DFHRESP(DSNNOTFOUND)	0	0	0
91000176	91	             MOVE 'DSNNOTFOUND' TO EIBRESP-STRING	0	0	0
91000177	91	           WHEN DFHRESP(LOADING)	0	0	0
91000178	91	             MOVE 'LOADING' TO EIBRESP-STRING	0	0	0
91000179	91	           WHEN DFHRESP(MODELIDERR)	0	0	0
91000180	91	             MOVE 'MODELIDERR' TO EIBRESP-STRING	0	0	0
91000181	91	           WHEN DFHRESP(SESSIONERR)	0	0	0
91000182	91	             MOVE 'SESSIONERR' TO EIBRESP-STRING	0	0	0
91000183	91	           WHEN DFHRESP(OUTDESCRERR)	0	0	0
91000184	91	             MOVE 'OUTDESCRERR' TO EIBRESP-STRING	0	0	0
91000185	91	           WHEN DFHRESP(PARTNERIDERR)	0	0	0
91000186	91	             MOVE 'PARTNERIDERR' TO EIBRESP-STRING	0	0	0
91000187	91	           WHEN DFHRESP(PROFILEIDERR)	0	0	0
91000188	91	             MOVE 'PROFILEIDERR' TO EIBRESP-STRING	0	0	0
91000189	91	           WHEN DFHRESP(NETNAMEIDERR)	0	0	0
91000190	91	             MOVE 'NETNAMEIDERR' TO EIBRESP-STRING	0	0	0
91000191	91	           WHEN DFHRESP(LOCKED)	0	0	0
91000192	91	             MOVE 'LOCKED' TO EIBRESP-STRING	0	0	0
91000193	91	           WHEN DFHRESP(RECORDBUSY)	0	0	0
91000194	91	             MOVE 'RECORDBUSY' TO EIBRESP-STRING	0	0	0
91000195	91	           WHEN DFHRESP(UOWNOTFOUND)	0	0	0
91000196	91	             MOVE 'UOWNOTFOUND' TO EIBRESP-STRING	0	0	0
91000197	91	           WHEN DFHRESP(UOWLNOTFOUND)	0	0	0
91000198	91	             MOVE 'UOWLNOTFOUND' TO EIBRESP-STRING	0	0	0
91000199	91	           WHEN DFHRESP(LINKABEND)	0	0	0
91000200	91	             MOVE 'LINKABEND' TO EIBRESP-STRING	0	0	0
91000201	91	           WHEN DFHRESP(CHANGED)	0	0	0
91000202	91	             MOVE 'CHANGED' TO EIBRESP-STRING	0	0	0
91000203	91	           WHEN DFHRESP(PROCESSBUSY)	0	0	0
91000204	91	             MOVE 'PROCESSBUSY' TO EIBRESP-STRING	0	0	0
91000205	91	           WHEN DFHRESP(ACTIVITYBUSY)	0	0	0
91000206	91	             MOVE 'ACTIVITYBUSY' TO EIBRESP-STRING	0	0	0
91000207	91	           WHEN DFHRESP(PROCESSERR)	0	0	0
91000208	91	             MOVE 'PROCESSERR' TO EIBRESP-STRING	0	0	0
91000209	91	           WHEN DFHRESP(ACTIVITYERR)	0	0	0
91000210	91	             MOVE 'ACTIVITYERR' TO EIBRESP-STRING	0	0	0
91000211	91	           WHEN DFHRESP(CONTAINERERR)	0	0	0
91000212	91	             MOVE 'CONTAINERERR' TO EIBRESP-STRING	0	0	0
91000213	91	           WHEN DFHRESP(EVENTERR)	0	0	0
91000214	91	             MOVE 'EVENTERR' TO EIBRESP-STRING	0	0	0
91000215	91	           WHEN DFHRESP(TOKENERR)	0	0	0
91000216	91	             MOVE 'TOKENERR' TO EIBRESP-STRING	0	0	0
91000217	91	           WHEN DFHRESP(NOTFINISHED)	0	0	0
91000218	91	             MOVE 'NOTFINISHED' TO EIBRESP-STRING	0	0	0
91000219	91	           WHEN DFHRESP(POOLERR)	0	0	0
91000220	91	             MOVE 'POOLERR' TO EIBRESP-STRING	0	0	0
91000221	91	           WHEN DFHRESP(TIMERERR)	0	0	0
91000222	91	             MOVE 'TIMERERR' TO EIBRESP-STRING	0	0	0
91000223	91	           WHEN DFHRESP(SYMBOLERR)	0	0	0
91000224	91	             MOVE 'SYMBOLERR' TO EIBRESP-STRING	0	0	0
91000225	91	           WHEN DFHRESP(TEMPLATERR)	0	0	0
91000226	91	             MOVE 'TEMPLATERR' TO EIBRESP-STRING	0	0	0
91000227	91	           WHEN DFHRESP(NOTSUPERUSER)	0	0	0
91000228	91	             MOVE 'NOTSUPERUSER' TO EIBRESP-STRING	0	0	0
91000229	91	           WHEN DFHRESP(CSDERR)	0	0	0
91000230	91	             MOVE 'CSDERR' TO EIBRESP-STRING	0	0	0
91000231	91	           WHEN DFHRESP(DUPRES)	0	0	0
91000232	91	             MOVE 'DUPRES' TO EIBRESP-STRING	0	0	0
91000233	91	           WHEN DFHRESP(RESUNAVAIL)	0	0	0
91000234	91	             MOVE 'RESUNAVAIL' TO EIBRESP-STRING	0	0	0
91000235	91	           WHEN DFHRESP(CHANNELERR)	0	0	0
91000236	91	             MOVE 'CHANNELERR' TO EIBRESP-STRING	0	0	0
91000237	91	           WHEN DFHRESP(CCSIDERR)	0	0	0
91000238	91	             MOVE 'CCSIDERR' TO EIBRESP-STRING	0	0	0
91000239	91	           WHEN DFHRESP(TIMEDOUT)	0	0	0
91000240	91	             MOVE 'TIMEDOUT' TO EIBRESP-STRING	0	0	0
91000241	91	           WHEN DFHRESP(CODEPAGEERR)	0	0	0
91000242	91	             MOVE 'CODEPAGEERR' TO EIBRESP-STRING	0	0	0
91000243	91	           WHEN DFHRESP(INCOMPLETE)	0	0	0
91000244	91	             MOVE 'INCOMPLETE' TO EIBRESP-STRING	0	0	0
91000245	91	           END-EVALUATE.	0	0	0
91000246	91	       EIBRESP-TOSTRING-EXIT.	0	0	0
91000247	91	           EXIT.	0	0	0
92000001	92	      ******************************************************************	1	0	1
92000002	92	      *                                                                *	1	0	0
92000003	92	      *  Copyright IBM Corp. 2023                                      *	1	0	0
92000004	92	      *                                                                *	1	0	0
92000005	92	      *                                                                *	1	0	0
92000006	92	      ******************************************************************	1	0	0
92000007	92	       77 SORTCODE           PIC 9(6) VALUE 987654.	0	0	1
93000001	93	      ******************************************************************	1	0	1
93000002	93	      *                                                                *	1	0	0
93000003	93	      *  Copyright IBM Corp. 2023                                      *	1	0	0
93000004	93	      *                                                                *	1	0	0
93000005	93	      *                                                                *	1	0	0
93000006	93	      ******************************************************************	1	0	0
93000007	93	           03 CUSTOMER-CONTROL-RECORD.	0	0	1
93000008	93	              05 CUSTOMER-CONTROL-EYECATCHER             PIC X(4).	0	0	0
93000009	93	                 88 CUSTOMER-CONTROL-EYECATCHER-V        VALUE 'CTRL'.	0	0	0
93000010	93	              05 CUSTOMER-CONTROL-KEY.	0	0	0
93000011	93	                 07 CUSTOMER-CONTROL-SORTCODE        PIC 9(6) DISPLAY.	0	0	0
93000012	93	                 07 CUSTOMER-CONTROL-NUMBER          PIC 9(10) DISPLAY.	0	0	0
93000013	93	              05 NUMBER-OF-CUSTOMERS                 PIC 9(10) DISPLAY.	0	0	0
93000014	93	              05 LAST-CUSTOMER-NUMBER                PIC 9(10) DISPLAY.	0	0	0
93000015	93	              05 CUSTOMER-CONTROL-SUCCESS-FLAG       PIC X.	0	0	0
93000016	93	              88 CUSTOMER-CONTROL-SUCCESS VALUE 'Y'.	0	0	0
93000017	93	              05 CUSTOMER-CONTROL-FAIL-CODE PIC X.	0	0	0
93000018	93	              05 FILLER                              PIC X(38).	0	0	0
93000019	93	              05 FILLER                              PIC X(160).	0	0	0
93000020	93	              05 FILLER                              PIC 9(8).	0	0	0
93000021	93	              05 FILLER                              PIC 999.	0	0	0
93000022	93	              05 FILLER                              PIC 9(8).	0	0	0
94000001	94	      ******************************************************************	1	0	1
94000002	94	      *                                                                *	1	0	0
94000003	94	      *  Copyright IBM Corp. 2023                                      *	1	0	0
94000004	94	      *                                                                *	1	0	0
94000005	94	      *                                                                *	1	0	0
94000006	94	      ******************************************************************	1	0	0
94000007	94	          03 NUMBER-OF-ACCOUNTS        PIC S9(8) BINARY.	0	0	1
94000008	94	          03 CUSTOMER-NUMBER           PIC 9(10).	0	0	0
94000009	94	          03 COMM-SUCCESS              PIC X.	0	0	0
94000010	94	          03 COMM-FAIL-CODE            PIC X.	0	0	0
94000011	94	          03 CUSTOMER-FOUND            PIC X.	0	0	0
94000012	94	          03 COMM-PCB-POINTER          PIC X(4).	0	0	0
94000013	94	          03 ACCOUNT-DETAILS OCCURS 1 TO 20 DEPENDING ON	0	0	0
94000014	94	              NUMBER-OF-ACCOUNTS.	0	0	0
94000015	94	            05 COMM-EYE                  PIC X(4).	0	0	0
94000016	94	            05 COMM-CUSTNO               PIC X(10).	0	0	0
94000017	94	            05 COMM-SCODE                PIC X(6).	0	0	0
94000018	94	            05 COMM-ACCNO                PIC 9(8).	0	0	0
94000019	94	            05 COMM-ACC-TYPE             PIC X(8).	0	0	0
94000020	94	            05 COMM-INT-RATE             PIC 9(4)V99.	0	0	0
94000021	94	            05 COMM-OPENED               PIC 9(8).	0	0	0
94000022	94	            05 COMM-OPENED-GROUP REDEFINES COMM-OPENED.	0	0	0
94000023	94	              07 COMM-OPENED-DAY PIC 99.	0	0	0
94000024	94	              07 COMM-OPENED-MONTH PIC 99.	0	0	0
94000025	94	              07 COMM-OPENED-YEAR PIC 9999.	0	0	0
94000026	94	            05 COMM-OVERDRAFT            PIC 9(8).	0	0	0
94000027	94	            05 COMM-LAST-STMT-DT         PIC 9(8).	0	0	0
94000028	94	            05 COMM-LAST-STMT-GROUP REDEFINES COMM-LAST-STMT-DT.	0	0	0
94000029	94	              07 COMM-LAST-STMT-DAY PIC 99.	0	0	0
94000030	94	              07 COMM-LAST-STMT-MONTH PIC 99.	0	0	0
94000031	94	              07 COMM-LAST-STMT-YEAR PIC 9999.	0	0	0
94000032	94	            05 COMM-NEXT-STMT-DT         PIC 9(8).	0	0	0
94000033	94	            05 COMM-NEXT-STMT-GROUP REDEFINES COMM-NEXT-STMT-DT.	0	0	0
94000034	94	              07 COMM-NEXT-STMT-DAY PIC 99.	0	0	0
94000035	94	              07 COMM-NEXT-STMT-MONTH PIC 99.	0	0	0
94000036	94	              07 COMM-NEXT-STMT-YEAR PIC 9999.	0	0	0
94000037	94	            05 COMM-AVAIL-BAL            PIC S9(10)V99.	0	0	0
94000038	94	            05 COMM-ACTUAL-BAL           PIC S9(10)V99.	0	0	0
95000001	95	      ******************************************************************	1	0	1
95000002	95	      *                                                                *	1	0	0
95000003	95	      *  Copyright IBM Corp. 2023                                      *	1	0	0
95000004	95	      *                                                                *	1	0	0
95000005	95	      *                                                                *	1	0	0
95000006	95	      ******************************************************************	1	0	0
95000007	95	          03 COMM-EYE                  PIC X(4).	0	0	1
95000008	95	          03 COMM-CUSTNO               PIC X(10).	0	0	0
95000009	95	          03 COMM-SCODE                PIC X(6).	0	0	0
95000010	95	          03 COMM-ACCNO                PIC 9(8).	0	0	0
95000011	95	          03 COMM-ACC-TYPE             PIC X(8).	0	0	0
95000012	95	          03 COMM-INT-RATE             PIC 9(4)V99.	0	0	0
95000013	95	          03 COMM-OPENED               PIC 9(8).	0	0	0
95000014	95	          03 COMM-OPENED-GROUP REDEFINES COMM-OPENED.	0	0	0
95000015	95	             05 COMM-OPENED-DAY              PIC 99.	0	0	0
95000016	95	             05 COMM-OPENED-MONTH            PIC 99.	0	0	0
95000017	95	             05 COMM-OPENED-YEAR             PIC 9999.	0	0	0
95000018	95	          03 COMM-OVERDRAFT            PIC 9(8).	0	0	0
95000019	95	          03 COMM-LAST-STMT-DT         PIC 9(8).	0	0	0
95000020	95	          03 COMM-LAST-STMNT-GROUP REDEFINES COMM-LAST-STMT-DT.	0	0	0
95000021	95	             05 COMM-LASTST-DAY               PIC 99.	0	0	0
95000022	95	             05 COMM-LASTST-MONTH             PIC 99.	0	0	0
95000023	95	             05 COMM-LASTST-YEAR              PIC 9999.	0	0	0
95000024	95	          03 COMM-NEXT-STMT-DT         PIC 9(8).	0	0	0
95000025	95	          03 COMM-NEXT-STMNT-GROUP REDEFINES COMM-NEXT-STMT-DT.	0	0	0
95000026	95	             05 COMM-NEXTST-DAY               PIC 99.	0	0	0
95000027	95	             05 COMM-NEXTST-MONTH             PIC 99.	0	0	0
95000028	95	             05 COMM-NEXTST-YEAR              PIC 9999.	0	0	0
95000029	95	          03 COMM-AVAIL-BAL            PIC S9(10)V99.	0	0	0
95000030	95	          03 COMM-ACTUAL-BAL           PIC S9(10)V99.	0	0	0
95000031	95	          03 COMM-SUCCESS              PIC X.	0	0	0
96000001	96	      ******************************************************************	1	0	1
96000002	96	      *                                                                *	1	0	0
96000003	96	      *  Copyright IBM Corp. 2023                                      *	1	0	0
96000004	96	      *                                                                *	1	0	0
96000005	96	      *                                                                *	1	0	0
96000006	96	      ******************************************************************	1	0	0
96000007	96	           03 CONTROL-CUSTOMER-COUNT PIC 9(10) PACKED-DECIMAL.	0	0	1
96000008	96	           03 CONTROL-CUSTOMER-LAST PIC 9(10) PACKED-DECIMAL.	0	0	0
96000009	96	           03 CONTROL-ACCOUNT-COUNT PIC 9(8) PACKED-DECIMAL.	0	0	0
96000010	96	           03 CONTROL-ACCOUNT-LAST PIC 9(8) PACKED-DECIMAL.	0	0	0
97000001	97	      ******************************************************************	1	0	1
97000002	97	      *                                                                *	1	0	0
97000003	97	      *  Copyright IBM Corp. 2023                                      *	1	0	0
97000004	97	      *	1	0	0
97000005	97	      *                                                                *	1	0	0
97000006	97	      ******************************************************************	1	0	0
97000007	97	           03 CUSTOMER-RECORD.	0	0	1
97000008	97	              05 CUSTOMER-EYECATCHER                 PIC X(4).	0	0	0
97000009	97	                 88 CUSTOMER-EYECATCHER-VALUE        VALUE 'CUST'.	0	0	0
97000010	97	              05 CUSTOMER-KEY.	0	0	0
97000011	97	                 07 CUSTOMER-SORTCODE                PIC 9(6) DISPLAY.	0	0	0
97000012	97	                 07 CUSTOMER-NUMBER                  PIC 9(10) DISPLAY.	0	0	0
97000013	97	              05 CUSTOMER-NAME                       PIC X(60).	0	0	0
97000014	97	      *          07 CUSTOMER-TITLE                   PIC X(8).	1	0	1
97000015	97	      *          07 CUSTOMER-GIVEN-NAME              PIC X(20).	1	0	0
97000016	97	      *          07 CUSTOMER-INITIALS                PIC X(10).	1	0	0
97000017	97	      *          07 CUSTOMER-FAMILY-NAME             PIC X(20).	1	0	0
97000018	97	              05 CUSTOMER-ADDRESS                    PIC X(160).	0	0	1
97000019	97	      *          07 CUSTOMER-STREET-ADDRESS          PIC X(50).	1	0	1
97000020	97	      *          07 CUSTOMER-ADDRESS-DISTRICT        PIC X(50).	1	0	0
97000021	97	      *          07 CUSTOMER-ADDRESS-TOWN            PIC X(50).	1	0	0
97000022	97	      *          07 CUSTOMER-POSTCODE-OR-ZIP         PIC X(10).	1	0	0
97000023	97	              05 CUSTOMER-DATE-OF-BIRTH              PIC 9(8).	0	0	1
97000024	97	              05 CUSTOMER-DOB-GROUP REDEFINES CUSTOMER-DATE-OF-BIRTH.	0	0	0
97000025	97	                 07 CUSTOMER-BIRTH-DAY               PIC 99.	0	0	0
97000026	97	                 07 CUSTOMER-BIRTH-MONTH             PIC 99.	0	0	0
97000027	97	                 07 CUSTOMER-BIRTH-YEAR              PIC 9999.	0	0	0
97000028	97	              05 CUSTOMER-CREDIT-SCORE               PIC 999.	0	0	0
97000029	97	              05 CUSTOMER-CS-REVIEW-DATE             PIC 9(8).	0	0	0
97000030	97	              05 CUSTOMER-CS-GROUP	0	0	0
97000031	97	                 REDEFINES CUSTOMER-CS-REVIEW-DATE.	0	0	0
97000032	97	                 07 CUSTOMER-CS-REVIEW-DAY           PIC 99.	0	0	0
97000033	97	                 07 CUSTOMER-CS-REVIEW-MONTH         PIC 99.	0	0	0
97000034	97	                 07 CUSTOMER-CS-REVIEW-YEAR          PIC 9999.	0	0	0
98000001	98	      ******************************************************************	1	0	1
98000002	98	      *                                                                *	1	0	0
98000003	98	      *  Copyright IBM Corp. 2023                                      *	1	0	0
98000004	98	      *                                                                *	1	0	0
98000005	98	      *                                                                *	1	0	0
98000006	98	      ******************************************************************	1	0	0
98000007	98	          03 COMM-FACCNO               PIC 9(8).	0	0	1
98000008	98	          03 COMM-FSCODE               PIC 9(6).	0	0	0
98000009	98	          03 COMM-TACCNO               PIC 9(8).	0	0	0
98000010	98	          03 COMM-TSCODE               PIC 9(6).	0	0	0
98000011	98	          03 COMM-AMT                  PIC S9(10)V99.	0	0	0
98000012	98	          03 COMM-FAVBAL               PIC S9(10)V99.	0	0	0
98000013	98	          03 COMM-FACTBAL              PIC S9(10)V99.	0	0	0
98000014	98	          03 COMM-TAVBAL               PIC S9(10)V99.	0	0	0
98000015	98	          03 COMM-TACTBAL              PIC S9(10)V99.	0	0	0
98000016	98	          03 COMM-FAIL-CODE            PIC X.	0	0	0
98000017	98	          03 COMM-SUCCESS              PIC X.	0	0	0
99000001	99	      ******************************************************************	1	0	1
99000002	99	      *                                                                *	1	0	0
99000003	99	      *  Copyright IBM Corp. 2023                                      *	1	0	0
99000004	99	      *                                                                *	1	0	0
99000005	99	      *                                                                *	1	0	0
99000006	99	      ******************************************************************	1	0	0
99000007	99	          03 COMM-EYE                  PIC X(4).	0	0	1
99000008	99	          03 COMM-SCODE                PIC X(6).	0	0	0
99000009	99	          03 COMM-CUSTNO               PIC X(10).	0	0	0
99000010	99	          03 COMM-NAME                 PIC X(60).	0	0	0
99000011	99	          03 COMM-ADDR                 PIC X(160).	0	0	0
99000012	99	          03 COMM-DOB                  PIC 9(8).	0	0	0
99000013	99	          03 COMM-DOB-GROUP REDEFINES COMM-DOB.	0	0	0
99000014	99	             05 COMM-BIRTH-DAY               PIC 99.	0	0	0
99000015	99	             05 COMM-BIRTH-MONTH             PIC 99.	0	0	0
99000016	99	             05 COMM-BIRTH-YEAR              PIC 9999.	0	0	0
99000017	99	          03 COMM-CREDIT-SCORE         PIC 9(3).	0	0	0
99000018	99	          03 COMM-CS-REVIEW-DATE       PIC 9(8).	0	0	0
99000019	99	          03 COMM-CS-REVIEW-GROUP REDEFINES COMM-CS-REVIEW-DATE.	0	0	0
99000020	99	             05 COMM-CS-REVIEW-DD            PIC 99.	0	0	0
99000021	99	             05 COMM-CS-REVIEW-MM            PIC 99.	0	0	0
99000022	99	             05 COMM-CS-REVIEW-YYYY          PIC 9999.	0	0	0
99000023	99	          03 COMM-DEL-SUCCESS          PIC X.	0	0	0
99000024	99	          03 COMM-DEL-FAIL-CD          PIC X.	0	0	0
100000001	100	      ******************************************************************	1	0	1
100000002	100	      *                                                                *	1	0	0
100000003	100	      *  Copyright IBM Corp. 2023                                      *	1	0	0
100000004	100	      *                                                                *	1	0	0
100000005	100	      *                                                                *	1	0	0
100000006	100	      ******************************************************************	1	0	0
100000007	100	       01  BANKMAPI.	0	0	1
100000008	100	           02  FILLER PIC X(12).	0	0	0
100000009	100	           02  COMPANYL    COMP  PIC  S9(4).	0	0	0
100000010	100	           02  COMPANYF    PICTURE X.	0	0	0
100000011	100	           02  FILLER REDEFINES COMPANYF.	0	0	0
100000012	100	             03 COMPANYA    PICTURE X.	0	0	0
100000013	100	           02  FILLER   PICTURE X(6).	0	0	0
100000014	100	           02  COMPANYI  PIC X(40).	0	0	0
100000015	100	           02  SORTCODEL    COMP  PIC  S9(4).	0	0	0
100000016	100	           02  SORTCODEF    PICTURE X.	0	0	0
100000017	100	           02  FILLER REDEFINES SORTCODEF.	0	0	0
100000018	100	             03 SORTCODEA    PICTURE X.	0	0	0
100000019	100	           02  FILLER   PICTURE X(6).	0	0	0
100000020	100	           02  SORTCODEI  PIC X(6).	0	0	0
100000021	100	           02  CUSTCTRLL    COMP  PIC  S9(4).	0	0	0
100000022	100	           02  CUSTCTRLF    PICTURE X.	0	0	0
100000023	100	           02  FILLER REDEFINES CUSTCTRLF.	0	0	0
100000024	100	             03 CUSTCTRLA    PICTURE X.	0	0	0
100000025	100	           02  FILLER   PICTURE X(6).	0	0	0
100000026	100	           02  CUSTCTRLI  PIC X(1).	0	0	0
100000027	100	           02  CUSTOMERL    COMP  PIC  S9(4).	0	0	0
100000028	100	           02  CUSTOMERF    PICTURE X.	0	0	0
100000029	100	           02  FILLER REDEFINES CUSTOMERF.	0	0	0
100000030	100	             03 CUSTOMERA    PICTURE X.	0	0	0
100000031	100	           02  FILLER   PICTURE X(6).	0	0	0
100000032	100	           02  CUSTOMERI  PIC X(10).	0	0	0
100000033	100	           02  ACCTCTRLL    COMP  PIC  S9(4).	0	0	0
100000034	100	           02  ACCTCTRLF    PICTURE X.	0	0	0
100000035	100	           02  FILLER REDEFINES ACCTCTRLF.	0	0	0
100000036	100	             03 ACCTCTRLA    PICTURE X.	0	0	0
100000037	100	           02  FILLER   PICTURE X(6).	0	0	0
100000038	100	           02  ACCTCTRLI  PIC X(1).	0	0	0
100000039	100	           02  ACCOUNTL    COMP  PIC  S9(4).	0	0	0
100000040	100	           02  ACCOUNTF    PICTURE X.	0	0	0
100000041	100	           02  FILLER REDEFINES ACCOUNTF.	0	0	0
100000042	100	             03 ACCOUNTA    PICTURE X.	0	0	0
100000043	100	           02  FILLER   PICTURE X(6).	0	0	0
100000044	100	           02  ACCOUNTI  PIC X(10).	0	0	0
100000045	100	           02  PROCCTRLL    COMP  PIC  S9(4).	0	0	0
100000046	100	           02  PROCCTRLF    PICTURE X.	0	0	0
100000047	100	           02  FILLER REDEFINES PROCCTRLF.	0	0	0
100000048	100	             03 PROCCTRLA    PICTURE X.	0	0	0
100000049	100	           02  FILLER   PICTURE X(6).	0	0	0
100000050	100	           02  PROCCTRLI  PIC X(1).	0	0	0
100000051	100	           02  PROCTRANL    COMP  PIC  S9(4).	0	0	0
100000052	100	           02  PROCTRANF    PICTURE X.	0	0	0
100000053	100	           02  FILLER REDEFINES PROCTRANF.	0	0	0
100000054	100	             03 PROCTRANA    PICTURE X.	0	0	0
100000055	100	           02  FILLER   PICTURE X(6).	0	0	0
100000056	100	           02  PROCTRANI  PIC X(10).	0	0	0
100000057	100	           02  REJTCTRLL    COMP  PIC  S9(4).	0	0	0
100000058	100	           02  REJTCTRLF    PICTURE X.	0	0	0
100000059	100	           02  FILLER REDEFINES REJTCTRLF.	0	0	0
100000060	100	             03 REJTCTRLA    PICTURE X.	0	0	0
100000061	100	           02  FILLER   PICTURE X(6).	0	0	0
100000062	100	           02  REJTCTRLI  PIC X(1).	0	0	0
100000063	100	           02  REJTRANL    COMP  PIC  S9(4).	0	0	0
100000064	100	           02  REJTRANF    PICTURE X.	0	0	0
100000065	100	           02  FILLER REDEFINES REJTRANF.	0	0	0
100000066	100	             03 REJTRANA    PICTURE X.	0	0	0
100000067	100	           02  FILLER   PICTURE X(6).	0	0	0
100000068	100	           02  REJTRANI  PIC X(10).	0	0	0
100000069	100	           02  B2BXCTRLL    COMP  PIC  S9(4).	0	0	0
100000070	100	           02  B2BXCTRLF    PICTURE X.	0	0	0
100000071	100	           02  FILLER REDEFINES B2BXCTRLF.	0	0	0
100000072	100	             03 B2BXCTRLA    PICTURE X.	0	0	0
100000073	100	           02  FILLER   PICTURE X(6).	0	0	0
100000074	100	           02  B2BXCTRLI  PIC X(1).	0	0	0
100000075	100	           02  B2BXFRL    COMP  PIC  S9(4).	0	0	0
100000076	100	           02  B2BXFRF    PICTURE X.	0	0	0
100000077	100	           02  FILLER REDEFINES B2BXFRF.	0	0	0
100000078	100	             03 B2BXFRA    PICTURE X.	0	0	0
100000079	100	           02  FILLER   PICTURE X(6).	0	0	0
100000080	100	           02  B2BXFRI  PIC X(10).	0	0	0
100000081	100	           02  CLEACTRLL    COMP  PIC  S9(4).	0	0	0
100000082	100	           02  CLEACTRLF    PICTURE X.	0	0	0
100000083	100	           02  FILLER REDEFINES CLEACTRLF.	0	0	0
100000084	100	             03 CLEACTRLA    PICTURE X.	0	0	0
100000085	100	           02  FILLER   PICTURE X(6).	0	0	0
100000086	100	           02  CLEACTRLI  PIC X(1).	0	0	0
100000087	100	           02  CLEARINGL    COMP  PIC  S9(4).	0	0	0
100000088	100	           02  CLEARINGF    PICTURE X.	0	0	0
100000089	100	           02  FILLER REDEFINES CLEARINGF.	0	0	0
100000090	100	             03 CLEARINGA    PICTURE X.	0	0	0
100000091	100	           02  FILLER   PICTURE X(6).	0	0	0
100000092	100	           02  CLEARINGI  PIC X(10).	0	0	0
100000093	100	           02  SODDCTRLL    COMP  PIC  S9(4).	0	0	0
100000094	100	           02  SODDCTRLF    PICTURE X.	0	0	0
100000095	100	           02  FILLER REDEFINES SODDCTRLF.	0	0	0
100000096	100	             03 SODDCTRLA    PICTURE X.	0	0	0
100000097	100	           02  FILLER   PICTURE X(6).	0	0	0
100000098	100	           02  SODDCTRLI  PIC X(1).	0	0	0
100000099	100	           02  SODDL    COMP  PIC  S9(4).	0	0	0
100000100	100	           02  SODDF    PICTURE X.	0	0	0
100000101	100	           02  FILLER REDEFINES SODDF.	0	0	0
100000102	100	             03 SODDA    PICTURE X.	0	0	0
100000103	100	           02  FILLER   PICTURE X(6).	0	0	0
100000104	100	           02  SODDI  PIC X(10).	0	0	0
100000105	100	           02  NCOUCTRLL    COMP  PIC  S9(4).	0	0	0
100000106	100	           02  NCOUCTRLF    PICTURE X.	0	0	0
100000107	100	           02  FILLER REDEFINES NCOUCTRLF.	0	0	0
100000108	100	             03 NCOUCTRLA    PICTURE X.	0	0	0
100000109	100	           02  FILLER   PICTURE X(6).	0	0	0
100000110	100	           02  NCOUCTRLI  PIC X(1).	0	0	0
100000111	100	           02  NCOUNTERL    COMP  PIC  S9(4).	0	0	0
100000112	100	           02  NCOUNTERF    PICTURE X.	0	0	0
100000113	100	           02  FILLER REDEFINES NCOUNTERF.	0	0	0
100000114	100	             03 NCOUNTERA    PICTURE X.	0	0	0
100000115	100	           02  FILLER   PICTURE X(6).	0	0	0
100000116	100	           02  NCOUNTERI  PIC X(10).	0	0	0
100000117	100	           02  CUSTMSGL    COMP  PIC  S9(4).	0	0	0
100000118	100	           02  CUSTMSGF    PICTURE X.	0	0	0
100000119	100	           02  FILLER REDEFINES CUSTMSGF.	0	0	0
100000120	100	             03 CUSTMSGA    PICTURE X.	0	0	0
100000121	100	           02  FILLER   PICTURE X(6).	0	0	0
100000122	100	           02  CUSTMSGI  PIC X(70).	0	0	0
100000123	100	           02  ACCTMSGL    COMP  PIC  S9(4).	0	0	0
100000124	100	           02  ACCTMSGF    PICTURE X.	0	0	0
100000125	100	           02  FILLER REDEFINES ACCTMSGF.	0	0	0
100000126	100	             03 ACCTMSGA    PICTURE X.	0	0	0
100000127	100	           02  FILLER   PICTURE X(6).	0	0	0
100000128	100	           02  ACCTMSGI  PIC X(70).	0	0	0
100000129	100	           02  PROCMSGL    COMP  PIC  S9(4).	0	0	0
100000130	100	           02  PROCMSGF    PICTURE X.	0	0	0
100000131	100	           02  FILLER REDEFINES PROCMSGF.	0	0	0
100000132	100	             03 PROCMSGA    PICTURE X.	0	0	0
100000133	100	           02  FILLER   PICTURE X(6).	0	0	0
100000134	100	           02  PROCMSGI  PIC X(70).	0	0	0
100000135	100	           02  REJTMSGL    COMP  PIC  S9(4).	0	0	0
100000136	100	           02  REJTMSGF    PICTURE X.	0	0	0
100000137	100	           02  FILLER REDEFINES REJTMSGF.	0	0	0
100000138	100	             03 REJTMSGA    PICTURE X.	0	0	0
100000139	100	           02  FILLER   PICTURE X(6).	0	0	0
100000140	100	           02  REJTMSGI  PIC X(70).	0	0	0
100000141	100	           02  B2BXMSGL    COMP  PIC  S9(4).	0	0	0
100000142	100	           02  B2BXMSGF    PICTURE X.	0	0	0
100000143	100	           02  FILLER REDEFINES B2BXMSGF.	0	0	0
100000144	100	             03 B2BXMSGA    PICTURE X.	0	0	0
100000145	100	           02  FILLER   PICTURE X(6).	0	0	0
100000146	100	           02  B2BXMSGI  PIC X(70).	0	0	0
100000147	100	           02  CLEAMSGL    COMP  PIC  S9(4).	0	0	0
100000148	100	           02  CLEAMSGF    PICTURE X.	0	0	0
100000149	100	           02  FILLER REDEFINES CLEAMSGF.	0	0	0
100000150	100	             03 CLEAMSGA    PICTURE X.	0	0	0
100000151	100	           02  FILLER   PICTURE X(6).	0	0	0
100000152	100	           02  CLEAMSGI  PIC X(70).	0	0	0
100000153	100	           02  SODDMSGL    COMP  PIC  S9(4).	0	0	0
100000154	100	           02  SODDMSGF    PICTURE X.	0	0	0
100000155	100	           02  FILLER REDEFINES SODDMSGF.	0	0	0
100000156	100	             03 SODDMSGA    PICTURE X.	0	0	0
100000157	100	           02  FILLER   PICTURE X(6).	0	0	0
100000158	100	           02  SODDMSGI  PIC X(70).	0	0	0
100000159	100	           02  NCOUMSGL    COMP  PIC  S9(4).	0	0	0
100000160	100	           02  NCOUMSGF    PICTURE X.	0	0	0
100000161	100	           02  FILLER REDEFINES NCOUMSGF.	0	0	0
100000162	100	             03 NCOUMSGA    PICTURE X.	0	0	0
100000163	100	           02  FILLER   PICTURE X(6).	0	0	0
100000164	100	           02  NCOUMSGI  PIC X(70).	0	0	0
100000165	100	       01  BANKMAPO REDEFINES BANKMAPI.	0	0	0
100000166	100	           02  FILLER PIC X(12).	0	0	0
100000167	100	           02  FILLER PICTURE X(3).	0	0	0
100000168	100	           02  COMPANYC    PICTURE X.	0	0	0
100000169	100	           02  COMPANYP    PICTURE X.	0	0	0
100000170	100	           02  COMPANYH    PICTURE X.	0	0	0
100000171	100	           02  COMPANYV    PICTURE X.	0	0	0
100000172	100	           02  COMPANYU    PICTURE X.	0	0	0
100000173	100	           02  COMPANYM    PICTURE X.	0	0	0
100000174	100	           02  COMPANYO  PIC X(40).	0	0	0
100000175	100	           02  FILLER PICTURE X(3).	0	0	0
100000176	100	           02  SORTCODEC    PICTURE X.	0	0	0
100000177	100	           02  SORTCODEP    PICTURE X.	0	0	0
100000178	100	           02  SORTCODEH    PICTURE X.	0	0	0
100000179	100	           02  SORTCODEV    PICTURE X.	0	0	0
100000180	100	           02  SORTCODEU    PICTURE X.	0	0	0
100000181	100	           02  SORTCODEM    PICTURE X.	0	0	0
100000182	100	           02  SORTCODEO  PIC X(6).	0	0	0
100000183	100	           02  FILLER PICTURE X(3).	0	0	0
100000184	100	           02  CUSTCTRLC    PICTURE X.	0	0	0
100000185	100	           02  CUSTCTRLP    PICTURE X.	0	0	0
100000186	100	           02  CUSTCTRLH    PICTURE X.	0	0	0
100000187	100	           02  CUSTCTRLV    PICTURE X.	0	0	0
100000188	100	           02  CUSTCTRLU    PICTURE X.	0	0	0
100000189	100	           02  CUSTCTRLM    PICTURE X.	0	0	0
100000190	100	           02  CUSTCTRLO  PIC X(1).	0	0	0
100000191	100	           02  FILLER PICTURE X(3).	0	0	0
100000192	100	           02  CUSTOMERC    PICTURE X.	0	0	0
100000193	100	           02  CUSTOMERP    PICTURE X.	0	0	0
100000194	100	           02  CUSTOMERH    PICTURE X.	0	0	0
100000195	100	           02  CUSTOMERV    PICTURE X.	0	0	0
100000196	100	           02  CUSTOMERU    PICTURE X.	0	0	0
100000197	100	           02  CUSTOMERM    PICTURE X.	0	0	0
100000198	100	           02  CUSTOMERO  PIC X(10).	0	0	0
100000199	100	           02  FILLER PICTURE X(3).	0	0	0
100000200	100	           02  ACCTCTRLC    PICTURE X.	0	0	0
100000201	100	           02  ACCTCTRLP    PICTURE X.	0	0	0
100000202	100	           02  ACCTCTRLH    PICTURE X.	0	0	0
100000203	100	           02  ACCTCTRLV    PICTURE X.	0	0	0
100000204	100	           02  ACCTCTRLU    PICTURE X.	0	0	0
100000205	100	           02  ACCTCTRLM    PICTURE X.	0	0	0
100000206	100	           02  ACCTCTRLO  PIC X(1).	0	0	0
100000207	100	           02  FILLER PICTURE X(3).	0	0	0
100000208	100	           02  ACCOUNTC    PICTURE X.	0	0	0
100000209	100	           02  ACCOUNTP    PICTURE X.	0	0	0
100000210	100	           02  ACCOUNTH    PICTURE X.	0	0	0
100000211	100	           02  ACCOUNTV    PICTURE X.	0	0	0
100000212	100	           02  ACCOUNTU    PICTURE X.	0	0	0
100000213	100	           02  ACCOUNTM    PICTURE X.	0	0	0
100000214	100	           02  ACCOUNTO  PIC X(10).	0	0	0
100000215	100	           02  FILLER PICTURE X(3).	0	0	0
100000216	100	           02  PROCCTRLC    PICTURE X.	0	0	0
100000217	100	           02  PROCCTRLP    PICTURE X.	0	0	0
100000218	100	           02  PROCCTRLH    PICTURE X.	0	0	0
100000219	100	           02  PROCCTRLV    PICTURE X.	0	0	0
100000220	100	           02  PROCCTRLU    PICTURE X.	0	0	0
100000221	100	           02  PROCCTRLM    PICTURE X.	0	0	0
100000222	100	           02  PROCCTRLO  PIC X(1).	0	0	0
100000223	100	           02  FILLER PICTURE X(3).	0	0	0
100000224	100	           02  PROCTRANC    PICTURE X.	0	0	0
100000225	100	           02  PROCTRANP    PICTURE X.	0	0	0
100000226	100	           02  PROCTRANH    PICTURE X.	0	0	0
100000227	100	           02  PROCTRANV    PICTURE X.	0	0	0
100000228	100	           02  PROCTRANU    PICTURE X.	0	0	0
100000229	100	           02  PROCTRANM    PICTURE X.	0	0	0
100000230	100	           02  PROCTRANO  PIC X(10).	0	0	0
100000231	100	           02  FILLER PICTURE X(3).	0	0	0
100000232	100	           02  REJTCTRLC    PICTURE X.	0	0	0
100000233	100	           02  REJTCTRLP    PICTURE X.	0	0	0
100000234	100	           02  REJTCTRLH    PICTURE X.	0	0	0
100000235	100	           02  REJTCTRLV    PICTURE X.	0	0	0
100000236	100	           02  REJTCTRLU    PICTURE X.	0	0	0
100000237	100	           02  REJTCTRLM    PICTURE X.	0	0	0
100000238	100	           02  REJTCTRLO  PIC X(1).	0	0	0
100000239	100	           02  FILLER PICTURE X(3).	0	0	0
100000240	100	           02  REJTRANC    PICTURE X.	0	0	0
100000241	100	           02  REJTRANP    PICTURE X.	0	0	0
100000242	100	           02  REJTRANH    PICTURE X.	0	0	0
100000243	100	           02  REJTRANV    PICTURE X.	0	0	0
100000244	100	           02  REJTRANU    PICTURE X.	0	0	0
100000245	100	           02  REJTRANM    PICTURE X.	0	0	0
100000246	100	           02  REJTRANO  PIC X(10).	0	0	0
100000247	100	           02  FILLER PICTURE X(3).	0	0	0
100000248	100	           02  B2BXCTRLC    PICTURE X.	0	0	0
100000249	100	           02  B2BXCTRLP    PICTURE X.	0	0	0
100000250	100	           02  B2BXCTRLH    PICTURE X.	0	0	0
100000251	100	           02  B2BXCTRLV    PICTURE X.	0	0	0
100000252	100	           02  B2BXCTRLU    PICTURE X.	0	0	0
100000253	100	           02  B2BXCTRLM    PICTURE X.	0	0	0
100000254	100	           02  B2BXCTRLO  PIC X(1).	0	0	0
100000255	100	           02  FILLER PICTURE X(3).	0	0	0
100000256	100	           02  B2BXFRC    PICTURE X.	0	0	0
100000257	100	           02  B2BXFRP    PICTURE X.	0	0	0
100000258	100	           02  B2BXFRH    PICTURE X.	0	0	0
100000259	100	           02  B2BXFRV    PICTURE X.	0	0	0
100000260	100	           02  B2BXFRU    PICTURE X.	0	0	0
100000261	100	           02  B2BXFRM    PICTURE X.	0	0	0
100000262	100	           02  B2BXFRO  PIC X(10).	0	0	0
100000263	100	           02  FILLER PICTURE X(3).	0	0	0
100000264	100	           02  CLEACTRLC    PICTURE X.	0	0	0
100000265	100	           02  CLEACTRLP    PICTURE X.	0	0	0
100000266	100	           02  CLEACTRLH    PICTURE X.	0	0	0
100000267	100	           02  CLEACTRLV    PICTURE X.	0	0	0
100000268	100	           02  CLEACTRLU    PICTURE X.	0	0	0
100000269	100	           02  CLEACTRLM    PICTURE X.	0	0	0
100000270	100	           02  CLEACTRLO  PIC X(1).	0	0	0
100000271	100	           02  FILLER PICTURE X(3).	0	0	0
100000272	100	           02  CLEARINGC    PICTURE X.	0	0	0
100000273	100	           02  CLEARINGP    PICTURE X.	0	0	0
100000274	100	           02  CLEARINGH    PICTURE X.	0	0	0
100000275	100	           02  CLEARINGV    PICTURE X.	0	0	0
100000276	100	           02  CLEARINGU    PICTURE X.	0	0	0
100000277	100	           02  CLEARINGM    PICTURE X.	0	0	0
100000278	100	           02  CLEARINGO  PIC X(10).	0	0	0
100000279	100	           02  FILLER PICTURE X(3).	0	0	0
100000280	100	           02  SODDCTRLC    PICTURE X.	0	0	0
100000281	100	           02  SODDCTRLP    PICTURE X.	0	0	0
100000282	100	           02  SODDCTRLH    PICTURE X.	0	0	0
100000283	100	           02  SODDCTRLV    PICTURE X.	0	0	0
100000284	100	           02  SODDCTRLU    PICTURE X.	0	0	0
100000285	100	           02  SODDCTRLM    PICTURE X.	0	0	0
100000286	100	           02  SODDCTRLO  PIC X(1).	0	0	0
100000287	100	           02  FILLER PICTURE X(3).	0	0	0
100000288	100	           02  SODDC    PICTURE X.	0	0	0
100000289	100	           02  SODDP    PICTURE X.	0	0	0
100000290	100	           02  SODDH    PICTURE X.	0	0	0
100000291	100	           02  SODDV    PICTURE X.	0	0	0
100000292	100	           02  SODDU    PICTURE X.	0	0	0
100000293	100	           02  SODDM    PICTURE X.	0	0	0
100000294	100	           02  SODDO  PIC X(10).	0	0	0
100000295	100	           02  FILLER PICTURE X(3).	0	0	0
100000296	100	           02  NCOUCTRLC    PICTURE X.	0	0	0
100000297	100	           02  NCOUCTRLP    PICTURE X.	0	0	0
100000298	100	           02  NCOUCTRLH    PICTURE X.	0	0	0
100000299	100	           02  NCOUCTRLV    PICTURE X.	0	0	0
100000300	100	           02  NCOUCTRLU    PICTURE X.	0	0	0
100000301	100	           02  NCOUCTRLM    PICTURE X.	0	0	0
100000302	100	           02  NCOUCTRLO  PIC X(1).	0	0	0
100000303	100	           02  FILLER PICTURE X(3).	0	0	0
100000304	100	           02  NCOUNTERC    PICTURE X.	0	0	0
100000305	100	           02  NCOUNTERP    PICTURE X.	0	0	0
100000306	100	           02  NCOUNTERH    PICTURE X.	0	0	0
100000307	100	           02  NCOUNTERV    PICTURE X.	0	0	0
100000308	100	           02  NCOUNTERU    PICTURE X.	0	0	0
100000309	100	           02  NCOUNTERM    PICTURE X.	0	0	0
100000310	100	           02  NCOUNTERO  PIC X(10).	0	0	0
100000311	100	           02  FILLER PICTURE X(3).	0	0	0
100000312	100	           02  CUSTMSGC    PICTURE X.	0	0	0
100000313	100	           02  CUSTMSGP    PICTURE X.	0	0	0
100000314	100	           02  CUSTMSGH    PICTURE X.	0	0	0
100000315	100	           02  CUSTMSGV    PICTURE X.	0	0	0
100000316	100	           02  CUSTMSGU    PICTURE X.	0	0	0
100000317	100	           02  CUSTMSGM    PICTURE X.	0	0	0
100000318	100	           02  CUSTMSGO  PIC X(70).	0	0	0
100000319	100	           02  FILLER PICTURE X(3).	0	0	0
100000320	100	           02  ACCTMSGC    PICTURE X.	0	0	0
100000321	100	           02  ACCTMSGP    PICTURE X.	0	0	0
100000322	100	           02  ACCTMSGH    PICTURE X.	0	0	0
100000323	100	           02  ACCTMSGV    PICTURE X.	0	0	0
100000324	100	           02  ACCTMSGU    PICTURE X.	0	0	0
100000325	100	           02  ACCTMSGM    PICTURE X.	0	0	0
100000326	100	           02  ACCTMSGO  PIC X(70).	0	0	0
100000327	100	           02  FILLER PICTURE X(3).	0	0	0
100000328	100	           02  PROCMSGC    PICTURE X.	0	0	0
100000329	100	           02  PROCMSGP    PICTURE X.	0	0	0
100000330	100	           02  PROCMSGH    PICTURE X.	0	0	0
100000331	100	           02  PROCMSGV    PICTURE X.	0	0	0
100000332	100	           02  PROCMSGU    PICTURE X.	0	0	0
100000333	100	           02  PROCMSGM    PICTURE X.	0	0	0
100000334	100	           02  PROCMSGO  PIC X(70).	0	0	0
100000335	100	           02  FILLER PICTURE X(3).	0	0	0
100000336	100	           02  REJTMSGC    PICTURE X.	0	0	0
100000337	100	           02  REJTMSGP    PICTURE X.	0	0	0
100000338	100	           02  REJTMSGH    PICTURE X.	0	0	0
100000339	100	           02  REJTMSGV    PICTURE X.	0	0	0
100000340	100	           02  REJTMSGU    PICTURE X.	0	0	0
100000341	100	           02  REJTMSGM    PICTURE X.	0	0	0
100000342	100	           02  REJTMSGO  PIC X(70).	0	0	0
100000343	100	           02  FILLER PICTURE X(3).	0	0	0
100000344	100	           02  B2BXMSGC    PICTURE X.	0	0	0
100000345	100	           02  B2BXMSGP    PICTURE X.	0	0	0
100000346	100	           02  B2BXMSGH    PICTURE X.	0	0	0
100000347	100	           02  B2BXMSGV    PICTURE X.	0	0	0
100000348	100	           02  B2BXMSGU    PICTURE X.	0	0	0
100000349	100	           02  B2BXMSGM    PICTURE X.	0	0	0
100000350	100	           02  B2BXMSGO  PIC X(70).	0	0	0
100000351	100	           02  FILLER PICTURE X(3).	0	0	0
100000352	100	           02  CLEAMSGC    PICTURE X.	0	0	0
100000353	100	           02  CLEAMSGP    PICTURE X.	0	0	0
100000354	100	           02  CLEAMSGH    PICTURE X.	0	0	0
100000355	100	           02  CLEAMSGV    PICTURE X.	0	0	0
100000356	100	           02  CLEAMSGU    PICTURE X.	0	0	0
100000357	100	           02  CLEAMSGM    PICTURE X.	0	0	0
100000358	100	           02  CLEAMSGO  PIC X(70).	0	0	0
100000359	100	           02  FILLER PICTURE X(3).	0	0	0
100000360	100	           02  SODDMSGC    PICTURE X.	0	0	0
100000361	100	           02  SODDMSGP    PICTURE X.	0	0	0
100000362	100	           02  SODDMSGH    PICTURE X.	0	0	0
100000363	100	           02  SODDMSGV    PICTURE X.	0	0	0
100000364	100	           02  SODDMSGU    PICTURE X.	0	0	0
100000365	100	           02  SODDMSGM    PICTURE X.	0	0	0
100000366	100	           02  SODDMSGO  PIC X(70).	0	0	0
100000367	100	           02  FILLER PICTURE X(3).	0	0	0
100000368	100	           02  NCOUMSGC    PICTURE X.	0	0	0
100000369	100	           02  NCOUMSGP    PICTURE X.	0	0	0
100000370	100	           02  NCOUMSGH    PICTURE X.	0	0	0
100000371	100	           02  NCOUMSGV    PICTURE X.	0	0	0
100000372	100	           02  NCOUMSGU    PICTURE X.	0	0	0
100000373	100	           02  NCOUMSGM    PICTURE X.	0	0	0
100000374	100	           02  NCOUMSGO  PIC X(70).	0	0	0
101000001	101	      ******************************************************************	1	0	1
101000002	101	      *                                                                *	1	0	0
101000003	101	      *  Copyright IBM Corp. 2023                                      *	1	0	0
101000004	101	      *                                                                *	1	0	0
101000005	101	      *                                                                *	1	0	0
101000006	101	      ******************************************************************	1	0	0
101000007	101	        01 DELACC-COMMAREA.	0	0	1
101000008	101	          03 DELACC-EYE                  PIC X(4).	0	0	0
101000009	101	          03 DELACC-CUSTNO               PIC X(10).	0	0	0
101000010	101	          03 DELACC-SCODE                PIC X(6).	0	0	0
101000011	101	          03 DELACC-ACCNO                PIC 9(8).	0	0	0
101000012	101	          03 DELACC-ACC-TYPE             PIC X(8).	0	0	0
101000013	101	          03 DELACC-INT-RATE             PIC 9(4)V99.	0	0	0
101000014	101	          03 DELACC-OPENED               PIC 9(8).	0	0	0
101000015	101	          03 DELACC-OPENED-GROUP REDEFINES DELACC-OPENED.	0	0	0
101000016	101	            05 DELACC-OPENED-DAY   PIC 99.	0	0	0
101000017	101	            05 DELACC-OPENED-MONTH PIC 99.	0	0	0
101000018	101	            05 DELACC-OPENED-YEAR  PIC 9999.	0	0	0
101000019	101	          03 DELACC-OVERDRAFT            PIC 9(8).	0	0	0
101000020	101	          03 DELACC-LAST-STMT-DT         PIC 9(8).	0	0	0
101000021	101	          03 DELACC-LAST-STMT-GROUP REDEFINES DELACC-LAST-STMT-DT.	0	0	0
101000022	101	            05 DELACC-LAST-STMT-DAY   PIC 99.	0	0	0
101000023	101	            05 DELACC-LAST-STMT-MONTH PIC 99.	0	0	0
101000024	101	            05 DELACC-LAST-STMT-YEAR  PIC 9999.	0	0	0
101000025	101	          03 DELACC-NEXT-STMT-DT         PIC 9(8).	0	0	0
101000026	101	          03 DELACC-NEXT-STMT-GROUP REDEFINES DELACC-NEXT-STMT-DT.	0	0	0
101000027	101	            05 DELACC-NEXT-STMT-DAY   PIC 99.	0	0	0
101000028	101	            05 DELACC-NEXT-STMT-MONTH PIC 99.	0	0	0
101000029	101	            05 DELACC-NEXT-STMT-YEAR  PIC 9999.	0	0	0
101000030	101	          03 DELACC-AVAIL-BAL            PIC S9(10)V99.	0	0	0
101000031	101	          03 DELACC-ACTUAL-BAL           PIC S9(10)V99.	0	0	0
101000032	101	          03 DELACC-SUCCESS              PIC X.	0	0	0
101000033	101	          03 DELACC-FAIL-CD              PIC X.	0	0	0
101000034	101	          03 DELACC-DEL-SUCCESS          PIC X.	0	0	0
101000035	101	          03 DELACC-DEL-FAIL-CD          PIC X.	0	0	0
101000036	101	          03 DELACC-DEL-APPLID           PIC X(8).	0	0	0
101000037	101	          03 DELACC-DEL-PCB1             POINTER.	0	0	0
101000038	101	          03 DELACC-DEL-PCB2             POINTER.	0	0	0
101000039	101	          03 DELACC-DEL-PCB3             POINTER.	0	0	0
102000001	102	      ******************************************************************	1	0	1
102000002	102	      *                                                                *	1	0	0
102000003	102	      *  Copyright IBM Corp. 2023                                      *	1	0	0
102000004	102	      *                                                                *	1	0	0
102000005	102	      *                                                                *	1	0	0
102000006	102	      ******************************************************************	1	0	0
102000007	102	       01 PROCISRT-COMMAREA.	0	0	1
102000008	102	           03 PROCISRT-FUNCTION PIC X.	0	0	0
102000009	102	           88 PROCISRT-DEBIT VALUE '1'.	0	0	0
102000010	102	           88 PROCISRT-CREDIT VALUE '2'.	0	0	0
102000011	102	           88 PROCISRT-XFR-LOCAL VALUE '3'.	0	0	0
102000012	102	           88 PROCISRT-DELETE-CUSTOMER VALUE '4'.	0	0	0
102000013	102	           88 PROCISRT-CREATE-CUSTOMER VALUE '5'.	0	0	0
102000014	102	           88 PROCISRT-DELETE-ACCOUNT VALUE '6'.	0	0	0
102000015	102	           88 PROCISRT-CREATE-ACCOUNT VALUE '7'.	0	0	0
102000016	102	           03 PROCISRT-PCB-POINTER POINTER.	0	0	0
102000017	102	           03 PROCISRT-DEBIT-STRUCT.	0	0	0
102000018	102	             05 PROCISRT-DEBIT-ACCNO PIC 9(8).	0	0	0
102000019	102	             05 PROCISRT-DEBIT-SORTCODE       PIC 9(6).	0	0	0
102000020	102	             05 PROCISRT-DEBIT-AMOUNT         PIC S9(10)V99.	0	0	0
102000021	102	             05 FILLER PIC X(100).	0	0	0
102000022	102	           03 PROCISRT-CREDIT-STRUCT	0	0	0
102000023	102	             REDEFINES PROCISRT-DEBIT-STRUCT.	0	0	0
102000024	102	             05 PROCISRT-CREDIT-ACCNO PIC 9(8).	0	0	0
102000025	102	             05 PROCISRT-CREDIT-SORTCODE       PIC 9(6).	0	0	0
102000026	102	             05 PROCISRT-CREDIT-AMOUNT         PIC S9(10)V99.	0	0	0
102000027	102	           03 PROCISRT-XFR-LOCAL-STRUCT	0	0	0
102000028	102	             REDEFINES PROCISRT-DEBIT-STRUCT.	0	0	0
102000029	102	             05 PROCISRT-XFR-L-ACCNO PIC 9(8).	0	0	0
102000030	102	             05 PROCISRT-XFR-L-SORTCODE       PIC 9(6).	0	0	0
102000031	102	             05 PROCISRT-XFR-L-AMOUNT         PIC S9(10)V99.	0	0	0
102000032	102	             05 PROCISRT-XFR-L-TARGET-ACCNO PIC 9(8).	0	0	0
102000033	102	           03 PROCISRT-DELETE-CUST-STRUCT	0	0	0
102000034	102	             REDEFINES PROCISRT-DEBIT-STRUCT.	0	0	0
102000035	102	             05 PROCISRT-DELETE-CUST-ACCNO PIC 9(8).	0	0	0
102000036	102	             05 PROCISRT-DELETE-CUST-SORTCODE       PIC 9(6).	0	0	0
102000037	102	             05 PROCISRT-DELETE-CUST-BALANCE        PIC S9(10)V99.	0	0	0
102000038	102	             05 PROCISRT-DELETE-CUST-DOB.	0	0	0
102000039	102	               07 PROCISRT-DELETE-CUST-DOB-YYYY     PIC 9999.	0	0	0
102000040	102	               07 PROCISRT-DELETE-CUST-DOB-MM       PIC 99.	0	0	0
102000041	102	               07 PROCISRT-DELETE-CUST-DOB-DD       PIC 99.	0	0	0
102000042	102	             05 PROCISRT-DELETE-CUST-NAME           PIC X(60).	0	0	0
102000043	102	             05 PROCISRT-DELETE-CUST-NUMBER         PIC 9(10).	0	0	0
102000044	102	           03 PROCISRT-CREATE-CUST-STRUCT	0	0	0
102000045	102	             REDEFINES PROCISRT-DEBIT-STRUCT.	0	0	0
102000046	102	             05 PROCISRT-CREATE-CUST-ACCNO PIC 9(8).	0	0	0
102000047	102	             05 PROCISRT-CREATE-CUST-SORTCODE       PIC 9(6).	0	0	0
102000048	102	             05 PROCISRT-CREATE-CUST-BALANCE        PIC S9(10)V99.	0	0	0
102000049	102	             05 PROCISRT-CREATE-CUST-DOB.	0	0	0
102000050	102	               07 PROCISRT-CREATE-CUST-DOB-YYYY     PIC 9999.	0	0	0
102000051	102	               07 PROCISRT-CREATE-CUST-DOB-MM       PIC 99.	0	0	0
102000052	102	               07 PROCISRT-CREATE-CUST-DOB-DD       PIC 99.	0	0	0
102000053	102	             05 PROCISRT-CREATE-CUST-NAME           PIC X(60).	0	0	0
102000054	102	             05 PROCISRT-CREATE-CUST-NUMBER         PIC 9(10).	0	0	0
102000055	102	           03 PROCISRT-DELACC-STRUCT	0	0	0
102000056	102	             REDEFINES PROCISRT-DEBIT-STRUCT.	0	0	0
102000057	102	             05 PROCISRT-DELACC-ACCNO PIC 9(8).	0	0	0
102000058	102	             05 PROCISRT-DELACC-SORTCODE       PIC 9(6).	0	0	0
102000059	102	             05 PROCISRT-DELACC-BALANCE        PIC S9(10)V99.	0	0	0
102000060	102	             05 PROCISRT-DELACC-L-STMNT.	0	0	0
102000061	102	               07 PROCISRT-DELACC-L-STMNT-YYYY     PIC 9999.	0	0	0
102000062	102	               07 PROCISRT-DELACC-L-STMNT-MM       PIC 99.	0	0	0
102000063	102	               07 PROCISRT-DELACC-L-STMNT-DD       PIC 99.	0	0	0
102000064	102	             05 PROCISRT-DELACC-N-STMNT.	0	0	0
102000065	102	               07 PROCISRT-DELACC-N-STMNT-YYYY     PIC 9999.	0	0	0
102000066	102	               07 PROCISRT-DELACC-N-STMNT-MM       PIC 99.	0	0	0
102000067	102	               07 PROCISRT-DELACC-N-STMNT-DD       PIC 99.	0	0	0
102000068	102	             05 PROCISRT-DELACC-TYPE           PIC X(8).	0	0	0
102000069	102	             05 PROCISRT-DELACC-CUSTNO         PIC 9(10).	0	0	0
102000070	102	           03 PROCISRT-CREACC-STRUCT	0	0	0
102000071	102	             REDEFINES PROCISRT-DEBIT-STRUCT.	0	0	0
102000072	102	             05 PROCISRT-CREACC-ACCNO PIC 9(8).	0	0	0
102000073	102	             05 PROCISRT-CREACC-SORTCODE       PIC 9(6).	0	0	0
102000074	102	             05 PROCISRT-CREACC-BALANCE        PIC S9(10)V99.	0	0	0
102000075	102	             05 PROCISRT-CREACC-L-STMNT.	0	0	0
102000076	102	               07 PROCISRT-CREACC-L-STMNT-YYYY     PIC 9999.	0	0	0
102000077	102	               07 PROCISRT-CREACC-L-STMNT-MM       PIC 99.	0	0	0
102000078	102	               07 PROCISRT-CREACC-L-STMNT-DD       PIC 99.	0	0	0
102000079	102	             05 PROCISRT-CREAET-ACCT-N-STMNT.	0	0	0
102000080	102	               07 PROCISRT-CREACC-N-STMNT-YYYY     PIC 9999.	0	0	0
102000081	102	               07 PROCISRT-CREACC-N-STMNT-MM       PIC 99.	0	0	0
102000082	102	               07 PROCISRT-CREACC-N-STMNT-DD       PIC 99.	0	0	0
102000083	102	             05 PROCISRT-CREACC-TYPE           PIC X(8).	0	0	0
102000084	102	             05 PROCISRT-CREACC-CUSTNO         PIC 9(10).	0	0	0
103000001	103	      ******************************************************************	1	0	1
103000002	103	      *                                                                *	1	0	0
103000003	103	      *  Copyright IBM Corp. 2023                                      *	1	0	0
103000004	103	      *                                                                *	1	0	0
103000005	103	      *                                                                *	1	0	0
103000006	103	      ******************************************************************	1	0	0
103000007	103	          03 COMM-EYECATCHER                 PIC X(4).	0	0	1
103000008	103	          03 COMM-CUSTNO                     PIC 9(10).	0	0	0
103000009	103	          03 COMM-KEY.	0	0	0
103000010	103	             05 COMM-SORTCODE                PIC 9(6) DISPLAY.	0	0	0
103000011	103	             05 COMM-NUMBER                  PIC 9(8) DISPLAY.	0	0	0
103000012	103	          03 COMM-ACC-TYPE                   PIC X(8).	0	0	0
103000013	103	          03 COMM-INT-RT                     PIC 9(4)V99.	0	0	0
103000014	103	          03 COMM-OPENED                     PIC 9(8).	0	0	0
103000015	103	          03 COMM-OPENED-GROUP REDEFINES COMM-OPENED.	0	0	0
103000016	103	             05 COMM-OPENED-DAY              PIC 99.	0	0	0
103000017	103	             05 COMM-OPENED-MONTH            PIC 99.	0	0	0
103000018	103	             05 COMM-OPENED-YEAR             PIC 9999.	0	0	0
103000019	103	          03 COMM-OVERDR-LIM                 PIC 9(8).	0	0	0
103000020	103	          03 COMM-LAST-STMT-DT               PIC 9(8).	0	0	0
103000021	103	          03 COMM-LAST-STMNT-GROUP REDEFINES COMM-LAST-STMT-DT.	0	0	0
103000022	103	             05 COMM-LASTST-DAY               PIC 99.	0	0	0
103000023	103	             05 COMM-LASTST-MONTH             PIC 99.	0	0	0
103000024	103	             05 COMM-LASTST-YEAR              PIC 9999.	0	0	0
103000025	103	          03 COMM-NEXT-STMT-DT               PIC 9(8).	0	0	0
103000026	103	          03 COMM-NEXT-STMNT-GROUP REDEFINES COMM-NEXT-STMT-DT.	0	0	0
103000027	103	             05 COMM-NEXTST-DAY               PIC 99.	0	0	0
103000028	103	             05 COMM-NEXTST-MONTH             PIC 99.	0	0	0
103000029	103	             05 COMM-NEXTST-YEAR              PIC 9999.	0	0	0
103000030	103	          03 COMM-AVAIL-BAL                  PIC S9(10)V99.	0	0	0
103000031	103	          03 COMM-ACT-BAL                    PIC S9(10)V99.	0	0	0
103000032	103	          03 COMM-SUCCESS                    PIC X.	0	0	0
103000033	103	          03 COMM-FAIL-CODE                  PIC X.	0	0	0
104000001	104	      ******************************************************************	1	0	1
104000002	104	      *                                                                *	1	0	0
104000003	104	      *  Copyright IBM Corp. 2023                                      *	1	0	0
104000004	104	      *                                                                *	1	0	0
104000005	104	      *                                                                *	1	0	0
104000006	104	      ******************************************************************	1	0	0
104000007	104	           EXEC SQL DECLARE PROCTRAN TABLE	0	0	1
104000008	104	              (	0	0	0
104000009	104	               PROCTRAN_EYECATCHER             CHAR(4),	0	0	0
104000010	104	               PROCTRAN_SORTCODE               CHAR(6) NOT NULL,	0	0	0
104000011	104	               PROCTRAN_NUMBER                 CHAR(8) NOT NULL,	0	0	0
104000012	104	               PROCTRAN_DATE                   CHAR(8),	0	0	0
104000013	104	               PROCTRAN_TIME                   CHAR(6),	0	0	0
104000014	104	               PROCTRAN_REF                    CHAR(12),	0	0	0
104000015	104	               PROCTRAN_TYPE                   CHAR(3),	0	0	0
104000016	104	               PROCTRAN_DESC                   CHAR(40),	0	0	0
104000017	104	               PROCTRAN_AMOUNT                 DECIMAL(12, 2)	0	0	0
104000018	104	              )	0	0	0
104000019	104	           END-EXEC.	0	0	0
105000001	105	      ******************************************************************	1	0	1
105000002	105	      *                                                                *	1	0	0
105000003	105	      *  Copyright IBM Corp. 2023                                      *	1	0	0
105000004	105	      *                                                                *	1	0	0
105000005	105	      *                                                                *	1	0	0
105000006	105	      ******************************************************************	1	0	0
105000007	105	              03 ACCOUNT-CONTROL-RECORD.	0	0	1
105000008	105	                 05 ACCOUNT-CONTROL-EYE-CATCHER        PIC X(4).	0	0	0
105000009	105	                 88 ACCOUNT-CONTROL-EYECATCHER-V   VALUE 'CTRL'.	0	0	0
105000010	105	                 05 FILLER                     PIC 9(10).	0	0	0
105000011	105	                 05 ACCOUNT-CONTROL-KEY.	0	0	0
105000012	105	                    07 ACCOUNT-CONTROL-SORT-CODE       PIC 9(6).	0	0	0
105000013	105	                    07 ACCOUNT-CONTROL-NUMBER          PIC 9(8).	0	0	0
105000014	105	                 05 NUMBER-OF-ACCOUNTS                 PIC 9(8).	0	0	0
105000015	105	                 05 LAST-ACCOUNT-NUMBER                PIC 9(8).	0	0	0
105000016	105	                 05 ACCOUNT-CONTROL-SUCCESS-FLAG       PIC X.	0	0	0
105000017	105	                 88 ACCOUNT-CONTROL-SUCCESS VALUE 'Y'.	0	0	0
105000018	105	                 05 ACCOUNT-CONTROL-FAIL-CODE PIC X.	0	0	0
105000019	105	                 05 FILLER                     PIC 9(4)V99.	0	0	0
105000020	105	                 05 FILLER                     PIC 9(8).	0	0	0
105000021	105	                 05 FILLER                     PIC 9(8).	0	0	0
105000022	105	                 05 FILLER                     PIC 9(8).	0	0	0
105000023	105	                 05 FILLER                     PIC 9(8).	0	0	0
105000024	105	                 05 FILLER                     PIC S9(10)V99.	0	0	0
105000025	105	                 05 FILLER                     PIC X(2).	0	0	0
106000001	106	      ******************************************************************	1	0	1
106000002	106	      *                                                                *	1	0	0
106000003	106	      *  Copyright IBM Corp. 2023                                      *	1	0	0
106000004	106	      *                                                                *	1	0	0
106000005	106	      *                                                                *	1	0	0
106000006	106	      ******************************************************************	1	0	0
106000007	106	          03 INQCUST-EYE                  PIC X(4).	0	0	1
106000008	106	          03 INQCUST-SCODE                PIC X(6).	0	0	0
106000009	106	          03 INQCUST-CUSTNO               PIC 9(10).	0	0	0
106000010	106	          03 INQCUST-NAME                 PIC X(60).	0	0	0
106000011	106	          03 INQCUST-ADDR                 PIC X(160).	0	0	0
106000012	106	          03 INQCUST-DOB.	0	0	0
106000013	106	            05 INQCUST-DOB-DD             PIC 99.	0	0	0
106000014	106	            05 INQCUST-DOB-MM             PIC 99.	0	0	0
106000015	106	            05 INQCUST-DOB-YYYY           PIC 9999.	0	0	0
106000016	106	          03 INQCUST-CREDIT-SCORE         PIC 999.	0	0	0
106000017	106	          03 INQCUST-CS-REVIEW-DT.	0	0	0
106000018	106	            05 INQCUST-CS-REVIEW-DD       PIC 99.	0	0	0
106000019	106	            05 INQCUST-CS-REVIEW-MM       PIC 99.	0	0	0
106000020	106	            05 INQCUST-CS-REVIEW-YYYY     PIC 9999.	0	0	0
106000021	106	          03 INQCUST-INQ-SUCCESS          PIC X.	0	0	0
106000022	106	          03 INQCUST-INQ-FAIL-CD          PIC X.	0	0	0
106000023	106	          03 INQCUST-PCB-POINTER          POINTER.	0	0	0
107000001	107		0	0	0
107000002	107	*	0	0	0
107000003	107	*     Copyright IBM Corp. 2023	0	0	0
107000004	107	*	0	0	0
107000005	107		0	0	0
107000006	107		0	0	0
107000007	107	***************************************************************	0	0	0
107000008	107	*	0	0	0
107000009	107	* BNK1DCM	0	0	0
107000010	107	* Display Customer for CICS Banking Sample Application	0	0	0
107000011	107	*	0	0	0
107000012	107	* Created: Created: 12-Nov-2015	0	0	0
107000013	107	*	0	0	0
107000014	107	* Generated by: IBM Rational Developer for System z with Java	0	0	0
107000015	107	*	0	0	0
107000016	107	* Description: Displays Customer Information	0	0	0
107000017	107	*	0	0	0
107000018	107	*	0	0	0
107000019	107	*	0	0	0
107000020	107	***************************************************************	0	0	0
107000021	107	BNK1DCM  DFHMSD TYPE=&SYSPARM,MODE=INOUT,LANG=COBOL,STORAGE=AUTO,      *	0	0	0
107000022	107	               CTRL=FREEKB,EXTATT=YES,TERM=3270-2,TIOAPFX=YES,         *	0	0	0
107000023	107	               MAPATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI),                *	0	0	0
107000024	107	               DSATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI)	0	0	0
107000025	107	BNK1DC   DFHMDI SIZE=(24,80),                                          *	0	0	0
107000026	107	               COLUMN=1,LINE=1	0	0	0
107000027	107	         DFHMDF POS=(1,1),LENGTH=7,INITIAL='BNK1DC ',                  *	0	0	0
107000028	107	               ATTRB=(NORM,PROT),COLOR=BLUE	0	0	0
107000029	107	COMPANY  DFHMDF POS=(1,16),LENGTH=52,ATTRB=(NORM,PROT),COLOR=RED,      *	0	0	0
107000030	107	               INITIAL='CICS Banking Sample Application - Display Custo*	0	0	0
107000031	107	               mer.'	0	0	0
107000032	107	***********************************************************************	0	0	0
107000033	107	         DFHMDF POS=(3,1),LENGTH=44,ATTRB=(ASKIP,PROT),COLOR=TURQUOISE,*	0	0	0
107000034	107	               INITIAL='Provide a CUSTOMER number. Then press Enter.'	0	0	0
107000035	107	         DFHMDF POS=(5,1),LENGTH=16,ATTRB=(ASKIP,PROT),COLOR=TURQUOISE,*	0	0	0
107000036	107	               INITIAL='CUSTOMER NUMBER'	0	0	0
107000037	107	CUSTNO   DFHMDF POS=(5,17),LENGTH=10,ATTRB=(NORM,IC),COLOR=GREEN,      *	0	0	0
107000038	107	               HILIGHT=UNDERLINE	0	0	0
107000039	107	         DFHMDF POS=(5,28),LENGTH=1,ATTRB=(ASKIP,PROT)	0	0	0
107000040	107	         DFHMDF POS=(7,1),LENGTH=16,ATTRB=(ASKIP,PROT),                *	0	0	0
107000041	107	               COLOR=NEUTRAL,INITIAL='Sort Code       '	0	0	0
107000042	107	SORTC    DFHMDF POS=(7,18),LENGTH=6,ATTRB=(NORM,PROT,FSET,ASKIP),      *	0	0	0
107000043	107	               COLOR=NEUTRAL	0	0	0
107000044	107	         DFHMDF POS=(8,1),LENGTH=16,ATTRB=(NORM,PROT,ASKIP),           *	0	0	0
107000045	107	               COLOR=NEUTRAL,INITIAL='Customer Number '	0	0	0
107000046	107	CUSTNO2  DFHMDF POS=(8,18),LENGTH=10,ATTRB=(NORM,PROT,ASKIP,FSET),     *	0	0	0
107000047	107	               COLOR=NEUTRAL	0	0	0
107000048	107	         DFHMDF POS=(9,1),LENGTH=16,ATTRB=(NORM,PROT),                 *	0	0	0
107000049	107	               COLOR=NEUTRAL,INITIAL='Customer Name   '	0	0	0
107000050	107	CUSTNAM  DFHMDF POS=(9,18),LENGTH=60,                                  *	0	0	0
107000051	107	               ATTRB=(PROT,FSET,NORM,ASKIP),COLOR=NEUTRAL	0	0	0
107000052	107	         DFHMDF POS=(9,79),LENGTH=0,                                   *	0	0	0
107000053	107	               ATTRB=(PROT,ASKIP),COLOR=GREEN	0	0	0
107000054	107	         DFHMDF POS=(10,1),LENGTH=16,ATTRB=(NORM,PROT),                *	0	0	0
107000055	107	               COLOR=NEUTRAL,INITIAL='Customer Address'	0	0	0
107000056	107	CUSTAD1  DFHMDF POS=(10,18),LENGTH=60,                                 *	0	0	0
107000057	107	               ATTRB=(PROT,FSET,NORM,ASKIP),COLOR=NEUTRAL	0	0	0
107000058	107	         DFHMDF POS=(10,79),LENGTH=0,                                  *	0	0	0
107000059	107	               ATTRB=(PROT,ASKIP),COLOR=GREEN	0	0	0
107000060	107	         DFHMDF POS=(11,1),LENGTH=1,ATTRB=(NORM,PROT,ASKIP),           *	0	0	0
107000061	107	               COLOR=NEUTRAL,INITIAL=' '	0	0	0
107000062	107	CUSTAD2  DFHMDF POS=(11,18),LENGTH=60,ATTRB=(NORM,PROT,ASKIP,FSET),    *	0	0	0
107000063	107	               COLOR=NEUTRAL	0	0	0
107000064	107	         DFHMDF POS=(11,79),LENGTH=0,                                  *	0	0	0
107000065	107	               ATTRB=(PROT,ASKIP),COLOR=GREEN	0	0	0
107000066	107	         DFHMDF POS=(12,1),LENGTH=1,ATTRB=(NORM,PROT,ASKIP),           *	0	0	0
107000067	107	               COLOR=NEUTRAL,INITIAL=' '	0	0	0
107000068	107	CUSTAD3  DFHMDF POS=(12,18),LENGTH=40,ATTRB=(NORM,PROT,FSET,ASKIP),    *	0	0	0
107000069	107	               COLOR=NEUTRAL	0	0	0
107000070	107	         DFHMDF POS=(12,59),LENGTH=0,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
107000071	107	               COLOR=NEUTRAL	0	0	0
107000072	107	         DFHMDF POS=(13,1),LENGTH=16,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
107000073	107	               COLOR=NEUTRAL,INITIAL='Customer D.O.B.'	0	0	0
107000074	107	DOBDD    DFHMDF POS=(13,18),LENGTH=2,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
107000075	107	               COLOR=NEUTRAL	0	0	0
107000076	107	         DFHMDF POS=(13,21),LENGTH=1,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
107000077	107	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
107000078	107	DOBMM    DFHMDF POS=(13,23),LENGTH=2,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
107000079	107	               COLOR=NEUTRAL	0	0	0
107000080	107	         DFHMDF POS=(13,26),LENGTH=1,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
107000081	107	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
107000082	107	DOBYY    DFHMDF POS=(13,28),LENGTH=4,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
107000083	107	               COLOR=NEUTRAL	0	0	0
107000084	107	         DFHMDF POS=(14,1),LENGTH=17,ATTRB=(NORM,PROT),                *	0	0	0
107000085	107	               COLOR=NEUTRAL,INITIAL='Credit Score    '	0	0	0
107000086	107	CREDSC   DFHMDF POS=(14,18),LENGTH=3,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
107000087	107	               COLOR=NEUTRAL	0	0	0
107000088	107	         DFHMDF POS=(15,1),LENGTH=17,ATTRB=(NORM,PROT),                *	0	0	0
107000089	107	               COLOR=NEUTRAL,INITIAL='CS Review Date  '	0	0	0
107000090	107	SCRDTDD  DFHMDF POS=(15,18),LENGTH=2,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
107000091	107	               COLOR=NEUTRAL	0	0	0
107000092	107	         DFHMDF POS=(15,21),LENGTH=1,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
107000093	107	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
107000094	107	SCRDTMM  DFHMDF POS=(15,23),LENGTH=2,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
107000095	107	               COLOR=NEUTRAL	0	0	0
107000096	107	         DFHMDF POS=(15,26),LENGTH=1,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
107000097	107	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
107000098	107	SCRDTYY  DFHMDF POS=(15,28),LENGTH=4,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
107000099	107	               COLOR=NEUTRAL	0	0	0
107000100	107	***********************************************************************	0	0	0
107000101	107	MESSAGE  DFHMDF POS=(23,1),LENGTH=79,COLOR=YELLOW,                     *	0	0	0
107000102	107	               ATTRB=(BRT,PROT,ASKIP)	0	0	0
107000103	107	         DFHMDF POS=(24,1),LENGTH=20,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
107000104	107	               COLOR=BLUE,INITIAL='F3=Exit   F12=Cancel'	0	0	0
107000105	107	DUMMY    DFHMDF POS=(24,79),LENGTH=1,ATTRB=(DRK,PROT,FSET,ASKIP),      *	0	0	0
107000106	107	               INITIAL=' '	0	0	0
107000107	107	***********************************************************************	0	0	0
107000108	107	         DFHMSD TYPE=FINAL	0	0	0
107000109	107	         END	0	0	0
108000001	108		0	0	0
108000002	108	*	0	0	0
108000003	108	*     Copyright IBM Corp. 2023	0	0	0
108000004	108	*	0	0	0
108000005	108		0	0	0
108000006	108		0	0	0
108000007	108	***************************************************************	0	0	0
108000008	108	*	0	0	0
108000009	108	* BNK1CDM	0	0	0
108000010	108	* Display Customer for CICS Banking Sample Application	0	0	0
108000011	108	*	0	0	0
108000012	108	* Created: 12-Nov-2015	0	0	0
108000013	108	*	0	0	0
108000014	108	* Generated by: IBM Rational Developer for System z with Java	0	0	0
108000015	108	*	0	0	0
108000016	108	* Description: Credits and Debits funds to an existing account	0	0	0
108000017	108	*	0	0	0
108000018	108	*	0	0	0
108000019	108	*	0	0	0
108000020	108	***************************************************************	0	0	0
108000021	108	BNK1CDM  DFHMSD TYPE=&SYSPARM,MODE=INOUT,LANG=COBOL,STORAGE=AUTO,      *	0	0	0
108000022	108	               CTRL=FREEKB,EXTATT=YES,TERM=3270-2,TIOAPFX=YES,         *	0	0	0
108000023	108	               MAPATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI),                *	0	0	0
108000024	108	               DSATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI)	0	0	0
108000025	108	BNK1CD   DFHMDI SIZE=(24,80),                                          *	0	0	0
108000026	108	               COLUMN=1,LINE=1	0	0	0
108000027	108	         DFHMDF POS=(1,1),LENGTH=7,INITIAL='BNK1CD ',                  *	0	0	0
108000028	108	               ATTRB=(PROT,NORM),COLOR=BLUE	0	0	0
108000029	108	COMPANY  DFHMDF POS=(1,15),LENGTH=58,ATTRB=(NORM,PROT),COLOR=RED,      *	0	0	0
108000030	108	               INITIAL='CICS Banking Sample Application - Credit/Debit *	0	0	0
108000031	108	               Funds.'	0	0	0
108000032	108	**********************************************************************	0	0	0
108000033	108	         DFHMDF POS=(3,1),LENGTH=61,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
108000034	108	               INITIAL='Provide an ACCOUNT number and an AMOUNT and the*	0	0	0
108000035	108	               n press Enter.'	0	0	0
108000036	108	         DFHMDF POS=(8,1),LENGTH=15,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
108000037	108	               INITIAL='ACCOUNT NUMBER:'	0	0	0
108000038	108	ACCNO    DFHMDF POS=(8,17),LENGTH=8,ATTRB=(NORM,NUM,IC,FSET),          *	0	0	0
108000039	108	               COLOR=GREEN,                                            *	0	0	0
108000040	108	               HILIGHT=UNDERLINE	0	0	0
108000041	108	         DFHMDF POS=(8,26),LENGTH=7,ATTRB=(NORM,PROT,ASKIP),           *	0	0	0
108000042	108	               COLOR=TURQUOISE,                                        *	0	0	0
108000043	108	               INITIAL='AMOUNT:'	0	0	0
108000044	108	SIGN     DFHMDF POS=(8,35),LENGTH=1,ATTRB=(NORM,UNPROT,FSET),          *	0	0	0
108000045	108	               COLOR=GREEN,INITIAL='+',HILIGHT=UNDERLINE	0	0	0
108000046	108	AMT      DFHMDF POS=(8,37),LENGTH=13,ATTRB=(NORM,UNPROT,FSET),         *	0	0	0
108000047	108	               COLOR=GREEN,INITIAL='0000000000.00',HILIGHT=UNDERLINE	0	0	0
108000048	108	         DFHMDF POS=(8,51),LENGTH=1,ATTRB=(PROT,ASKIP),                *	0	0	0
108000049	108	               COLOR=GREEN,INITIAL=' '	0	0	0
108000050	108	         DFHMDF POS=(10,1),LENGTH=16,ATTRB=(NORM,PROT),COLOR=TURQUOISE,*	0	0	0
108000051	108	               INITIAL='Sort Code: '	0	0	0
108000052	108	SORTC    DFHMDF POS=(10,21),LENGTH=6,ATTRB=(NORM,NUM,PROT),            *	0	0	0
108000053	108	               COLOR=NEUTRAL,INITIAL='      '	0	0	0
108000054	108	         DFHMDF POS=(11,1),LENGTH=18,ATTRB=(NORM,PROT),COLOR=TURQUOISE,*	0	0	0
108000055	108	               INITIAL='Available Balance:'	0	0	0
108000056	108	AVBAL    DFHMDF POS=(11,20),LENGTH=14,ATTRB=(NORM,PROT),               *	0	0	0
108000057	108	               COLOR=NEUTRAL	0	0	0
108000058	108	         DFHMDF POS=(12,1),LENGTH=16,ATTRB=(NORM,PROT),COLOR=TURQUOISE,*	0	0	0
108000059	108	               INITIAL='Actual Balance:'	0	0	0
108000060	108	ACTBAL   DFHMDF POS=(12,20),LENGTH=14,ATTRB=(NORM,PROT),               *	0	0	0
108000061	108	               COLOR=NEUTRAL	0	0	0
108000062	108	***********************************************************************	0	0	0
108000063	108	MESSAGE  DFHMDF POS=(23,1),LENGTH=79,COLOR=YELLOW,ATTRB=(BRT,PROT)	0	0	0
108000064	108	         DFHMDF POS=(24,1),LENGTH=20,ATTRB=(NORM,PROT),COLOR=BLUE,     *	0	0	0
108000065	108	               INITIAL='F3=Exit   F12=Cancel'	0	0	0
108000066	108	DUMMY    DFHMDF POS=(24,79),LENGTH=1,ATTRB=(DRK,PROT,FSET),INITIAL=' '	0	0	0
108000067	108	***********************************************************************	0	0	0
108000068	108	         DFHMSD TYPE=FINAL	0	0	0
108000069	108	         END	0	0	0
109000001	109		0	0	0
109000002	109	*	0	0	0
109000003	109	*     Copyright IBM Corp. 2023	0	0	0
109000004	109	*	0	0	0
109000005	109		0	0	0
109000006	109	***************************************************************	0	0	0
109000007	109	*	0	0	0
109000008	109	* BNKB2M	0	0	0
109000009	109	* Transfer an amount from one account to another account for	0	0	0
109000010	109	* CICS Banking Sample Application	0	0	0
109000011	109	*	0	0	0
109000012	109	* Created: 12-Nov-2019	0	0	0
109000013	109	*	0	0	0
109000014	109	* Generated by: IBM Rational Developer for System z with Java	0	0	0
109000015	109	*	0	0	0
109000016	109	* Description: Transfers funds between two accounts	0	0	0
109000017	109	*	0	0	0
109000018	109	*	0	0	0
109000019	109	*	0	0	0
109000020	109	***************************************************************	0	0	0
109000021	109	BNK1TFM  DFHMSD TYPE=&SYSPARM,MODE=INOUT,LANG=COBOL,STORAGE=AUTO,      *	0	0	0
109000022	109	               CTRL=FREEKB,EXTATT=YES,TERM=3270-2,TIOAPFX=YES,         *	0	0	0
109000023	109	               MAPATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI),                *	0	0	0
109000024	109	               DSATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI)	0	0	0
109000025	109	BNK1B2   DFHMDI SIZE=(24,80),                                          *	0	0	0
109000026	109	               COLUMN=1,                                               *	0	0	0
109000027	109	               LINE=1	0	0	0
109000028	109	         DFHMDF POS=(1,1),LENGTH=7,INITIAL='BNK1B2',                   *	0	0	0
109000029	109	               ATTRB=(ASKIP,NORM),COLOR=BLUE	0	0	0
109000030	109	COMPANY  DFHMDF POS=(1,15),LENGTH=58,COLOR=RED,                        *	0	0	0
109000031	109	               INITIAL='CICS Banking Sample Application - Transfer Fund*	0	0	0
109000032	109	               s',                                                     *	0	0	0
109000033	109	               ATTRB=(PROT,NORM)	0	0	0
109000034	109	         DFHMDF POS=(3,1),LENGTH=15,INITIAL='Transfer funds',          *	0	0	0
109000035	109	               ATTRB=(ASKIP,NORM),HILIGHT=OFF,COLOR=NEUTRAL	0	0	0
109000036	109	         DFHMDF POS=(2,1),LENGTH=79,                                   *	0	0	0
109000037	109	               ATTRB=ASKIP	0	0	0
109000038	109	*	0	0	0
109000039	109	         DFHMDF POS=(5,5),LENGTH=73,                                   *	0	0	0
109000040	109	               INITIAL='Provide the Sort Code and Account Number of the*	0	0	0
109000041	109	                Accounts you want ',                                   *	0	0	0
109000042	109	               ATTRB=(ASKIP,NORM),COLOR=YELLOW	0	0	0
109000043	109	*	0	0	0
109000044	109	         DFHMDF POS=(6,5),LENGTH=68,                                   *	0	0	0
109000045	109	               INITIAL='to transfer money FROM and TO and the AMOUNT yo*	0	0	0
109000046	109	               u want to transfer. ',                                  *	0	0	0
109000047	109	               ATTRB=(ASKIP,NORM),COLOR=YELLOW	0	0	0
109000048	109	         DFHMDF POS=(7,5),LENGTH=68,INITIAL='Then press ENTER.  ',     *	0	0	0
109000049	109	               ATTRB=(ASKIP,NORM),HILIGHT=OFF,COLOR=YELLOW	0	0	0
109000050	109	         DFHMDF POS=(8,1),LENGTH=79,                                   *	0	0	0
109000051	109	               ATTRB=ASKIP	0	0	0
109000052	109	*	0	0	0
109000053	109	         DFHMDF POS=(9,5),LENGTH=12,INITIAL='From Account',            *	0	0	0
109000054	109	               ATTRB=(ASKIP,BRT),HILIGHT=OFF,COLOR=TURQUOISE	0	0	0
109000055	109	         DFHMDF POS=(10,10),LENGTH=16,INITIAL='Sort Code      :',      *	0	0	0
109000056	109	               ATTRB=(ASKIP,NORM),COLOR=TURQUOISE	0	0	0
109000057	109	FSCDE1   DFHMDF POS=(10,27),LENGTH=2,INITIAL='00',                     *	0	0	0
109000058	109	               ATTRB=(ASKIP,BRT),COLOR=TURQUOISE	0	0	0
109000059	109	         DFHMDF POS=(10,30),LENGTH=1,INITIAL='-',                      *	0	0	0
109000060	109	               ATTRB=(ASKIP,BRT),COLOR=TURQUOISE	0	0	0
109000061	109	FSCDE2   DFHMDF POS=(10,32),LENGTH=2,INITIAL='00',                     *	0	0	0
109000062	109	               ATTRB=(ASKIP,BRT),COLOR=TURQUOISE	0	0	0
109000063	109	         DFHMDF POS=(10,35),LENGTH=1,INITIAL='-',                      *	0	0	0
109000064	109	               ATTRB=(ASKIP,BRT),COLOR=TURQUOISE	0	0	0
109000065	109	FSCDE3   DFHMDF POS=(10,37),LENGTH=2,INITIAL='00',                     *	0	0	0
109000066	109	               ATTRB=(ASKIP,BRT),COLOR=TURQUOISE	0	0	0
109000067	109	         DFHMDF POS=(10,40),LENGTH=39,                                 *	0	0	0
109000068	109	               ATTRB=ASKIP,COLOR=RED	0	0	0
109000069	109	         DFHMDF POS=(11,10),LENGTH=16,INITIAL='Account Number :',      *	0	0	0
109000070	109	               ATTRB=(ASKIP,NORM),COLOR=YELLOW	0	0	0
109000071	109	FACCNO   DFHMDF POS=(11,27),LENGTH=8,HILIGHT=UNDERLINE,                *	0	0	0
109000072	109	               ATTRB=(NUM,BRT,IC),COLOR=GREEN	0	0	0
109000073	109	         DFHMDF POS=(11,36),LENGTH=43,                                 *	0	0	0
109000074	109	               ATTRB=ASKIP	0	0	0
109000075	109	         DFHMDF POS=(12,1),LENGTH=79,                                  *	0	0	0
109000076	109	               ATTRB=ASKIP	0	0	0
109000077	109	         DFHMDF POS=(13,10),LENGTH=26,                                 *	0	0	0
109000078	109	               INITIAL='Amount to be Transferred :',                   *	0	0	0
109000079	109	               ATTRB=(ASKIP,NORM),COLOR=YELLOW	0	0	0
109000080	109	AMT      DFHMDF POS=(13,39),LENGTH=13,ATTRB=(NORM,UNPROT),             *	0	0	0
109000081	109	               COLOR=GREEN,INITIAL='0000000000.00',HILIGHT=UNDERLINE	0	0	0
109000082	109	         DFHMDF POS=(13,53),LENGTH=24,                                 *	0	0	0
109000083	109	               ATTRB=ASKIP	0	0	0
109000084	109	         DFHMDF POS=(14,1),LENGTH=79,                                  *	0	0	0
109000085	109	               ATTRB=ASKIP	0	0	0
109000086	109	         DFHMDF POS=(15,10),LENGTH=26,                                 *	0	0	0
109000087	109	               INITIAL='Actual Balance ......... :',                   *	0	0	0
109000088	109	               ATTRB=(ASKIP,NORM),COLOR=TURQUOISE	0	0	0
109000089	109	ACTSIGN  DFHMDF POS=(15,37),LENGTH=1,INITIAL=' ',                      *	0	0	0
109000090	109	               ATTRB=(ASKIP,NORM),COLOR=TURQUOISE	0	0	0
109000091	109	ACTPND   DFHMDF POS=(15,39),LENGTH=10,INITIAL='0000000000',            *	0	0	0
109000092	109	               ATTRB=(NUM,PROT,ASKIP,NORM),COLOR=TURQUOISE	0	0	0
109000093	109	         DFHMDF POS=(15,50),LENGTH=1,INITIAL='.',                      *	0	0	0
109000094	109	               ATTRB=(ASKIP,NORM),COLOR=TURQUOISE	0	0	0
109000095	109	ACTPNC   DFHMDF POS=(15,52),LENGTH=2,INITIAL='00',                     *	0	0	0
109000096	109	               ATTRB=(NUM,PROT,ASKIP,NORM),COLOR=TURQUOISE	0	0	0
109000097	109	         DFHMDF POS=(15,55),LENGTH=24,                                 *	0	0	0
109000098	109	               ATTRB=ASKIP	0	0	0
109000099	109	         DFHMDF POS=(16,10),LENGTH=26,                                 *	0	0	0
109000100	109	               INITIAL='Available Balance ...... :',                   *	0	0	0
109000101	109	               ATTRB=(ASKIP,NORM),COLOR=TURQUOISE	0	0	0
109000102	109	AVASIGN  DFHMDF POS=(16,37),LENGTH=1,INITIAL=' ',                      *	0	0	0
109000103	109	               ATTRB=(ASKIP,NORM),COLOR=TURQUOISE	0	0	0
109000104	109	AVAPND   DFHMDF POS=(16,39),LENGTH=10,INITIAL='0000000000',            *	0	0	0
109000105	109	               ATTRB=(NUM,NORM,PROT,ASKIP),COLOR=TURQUOISE	0	0	0
109000106	109	         DFHMDF POS=(16,50),LENGTH=1,INITIAL='.',                      *	0	0	0
109000107	109	               ATTRB=(ASKIP,NORM,PROT,ASKIP),COLOR=TURQUOISE	0	0	0
109000108	109	AVAPNC   DFHMDF POS=(16,52),LENGTH=2,INITIAL='00',                     *	0	0	0
109000109	109	               ATTRB=(NUM,NORM,PROT,ASKIP),COLOR=TURQUOISE	0	0	0
109000110	109	         DFHMDF POS=(16,55),LENGTH=24,                                 *	0	0	0
109000111	109	               ATTRB=ASKIP	0	0	0
109000112	109	         DFHMDF POS=(17,1),LENGTH=79,                                  *	0	0	0
109000113	109	               ATTRB=ASKIP	0	0	0
109000114	109	*	0	0	0
109000115	109	         DFHMDF POS=(18,5),LENGTH=12,INITIAL='To Account',             *	0	0	0
109000116	109	               ATTRB=(ASKIP,BRT),HILIGHT=OFF,COLOR=YELLOW	0	0	0
109000117	109	         DFHMDF POS=(19,10),LENGTH=16,INITIAL='Sort Code      :',      *	0	0	0
109000118	109	               ATTRB=(ASKIP,NORM),COLOR=YELLOW	0	0	0
109000119	109	TSCDE1   DFHMDF POS=(19,27),LENGTH=2,INITIAL='00',                     *	0	0	0
109000120	109	               ATTRB=(ASKIP,BRT),COLOR=TURQUOISE	0	0	0
109000121	109	         DFHMDF POS=(19,30),LENGTH=1,INITIAL='-',                      *	0	0	0
109000122	109	               ATTRB=ASKIP	0	0	0
109000123	109	TSCDE2   DFHMDF POS=(19,32),LENGTH=2,INITIAL='00',                     *	0	0	0
109000124	109	               ATTRB=(ASKIP,BRT),COLOR=TURQUOISE	0	0	0
109000125	109	         DFHMDF POS=(19,35),LENGTH=1,INITIAL='-',                      *	0	0	0
109000126	109	               ATTRB=ASKIP	0	0	0
109000127	109	TSCDE3   DFHMDF POS=(19,37),LENGTH=2,INITIAL='00',                     *	0	0	0
109000128	109	               ATTRB=(NUM,BRT),COLOR=GREEN,HILIGHT=UNDERLINE	0	0	0
109000129	109	         DFHMDF POS=(19,40),LENGTH=39,                                 *	0	0	0
109000130	109	               ATTRB=ASKIP	0	0	0
109000131	109	         DFHMDF POS=(20,10),LENGTH=16,INITIAL='Account Number :',      *	0	0	0
109000132	109	               ATTRB=(ASKIP,NORM),COLOR=YELLOW	0	0	0
109000133	109	TACCNO   DFHMDF POS=(20,27),LENGTH=8,                                  *	0	0	0
109000134	109	               ATTRB=(NUM,BRT),COLOR=GREEN,HILIGHT=UNDERLINE	0	0	0
109000135	109	         DFHMDF POS=(20,36),LENGTH=43,                                 *	0	0	0
109000136	109	               ATTRB=ASKIP	0	0	0
109000137	109	*	0	0	0
109000138	109	         DFHMDF POS=(21,1),LENGTH=79,                                  *	0	0	0
109000139	109	               ATTRB=ASKIP	0	0	0
109000140	109	         DFHMDF POS=(22,1),LENGTH=79,                                  *	0	0	0
109000141	109	               ATTRB=ASKIP	0	0	0
109000142	109	*	0	0	0
109000143	109	MESSAGE  DFHMDF POS=(23,1),LENGTH=79,                                  *	0	0	0
109000144	109	               ATTRB=(ASKIP,BRT),COLOR=YELLOW	0	0	0
109000145	109	         DFHMDF POS=(24,1),LENGTH=20,ATTRB=(NORM,ASKIP),COLOR=BLUE,    *	0	0	0
109000146	109	               INITIAL='F3=Exit   F12=Cancel'	0	0	0
109000147	109	DUMMY    DFHMDF POS=(24,79),LENGTH=1,ATTRB=(DRK,ASKIP),INITIAL=' '	0	0	0
109000148	109	***********************************************************************	0	0	0
109000149	109	         DFHMSD TYPE=FINAL	0	0	0
109000150	109	         END	0	0	0
110000001	110		0	0	0
110000002	110	*	0	0	0
110000003	110	*     Copyright IBM Corp. 2023	0	0	0
110000004	110	*	0	0	0
110000005	110		0	0	0
110000006	110		0	0	0
110000007	110	***************************************************************	0	0	0
110000008	110	*	0	0	0
110000009	110	* BNK1DAM	0	0	0
110000010	110	* Display Account for CICS Banking Sample Application	0	0	0
110000011	110	*	0	0	0
110000012	110	* Created: 12-Nov-2014	0	0	0
110000013	110	*	0	0	0
110000014	110	* Generated by: IBM Rational Developer for System z with Java	0	0	0
110000015	110	*	0	0	0
110000016	110	* Description: Displays Account Information	0	0	0
110000017	110	*	0	0	0
110000018	110	*	0	0	0
110000019	110	*	0	0	0
110000020	110	***************************************************************	0	0	0
110000021	110	BNK1DAM  DFHMSD TYPE=&SYSPARM,MODE=INOUT,LANG=COBOL,STORAGE=AUTO,      *	0	0	0
110000022	110	               CTRL=FREEKB,EXTATT=YES,TERM=3270-2,TIOAPFX=YES,         *	0	0	0
110000023	110	               MAPATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI),                *	0	0	0
110000024	110	               DSATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI)	0	0	0
110000025	110	BNK1DA   DFHMDI SIZE=(24,80),                                          *	0	0	0
110000026	110	               COLUMN=1,LINE=1	0	0	0
110000027	110	* START OF Display Customer view for BANK 1	0	0	0
110000028	110	         DFHMDF POS=(1,1),LENGTH=7,INITIAL='BNK1DA ',                  *	0	0	0
110000029	110	               ATTRB=(PROT,NORM),COLOR=BLUE	0	0	0
110000030	110	COMPANY  DFHMDF POS=(1,16),LENGTH=52,ATTRB=(NORM,PROT),COLOR=RED,      *	0	0	0
110000031	110	               INITIAL='CICS Banking Sample Application - Display Accou*	0	0	0
110000032	110	               nt.'	0	0	0
110000033	110	***********************************************************************	0	0	0
110000034	110	         DFHMDF POS=(3,1),LENGTH=44,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
110000035	110	               INITIAL='Provide an ACCOUNT number. Then press Enter.'	0	0	0
110000036	110	         DFHMDF POS=(5,1),LENGTH=15,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
110000037	110	               INITIAL='ACCOUNT NUMBER'	0	0	0
110000038	110	ACCNO    DFHMDF POS=(5,17),LENGTH=8,ATTRB=(NORM,NUM,IC),COLOR=GREEN,   *	0	0	0
110000039	110	               HILIGHT=UNDERLINE	0	0	0
110000040	110	         DFHMDF POS=(5,26),LENGTH=1,ATTRB=(PROT,ASKIP)	0	0	0
110000041	110	         DFHMDF POS=(7,1),LENGTH=18,ATTRB=(NORM,PROT),                 *	0	0	0
110000042	110	               COLOR=NEUTRAL,INITIAL=' Customer Number:'	0	0	0
110000043	110	CUSTNO   DFHMDF POS=(7,20),LENGTH=10,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
110000044	110	               COLOR=NEUTRAL	0	0	0
110000045	110	         DFHMDF POS=(8,1),LENGTH=18,ATTRB=(NORM,PROT),                 *	0	0	0
110000046	110	               COLOR=NEUTRAL,INITIAL=' Sort Code      :'	0	0	0
110000047	110	SORTC    DFHMDF POS=(8,20),LENGTH=6,ATTRB=(NORM,PROT,FSET,ASKIP),      *	0	0	0
110000048	110	               COLOR=NEUTRAL	0	0	0
110000049	110	         DFHMDF POS=(9,1),LENGTH=18,ATTRB=(NORM,PROT),                 *	0	0	0
110000050	110	               COLOR=NEUTRAL,INITIAL=' Account Number :'	0	0	0
110000051	110	ACCNO2   DFHMDF POS=(9,20),LENGTH=10,                                  *	0	0	0
110000052	110	               ATTRB=(PROT,ASKIP,FSET,NORM),COLOR=NEUTRAL	0	0	0
110000053	110	         DFHMDF POS=(10,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
110000054	110	               COLOR=NEUTRAL,INITIAL=' Account Type   :'	0	0	0
110000055	110	ACTYPE   DFHMDF POS=(10,20),LENGTH=8,                                  *	0	0	0
110000056	110	               ATTRB=(PROT,ASKIP,FSET,NORM),COLOR=NEUTRAL	0	0	0
110000057	110	         DFHMDF POS=(11,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
110000058	110	               COLOR=NEUTRAL,INITIAL=' Interest Rate  :'	0	0	0
110000059	110	INTRT    DFHMDF POS=(11,20),LENGTH=7,                                  *	0	0	0
110000060	110	               ATTRB=(PROT,ASKIP,FSET,NORM),COLOR=NEUTRAL,             *	0	0	0
110000061	110	               PICOUT='9999.99'	0	0	0
110000062	110	         DFHMDF POS=(12,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
110000063	110	               COLOR=NEUTRAL,INITIAL=' Account Opened :'	0	0	0
110000064	110	OPENDD   DFHMDF POS=(12,20),LENGTH=2,ATTRB=(NORM,PROT,ASKIP,FSET),     *	0	0	0
110000065	110	               COLOR=NEUTRAL	0	0	0
110000066	110	         DFHMDF POS=(12,23),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
110000067	110	               COLOR=GREEN,INITIAL='/'	0	0	0
110000068	110	OPENMM   DFHMDF POS=(12,25),LENGTH=2,ATTRB=(NORM,PROT,ASKIP,FSET),     *	0	0	0
110000069	110	               COLOR=NEUTRAL	0	0	0
110000070	110	         DFHMDF POS=(12,28),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
110000071	110	               COLOR=GREEN,INITIAL='/'	0	0	0
110000072	110	OPENYY   DFHMDF POS=(12,30),LENGTH=4,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
110000073	110	               COLOR=NEUTRAL	0	0	0
110000074	110	         DFHMDF POS=(13,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
110000075	110	               COLOR=NEUTRAL,INITIAL=' Overdraft limit:'	0	0	0
110000076	110	OVERDR   DFHMDF POS=(13,20),LENGTH=8,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
110000077	110	               COLOR=NEUTRAL	0	0	0
110000078	110	         DFHMDF POS=(14,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
110000079	110	               COLOR=NEUTRAL,INITIAL=' Last statement :'	0	0	0
110000080	110	LSTMTDD  DFHMDF POS=(14,20),LENGTH=2,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
110000081	110	               COLOR=NEUTRAL	0	0	0
110000082	110	         DFHMDF POS=(14,23),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
110000083	110	               COLOR=GREEN,INITIAL='/'	0	0	0
110000084	110	LSTMTMM  DFHMDF POS=(14,25),LENGTH=2,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
110000085	110	               COLOR=NEUTRAL	0	0	0
110000086	110	         DFHMDF POS=(14,28),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
110000087	110	               COLOR=GREEN,INITIAL='/'	0	0	0
110000088	110	LSTMTYY  DFHMDF POS=(14,30),LENGTH=4,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
110000089	110	               COLOR=NEUTRAL	0	0	0
110000090	110	         DFHMDF POS=(15,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
110000091	110	               COLOR=NEUTRAL,INITIAL=' Next statement :'	0	0	0
110000092	110	NSTMTDD  DFHMDF POS=(15,20),LENGTH=2,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
110000093	110	               COLOR=NEUTRAL	0	0	0
110000094	110	         DFHMDF POS=(15,23),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
110000095	110	               COLOR=GREEN,INITIAL='/'	0	0	0
110000096	110	NSTMTMM  DFHMDF POS=(15,25),LENGTH=2,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
110000097	110	               COLOR=NEUTRAL	0	0	0
110000098	110	         DFHMDF POS=(15,28),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
110000099	110	               COLOR=GREEN,INITIAL='/'	0	0	0
110000100	110	NSTMTYY  DFHMDF POS=(15,30),LENGTH=4,ATTRB=(NORM,PROT,FSET,ASKIP),     *	0	0	0
110000101	110	               COLOR=NEUTRAL	0	0	0
110000102	110	         DFHMDF POS=(16,1),LENGTH=17,ATTRB=(NORM,PROT),                *	0	0	0
110000103	110	               COLOR=NEUTRAL,INITIAL=' Available Bal  :'	0	0	0
110000104	110	AVBAL    DFHMDF POS=(16,19),LENGTH=14,ATTRB=(NORM,PROT,FSET,ASKIP),    *	0	0	0
110000105	110	               COLOR=NEUTRAL	0	0	0
110000106	110	         DFHMDF POS=(17,1),LENGTH=17,ATTRB=(NORM,PROT),                *	0	0	0
110000107	110	               COLOR=NEUTRAL,INITIAL=' Actual Balance :'	0	0	0
110000108	110	ACTBAL   DFHMDF POS=(17,19),LENGTH=14,ATTRB=(NORM,PROT,FSET,ASKIP),    *	0	0	0
110000109	110	               COLOR=NEUTRAL	0	0	0
110000110	110	***********************************************************************	0	0	0
110000111	110	MESSAGE  DFHMDF POS=(23,1),LENGTH=79,COLOR=YELLOW,                     *	0	0	0
110000112	110	               ATTRB=(BRT,PROT,ASKIP)	0	0	0
110000113	110	         DFHMDF POS=(24,1),LENGTH=20,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
110000114	110	               COLOR=BLUE,INITIAL='F3=Exit   F12=Cancel'	0	0	0
110000115	110	DUMMY    DFHMDF POS=(24,79),LENGTH=1,ATTRB=(DRK,PROT,FSET,ASKIP),      *	0	0	0
110000116	110	               INITIAL=' '	0	0	0
110000117	110	***********************************************************************	0	0	0
110000118	110	         DFHMSD TYPE=FINAL	0	0	0
110000119	110	         END	0	0	0
111000001	111		0	0	0
111000002	111	*	0	0	0
111000003	111	*     Copyright IBM Corp. 2023	0	0	0
111000004	111	*	0	0	0
111000005	111		0	0	0
111000006	111		0	0	0
111000007	111	***************************************************************	0	0	0
111000008	111	*	0	0	0
111000009	111	* BNK1ACC	0	0	0
111000010	111	* Display Accounts for a given customer for CICS Banking Sample	0	0	0
111000011	111	* Application	0	0	0
111000012	111	*	0	0	0
111000013	111	* Created: 12-Nov-2014	0	0	0
111000014	111	*	0	0	0
111000015	111	* Generated by: IBM Rational Developer for System z with Java	0	0	0
111000016	111	*	0	0	0
111000017	111	* Description: Display Account Information	0	0	0
111000018	111	*	0	0	0
111000019	111	*	0	0	0
111000020	111	*	0	0	0
111000021	111	***************************************************************	0	0	0
111000022	111	BNK1ACC  DFHMSD TYPE=&SYSPARM,MODE=INOUT,LANG=COBOL,STORAGE=AUTO,      *	0	0	0
111000023	111	               CTRL=FREEKB,EXTATT=YES,TERM=3270-2,TIOAPFX=YES,         *	0	0	0
111000024	111	               MAPATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI),                *	0	0	0
111000025	111	               DSATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI)	0	0	0
111000026	111	BNK1ACC  DFHMDI SIZE=(24,80),                                          *	0	0	0
111000027	111	               COLUMN=1,LINE=1	0	0	0
111000028	111	         DFHMDF POS=(1,1),LENGTH=7,INITIAL='BNK1ACC',                  *	0	0	0
111000029	111	               ATTRB=(PROT,NORM),COLOR=BLUE	0	0	0
111000030	111	COMPANY  DFHMDF POS=(1,14),LENGTH=60,ATTRB=(NORM,PROT),COLOR=RED,      *	0	0	0
111000031	111	               INITIAL='CICS Banking Sample Application - Accounts for *	0	0	0
111000032	111	               Customers.'	0	0	0
111000033	111	***********************************************************************	0	0	0
111000034	111	         DFHMDF POS=(3,1),LENGTH=44,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
111000035	111	               INITIAL='Provide a Customer number. Then press Enter.'	0	0	0
111000036	111	         DFHMDF POS=(5,1),LENGTH=15,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
111000037	111	               INITIAL='CUSTOMER NUMBER'	0	0	0
111000038	111	CUSTNO   DFHMDF POS=(5,17),LENGTH=10,ATTRB=(NORM,NUM,IC),COLOR=GREEN,  *	0	0	0
111000039	111	               HILIGHT=UNDERLINE	0	0	0
111000040	111	         DFHMDF POS=(5,28),LENGTH=1,ATTRB=(NORM,PROT,ASKIP)	0	0	0
111000041	111	         DFHMDF POS=(8,1),LENGTH=41,ATTRB=(NORM,PROT),                 *	0	0	0
111000042	111	               COLOR=NEUTRAL,                                          *	0	0	0
111000043	111	               INITIAL='SORT CODE   ACCOUNT NUMBER   ACCOUNT TYPE'	0	0	0
111000044	111	         DFHMDF POS=(8,43),LENGTH=33,ATTRB=(NORM,PROT),                *	0	0	0
111000045	111	               COLOR=NEUTRAL,                                          *	0	0	0
111000046	111	               INITIAL='   AVAIL BALANCE   ACTUAL BALANCE'	0	0	0
111000047	111	ACCOUNT  DFHMDF POS=(9,1),LENGTH=79,ATTRB=(NORM,PROT,FSET,ASKIP),      *	0	0	0
111000048	111	               COLOR=NEUTRAL,OCCURS=10	0	0	0
111000049	111	***********************************************************************	0	0	0
111000050	111	MESSAGE  DFHMDF POS=(23,1),LENGTH=79,COLOR=YELLOW,                     *	0	0	0
111000051	111	               ATTRB=(BRT,PROT,ASKIP)	0	0	0
111000052	111	         DFHMDF POS=(24,1),LENGTH=20,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
111000053	111	               COLOR=BLUE,                                             *	0	0	0
111000054	111	               INITIAL='F3=Exit   F12=Cancel'	0	0	0
111000055	111	DUMMY    DFHMDF POS=(24,79),LENGTH=1,ATTRB=(DRK,PROT,ASKIP,FSET),      *	0	0	0
111000056	111	               INITIAL=' '	0	0	0
111000057	111	***********************************************************************	0	0	0
111000058	111	         DFHMSD TYPE=FINAL	0	0	0
111000059	111	         END	0	0	0
112000001	112		0	0	0
112000002	112	*	0	0	0
112000003	112	*     Copyright IBM Corp. 2023	0	0	0
112000004	112	*	0	0	0
112000005	112	******************************************************************	0	0	0
112000006	112		0	0	0
112000007	112	***************************************************************	0	0	0
112000008	112	*	0	0	0
112000009	112	* BNK1TFM	0	0	0
112000010	112	* Transfer funds from one account to another account for	0	0	0
112000011	112	* CICS Banking Sample Application	0	0	0
112000012	112	*	0	0	0
112000013	112	* Created: 12-Nov-2019	0	0	0
112000014	112	*	0	0	0
112000015	112	* Generated by: IBM Rational Developer for System z with Java	0	0	0
112000016	112	*	0	0	0
112000017	112	* Description: Transfers funds from one account to another	0	0	0
112000018	112	*	0	0	0
112000019	112	*	0	0	0
112000020	112	*	0	0	0
112000021	112	***************************************************************	0	0	0
112000022	112	BNK1TFM  DFHMSD TYPE=&SYSPARM,MODE=INOUT,LANG=COBOL,STORAGE=AUTO,      *	0	0	0
112000023	112	               CTRL=FREEKB,EXTATT=YES,TERM=3270-2,TIOAPFX=YES,         *	0	0	0
112000024	112	               MAPATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI),                *	0	0	0
112000025	112	               DSATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI)	0	0	0
112000026	112	BNK1TF   DFHMDI SIZE=(24,80),                                          *	0	0	0
112000027	112	               COLUMN=1,LINE=1	0	0	0
112000028	112	         DFHMDF POS=(1,1),LENGTH=7,INITIAL='BNK1TF ',                  *	0	0	0
112000029	112	               ATTRB=(NORM,PROT),COLOR=BLUE	0	0	0
112000030	112	COMPANY  DFHMDF POS=(1,17),LENGTH=58,ATTRB=(NORM,PROT),COLOR=RED,      *	0	0	0
112000031	112	               INITIAL='CICS Banking Sample Application - Transfer fund*	0	0	0
112000032	112	               s.'	0	0	0
112000033	112	**********************************************************************	0	0	0
112000034	112	         DFHMDF POS=(3,1),LENGTH=70,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
112000035	112	               INITIAL='Provide a FROM account, a TO account and an Amo*	0	0	0
112000036	112	               unt and press Enter.'	0	0	0
112000037	112	         DFHMDF POS=(8,1),LENGTH=21,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
112000038	112	               INITIAL='FROM Account Number:'	0	0	0
112000039	112	FACCNO   DFHMDF POS=(8,23),LENGTH=8,ATTRB=(NORM,NUM,FSET),             *	0	0	0
112000040	112	               HILIGHT=UNDERLINE,COLOR=GREEN	0	0	0
112000041	112	         DFHMDF POS=(8,32),LENGTH=19,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
112000042	112	               COLOR=TURQUOISE,                                        *	0	0	0
112000043	112	               INITIAL='TO Account Number:'	0	0	0
112000044	112	TACCNO   DFHMDF POS=(8,52),LENGTH=8,ATTRB=(NORM,NUM,FSET),COLOR=GREEN, *	0	0	0
112000045	112	               HILIGHT=UNDERLINE	0	0	0
112000046	112	         DFHMDF POS=(8,61),LENGTH=1,ATTRB=(PROT,ASKIP)	0	0	0
112000047	112	         DFHMDF POS=(9,1),LENGTH=7,ATTRB=(NORM,PROT),COLOR=TURQUOISE,  *	0	0	0
112000048	112	               INITIAL='AMOUNT:'	0	0	0
112000049	112	AMT      DFHMDF POS=(9,23),LENGTH=13,ATTRB=(NORM,UNPROT,FSET),         *	0	0	0
112000050	112	               COLOR=GREEN,INITIAL='0000000000.00',HILIGHT=UNDERLINE	0	0	0
112000051	112	        DFHMDF POS=(9,37),LENGTH=1,ATTRB=(PROT,ASKIP)	0	0	0
112000052	112	         DFHMDF POS=(11,1),LENGTH=16,ATTRB=(NORM,PROT),COLOR=TURQUOISE,*	0	0	0
112000053	112	               INITIAL='FROM Account   :'	0	0	0
112000054	112	FACCNO2  DFHMDF POS=(11,20),LENGTH=8,ATTRB=(NORM,NUM,PROT),            *	0	0	0
112000055	112	               COLOR=TURQUOISE	0	0	0
112000056	112	         DFHMDF POS=(11,35),LENGTH=16,ATTRB=(NORM,PROT),               *	0	0	0
112000057	112	               COLOR=TURQUOISE,INITIAL='TO Account     :'	0	0	0
112000058	112	TACCNO2  DFHMDF POS=(11,55),LENGTH=8,ATTRB=(NORM,PROT),COLOR=TURQUOISE	0	0	0
112000059	112	         DFHMDF POS=(12,1),LENGTH=16,ATTRB=(NORM,PROT),COLOR=TURQUOISE,*	0	0	0
112000060	112	               INITIAL='Sort Code      :'	0	0	0
112000061	112	FSORTC   DFHMDF POS=(12,20),LENGTH=6,ATTRB=(NORM,NUM,PROT),            *	0	0	0
112000062	112	               COLOR=NEUTRAL,INITIAL='      '	0	0	0
112000063	112	         DFHMDF POS=(12,35),LENGTH=16,ATTRB=(NORM,PROT),               *	0	0	0
112000064	112	               COLOR=TURQUOISE,INITIAL='Sort Code      :'	0	0	0
112000065	112	TSORTC   DFHMDF POS=(12,55),LENGTH=6,ATTRB=(NORM,NUM,PROT),            *	0	0	0
112000066	112	               COLOR=NEUTRAL,INITIAL='      '	0	0	0
112000067	112	         DFHMDF POS=(13,1),LENGTH=16,ATTRB=(NORM,PROT),COLOR=TURQUOISE,*	0	0	0
112000068	112	               INITIAL='Actual Balance :'	0	0	0
112000069	112	FACTBAL  DFHMDF POS=(13,19),LENGTH=14,ATTRB=(NORM,PROT),               *	0	0	0
112000070	112	               COLOR=NEUTRAL	0	0	0
112000071	112	         DFHMDF POS=(13,35),LENGTH=16,ATTRB=(NORM,PROT),COLOR=TURQUOISE*	0	0	0
112000072	112	               ,INITIAL='Actual Balance :'	0	0	0
112000073	112	TACTBAL  DFHMDF POS=(13,54),LENGTH=14,ATTRB=(NORM,PROT),               *	0	0	0
112000074	112	               COLOR=NEUTRAL	0	0	0
112000075	112	         DFHMDF POS=(14,1),LENGTH=16,ATTRB=(NORM,PROT),COLOR=TURQUOISE,*	0	0	0
112000076	112	               INITIAL='Avail Balance  :'	0	0	0
112000077	112	FAVBAL   DFHMDF POS=(14,19),LENGTH=14,ATTRB=(NORM,PROT),               *	0	0	0
112000078	112	               COLOR=NEUTRAL	0	0	0
112000079	112	         DFHMDF POS=(14,35),LENGTH=18,ATTRB=(NORM,PROT),COLOR=TURQUOISE*	0	0	0
112000080	112	               ,INITIAL='Avail Balance  :'	0	0	0
112000081	112	TAVBAL   DFHMDF POS=(14,54),LENGTH=14,ATTRB=(NORM,PROT),               *	0	0	0
112000082	112	               COLOR=NEUTRAL	0	0	0
112000083	112	***********************************************************************	0	0	0
112000084	112	MESSAGE  DFHMDF POS=(23,1),LENGTH=79,COLOR=YELLOW,ATTRB=(BRT,PROT)	0	0	0
112000085	112	         DFHMDF POS=(24,1),LENGTH=20,ATTRB=(NORM,PROT),COLOR=BLUE,     *	0	0	0
112000086	112	               INITIAL='F3=Exit   F12=Cancel'	0	0	0
112000087	112	DUMMY    DFHMDF POS=(24,79),LENGTH=1,ATTRB=(DRK,PROT,FSET),INITIAL=' '	0	0	0
112000088	112	***********************************************************************	0	0	0
112000089	112	         DFHMSD TYPE=FINAL	0	0	0
112000090	112	         END	0	0	0
113000001	113		0	0	0
113000002	113	*	0	0	0
113000003	113	*     Copyright IBM Corp. 2023	0	0	0
113000004	113	*	0	0	0
113000005	113		0	0	0
113000006	113	***************************************************************	0	0	0
113000007	113	*	0	0	0
113000008	113	* BNK1MEN	0	0	0
113000009	113	* Main Menu for CICS Banking Sample Application	0	0	0
113000010	113	*	0	0	0
113000011	113	* Created: 12-Nov-2015	0	0	0
113000012	113	*	0	0	0
113000013	113	* Generated by: IBM Rational Developer for System z with Java	0	0	0
113000014	113	*	0	0	0
113000015	113	* Description: The Main Menu for CICS Banking Sample Application	0	0	0
113000016	113	*	0	0	0
113000017	113	*	0	0	0
113000018	113	*	0	0	0
113000019	113	***************************************************************	0	0	0
113000020	113	BNK1MAI DFHMSD TYPE=&SYSPARM,MODE=INOUT,LANG=COBOL,STORAGE=AUTO,       *	0	0	0
113000021	113	               CTRL=FREEKB,EXTATT=YES,TERM=3270-2,TIOAPFX=YES,         *	0	0	0
113000022	113	               MAPATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI),                *	0	0	0
113000023	113	               DSATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI)	0	0	0
113000024	113	BNK1ME   DFHMDI SIZE=(24,80),                                          *	0	0	0
113000025	113	               COLUMN=1,LINE=1	0	0	0
113000026	113	         DFHMDF POS=(1,1),LENGTH=7,INITIAL='BNK1MA ',                  *	0	0	0
113000027	113	               ATTRB=(PROT,NORM),COLOR=BLUE	0	0	0
113000028	113	COMPANY  DFHMDF POS=(1,20),LENGTH=43,ATTRB=(NORM,PROT),COLOR=RED,      *	0	0	0
113000029	113	               INITIAL='CICS Banking Sample Application - Main Menu.'	0	0	0
113000030	113	***********************************************************************	0	0	0
113000031	113	         DFHMDF POS=(3,1),LENGTH=36,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
113000032	113	               INITIAL='Select an option. Then press Enter.'	0	0	0
113000033	113	         DFHMDF POS=(5,1),LENGTH=14,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
113000034	113	               INITIAL='Action . . . .'	0	0	0
113000035	113	ACTION   DFHMDF POS=(5,16),LENGTH=1,ATTRB=(NORM,NUM,IC),COLOR=GREEN,   *	0	0	0
113000036	113	               INITIAL=' ',HILIGHT=UNDERLINE	0	0	0
113000037	113	         DFHMDF POS=(5,18),LENGTH=46,ATTRB=(PROT,ASKIP),COLOR=NEUTRAL, *	0	0	0
113000038	113	               INITIAL='1.  Display/Delete/Update CUSTOMER information'	0	0	0
113000039	113	         DFHMDF POS=(6,18),LENGTH=38,ATTRB=(PROT,ASKIP),COLOR=NEUTRAL, *	0	0	0
113000040	113	               INITIAL='2.  Display/Delete ACCOUNT information'	0	0	0
113000041	113	         DFHMDF POS=(7,18),LENGTH=19,ATTRB=(PROT,ASKIP),COLOR=NEUTRAL, *	0	0	0
113000042	113	               INITIAL='3.  Create CUSTOMER'	0	0	0
113000043	113	         DFHMDF POS=(8,18),LENGTH=18,ATTRB=(PROT,ASKIP),COLOR=NEUTRAL, *	0	0	0
113000044	113	               INITIAL='4.  Create ACCOUNT'	0	0	0
113000045	113	         DFHMDF POS=(9,18),LENGTH=18,ATTRB=(PROT,ASKIP),COLOR=NEUTRAL, *	0	0	0
113000046	113	               INITIAL='5.  Update ACCOUNT'	0	0	0
113000047	113	         DFHMDF POS=(10,18),LENGTH=36,ATTRB=(ASKIP,PROT),COLOR=NEUTRAL,*	0	0	0
113000048	113	               INITIAL='6.  Credit/Debit funds to an ACCOUNT'	0	0	0
113000049	113	         DFHMDF POS=(11,18),LENGTH=42,                                 *	0	0	0
113000050	113	               INITIAL='7.  Transfer funds',                           *	0	0	0
113000051	113	               ATTRB=(PROT,ASKIP),COLOR=NEUTRAL	0	0	0
113000052	113	         DFHMDF POS=(13,18),LENGTH=41,ATTRB=(ASKIP,PROT),COLOR=NEUTRAL,*	0	0	0
113000053	113	               INITIAL='A.  Look up Accounts with Customer Number'	0	0	0
113000054	113	***********************************************************************	0	0	0
113000055	113	MESSAGE  DFHMDF POS=(23,1),LENGTH=79,COLOR=YELLOW,                     *	0	0	0
113000056	113	               ATTRB=(BRT,PROT,ASKIP)	0	0	0
113000057	113	         DFHMDF POS=(24,1),LENGTH=20,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
113000058	113	               COLOR=BLUE,                                             *	0	0	0
113000059	113	               INITIAL='F3=Exit   F12=Cancel'	0	0	0
113000060	113	DUMMY    DFHMDF POS=(24,79),LENGTH=1,ATTRB=(DRK,PROT,FSET,ASKIP),      *	0	0	0
113000061	113	               INITIAL=' '	0	0	0
113000062	113	***********************************************************************	0	0	0
113000063	113	         DFHMSD TYPE=FINAL	0	0	0
113000064	113	         END	0	0	0
114000001	114		0	0	0
114000002	114	*	0	0	0
114000003	114	*     Copyright IBM Corp. 2023	0	0	0
114000004	114	*	0	0	0
114000005	114		0	0	0
114000006	114	***************************************************************	0	0	0
114000007	114	*	0	0	0
114000008	114	* BNK1UAM	0	0	0
114000009	114	* Update Account for CICS Banking Sample Application	0	0	0
114000010	114	*	0	0	0
114000011	114	* Created: 12-Nov-2014	0	0	0
114000012	114	*	0	0	0
114000013	114	* Generated by: IBM Rational Developer for System z with Java	0	0	0
114000014	114	*	0	0	0
114000015	114	* Description: Update Account Information	0	0	0
114000016	114	*	0	0	0
114000017	114	*	0	0	0
114000018	114	*	0	0	0
114000019	114	***************************************************************	0	0	0
114000020	114	BNK1UAM  DFHMSD TYPE=&SYSPARM,MODE=INOUT,LANG=COBOL,STORAGE=AUTO,      *	0	0	0
114000021	114	               CTRL=FREEKB,EXTATT=YES,TERM=3270-2,TIOAPFX=YES,         *	0	0	0
114000022	114	               MAPATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI),                *	0	0	0
114000023	114	               DSATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI)	0	0	0
114000024	114	BNK1UA   DFHMDI SIZE=(24,80),                                          *	0	0	0
114000025	114	               COLUMN=1,LINE=1	0	0	0
114000026	114	         DFHMDF POS=(1,1),LENGTH=7,INITIAL='BNK1UA ',                  *	0	0	0
114000027	114	               ATTRB=(NORM,PROT),COLOR=BLUE	0	0	0
114000028	114	COMPANY  DFHMDF POS=(1,17),LENGTH=52,ATTRB=(NORM,PROT),COLOR=RED,      *	0	0	0
114000029	114	               INITIAL='CICS Banking Sample Application - Update Accoun*	0	0	0
114000030	114	               t.'	0	0	0
114000031	114	***********************************************************************	0	0	0
114000032	114	         DFHMDF POS=(3,1),LENGTH=34,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
114000033	114	               INITIAL='Please provide an ACCOUNT number.'	0	0	0
114000034	114	         DFHMDF POS=(5,1),LENGTH=15,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
114000035	114	               INITIAL='ACCOUNT NUMBER'	0	0	0
114000036	114	ACCNO    DFHMDF POS=(5,17),LENGTH=8,ATTRB=(NORM,NUM,IC,UNPROT),        *	0	0	0
114000037	114	               COLOR=GREEN,                                            *	0	0	0
114000038	114	               HILIGHT=UNDERLINE	0	0	0
114000039	114	         DFHMDF POS=(5,26),LENGTH=1,ATTRB=(PROT,ASKIP)	0	0	0
114000040	114	         DFHMDF POS=(7,1),LENGTH=18,ATTRB=(NORM,PROT),                 *	0	0	0
114000041	114	               COLOR=NEUTRAL,INITIAL=' Customer Number:'	0	0	0
114000042	114	CUSTNO   DFHMDF POS=(7,20),LENGTH=10,ATTRB=(NORM,PROT,FSET),           *	0	0	0
114000043	114	               COLOR=TURQUOISE	0	0	0
114000044	114	         DFHMDF POS=(7,32),LENGTH=1,ATTRB=(ASKIP,PROT)	0	0	0
114000045	114	         DFHMDF POS=(8,1),LENGTH=18,ATTRB=(NORM,PROT),                 *	0	0	0
114000046	114	               COLOR=NEUTRAL,INITIAL=' Sort Code      :'	0	0	0
114000047	114	SORTC    DFHMDF POS=(8,20),LENGTH=6,ATTRB=(NORM,PROT,FSET),            *	0	0	0
114000048	114	               COLOR=TURQUOISE	0	0	0
114000049	114	         DFHMDF POS=(8,27),LENGTH=1,ATTRB=(ASKIP,PROT)	0	0	0
114000050	114	         DFHMDF POS=(9,1),LENGTH=18,ATTRB=(NORM,PROT),                 *	0	0	0
114000051	114	               COLOR=NEUTRAL,INITIAL=' Account Number :'	0	0	0
114000052	114	ACCNO2   DFHMDF POS=(9,20),LENGTH=8,                                   *	0	0	0
114000053	114	               ATTRB=(PROT,NORM,FSET),COLOR=TURQUOISE	0	0	0
114000054	114	         DFHMDF POS=(9,32),LENGTH=1,ATTRB=(ASKIP,PROT)	0	0	0
114000055	114	         DFHMDF POS=(10,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
114000056	114	               COLOR=NEUTRAL,INITIAL=' Account Type   :'	0	0	0
114000057	114	ACTYPE   DFHMDF POS=(10,20),LENGTH=8,                                  *	0	0	0
114000058	114	               ATTRB=(UNPROT,FSET,NORM),COLOR=GREEN,HILIGHT=UNDERLINE	0	0	0
114000059	114	         DFHMDF POS=(10,29),LENGTH=1,ATTRB=(ASKIP,PROT)	0	0	0
114000060	114	         DFHMDF POS=(11,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
114000061	114	               COLOR=NEUTRAL,INITIAL=' Interest Rate  :'	0	0	0
114000062	114	INTRT    DFHMDF POS=(11,20),LENGTH=7,                                  *	0	0	0
114000063	114	               ATTRB=(UNPROT,FSET,NORM),COLOR=GREEN,PICOUT='9999.99',  *	0	0	0
114000064	114	               HILIGHT=UNDERLINE	0	0	0
114000065	114	         DFHMDF POS=(11,28),LENGTH=1,ATTRB=(ASKIP,PROT)	0	0	0
114000066	114	         DFHMDF POS=(12,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
114000067	114	               COLOR=NEUTRAL,INITIAL=' Account Opened :'	0	0	0
114000068	114	OPENDD   DFHMDF POS=(12,20),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
114000069	114	               COLOR=TURQUOISE	0	0	0
114000070	114	         DFHMDF POS=(12,23),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
114000071	114	               COLOR=TURQUOISE,INITIAL='/'	0	0	0
114000072	114	OPENMM   DFHMDF POS=(12,25),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
114000073	114	               COLOR=TURQUOISE	0	0	0
114000074	114	         DFHMDF POS=(12,28),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
114000075	114	               COLOR=TURQUOISE,INITIAL='/'	0	0	0
114000076	114	OPENYY   DFHMDF POS=(12,30),LENGTH=4,ATTRB=(NORM,PROT,FSET),           *	0	0	0
114000077	114	               COLOR=TURQUOISE	0	0	0
114000078	114	         DFHMDF POS=(13,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
114000079	114	               COLOR=NEUTRAL,INITIAL=' Overdraft limit:'	0	0	0
114000080	114	OVERDR   DFHMDF POS=(13,20),LENGTH=8,ATTRB=(NORM,UNPROT,FSET),         *	0	0	0
114000081	114	               COLOR=GREEN,HILIGHT=UNDERLINE	0	0	0
114000082	114	         DFHMDF POS=(13,29),LENGTH=1,ATTRB=(ASKIP,PROT)	0	0	0
114000083	114	         DFHMDF POS=(14,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
114000084	114	               COLOR=NEUTRAL,INITIAL=' Last statement :'	0	0	0
114000085	114	LSTMTDD  DFHMDF POS=(14,20),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
114000086	114	               COLOR=TURQUOISE	0	0	0
114000087	114	         DFHMDF POS=(14,23),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
114000088	114	               COLOR=TURQUOISE,INITIAL='/'	0	0	0
114000089	114	LSTMTMM  DFHMDF POS=(14,25),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
114000090	114	               COLOR=TURQUOISE	0	0	0
114000091	114	         DFHMDF POS=(14,28),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
114000092	114	               COLOR=TURQUOISE,INITIAL='/'	0	0	0
114000093	114	LSTMTYY  DFHMDF POS=(14,30),LENGTH=4,ATTRB=(NORM,PROT,FSET),           *	0	0	0
114000094	114	               COLOR=TURQUOISE	0	0	0
114000095	114	         DFHMDF POS=(14,35),LENGTH=1,ATTRB=(ASKIP,PROT)	0	0	0
114000096	114	         DFHMDF POS=(15,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
114000097	114	               COLOR=NEUTRAL,INITIAL=' Next statement :'	0	0	0
114000098	114	NSTMTDD  DFHMDF POS=(15,20),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
114000099	114	               COLOR=TURQUOISE	0	0	0
114000100	114	         DFHMDF POS=(15,23),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
114000101	114	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
114000102	114	NSTMTMM  DFHMDF POS=(15,25),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
114000103	114	               COLOR=TURQUOISE	0	0	0
114000104	114	         DFHMDF POS=(15,28),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
114000105	114	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
114000106	114	NSTMTYY  DFHMDF POS=(15,30),LENGTH=4,ATTRB=(NORM,PROT,FSET),           *	0	0	0
114000107	114	               COLOR=TURQUOISE	0	0	0
114000108	114	         DFHMDF POS=(16,1),LENGTH=17,ATTRB=(NORM,PROT),                *	0	0	0
114000109	114	               COLOR=NEUTRAL,INITIAL=' Available Bal  :'	0	0	0
114000110	114	AVBAL    DFHMDF POS=(16,19),LENGTH=14,ATTRB=(NORM,PROT,FSET),          *	0	0	0
114000111	114	               COLOR=TURQUOISE	0	0	0
114000112	114	         DFHMDF POS=(17,1),LENGTH=17,ATTRB=(NORM,PROT),                *	0	0	0
114000113	114	               COLOR=NEUTRAL,INITIAL=' Actual Balance :'	0	0	0
114000114	114	ACTBAL   DFHMDF POS=(17,19),LENGTH=14,ATTRB=(NORM,PROT,FSET),          *	0	0	0
114000115	114	               COLOR=TURQUOISE	0	0	0
114000116	114	***********************************************************************	0	0	0
114000117	114	MESSAGE  DFHMDF POS=(23,1),LENGTH=79,COLOR=YELLOW,ATTRB=(BRT,PROT)	0	0	0
114000118	114	         DFHMDF POS=(24,1),LENGTH=20,ATTRB=(NORM,PROT),COLOR=BLUE,     *	0	0	0
114000119	114	               INITIAL='F3=Exit   F12=Cancel'	0	0	0
114000120	114	DUMMY    DFHMDF POS=(24,79),LENGTH=1,ATTRB=(DRK,PROT,FSET),INITIAL=' '	0	0	0
114000121	114	***********************************************************************	0	0	0
114000122	114	         DFHMSD TYPE=FINAL	0	0	0
114000123	114	         END	0	0	0
115000001	115		0	0	0
115000002	115	*	0	0	0
115000003	115	*     Copyright IBM Corp. 2023	0	0	0
115000004	115	*	0	0	0
115000005	115		0	0	0
115000006	115	***************************************************************	0	0	0
115000007	115	*	0	0	0
115000008	115	* BNK1CAM	0	0	0
115000009	115	* Create Account for CICS Banking Sample Application	0	0	0
115000010	115	*	0	0	0
115000011	115	* Created: 12-Nov-2015	0	0	0
115000012	115	*	0	0	0
115000013	115	* Generated by: IBM Rational Developer for System z with Java	0	0	0
115000014	115	*	0	0	0
115000015	115	* Description: Creates a new Account for an existing customer	0	0	0
115000016	115	*	0	0	0
115000017	115	*	0	0	0
115000018	115	*	0	0	0
115000019	115	***************************************************************	0	0	0
115000020	115	BNK1CAM  DFHMSD TYPE=&SYSPARM,MODE=INOUT,LANG=COBOL,STORAGE=AUTO,      *	0	0	0
115000021	115	               CTRL=FREEKB,EXTATT=YES,TERM=3270-2,TIOAPFX=YES,         *	0	0	0
115000022	115	               MAPATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI),                *	0	0	0
115000023	115	               DSATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI)	0	0	0
115000024	115	BNK1CA   DFHMDI SIZE=(24,80),                                          *	0	0	0
115000025	115	               COLUMN=1,LINE=1	0	0	0
115000026	115	         DFHMDF POS=(1,1),LENGTH=7,INITIAL='BNK1CA ',                  *	0	0	0
115000027	115	               ATTRB=(PROT,NORM),COLOR=BLUE	0	0	0
115000028	115	COMPANY  DFHMDF POS=(1,18),LENGTH=58,ATTRB=(NORM,PROT),COLOR=RED,      *	0	0	0
115000029	115	               INITIAL='CICS Banking Sample Application- Create Account*	0	0	0
115000030	115	               .'	0	0	0
115000031	115	***********************************************************************	0	0	0
115000032	115	         DFHMDF POS=(3,1),LENGTH=57,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
115000033	115	               INITIAL='Please provide the requested information and pr*	0	0	0
115000034	115	               ess Enter.'	0	0	0
115000035	115	         DFHMDF POS=(6,1),LENGTH=18,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
115000036	115	               INITIAL='Customer number  :'	0	0	0
115000037	115	CUSTNO   DFHMDF POS=(6,23),LENGTH=10,ATTRB=(NORM,NUM,FSET),            *	0	0	0
115000038	115	               COLOR=GREEN,HILIGHT=UNDERLINE	0	0	0
115000039	115	         DFHMDF POS=(6,34),LENGTH=1,ATTRB=(PROT,ASKIP)	0	0	0
115000040	115	         DFHMDF POS=(7,1),LENGTH=18,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
115000041	115	               INITIAL='Account Type     :'	0	0	0
115000042	115	ACCTYP   DFHMDF POS=(7,23),LENGTH=8,ATTRB=(NORM,UNPROT,FSET),          *	0	0	0
115000043	115	               COLOR=GREEN,HILIGHT=UNDERLINE	0	0	0
115000044	115	         DFHMDF POS=(7,32),LENGTH=1,ATTRB=(PROT,ASKIP)	0	0	0
115000045	115	         DFHMDF POS=(8,1),LENGTH=18,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
115000046	115	               INITIAL='Interest Rate    :'	0	0	0
115000047	115	INTRT    DFHMDF POS=(8,23),LENGTH=7,ATTRB=(NORM,FSET,UNPROT),          *	0	0	0
115000048	115	               COLOR=GREEN,INITIAL='0000.00',                          *	0	0	0
115000049	115	               HILIGHT=UNDERLINE	0	0	0
115000050	115	         DFHMDF POS=(8,31),LENGTH=1,ATTRB=(PROT,ASKIP)	0	0	0
115000051	115	         DFHMDF POS=(9,1),LENGTH=18,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
115000052	115	               INITIAL='Overdraft Limit  :'	0	0	0
115000053	115	OVERDR   DFHMDF POS=(9,23),LENGTH=8,ATTRB=(NORM,NUM,UNPROT,FSET),      *	0	0	0
115000054	115	               COLOR=GREEN,HILIGHT=UNDERLINE,INITIAL='0',JUSTIFY=RIGHT	0	0	0
115000055	115	         DFHMDF POS=(9,32),LENGTH=1,ATTRB=(PROT,ASKIP)	0	0	0
115000056	115		0	0	0
115000057	115	         DFHMDF POS=(13,1),LENGTH=18,ATTRB=(NORM,PROT),COLOR=NEUTRAL,  *	0	0	0
115000058	115	               INITIAL='Account number   :'	0	0	0
115000059	115	ACCNO    DFHMDF POS=(13,23),LENGTH=8,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000060	115	               COLOR=NEUTRAL,INITIAL='        '	0	0	0
115000061	115	         DFHMDF POS=(14,1),LENGTH=18,ATTRB=(NORM,PROT),COLOR=NEUTRAL,  *	0	0	0
115000062	115	               INITIAL='Sort code        :'	0	0	0
115000063	115	SRTCD    DFHMDF POS=(14,23),LENGTH=6,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000064	115	               COLOR=NEUTRAL	0	0	0
115000065	115	         DFHMDF POS=(15,1),LENGTH=18,ATTRB=(NORM,PROT),COLOR=NEUTRAL,  *	0	0	0
115000066	115	               INITIAL='Account Opened   :'	0	0	0
115000067	115	OPENDD   DFHMDF POS=(15,23),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000068	115	               COLOR=NEUTRAL	0	0	0
115000069	115	         DFHMDF POS=(15,26),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
115000070	115	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
115000071	115	OPENMM   DFHMDF POS=(15,28),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000072	115	               COLOR=NEUTRAL	0	0	0
115000073	115	         DFHMDF POS=(15,31),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
115000074	115	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
115000075	115	OPENYY   DFHMDF POS=(15,33),LENGTH=4,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000076	115	               COLOR=NEUTRAL	0	0	0
115000077	115	         DFHMDF POS=(16,1),LENGTH=18,ATTRB=(NORM,PROT),COLOR=NEUTRAL,  *	0	0	0
115000078	115	               INITIAL='Last Stmt Date   :'	0	0	0
115000079	115	LSTMDD   DFHMDF POS=(16,23),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000080	115	               COLOR=NEUTRAL	0	0	0
115000081	115	         DFHMDF POS=(16,26),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
115000082	115	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
115000083	115	LSTMMM   DFHMDF POS=(16,28),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000084	115	               COLOR=NEUTRAL	0	0	0
115000085	115	         DFHMDF POS=(16,31),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
115000086	115	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
115000087	115	LSTMYY   DFHMDF POS=(16,33),LENGTH=4,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000088	115	               COLOR=NEUTRAL	0	0	0
115000089	115	         DFHMDF POS=(17,1),LENGTH=18,ATTRB=(NORM,PROT),COLOR=NEUTRAL,  *	0	0	0
115000090	115	               INITIAL='Next Stmt Date   :'	0	0	0
115000091	115	NSTMTDD  DFHMDF POS=(17,23),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000092	115	               COLOR=NEUTRAL	0	0	0
115000093	115	         DFHMDF POS=(17,26),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
115000094	115	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
115000095	115	NSTMTMM  DFHMDF POS=(17,28),LENGTH=2,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000096	115	               COLOR=NEUTRAL	0	0	0
115000097	115	         DFHMDF POS=(17,31),LENGTH=1,ATTRB=(NORM,PROT),                *	0	0	0
115000098	115	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
115000099	115	NSTMTYY  DFHMDF POS=(17,33),LENGTH=4,ATTRB=(NORM,PROT,FSET),           *	0	0	0
115000100	115	               COLOR=NEUTRAL	0	0	0
115000101	115	         DFHMDF POS=(18,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
115000102	115	               COLOR=NEUTRAL,INITIAL='Available Balance:'	0	0	0
115000103	115	AVAIL    DFHMDF POS=(18,22),LENGTH=14,ATTRB=(NORM,PROT,FSET),          *	0	0	0
115000104	115	               COLOR=NEUTRAL	0	0	0
115000105	115	         DFHMDF POS=(19,1),LENGTH=18,ATTRB=(NORM,PROT),                *	0	0	0
115000106	115	               COLOR=NEUTRAL,INITIAL='Actual Balance   :'	0	0	0
115000107	115	ACTBAL   DFHMDF POS=(19,22),LENGTH=14,ATTRB=(NORM,PROT,FSET),          *	0	0	0
115000108	115	               COLOR=NEUTRAL	0	0	0
115000109	115	***********************************************************************	0	0	0
115000110	115	MESSAGE  DFHMDF POS=(23,1),LENGTH=79,COLOR=YELLOW,ATTRB=(BRT,PROT)	0	0	0
115000111	115	         DFHMDF POS=(24,1),LENGTH=20,ATTRB=(NORM,PROT),COLOR=BLUE,     *	0	0	0
115000112	115	               INITIAL='F3=Exit   F12=Cancel'	0	0	0
115000113	115	DUMMY    DFHMDF POS=(24,79),LENGTH=1,ATTRB=(DRK,PROT,FSET),INITIAL=' '	0	0	0
115000114	115	***********************************************************************	0	0	0
115000115	115	         DFHMSD TYPE=FINAL	0	0	0
115000116	115	         END	0	0	0
116000001	116		0	0	0
116000002	116	*	0	0	0
116000003	116	*     Copyright IBM Corp. 2023	0	0	0
116000004	116	*	0	0	0
116000005	116		0	0	0
116000006	116	******************************************************************	0	0	0
116000007	116		0	0	0
116000008	116	***************************************************************	0	0	0
116000009	116	*	0	0	0
116000010	116	* BNK1CCM	0	0	0
116000011	116	* Create Customer for CICS Banking Sample Application	0	0	0
116000012	116	*	0	0	0
116000013	116	* Created: 12-Nov-2015	0	0	0
116000014	116	*	0	0	0
116000015	116	* Generated by: IBM Rational Developer for System z with Java	0	0	0
116000016	116	*	0	0	0
116000017	116	* Description: Creates a new Customer	0	0	0
116000018	116	*	0	0	0
116000019	116	*	0	0	0
116000020	116	*	0	0	0
116000021	116	***************************************************************	0	0	0
116000022	116	BNK1CCM  DFHMSD TYPE=&SYSPARM,MODE=INOUT,LANG=COBOL,STORAGE=AUTO,      *	0	0	0
116000023	116	               CTRL=FREEKB,EXTATT=YES,TERM=3270-2,TIOAPFX=YES,         *	0	0	0
116000024	116	               MAPATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI),                *	0	0	0
116000025	116	               DSATTS=(COLOR,HILIGHT,OUTLINE,PS,SOSI)	0	0	0
116000026	116	BNK1CC   DFHMDI SIZE=(24,80),                                          *	0	0	0
116000027	116	               COLUMN=1,LINE=1	0	0	0
116000028	116	         DFHMDF POS=(1,1),LENGTH=7,INITIAL='BNK1CC ',                  *	0	0	0
116000029	116	               ATTRB=(PROT,NORM),COLOR=BLUE	0	0	0
116000030	116	COMPANY  DFHMDF POS=(1,16),LENGTH=52,ATTRB=(NORM,PROT),COLOR=RED,      *	0	0	0
116000031	116	               INITIAL='CICS Banking Sample Application - Create Custom*	0	0	0
116000032	116	               er.'	0	0	0
116000033	116	***********************************************************************	0	0	0
116000034	116	         DFHMDF POS=(3,1),LENGTH=46,ATTRB=(NORM,PROT),COLOR=TURQUOISE, *	0	0	0
116000035	116	               INITIAL='Provide a Name, Address and D.O.B. then Enter '	0	0	0
116000036	116	         DFHMDF POS=(7,1),LENGTH=16,ATTRB=(NORM,PROT),                 *	0	0	0
116000037	116	               COLOR=NEUTRAL,INITIAL=' Customer Title'	0	0	0
116000038	116	CUSTTIT  DFHMDF POS=(7,18),LENGTH=10,                                  *	0	0	0
116000039	116	               ATTRB=(UNPROT,FSET,NORM,IC),COLOR=GREEN,                *	0	0	0
116000040	116	               HILIGHT=UNDERLINE	0	0	0
116000041	116	         DFHMDF POS=(7,29),LENGTH=0,ATTRB=(ASKIP,PROT),                *	0	0	0
116000042	116	               COLOR=NEUTRAL	0	0	0
116000043	116	         DFHMDF POS=(7,31),LENGTH=14,ATTRB=(NORM,PROT),                *	0	0	0
116000044	116	               COLOR=NEUTRAL,INITIAL='First Name'	0	0	0
116000045	116	CHRISTN  DFHMDF POS=(7,46),LENGTH=20,                                  *	0	0	0
116000046	116	               ATTRB=(UNPROT,FSET,NORM),COLOR=GREEN,                   *	0	0	0
116000047	116	               HILIGHT=UNDERLINE	0	0	0
116000048	116	         DFHMDF POS=(7,67),LENGTH=0,ATTRB=(ASKIP,PROT),                *	0	0	0
116000049	116	               COLOR=NEUTRAL	0	0	0
116000050	116	         DFHMDF POS=(8,1),LENGTH=16,ATTRB=(NORM,PROT),                 *	0	0	0
116000051	116	               COLOR=NEUTRAL,INITIAL=' Middle Initials'	0	0	0
116000052	116	CUSTINS  DFHMDF POS=(8,18),LENGTH=2,                                   *	0	0	0
116000053	116	               ATTRB=(UNPROT,FSET,NORM),COLOR=GREEN,                   *	0	0	0
116000054	116	               HILIGHT=UNDERLINE	0	0	0
116000055	116	         DFHMDF POS=(8,21),LENGTH=0,                                   *	0	0	0
116000056	116	               ATTRB=(PROT,ASKIP),COLOR=GREEN	0	0	0
116000057	116	         DFHMDF POS=(8,22),LENGTH=12,ATTRB=(NORM,PROT),                *	0	0	0
116000058	116	               COLOR=NEUTRAL,INITIAL='Family name '	0	0	0
116000059	116	CUSTSN   DFHMDF POS=(8,35),LENGTH=20,                                  *	0	0	0
116000060	116	               ATTRB=(UNPROT,FSET,NORM),COLOR=GREEN,                   *	0	0	0
116000061	116	               HILIGHT=UNDERLINE	0	0	0
116000062	116	         DFHMDF POS=(8,56),ATTRB=(PROT,ASKIP),LENGTH=1	0	0	0
116000063	116	         DFHMDF POS=(10,1),LENGTH=16,ATTRB=(NORM,PROT),                *	0	0	0
116000064	116	               COLOR=NEUTRAL,INITIAL=' Customer Addr1 '	0	0	0
116000065	116	CUSTAD1  DFHMDF POS=(10,18),LENGTH=60,                                 *	0	0	0
116000066	116	               ATTRB=(UNPROT,FSET,NORM),COLOR=GREEN,                   *	0	0	0
116000067	116	               HILIGHT=UNDERLINE	0	0	0
116000068	116	         DFHMDF POS=(10,79),LENGTH=0,                                  *	0	0	0
116000069	116	               ATTRB=(PROT,ASKIP),COLOR=GREEN	0	0	0
116000070	116	         DFHMDF POS=(11,1),LENGTH=16,ATTRB=(NORM,PROT),                *	0	0	0
116000071	116	               COLOR=NEUTRAL,INITIAL=' Customer Addr2 '	0	0	0
116000072	116	CUSTAD2  DFHMDF POS=(11,18),LENGTH=60,ATTRB=(NORM,UNPROT,FSET),        *	0	0	0
116000073	116	               COLOR=GREEN,                                            *	0	0	0
116000074	116	               HILIGHT=UNDERLINE	0	0	0
116000075	116	         DFHMDF POS=(11,79),LENGTH=0,                                  *	0	0	0
116000076	116	               ATTRB=(PROT,ASKIP),COLOR=GREEN	0	0	0
116000077	116	         DFHMDF POS=(12,1),LENGTH=16,ATTRB=(NORM,PROT),                *	0	0	0
116000078	116	               COLOR=NEUTRAL,INITIAL=' Customer Addr3 '	0	0	0
116000079	116	CUSTAD3  DFHMDF POS=(12,18),LENGTH=40,ATTRB=(NORM,UNPROT,FSET),        *	0	0	0
116000080	116	               COLOR=GREEN,                                            *	0	0	0
116000081	116	               HILIGHT=UNDERLINE	0	0	0
116000082	116	         DFHMDF POS=(12,59),ATTRB=(PROT,ASKIP),LENGTH=1	0	0	0
116000083	116	         DFHMDF POS=(13,1),LENGTH=16,ATTRB=(NORM,PROT),                *	0	0	0
116000084	116	               COLOR=NEUTRAL,INITIAL=' Customer D.O.B.'	0	0	0
116000085	116	DOBDD    DFHMDF POS=(13,18),LENGTH=2,ATTRB=(NORM,UNPROT,FSET,NUM),     *	0	0	0
116000086	116	               COLOR=GREEN,HILIGHT=UNDERLINE	0	0	0
116000087	116	         DFHMDF POS=(13,21),LENGTH=1,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
116000088	116	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
116000089	116	DOBMM    DFHMDF POS=(13,23),LENGTH=2,ATTRB=(NORM,UNPROT,FSET,NUM),     *	0	0	0
116000090	116	               COLOR=GREEN,HILIGHT=UNDERLINE	0	0	0
116000091	116	         DFHMDF POS=(13,26),LENGTH=1,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
116000092	116	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
116000093	116	DOBYY    DFHMDF POS=(13,28),LENGTH=4,ATTRB=(NORM,NUM,UNPROT,FSET),     *	0	0	0
116000094	116	               COLOR=GREEN,HILIGHT=UNDERLINE	0	0	0
116000095	116	         DFHMDF POS=(13,33),ATTRB=(PROT,ASKIP),LENGTH=1	0	0	0
116000096	116	         DFHMDF POS=(15,1),LENGTH=16,ATTRB=(NORM,PROT),                *	0	0	0
116000097	116	               COLOR=NEUTRAL,INITIAL=' Sort Code     '	0	0	0
116000098	116	SORTC    DFHMDF POS=(15,18),LENGTH=6,ATTRB=(NORM,PROT,FSET,NUM),       *	0	0	0
116000099	116	               COLOR=NEUTRAL	0	0	0
116000100	116	         DFHMDF POS=(16,1),LENGTH=16,ATTRB=(NORM,PROT),                *	0	0	0
116000101	116	               COLOR=NEUTRAL,INITIAL=' Customer Number'	0	0	0
116000102	116	CUSTNO2  DFHMDF POS=(16,18),LENGTH=10,ATTRB=(NORM,PROT,FSET,NUM),      *	0	0	0
116000103	116	               COLOR=NEUTRAL	0	0	0
116000104	116	         DFHMDF POS=(17,1),LENGTH=16,ATTRB=(NORM,PROT),                *	0	0	0
116000105	116	               COLOR=NEUTRAL,INITIAL=' Credit Score   '	0	0	0
116000106	116	CREDSC   DFHMDF POS=(17,18),LENGTH=3,ATTRB=(NORM,PROT,FSET,NUM),       *	0	0	0
116000107	116	               COLOR=NEUTRAL	0	0	0
116000108	116	         DFHMDF POS=(18,1),LENGTH=16,ATTRB=(NORM,PROT),                *	0	0	0
116000109	116	               COLOR=NEUTRAL,INITIAL=' CS Review Date '	0	0	0
116000110	116	SCRDTDD  DFHMDF POS=(18,18),LENGTH=2,ATTRB=(NORM,PROT,FSET,NUM),       *	0	0	0
116000111	116	               COLOR=NEUTRAL	0	0	0
116000112	116	         DFHMDF POS=(18,21),LENGTH=1,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
116000113	116	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
116000114	116	SCRDTMM  DFHMDF POS=(18,23),LENGTH=2,ATTRB=(NORM,PROT,FSET,NUM),       *	0	0	0
116000115	116	               COLOR=NEUTRAL	0	0	0
116000116	116	         DFHMDF POS=(18,26),LENGTH=1,ATTRB=(NORM,PROT,ASKIP),          *	0	0	0
116000117	116	               COLOR=NEUTRAL,INITIAL='/'	0	0	0
116000118	116	SCRDTYY  DFHMDF POS=(18,28),LENGTH=4,ATTRB=(NORM,PROT,FSET,NUM),       *	0	0	0
116000119	116	               COLOR=NEUTRAL	0	0	0
116000120	116	***********************************************************************	0	0	0
116000121	116	MESSAGE  DFHMDF POS=(23,1),LENGTH=79,COLOR=YELLOW,ATTRB=(BRT,PROT)	0	0	0
116000122	116	         DFHMDF POS=(24,1),LENGTH=20,ATTRB=(NORM,PROT),COLOR=BLUE,     *	0	0	0
116000123	116	               INITIAL='F3=Exit   F12=Cancel'	0	0	0
116000124	116	DUMMY    DFHMDF POS=(24,79),LENGTH=1,ATTRB=(DRK,PROT,FSET),INITIAL=' '	0	0	0
116000125	116	***********************************************************************	0	0	0
116000126	116	         DFHMSD TYPE=FINAL	0	0	0
116000127	116	         END	0	0	0
117000001	117	*************************************************************************	0	0	0
117000002	117	*                                                                     *	0	0	0
117000003	117	*     Copyright IBM Corp. 2023                                        *	0	0	0
117000004	117	*                                                                     *	0	0	0
117000005	117	*************************************************************************	0	0	0
117000006	117		0	0	0
117000007	117	DFHNCOPT TITLE 'CICS Named Counter Server: Sample Option Table'	0	0	0
117000008	117	         EJECT ,	0	0	0
117000009	117	         DFHNCO POOLSEL=DFHNC*,POOL=YES	0	0	0
117000010	117	         DFHNCO POOL=YES	0	0	0
117000011	117	         END   DFHNCOPT	0	0	0
